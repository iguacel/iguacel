(this["webpackJsonpraster-react-canvas2"]=this["webpackJsonpraster-react-canvas2"]||[]).push([[19],{101:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(72),o=function(e,t){void 0===t&&console.warn('THREE.TrackballControls: The second parameter "domElement" is now mandatory.'),t===document&&console.error('THREE.TrackballControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.');var r=this,o=-1,a=0,i=1,s=2,c=3,l=4;this.object=e,this.domElement=t,this.enabled=!0,this.screen={left:0,top:0,width:0,height:0},this.rotateSpeed=1,this.zoomSpeed=1.2,this.panSpeed=.3,this.noRotate=!1,this.noZoom=!1,this.noPan=!1,this.staticMoving=!1,this.dynamicDampingFactor=.2,this.minDistance=0,this.maxDistance=1/0,this.keys=[65,83,68],this.mouseButtons={LEFT:n.MOUSE.ROTATE,MIDDLE:n.MOUSE.ZOOM,RIGHT:n.MOUSE.PAN},this.target=new n.Vector3;var u=new n.Vector3,h=1,p=o,d=o,f=new n.Vector3,m=new n.Vector2,v=new n.Vector2,g=new n.Vector3,y=0,b=new n.Vector2,w=new n.Vector2,M=0,x=0,E=new n.Vector2,S=new n.Vector2;this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.up0=this.object.up.clone(),this.zoom0=this.object.zoom;var T={type:"change"},L={type:"start"},R={type:"end"};this.handleResize=function(){var e=this.domElement.getBoundingClientRect(),t=this.domElement.ownerDocument.documentElement;this.screen.left=e.left+window.pageXOffset-t.clientLeft,this.screen.top=e.top+window.pageYOffset-t.clientTop,this.screen.width=e.width,this.screen.height=e.height};var A=function(){var e=new n.Vector2;return function(t,n){return e.set((t-r.screen.left)/r.screen.width,(n-r.screen.top)/r.screen.height),e}}(),_=function(){var e=new n.Vector2;return function(t,n){return e.set((t-.5*r.screen.width-r.screen.left)/(.5*r.screen.width),(r.screen.height+2*(r.screen.top-n))/r.screen.width),e}}();function P(e){!1!==r.enabled&&(window.removeEventListener("keydown",P),d===o&&(e.keyCode!==r.keys[a]||r.noRotate?e.keyCode!==r.keys[i]||r.noZoom?e.keyCode!==r.keys[s]||r.noPan||(d=s):d=i:d=a))}function C(){!1!==r.enabled&&(d=o,window.addEventListener("keydown",P,!1))}function O(e){if(!1!==r.enabled){if(e.preventDefault(),e.stopPropagation(),p===o)switch(e.button){case r.mouseButtons.LEFT:p=a;break;case r.mouseButtons.MIDDLE:p=i;break;case r.mouseButtons.RIGHT:p=s;break;default:p=o}var t=d!==o?d:p;t!==a||r.noRotate?t!==i||r.noZoom?t!==s||r.noPan||(E.copy(A(e.pageX,e.pageY)),S.copy(E)):(b.copy(A(e.pageX,e.pageY)),w.copy(b)):(v.copy(_(e.pageX,e.pageY)),m.copy(v)),document.addEventListener("mousemove",I,!1),document.addEventListener("mouseup",j,!1),r.dispatchEvent(L)}}function I(e){if(!1!==r.enabled){e.preventDefault(),e.stopPropagation();var t=d!==o?d:p;t!==a||r.noRotate?t!==i||r.noZoom?t!==s||r.noPan||S.copy(A(e.pageX,e.pageY)):w.copy(A(e.pageX,e.pageY)):(m.copy(v),v.copy(_(e.pageX,e.pageY)))}}function j(e){!1!==r.enabled&&(e.preventDefault(),e.stopPropagation(),p=o,document.removeEventListener("mousemove",I),document.removeEventListener("mouseup",j),r.dispatchEvent(R))}function D(e){if(!1!==r.enabled&&!0!==r.noZoom){switch(e.preventDefault(),e.stopPropagation(),e.deltaMode){case 2:b.y-=.025*e.deltaY;break;case 1:b.y-=.01*e.deltaY;break;default:b.y-=25e-5*e.deltaY}r.dispatchEvent(L),r.dispatchEvent(R)}}function k(e){if(!1!==r.enabled){switch(e.preventDefault(),e.touches.length){case 1:p=c,v.copy(_(e.touches[0].pageX,e.touches[0].pageY)),m.copy(v);break;default:p=l;var t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY;x=M=Math.sqrt(t*t+n*n);var o=(e.touches[0].pageX+e.touches[1].pageX)/2,a=(e.touches[0].pageY+e.touches[1].pageY)/2;E.copy(A(o,a)),S.copy(E)}r.dispatchEvent(L)}}function F(e){if(!1!==r.enabled)switch(e.preventDefault(),e.stopPropagation(),e.touches.length){case 1:m.copy(v),v.copy(_(e.touches[0].pageX,e.touches[0].pageY));break;default:var t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY;x=Math.sqrt(t*t+n*n);var o=(e.touches[0].pageX+e.touches[1].pageX)/2,a=(e.touches[0].pageY+e.touches[1].pageY)/2;S.copy(A(o,a))}}function U(e){if(!1!==r.enabled){switch(e.touches.length){case 0:p=o;break;case 1:p=c,v.copy(_(e.touches[0].pageX,e.touches[0].pageY)),m.copy(v)}r.dispatchEvent(R)}}function N(e){!1!==r.enabled&&e.preventDefault()}this.rotateCamera=function(){var e,t=new n.Vector3,o=new n.Quaternion,a=new n.Vector3,i=new n.Vector3,s=new n.Vector3,c=new n.Vector3;return function(){c.set(v.x-m.x,v.y-m.y,0),(e=c.length())?(f.copy(r.object.position).sub(r.target),a.copy(f).normalize(),i.copy(r.object.up).normalize(),s.crossVectors(i,a).normalize(),i.setLength(v.y-m.y),s.setLength(v.x-m.x),c.copy(i.add(s)),t.crossVectors(c,f).normalize(),e*=r.rotateSpeed,o.setFromAxisAngle(t,e),f.applyQuaternion(o),r.object.up.applyQuaternion(o),g.copy(t),y=e):!r.staticMoving&&y&&(y*=Math.sqrt(1-r.dynamicDampingFactor),f.copy(r.object.position).sub(r.target),o.setFromAxisAngle(g,y),f.applyQuaternion(o),r.object.up.applyQuaternion(o)),m.copy(v)}}(),this.zoomCamera=function(){var e;p===l?(e=M/x,M=x,r.object.isPerspectiveCamera?f.multiplyScalar(e):r.object.isOrthographicCamera?(r.object.zoom*=e,r.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")):(1!==(e=1+(w.y-b.y)*r.zoomSpeed)&&e>0&&(r.object.isPerspectiveCamera?f.multiplyScalar(e):r.object.isOrthographicCamera?(r.object.zoom/=e,r.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")),r.staticMoving?b.copy(w):b.y+=(w.y-b.y)*this.dynamicDampingFactor)},this.panCamera=function(){var e=new n.Vector2,t=new n.Vector3,o=new n.Vector3;return function(){if(e.copy(S).sub(E),e.lengthSq()){if(r.object.isOrthographicCamera){var n=(r.object.right-r.object.left)/r.object.zoom/r.domElement.clientWidth,a=(r.object.top-r.object.bottom)/r.object.zoom/r.domElement.clientWidth;e.x*=n,e.y*=a}e.multiplyScalar(f.length()*r.panSpeed),o.copy(f).cross(r.object.up).setLength(e.x),o.add(t.copy(r.object.up).setLength(e.y)),r.object.position.add(o),r.target.add(o),r.staticMoving?E.copy(S):E.add(e.subVectors(S,E).multiplyScalar(r.dynamicDampingFactor))}}}(),this.checkDistances=function(){r.noZoom&&r.noPan||(f.lengthSq()>r.maxDistance*r.maxDistance&&(r.object.position.addVectors(r.target,f.setLength(r.maxDistance)),b.copy(w)),f.lengthSq()<r.minDistance*r.minDistance&&(r.object.position.addVectors(r.target,f.setLength(r.minDistance)),b.copy(w)))},this.update=function(){f.subVectors(r.object.position,r.target),r.noRotate||r.rotateCamera(),r.noZoom||r.zoomCamera(),r.noPan||r.panCamera(),r.object.position.addVectors(r.target,f),r.object.isPerspectiveCamera?(r.checkDistances(),r.object.lookAt(r.target),u.distanceToSquared(r.object.position)>1e-6&&(r.dispatchEvent(T),u.copy(r.object.position))):r.object.isOrthographicCamera?(r.object.lookAt(r.target),(u.distanceToSquared(r.object.position)>1e-6||h!==r.object.zoom)&&(r.dispatchEvent(T),u.copy(r.object.position),h=r.object.zoom)):console.warn("THREE.TrackballControls: Unsupported camera type")},this.reset=function(){p=o,d=o,r.target.copy(r.target0),r.object.position.copy(r.position0),r.object.up.copy(r.up0),r.object.zoom=r.zoom0,r.object.updateProjectionMatrix(),f.subVectors(r.object.position,r.target),r.object.lookAt(r.target),r.dispatchEvent(T),u.copy(r.object.position),h=r.object.zoom},this.dispose=function(){this.domElement.removeEventListener("contextmenu",N,!1),this.domElement.removeEventListener("mousedown",O,!1),this.domElement.removeEventListener("wheel",D,!1),this.domElement.removeEventListener("touchstart",k,!1),this.domElement.removeEventListener("touchend",U,!1),this.domElement.removeEventListener("touchmove",F,!1),document.removeEventListener("mousemove",I,!1),document.removeEventListener("mouseup",j,!1),window.removeEventListener("keydown",P,!1),window.removeEventListener("keyup",C,!1)},this.domElement.addEventListener("contextmenu",N,!1),this.domElement.addEventListener("mousedown",O,!1),this.domElement.addEventListener("wheel",D,!1),this.domElement.addEventListener("touchstart",k,!1),this.domElement.addEventListener("touchend",U,!1),this.domElement.addEventListener("touchmove",F,!1),window.addEventListener("keydown",P,!1),window.addEventListener("keyup",C,!1),this.handleResize(),this.update()};o.prototype=Object.create(n.EventDispatcher.prototype),o.prototype.constructor=o},253:function(e,t,r){(function(t){var r="object"==typeof t&&t&&t.Object===Object&&t,n="object"==typeof self&&self&&self.Object===Object&&self,o=r||n||Function("return this")();function a(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}function i(e,t){for(var r=-1,n=t.length,o=e.length;++r<n;)e[o+r]=t[r];return e}var s=Object.prototype,c=s.hasOwnProperty,l=s.toString,u=o.Symbol,h=s.propertyIsEnumerable,p=u?u.isConcatSpreadable:void 0,d=Math.max;function f(e){return v(e)||function(e){return function(e){return g(e)&&function(e){return null!=e&&function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}(e.length)&&!function(e){var t=function(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}(e)?l.call(e):"";return"[object Function]"==t||"[object GeneratorFunction]"==t}(e)}(e)}(e)&&c.call(e,"callee")&&(!h.call(e,"callee")||"[object Arguments]"==l.call(e))}(e)||!!(p&&e&&e[p])}function m(e){if("string"==typeof e||function(e){return"symbol"==typeof e||g(e)&&"[object Symbol]"==l.call(e)}(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}var v=Array.isArray;function g(e){return!!e&&"object"==typeof e}var y,b,w=(y=function(e,t){return null==e?{}:function(e,t){return function(e,t,r){for(var n=-1,o=t.length,a={};++n<o;){var i=t[n],s=e[i];r(s,i)&&(a[i]=s)}return a}(e=Object(e),t,(function(t,r){return r in e}))}(e,function(e,t){for(var r=-1,n=e?e.length:0,o=Array(n);++r<n;)o[r]=t(e[r],r,e);return o}(function e(t,r,n,o,a){var s=-1,c=t.length;for(n||(n=f),a||(a=[]);++s<c;){var l=t[s];r>0&&n(l)?r>1?e(l,r-1,n,o,a):i(a,l):o||(a[a.length]=l)}return a}(t,1),m))},b=d(void 0===b?y.length-1:b,0),function(){for(var e=arguments,t=-1,r=d(e.length-b,0),n=Array(r);++t<r;)n[t]=e[b+t];t=-1;for(var o=Array(b+1);++t<b;)o[t]=e[t];return o[b]=n,a(y,this,o)});e.exports=w}).call(this,r(40))},254:function(e,t,r){(function(t){var r=/^\[object .+?Constructor\]$/,n=/^(?:0|[1-9]\d*)$/,o="object"==typeof t&&t&&t.Object===Object&&t,a="object"==typeof self&&self&&self.Object===Object&&self,i=o||a||Function("return this")();function s(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}function c(e,t){return!!(e?e.length:0)&&function(e,t,r){if(t!==t)return function(e,t,r,n){var o=e.length,a=r+(n?1:-1);for(;n?a--:++a<o;)if(t(e[a],a,e))return a;return-1}(e,p,r);var n=r-1,o=e.length;for(;++n<o;)if(e[n]===t)return n;return-1}(e,t,0)>-1}function l(e,t,r){for(var n=-1,o=e?e.length:0;++n<o;)if(r(t,e[n]))return!0;return!1}function u(e,t){for(var r=-1,n=e?e.length:0,o=Array(n);++r<n;)o[r]=t(e[r],r,e);return o}function h(e,t){for(var r=-1,n=t.length,o=e.length;++r<n;)e[o+r]=t[r];return e}function p(e){return e!==e}function d(e,t){return e.has(t)}function f(e,t){return function(r){return e(t(r))}}var m=Array.prototype,v=Function.prototype,g=Object.prototype,y=i["__core-js_shared__"],b=function(){var e=/[^.]+$/.exec(y&&y.keys&&y.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),w=v.toString,M=g.hasOwnProperty,x=g.toString,E=RegExp("^"+w.call(M).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),S=i.Symbol,T=f(Object.getPrototypeOf,Object),L=g.propertyIsEnumerable,R=m.splice,A=S?S.isConcatSpreadable:void 0,_=Object.getOwnPropertySymbols,P=Math.max,C=H(i,"Map"),O=H(Object,"create");function I(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function j(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function D(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function k(e){var t=-1,r=e?e.length:0;for(this.__data__=new D;++t<r;)this.add(e[t])}function F(e,t){var r=W(e)||q(e)?function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}(e.length,String):[],n=r.length,o=!!n;for(var a in e)!t&&!M.call(e,a)||o&&("length"==a||Z(a,n))||r.push(a);return r}function U(e,t){for(var r,n,o=e.length;o--;)if((r=e[o][0])===(n=t)||r!==r&&n!==n)return o;return-1}function N(e){return!(!J(e)||(t=e,b&&b in t))&&($(e)||function(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(r){}return t}(e)?E:r).test(function(e){if(null!=e){try{return w.call(e)}catch(t){}try{return e+""}catch(t){}}return""}(e));var t}function V(e){if(!J(e))return function(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t}(e);var t=function(e){var t=e&&e.constructor,r="function"==typeof t&&t.prototype||g;return e===r}(e),r=[];for(var n in e)("constructor"!=n||!t&&M.call(e,n))&&r.push(n);return r}function B(e){return function(e,t,r){var n=t(e);return W(e)?n:h(n,r(e))}(e,te,z)}function G(e,t){var r=e.__data__;return function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}(t)?r["string"==typeof t?"string":"hash"]:r.map}function H(e,t){var r=function(e,t){return null==e?void 0:e[t]}(e,t);return N(r)?r:void 0}I.prototype.clear=function(){this.__data__=O?O(null):{}},I.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},I.prototype.get=function(e){var t=this.__data__;if(O){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return M.call(t,e)?t[e]:void 0},I.prototype.has=function(e){var t=this.__data__;return O?void 0!==t[e]:M.call(t,e)},I.prototype.set=function(e,t){return this.__data__[e]=O&&void 0===t?"__lodash_hash_undefined__":t,this},j.prototype.clear=function(){this.__data__=[]},j.prototype.delete=function(e){var t=this.__data__,r=U(t,e);return!(r<0)&&(r==t.length-1?t.pop():R.call(t,r,1),!0)},j.prototype.get=function(e){var t=this.__data__,r=U(t,e);return r<0?void 0:t[r][1]},j.prototype.has=function(e){return U(this.__data__,e)>-1},j.prototype.set=function(e,t){var r=this.__data__,n=U(r,e);return n<0?r.push([e,t]):r[n][1]=t,this},D.prototype.clear=function(){this.__data__={hash:new I,map:new(C||j),string:new I}},D.prototype.delete=function(e){return G(this,e).delete(e)},D.prototype.get=function(e){return G(this,e).get(e)},D.prototype.has=function(e){return G(this,e).has(e)},D.prototype.set=function(e,t){return G(this,e).set(e,t),this},k.prototype.add=k.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},k.prototype.has=function(e){return this.__data__.has(e)};var X=_?f(_,Object):ae,z=_?function(e){for(var t=[];e;)h(t,X(e)),e=T(e);return t}:ae;function Y(e){return W(e)||q(e)||!!(A&&e&&e[A])}function Z(e,t){return!!(t=null==t?9007199254740991:t)&&("number"==typeof e||n.test(e))&&e>-1&&e%1==0&&e<t}function Q(e){if("string"==typeof e||function(e){return"symbol"==typeof e||ee(e)&&"[object Symbol]"==x.call(e)}(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function q(e){return function(e){return ee(e)&&K(e)}(e)&&M.call(e,"callee")&&(!L.call(e,"callee")||"[object Arguments]"==x.call(e))}var W=Array.isArray;function K(e){return null!=e&&function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}(e.length)&&!$(e)}function $(e){var t=J(e)?x.call(e):"";return"[object Function]"==t||"[object GeneratorFunction]"==t}function J(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function ee(e){return!!e&&"object"==typeof e}function te(e){return K(e)?F(e,!0):V(e)}var re,ne,oe=(re=function(e,t){return null==e?{}:(t=u(function e(t,r,n,o,a){var i=-1,s=t.length;for(n||(n=Y),a||(a=[]);++i<s;){var c=t[i];r>0&&n(c)?r>1?e(c,r-1,n,o,a):h(a,c):o||(a[a.length]=c)}return a}(t,1),Q),function(e,t){return function(e,t,r){for(var n=-1,o=t.length,a={};++n<o;){var i=t[n],s=e[i];r(s,i)&&(a[i]=s)}return a}(e=Object(e),t,(function(t,r){return r in e}))}(e,function(e,t,r,n){var o,a=-1,i=c,s=!0,h=e.length,p=[],f=t.length;if(!h)return p;r&&(t=u(t,(o=r,function(e){return o(e)}))),n?(i=l,s=!1):t.length>=200&&(i=d,s=!1,t=new k(t));e:for(;++a<h;){var m=e[a],v=r?r(m):m;if(m=n||0!==m?m:0,s&&v===v){for(var g=f;g--;)if(t[g]===v)continue e;p.push(m)}else i(t,v,n)||p.push(m)}return p}(B(e),t)))},ne=P(void 0===ne?re.length-1:ne,0),function(){for(var e=arguments,t=-1,r=P(e.length-ne,0),n=Array(r);++t<r;)n[t]=e[ne+t];t=-1;for(var o=Array(ne+1);++t<ne;)o[t]=e[t];return o[ne]=n,s(re,this,o)});function ae(){return[]}e.exports=oe}).call(this,r(40))},255:function(e,t,r){var n=function e(){function t(e){return o.appendChild(e.dom),e}function r(e){for(var t=0;t<o.children.length;t++)o.children[t].style.display=t===e?"block":"none";n=e}var n=0,o=document.createElement("div");o.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",o.addEventListener("click",(function(e){e.preventDefault(),r(++n%o.children.length)}),!1);var a=(performance||Date).now(),i=a,s=0,c=t(new e.Panel("FPS","#0ff","#002")),l=t(new e.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var u=t(new e.Panel("MB","#f08","#201"));return r(0),{REVISION:16,dom:o,addPanel:t,showPanel:r,begin:function(){a=(performance||Date).now()},end:function(){s++;var e=(performance||Date).now();if(l.update(e-a,200),e>i+1e3&&(c.update(1e3*s/(e-i),100),i=e,s=0,u)){var t=performance.memory;u.update(t.usedJSHeapSize/1048576,t.jsHeapSizeLimit/1048576)}return e},update:function(){a=this.end()},domElement:o,setMode:r}};n.Panel=function(e,t,r){var n=1/0,o=0,a=Math.round,i=a(window.devicePixelRatio||1),s=80*i,c=48*i,l=3*i,u=2*i,h=3*i,p=15*i,d=74*i,f=30*i,m=document.createElement("canvas");m.width=s,m.height=c,m.style.cssText="width:80px;height:48px";var v=m.getContext("2d");return v.font="bold "+9*i+"px Helvetica,Arial,sans-serif",v.textBaseline="top",v.fillStyle=r,v.fillRect(0,0,s,c),v.fillStyle=t,v.fillText(e,l,u),v.fillRect(h,p,d,f),v.fillStyle=r,v.globalAlpha=.9,v.fillRect(h,p,d,f),{dom:m,update:function(c,g){n=Math.min(n,c),o=Math.max(o,c),v.fillStyle=r,v.globalAlpha=1,v.fillRect(0,0,s,p),v.fillStyle=t,v.fillText(a(c)+" "+e+" ("+a(n)+"-"+a(o)+")",l,u),v.drawImage(m,h+i,p,d-i,f,h,p,d-i,f),v.fillRect(h+d-i,p,i,f),v.fillStyle=r,v.globalAlpha=.9,v.fillRect(h+d-i,p,i,a((1-c/g)*f))}}},e.exports=n},272:function(e,t,r){"use strict";r.d(t,"a",(function(){return j}));r(16);var n=r(5),o=r(17),a=r(14),i=r(8),s=r(9),c=(r(42),r(12)),l=r(3),u=r(141),h=r(142),p=r(0),d=r.n(p),f=r(76),m=(r(128),r(72)),v=(r(87),r(84),r(109),r(143),r(105),r(101)),g=function(e,t){void 0===t&&(console.warn('THREE.TransformControls: The second parameter "domElement" is now mandatory.'),t=document),m.Object3D.call(this),this.visible=!1,this.domElement=t;var r=new y;this.add(r);var n=new b;this.add(n);var o=this;H("camera",e),H("object",void 0),H("enabled",!0),H("axis",null),H("mode","translate"),H("translationSnap",null),H("rotationSnap",null),H("scaleSnap",null),H("space","world"),H("size",1),H("dragging",!1),H("showX",!0),H("showY",!0),H("showZ",!0);var a={type:"change"},i={type:"mouseDown"},s={type:"mouseUp",mode:o.mode},c={type:"objectChange"},l=new m.Raycaster;function u(e,t,r){for(var n=t.intersectObject(e,!0),o=0;o<n.length;o++)if(n[o].object.visible||r)return n[o];return!1}var h=new m.Vector3,p=new m.Vector3,d=new m.Quaternion,f={X:new m.Vector3(1,0,0),Y:new m.Vector3(0,1,0),Z:new m.Vector3(0,0,1)},v=new m.Vector3,g=new m.Vector3,w=new m.Vector3,M=new m.Vector3,x=new m.Vector3,E=new m.Vector3,S=0,T=new m.Vector3,L=new m.Quaternion,R=new m.Vector3,A=new m.Vector3,_=new m.Quaternion,P=new m.Quaternion,C=new m.Vector3,O=new m.Vector3,I=new m.Quaternion,j=new m.Vector3,D=new m.Vector3,k=new m.Quaternion,F=new m.Quaternion,U=new m.Vector3,N=new m.Vector3,V=new m.Vector3,B=new m.Quaternion,G=new m.Vector3;function H(e,t){var i=t;Object.defineProperty(o,e,{get:function(){return void 0!==i?i:t},set:function(t){i!==t&&(i=t,n[e]=t,r[e]=t,o.dispatchEvent({type:e+"-changed",value:t}),o.dispatchEvent(a))}}),o[e]=t,n[e]=t,r[e]=t}function X(e){if(document.pointerLockElement)return{x:0,y:0,button:e.button};var r=e.changedTouches?e.changedTouches[0]:e,n=t.getBoundingClientRect();return{x:(r.clientX-n.left)/n.width*2-1,y:-(r.clientY-n.top)/n.height*2+1,button:e.button}}function z(e){o.enabled&&o.pointerHover(X(e))}function Y(e){o.enabled&&(document.addEventListener("mousemove",Z,!1),o.pointerHover(X(e)),o.pointerDown(X(e)))}function Z(e){o.enabled&&o.pointerMove(X(e))}function Q(e){o.enabled&&(document.removeEventListener("mousemove",Z,!1),o.pointerUp(X(e)))}H("worldPosition",D),H("worldPositionStart",O),H("worldQuaternion",k),H("worldQuaternionStart",I),H("cameraPosition",T),H("cameraQuaternion",L),H("pointStart",v),H("pointEnd",g),H("rotationAxis",M),H("rotationAngle",S),H("eye",N),t.addEventListener("mousedown",Y,!1),t.addEventListener("touchstart",Y,!1),t.addEventListener("mousemove",z,!1),t.addEventListener("touchmove",z,!1),t.addEventListener("touchmove",Z,!1),document.addEventListener("mouseup",Q,!1),t.addEventListener("touchend",Q,!1),t.addEventListener("touchcancel",Q,!1),t.addEventListener("touchleave",Q,!1),this.dispose=function(){t.removeEventListener("mousedown",Y),t.removeEventListener("touchstart",Y),t.removeEventListener("mousemove",z),document.removeEventListener("mousemove",Z),t.removeEventListener("touchmove",z),t.removeEventListener("touchmove",Z),document.removeEventListener("mouseup",Q),t.removeEventListener("touchend",Q),t.removeEventListener("touchcancel",Q),t.removeEventListener("touchleave",Q),this.traverse((function(e){e.geometry&&e.geometry.dispose(),e.material&&e.material.dispose()}))},this.attach=function(e){return this.object=e,this.visible=!0,this},this.detach=function(){return this.object=void 0,this.visible=!1,this.axis=null,this},this.updateMatrixWorld=function(){void 0!==this.object&&(this.object.updateMatrixWorld(),null===this.object.parent?console.error("TransformControls: The attached 3D object must be a part of the scene graph."):this.object.parent.matrixWorld.decompose(A,_,C),this.object.matrixWorld.decompose(D,k,U),P.copy(_).inverse(),F.copy(k).inverse()),this.camera.updateMatrixWorld(),this.camera.matrixWorld.decompose(T,L,R),N.copy(T).sub(D).normalize(),m.Object3D.prototype.updateMatrixWorld.call(this)},this.pointerHover=function(e){if(void 0!==this.object&&!0!==this.dragging&&(void 0===e.button||0===e.button)){l.setFromCamera(e,this.camera);var t=u(r.picker[this.mode],l);this.axis=t?t.object.name:null}},this.pointerDown=function(e){if(void 0!==this.object&&!0!==this.dragging&&(void 0===e.button||0===e.button)&&(0===e.button||void 0===e.button)&&null!==this.axis){l.setFromCamera(e,this.camera);var t=u(n,l,!0);if(t){var r=this.space;if("scale"===this.mode?r="local":"E"!==this.axis&&"XYZE"!==this.axis&&"XYZ"!==this.axis||(r="world"),"local"===r&&"rotate"===this.mode){var o=this.rotationSnap;"X"===this.axis&&o&&(this.object.rotation.x=Math.round(this.object.rotation.x/o)*o),"Y"===this.axis&&o&&(this.object.rotation.y=Math.round(this.object.rotation.y/o)*o),"Z"===this.axis&&o&&(this.object.rotation.z=Math.round(this.object.rotation.z/o)*o)}this.object.updateMatrixWorld(),this.object.parent.updateMatrixWorld(),V.copy(this.object.position),B.copy(this.object.quaternion),G.copy(this.object.scale),this.object.matrixWorld.decompose(O,I,j),v.copy(t.point).sub(O)}this.dragging=!0,i.mode=this.mode,this.dispatchEvent(i)}},this.pointerMove=function(e){var t=this.axis,r=this.mode,o=this.object,i=this.space;if("scale"===r?i="local":"E"!==t&&"XYZE"!==t&&"XYZ"!==t||(i="world"),void 0!==o&&null!==t&&!1!==this.dragging&&(void 0===e.button||0===e.button)){l.setFromCamera(e,this.camera);var s=u(n,l,!0);if(s){if(g.copy(s.point).sub(O),"translate"===r)w.copy(g).sub(v),"local"===i&&"XYZ"!==t&&w.applyQuaternion(F),-1===t.indexOf("X")&&(w.x=0),-1===t.indexOf("Y")&&(w.y=0),-1===t.indexOf("Z")&&(w.z=0),"local"===i&&"XYZ"!==t?w.applyQuaternion(B).divide(C):w.applyQuaternion(P).divide(C),o.position.copy(w).add(V),this.translationSnap&&("local"===i&&(o.position.applyQuaternion(d.copy(B).inverse()),-1!==t.search("X")&&(o.position.x=Math.round(o.position.x/this.translationSnap)*this.translationSnap),-1!==t.search("Y")&&(o.position.y=Math.round(o.position.y/this.translationSnap)*this.translationSnap),-1!==t.search("Z")&&(o.position.z=Math.round(o.position.z/this.translationSnap)*this.translationSnap),o.position.applyQuaternion(B)),"world"===i&&(o.parent&&o.position.add(h.setFromMatrixPosition(o.parent.matrixWorld)),-1!==t.search("X")&&(o.position.x=Math.round(o.position.x/this.translationSnap)*this.translationSnap),-1!==t.search("Y")&&(o.position.y=Math.round(o.position.y/this.translationSnap)*this.translationSnap),-1!==t.search("Z")&&(o.position.z=Math.round(o.position.z/this.translationSnap)*this.translationSnap),o.parent&&o.position.sub(h.setFromMatrixPosition(o.parent.matrixWorld))));else if("scale"===r){if(-1!==t.search("XYZ")){var m=g.length()/v.length();g.dot(v)<0&&(m*=-1),p.set(m,m,m)}else h.copy(v),p.copy(g),h.applyQuaternion(F),p.applyQuaternion(F),p.divide(h),-1===t.search("X")&&(p.x=1),-1===t.search("Y")&&(p.y=1),-1===t.search("Z")&&(p.z=1);o.scale.copy(G).multiply(p),this.scaleSnap&&(-1!==t.search("X")&&(o.scale.x=Math.round(o.scale.x/this.scaleSnap)*this.scaleSnap||this.scaleSnap),-1!==t.search("Y")&&(o.scale.y=Math.round(o.scale.y/this.scaleSnap)*this.scaleSnap||this.scaleSnap),-1!==t.search("Z")&&(o.scale.z=Math.round(o.scale.z/this.scaleSnap)*this.scaleSnap||this.scaleSnap))}else if("rotate"===r){w.copy(g).sub(v);var y=20/D.distanceTo(h.setFromMatrixPosition(this.camera.matrixWorld));"E"===t?(M.copy(N),S=g.angleTo(v),x.copy(v).normalize(),E.copy(g).normalize(),S*=E.cross(x).dot(N)<0?1:-1):"XYZE"===t?(M.copy(w).cross(N).normalize(),S=w.dot(h.copy(M).cross(this.eye))*y):"X"!==t&&"Y"!==t&&"Z"!==t||(M.copy(f[t]),h.copy(f[t]),"local"===i&&h.applyQuaternion(k),S=w.dot(h.cross(N).normalize())*y),this.rotationSnap&&(S=Math.round(S/this.rotationSnap)*this.rotationSnap),this.rotationAngle=S,"local"===i&&"E"!==t&&"XYZE"!==t?(o.quaternion.copy(B),o.quaternion.multiply(d.setFromAxisAngle(M,S)).normalize()):(M.applyQuaternion(P),o.quaternion.copy(d.setFromAxisAngle(M,S)),o.quaternion.multiply(B).normalize())}this.dispatchEvent(a),this.dispatchEvent(c)}}},this.pointerUp=function(e){void 0!==e.button&&0!==e.button||(this.dragging&&null!==this.axis&&(s.mode=this.mode,this.dispatchEvent(s)),this.dragging=!1,void 0===e.button&&(this.axis=null))},this.getMode=function(){return o.mode},this.setMode=function(e){o.mode=e},this.setTranslationSnap=function(e){o.translationSnap=e},this.setRotationSnap=function(e){o.rotationSnap=e},this.setScaleSnap=function(e){o.scaleSnap=e},this.setSize=function(e){o.size=e},this.setSpace=function(e){o.space=e},this.update=function(){console.warn("THREE.TransformControls: update function has no more functionality and therefore has been deprecated.")}};g.prototype=Object.assign(Object.create(m.Object3D.prototype),{constructor:g,isTransformControls:!0});var y=function(){m.Object3D.call(this),this.type="TransformControlsGizmo";var e=new m.MeshBasicMaterial({depthTest:!1,depthWrite:!1,transparent:!0,side:m.DoubleSide,fog:!1}),t=new m.LineBasicMaterial({depthTest:!1,depthWrite:!1,transparent:!0,linewidth:1,fog:!1}),r=e.clone();r.opacity=.15;var n=e.clone();n.opacity=.33;var o=e.clone();o.color.set(16711680);var a=e.clone();a.color.set(65280);var i=e.clone();i.color.set(255);var s=e.clone();s.opacity=.25;var c=s.clone();c.color.set(16776960);var l=s.clone();l.color.set(65535);var u=s.clone();u.color.set(16711935),e.clone().color.set(16776960);var h=t.clone();h.color.set(16711680);var p=t.clone();p.color.set(65280);var d=t.clone();d.color.set(255);var f=t.clone();f.color.set(65535);var v=t.clone();v.color.set(16711935);var g=t.clone();g.color.set(16776960);var y=t.clone();y.color.set(7895160);var b=g.clone();b.opacity=.25;var w=new m.CylinderBufferGeometry(0,.05,.2,12,1,!1),M=new m.BoxBufferGeometry(.125,.125,.125),x=new m.BufferGeometry;x.setAttribute("position",new m.Float32BufferAttribute([0,0,0,1,0,0],3));var E=function(e,t){for(var r=new m.BufferGeometry,n=[],o=0;o<=64*t;++o)n.push(0,Math.cos(o/32*Math.PI)*e,Math.sin(o/32*Math.PI)*e);return r.setAttribute("position",new m.Float32BufferAttribute(n,3)),r},S={X:[[new m.Mesh(w,o),[1,0,0],[0,0,-Math.PI/2],null,"fwd"],[new m.Mesh(w,o),[1,0,0],[0,0,Math.PI/2],null,"bwd"],[new m.Line(x,h)]],Y:[[new m.Mesh(w,a),[0,1,0],null,null,"fwd"],[new m.Mesh(w,a),[0,1,0],[Math.PI,0,0],null,"bwd"],[new m.Line(x,p),null,[0,0,Math.PI/2]]],Z:[[new m.Mesh(w,i),[0,0,1],[Math.PI/2,0,0],null,"fwd"],[new m.Mesh(w,i),[0,0,1],[-Math.PI/2,0,0],null,"bwd"],[new m.Line(x,d),null,[0,-Math.PI/2,0]]],XYZ:[[new m.Mesh(new m.OctahedronBufferGeometry(.1,0),s.clone()),[0,0,0],[0,0,0]]],XY:[[new m.Mesh(new m.PlaneBufferGeometry(.295,.295),c.clone()),[.15,.15,0]],[new m.Line(x,g),[.18,.3,0],null,[.125,1,1]],[new m.Line(x,g),[.3,.18,0],[0,0,Math.PI/2],[.125,1,1]]],YZ:[[new m.Mesh(new m.PlaneBufferGeometry(.295,.295),l.clone()),[0,.15,.15],[0,Math.PI/2,0]],[new m.Line(x,f),[0,.18,.3],[0,0,Math.PI/2],[.125,1,1]],[new m.Line(x,f),[0,.3,.18],[0,-Math.PI/2,0],[.125,1,1]]],XZ:[[new m.Mesh(new m.PlaneBufferGeometry(.295,.295),u.clone()),[.15,0,.15],[-Math.PI/2,0,0]],[new m.Line(x,v),[.18,0,.3],null,[.125,1,1]],[new m.Line(x,v),[.3,0,.18],[0,-Math.PI/2,0],[.125,1,1]]]},T={X:[[new m.Mesh(new m.CylinderBufferGeometry(.2,0,1,4,1,!1),r),[.6,0,0],[0,0,-Math.PI/2]]],Y:[[new m.Mesh(new m.CylinderBufferGeometry(.2,0,1,4,1,!1),r),[0,.6,0]]],Z:[[new m.Mesh(new m.CylinderBufferGeometry(.2,0,1,4,1,!1),r),[0,0,.6],[Math.PI/2,0,0]]],XYZ:[[new m.Mesh(new m.OctahedronBufferGeometry(.2,0),r)]],XY:[[new m.Mesh(new m.PlaneBufferGeometry(.4,.4),r),[.2,.2,0]]],YZ:[[new m.Mesh(new m.PlaneBufferGeometry(.4,.4),r),[0,.2,.2],[0,Math.PI/2,0]]],XZ:[[new m.Mesh(new m.PlaneBufferGeometry(.4,.4),r),[.2,0,.2],[-Math.PI/2,0,0]]]},L={START:[[new m.Mesh(new m.OctahedronBufferGeometry(.01,2),n),null,null,null,"helper"]],END:[[new m.Mesh(new m.OctahedronBufferGeometry(.01,2),n),null,null,null,"helper"]],DELTA:[[new m.Line(function(){var e=new m.BufferGeometry;return e.setAttribute("position",new m.Float32BufferAttribute([0,0,0,1,1,1],3)),e}(),n),null,null,null,"helper"]],X:[[new m.Line(x,n.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new m.Line(x,n.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new m.Line(x,n.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},R={X:[[new m.Line(E(1,.5),h)],[new m.Mesh(new m.OctahedronBufferGeometry(.04,0),o),[0,0,.99],null,[1,3,1]]],Y:[[new m.Line(E(1,.5),p),null,[0,0,-Math.PI/2]],[new m.Mesh(new m.OctahedronBufferGeometry(.04,0),a),[0,0,.99],null,[3,1,1]]],Z:[[new m.Line(E(1,.5),d),null,[0,Math.PI/2,0]],[new m.Mesh(new m.OctahedronBufferGeometry(.04,0),i),[.99,0,0],null,[1,3,1]]],E:[[new m.Line(E(1.25,1),b),null,[0,Math.PI/2,0]],[new m.Mesh(new m.CylinderBufferGeometry(.03,0,.15,4,1,!1),b),[1.17,0,0],[0,0,-Math.PI/2],[1,1,.001]],[new m.Mesh(new m.CylinderBufferGeometry(.03,0,.15,4,1,!1),b),[-1.17,0,0],[0,0,Math.PI/2],[1,1,.001]],[new m.Mesh(new m.CylinderBufferGeometry(.03,0,.15,4,1,!1),b),[0,-1.17,0],[Math.PI,0,0],[1,1,.001]],[new m.Mesh(new m.CylinderBufferGeometry(.03,0,.15,4,1,!1),b),[0,1.17,0],[0,0,0],[1,1,.001]]],XYZE:[[new m.Line(E(1,1),y),null,[0,Math.PI/2,0]]]},A={AXIS:[[new m.Line(x,n.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]]},_={X:[[new m.Mesh(new m.TorusBufferGeometry(1,.1,4,24),r),[0,0,0],[0,-Math.PI/2,-Math.PI/2]]],Y:[[new m.Mesh(new m.TorusBufferGeometry(1,.1,4,24),r),[0,0,0],[Math.PI/2,0,0]]],Z:[[new m.Mesh(new m.TorusBufferGeometry(1,.1,4,24),r),[0,0,0],[0,0,-Math.PI/2]]],E:[[new m.Mesh(new m.TorusBufferGeometry(1.25,.1,2,24),r)]],XYZE:[[new m.Mesh(new m.SphereBufferGeometry(.7,10,8),r)]]},P={X:[[new m.Mesh(M,o),[.8,0,0],[0,0,-Math.PI/2]],[new m.Line(x,h),null,null,[.8,1,1]]],Y:[[new m.Mesh(M,a),[0,.8,0]],[new m.Line(x,p),null,[0,0,Math.PI/2],[.8,1,1]]],Z:[[new m.Mesh(M,i),[0,0,.8],[Math.PI/2,0,0]],[new m.Line(x,d),null,[0,-Math.PI/2,0],[.8,1,1]]],XY:[[new m.Mesh(M,c),[.85,.85,0],null,[2,2,.2]],[new m.Line(x,g),[.855,.98,0],null,[.125,1,1]],[new m.Line(x,g),[.98,.855,0],[0,0,Math.PI/2],[.125,1,1]]],YZ:[[new m.Mesh(M,l),[0,.85,.85],null,[.2,2,2]],[new m.Line(x,f),[0,.855,.98],[0,0,Math.PI/2],[.125,1,1]],[new m.Line(x,f),[0,.98,.855],[0,-Math.PI/2,0],[.125,1,1]]],XZ:[[new m.Mesh(M,u),[.85,0,.85],null,[2,.2,2]],[new m.Line(x,v),[.855,0,.98],null,[.125,1,1]],[new m.Line(x,v),[.98,0,.855],[0,-Math.PI/2,0],[.125,1,1]]],XYZX:[[new m.Mesh(new m.BoxBufferGeometry(.125,.125,.125),s.clone()),[1.1,0,0]]],XYZY:[[new m.Mesh(new m.BoxBufferGeometry(.125,.125,.125),s.clone()),[0,1.1,0]]],XYZZ:[[new m.Mesh(new m.BoxBufferGeometry(.125,.125,.125),s.clone()),[0,0,1.1]]]},C={X:[[new m.Mesh(new m.CylinderBufferGeometry(.2,0,.8,4,1,!1),r),[.5,0,0],[0,0,-Math.PI/2]]],Y:[[new m.Mesh(new m.CylinderBufferGeometry(.2,0,.8,4,1,!1),r),[0,.5,0]]],Z:[[new m.Mesh(new m.CylinderBufferGeometry(.2,0,.8,4,1,!1),r),[0,0,.5],[Math.PI/2,0,0]]],XY:[[new m.Mesh(M,r),[.85,.85,0],null,[3,3,.2]]],YZ:[[new m.Mesh(M,r),[0,.85,.85],null,[.2,3,3]]],XZ:[[new m.Mesh(M,r),[.85,0,.85],null,[3,.2,3]]],XYZX:[[new m.Mesh(new m.BoxBufferGeometry(.2,.2,.2),r),[1.1,0,0]]],XYZY:[[new m.Mesh(new m.BoxBufferGeometry(.2,.2,.2),r),[0,1.1,0]]],XYZZ:[[new m.Mesh(new m.BoxBufferGeometry(.2,.2,.2),r),[0,0,1.1]]]},O={X:[[new m.Line(x,n.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new m.Line(x,n.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new m.Line(x,n.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},I=function(e){var t=new m.Object3D;for(var r in e)for(var n=e[r].length;n--;){var o=e[r][n][0].clone(),a=e[r][n][1],i=e[r][n][2],s=e[r][n][3],c=e[r][n][4];o.name=r,o.tag=c,a&&o.position.set(a[0],a[1],a[2]),i&&o.rotation.set(i[0],i[1],i[2]),s&&o.scale.set(s[0],s[1],s[2]),o.updateMatrix();var l=o.geometry.clone();l.applyMatrix4(o.matrix),o.geometry=l,o.renderOrder=1/0,o.position.set(0,0,0),o.rotation.set(0,0,0),o.scale.set(1,1,1),t.add(o)}return t},j=new m.Vector3(0,0,0),D=new m.Euler,k=new m.Vector3(0,1,0),F=new m.Vector3(0,0,0),U=new m.Matrix4,N=new m.Quaternion,V=new m.Quaternion,B=new m.Quaternion,G=new m.Vector3(1,0,0),H=new m.Vector3(0,1,0),X=new m.Vector3(0,0,1);this.gizmo={},this.picker={},this.helper={},this.add(this.gizmo.translate=I(S)),this.add(this.gizmo.rotate=I(R)),this.add(this.gizmo.scale=I(P)),this.add(this.picker.translate=I(T)),this.add(this.picker.rotate=I(_)),this.add(this.picker.scale=I(C)),this.add(this.helper.translate=I(L)),this.add(this.helper.rotate=I(A)),this.add(this.helper.scale=I(O)),this.picker.translate.visible=!1,this.picker.rotate.visible=!1,this.picker.scale.visible=!1,this.updateMatrixWorld=function(){var e=this.space;"scale"===this.mode&&(e="local");var t="local"===e?this.worldQuaternion:B;this.gizmo.translate.visible="translate"===this.mode,this.gizmo.rotate.visible="rotate"===this.mode,this.gizmo.scale.visible="scale"===this.mode,this.helper.translate.visible="translate"===this.mode,this.helper.rotate.visible="rotate"===this.mode,this.helper.scale.visible="scale"===this.mode;var r=[];r=(r=(r=r.concat(this.picker[this.mode].children)).concat(this.gizmo[this.mode].children)).concat(this.helper[this.mode].children);for(var n=0;n<r.length;n++){var o,a=r[n];if(a.visible=!0,a.rotation.set(0,0,0),a.position.copy(this.worldPosition),o=this.camera.isOrthographicCamera?(this.camera.top-this.camera.bottom)/this.camera.zoom:this.worldPosition.distanceTo(this.cameraPosition)*Math.min(1.9*Math.tan(Math.PI*this.camera.fov/360)/this.camera.zoom,7),a.scale.set(1,1,1).multiplyScalar(o*this.size/7),"helper"!==a.tag){if(a.quaternion.copy(t),"translate"===this.mode||"scale"===this.mode){"X"!==a.name&&"XYZX"!==a.name||Math.abs(k.copy(G).applyQuaternion(t).dot(this.eye))>.99&&(a.scale.set(1e-10,1e-10,1e-10),a.visible=!1),"Y"!==a.name&&"XYZY"!==a.name||Math.abs(k.copy(H).applyQuaternion(t).dot(this.eye))>.99&&(a.scale.set(1e-10,1e-10,1e-10),a.visible=!1),"Z"!==a.name&&"XYZZ"!==a.name||Math.abs(k.copy(X).applyQuaternion(t).dot(this.eye))>.99&&(a.scale.set(1e-10,1e-10,1e-10),a.visible=!1),"XY"===a.name&&Math.abs(k.copy(X).applyQuaternion(t).dot(this.eye))<.2&&(a.scale.set(1e-10,1e-10,1e-10),a.visible=!1),"YZ"===a.name&&Math.abs(k.copy(G).applyQuaternion(t).dot(this.eye))<.2&&(a.scale.set(1e-10,1e-10,1e-10),a.visible=!1),"XZ"===a.name&&Math.abs(k.copy(H).applyQuaternion(t).dot(this.eye))<.2&&(a.scale.set(1e-10,1e-10,1e-10),a.visible=!1),-1!==a.name.search("X")&&(k.copy(G).applyQuaternion(t).dot(this.eye)<0?"fwd"===a.tag?a.visible=!1:a.scale.x*=-1:"bwd"===a.tag&&(a.visible=!1)),-1!==a.name.search("Y")&&(k.copy(H).applyQuaternion(t).dot(this.eye)<0?"fwd"===a.tag?a.visible=!1:a.scale.y*=-1:"bwd"===a.tag&&(a.visible=!1)),-1!==a.name.search("Z")&&(k.copy(X).applyQuaternion(t).dot(this.eye)<0?"fwd"===a.tag?a.visible=!1:a.scale.z*=-1:"bwd"===a.tag&&(a.visible=!1))}else"rotate"===this.mode&&(V.copy(t),k.copy(this.eye).applyQuaternion(N.copy(t).inverse()),-1!==a.name.search("E")&&a.quaternion.setFromRotationMatrix(U.lookAt(this.eye,F,H)),"X"===a.name&&(N.setFromAxisAngle(G,Math.atan2(-k.y,k.z)),N.multiplyQuaternions(V,N),a.quaternion.copy(N)),"Y"===a.name&&(N.setFromAxisAngle(H,Math.atan2(k.x,k.z)),N.multiplyQuaternions(V,N),a.quaternion.copy(N)),"Z"===a.name&&(N.setFromAxisAngle(X,Math.atan2(k.y,k.x)),N.multiplyQuaternions(V,N),a.quaternion.copy(N)));a.visible=a.visible&&(-1===a.name.indexOf("X")||this.showX),a.visible=a.visible&&(-1===a.name.indexOf("Y")||this.showY),a.visible=a.visible&&(-1===a.name.indexOf("Z")||this.showZ),a.visible=a.visible&&(-1===a.name.indexOf("E")||this.showX&&this.showY&&this.showZ),a.material._opacity=a.material._opacity||a.material.opacity,a.material._color=a.material._color||a.material.color.clone(),a.material.color.copy(a.material._color),a.material.opacity=a.material._opacity,this.enabled?this.axis&&(a.name===this.axis||this.axis.split("").some((function(e){return a.name===e}))?(a.material.opacity=1,a.material.color.lerp(new m.Color(1,1,1),.5)):(a.material.opacity*=.25,a.material.color.lerp(new m.Color(1,1,1),.5))):(a.material.opacity*=.5,a.material.color.lerp(new m.Color(1,1,1),.5))}else a.visible=!1,"AXIS"===a.name?(a.position.copy(this.worldPositionStart),a.visible=!!this.axis,"X"===this.axis&&(N.setFromEuler(D.set(0,0,0)),a.quaternion.copy(t).multiply(N),Math.abs(k.copy(G).applyQuaternion(t).dot(this.eye))>.9&&(a.visible=!1)),"Y"===this.axis&&(N.setFromEuler(D.set(0,0,Math.PI/2)),a.quaternion.copy(t).multiply(N),Math.abs(k.copy(H).applyQuaternion(t).dot(this.eye))>.9&&(a.visible=!1)),"Z"===this.axis&&(N.setFromEuler(D.set(0,Math.PI/2,0)),a.quaternion.copy(t).multiply(N),Math.abs(k.copy(X).applyQuaternion(t).dot(this.eye))>.9&&(a.visible=!1)),"XYZE"===this.axis&&(N.setFromEuler(D.set(0,Math.PI/2,0)),k.copy(this.rotationAxis),a.quaternion.setFromRotationMatrix(U.lookAt(F,k,H)),a.quaternion.multiply(N),a.visible=this.dragging),"E"===this.axis&&(a.visible=!1)):"START"===a.name?(a.position.copy(this.worldPositionStart),a.visible=this.dragging):"END"===a.name?(a.position.copy(this.worldPosition),a.visible=this.dragging):"DELTA"===a.name?(a.position.copy(this.worldPositionStart),a.quaternion.copy(this.worldQuaternionStart),j.set(1e-10,1e-10,1e-10).add(this.worldPositionStart).sub(this.worldPosition).multiplyScalar(-1),j.applyQuaternion(this.worldQuaternionStart.clone().inverse()),a.scale.copy(j),a.visible=this.dragging):(a.quaternion.copy(t),this.dragging?a.position.copy(this.worldPositionStart):a.position.copy(this.worldPosition),this.axis&&(a.visible=-1!==this.axis.search(a.name)))}m.Object3D.prototype.updateMatrixWorld.call(this)}};y.prototype=Object.assign(Object.create(m.Object3D.prototype),{constructor:y,isTransformControlsGizmo:!0});var b=function(){m.Mesh.call(this,new m.PlaneBufferGeometry(1e5,1e5,2,2),new m.MeshBasicMaterial({visible:!1,wireframe:!0,side:m.DoubleSide,transparent:!0,opacity:.1})),this.type="TransformControlsPlane";var e=new m.Vector3(1,0,0),t=new m.Vector3(0,1,0),r=new m.Vector3(0,0,1),n=new m.Vector3,o=new m.Vector3,a=new m.Vector3,i=new m.Matrix4,s=new m.Quaternion;this.updateMatrixWorld=function(){var c=this.space;switch(this.position.copy(this.worldPosition),"scale"===this.mode&&(c="local"),e.set(1,0,0).applyQuaternion("local"===c?this.worldQuaternion:s),t.set(0,1,0).applyQuaternion("local"===c?this.worldQuaternion:s),r.set(0,0,1).applyQuaternion("local"===c?this.worldQuaternion:s),a.copy(t),this.mode){case"translate":case"scale":switch(this.axis){case"X":a.copy(this.eye).cross(e),o.copy(e).cross(a);break;case"Y":a.copy(this.eye).cross(t),o.copy(t).cross(a);break;case"Z":a.copy(this.eye).cross(r),o.copy(r).cross(a);break;case"XY":o.copy(r);break;case"YZ":o.copy(e);break;case"XZ":a.copy(r),o.copy(t);break;case"XYZ":case"E":o.set(0,0,0)}break;case"rotate":default:o.set(0,0,0)}0===o.length()?this.quaternion.copy(this.cameraQuaternion):(i.lookAt(n.set(0,0,0),o,a),this.quaternion.setFromRotationMatrix(i)),m.Object3D.prototype.updateMatrixWorld.call(this)}};b.prototype=Object.assign(Object.create(m.Mesh.prototype),{constructor:b,isTransformControlsPlane:!0});r(253),r(254);var w=function(e,t){void 0===t&&(console.warn('THREE.PointerLockControls: The second parameter "domElement" is now mandatory.'),t=document.body),this.domElement=t,this.isLocked=!1;var r=this,n={type:"change"},o={type:"lock"},a={type:"unlock"},i=new m.Euler(0,0,0,"YXZ"),s=Math.PI/2,c=new m.Vector3;function l(t){if(!1!==r.isLocked){var o=t.movementX||t.mozMovementX||t.webkitMovementX||0,a=t.movementY||t.mozMovementY||t.webkitMovementY||0;i.setFromQuaternion(e.quaternion),i.y-=.002*o,i.x-=.002*a,i.x=Math.max(-s,Math.min(s,i.x)),e.quaternion.setFromEuler(i),r.dispatchEvent(n)}}function u(){document.pointerLockElement===r.domElement?(r.dispatchEvent(o),r.isLocked=!0):(r.dispatchEvent(a),r.isLocked=!1)}function h(){console.error("THREE.PointerLockControls: Unable to use Pointer Lock API")}this.connect=function(){document.addEventListener("mousemove",l,!1),document.addEventListener("pointerlockchange",u,!1),document.addEventListener("pointerlockerror",h,!1)},this.disconnect=function(){document.removeEventListener("mousemove",l,!1),document.removeEventListener("pointerlockchange",u,!1),document.removeEventListener("pointerlockerror",h,!1)},this.dispose=function(){this.disconnect()},this.getObject=function(){return e},this.getDirection=function(){var t=new m.Vector3(0,0,-1);return function(r){return r.copy(t).applyQuaternion(e.quaternion)}}(),this.moveForward=function(t){c.setFromMatrixColumn(e.matrix,0),c.crossVectors(e.up,c),e.position.addScaledVector(c,t)},this.moveRight=function(t){c.setFromMatrixColumn(e.matrix,0),e.position.addScaledVector(c,t)},this.lock=function(){this.domElement.requestPointerLock()},this.unlock=function(){document.exitPointerLock()},this.connect()};(w.prototype=Object.create(m.EventDispatcher.prototype)).constructor=w;var M=function(e){m.Loader.call(this,e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}};M.prototype=Object.assign(Object.create(m.Loader.prototype),{constructor:M,setDecoderPath:function(e){return this.decoderPath=e,this},setDecoderConfig:function(e){return this.decoderConfig=e,this},setWorkerLimit:function(e){return this.workerLimit=e,this},setVerbosity:function(){console.warn("THREE.DRACOLoader: The .setVerbosity() method has been removed.")},setDrawMode:function(){console.warn("THREE.DRACOLoader: The .setDrawMode() method has been removed.")},setSkipDequantization:function(){console.warn("THREE.DRACOLoader: The .setSkipDequantization() method has been removed.")},load:function(e,t,r,n){var o=this,a=new m.FileLoader(this.manager);a.setPath(this.path),a.setResponseType("arraybuffer"),"use-credentials"===this.crossOrigin&&a.setWithCredentials(!0),a.load(e,(function(e){var r={attributeIDs:o.defaultAttributeIDs,attributeTypes:o.defaultAttributeTypes,useUniqueIDs:!1};o.decodeGeometry(e,r).then(t).catch(n)}),r,n)},decodeDracoFile:function(e,t,r,n){var o={attributeIDs:r||this.defaultAttributeIDs,attributeTypes:n||this.defaultAttributeTypes,useUniqueIDs:!!r};this.decodeGeometry(e,o).then(t)},decodeGeometry:function(e,t){var r=this;for(var n in t.attributeTypes){var o=t.attributeTypes[n];void 0!==o.BYTES_PER_ELEMENT&&(t.attributeTypes[n]=o.name)}var a,i=JSON.stringify(t);if(M.taskCache.has(e)){var s=M.taskCache.get(e);if(s.key===i)return s.promise;if(0===e.byteLength)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}var c=this.workerNextTaskID++,l=e.byteLength,u=this._getWorker(c,l).then((function(r){return a=r,new Promise((function(r,n){a._callbacks[c]={resolve:r,reject:n},a.postMessage({type:"decode",id:c,taskConfig:t,buffer:e},[e])}))})).then((function(e){return r._createGeometry(e.geometry)}));return u.catch((function(){return!0})).then((function(){a&&c&&r._releaseTask(a,c)})),M.taskCache.set(e,{key:i,promise:u}),u},_createGeometry:function(e){var t=new m.BufferGeometry;e.index&&t.setIndex(new m.BufferAttribute(e.index.array,1));for(var r=0;r<e.attributes.length;r++){var n=e.attributes[r],o=n.name,a=n.array,i=n.itemSize;t.setAttribute(o,new m.BufferAttribute(a,i))}return t},_loadLibrary:function(e,t){var r=new m.FileLoader(this.manager);return r.setPath(this.decoderPath),r.setResponseType(t),new Promise((function(t,n){r.load(e,t,void 0,n)}))},preload:function(){return this._initDecoder(),this},_initDecoder:function(){var e=this;if(this.decoderPending)return this.decoderPending;var t="object"!==typeof WebAssembly||"js"===this.decoderConfig.type,r=[];return t?r.push(this._loadLibrary("draco_decoder.js","text")):(r.push(this._loadLibrary("draco_wasm_wrapper.js","text")),r.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(r).then((function(r){var n=r[0];t||(e.decoderConfig.wasmBinary=r[1]);var o=M.DRACOWorker.toString(),a=["/* draco decoder */",n,"","/* worker */",o.substring(o.indexOf("{")+1,o.lastIndexOf("}"))].join("\n");e.workerSourceURL=URL.createObjectURL(new Blob([a]))})),this.decoderPending},_getWorker:function(e,t){var r=this;return this._initDecoder().then((function(){var n;r.workerPool.length<r.workerLimit?((n=new Worker(r.workerSourceURL))._callbacks={},n._taskCosts={},n._taskLoad=0,n.postMessage({type:"init",decoderConfig:r.decoderConfig}),n.onmessage=function(e){var t=e.data;switch(t.type){case"decode":n._callbacks[t.id].resolve(t);break;case"error":n._callbacks[t.id].reject(t);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+t.type+'"')}},r.workerPool.push(n)):r.workerPool.sort((function(e,t){return e._taskLoad>t._taskLoad?-1:1}));return(n=r.workerPool[r.workerPool.length-1])._taskCosts[e]=t,n._taskLoad+=t,n}))},_releaseTask:function(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]},debug:function(){console.log("Task load: ",this.workerPool.map((function(e){return e._taskLoad})))},dispose:function(){for(var e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this}}),M.DRACOWorker=function(){var e,t;function r(e,t,r,n,o,a){var i,s,c=a.num_components(),l=r.num_points()*c;switch(o){case Float32Array:i=new e.DracoFloat32Array,t.GetAttributeFloatForAllPoints(r,a,i),s=new Float32Array(l);break;case Int8Array:i=new e.DracoInt8Array,t.GetAttributeInt8ForAllPoints(r,a,i),s=new Int8Array(l);break;case Int16Array:i=new e.DracoInt16Array,t.GetAttributeInt16ForAllPoints(r,a,i),s=new Int16Array(l);break;case Int32Array:i=new e.DracoInt32Array,t.GetAttributeInt32ForAllPoints(r,a,i),s=new Int32Array(l);break;case Uint8Array:i=new e.DracoUInt8Array,t.GetAttributeUInt8ForAllPoints(r,a,i),s=new Uint8Array(l);break;case Uint16Array:i=new e.DracoUInt16Array,t.GetAttributeUInt16ForAllPoints(r,a,i),s=new Uint16Array(l);break;case Uint32Array:i=new e.DracoUInt32Array,t.GetAttributeUInt32ForAllPoints(r,a,i),s=new Uint32Array(l);break;default:throw new Error("THREE.DRACOLoader: Unexpected attribute type.")}for(var u=0;u<l;u++)s[u]=i.GetValue(u);return e.destroy(i),{name:n,array:s,itemSize:c}}onmessage=function(n){var o=n.data;switch(o.type){case"init":e=o.decoderConfig,t=new Promise((function(t){e.onModuleLoaded=function(e){t({draco:e})},DracoDecoderModule(e)}));break;case"decode":var a=o.buffer,i=o.taskConfig;t.then((function(e){var t=e.draco,n=new t.Decoder,s=new t.DecoderBuffer;s.Init(new Int8Array(a),a.byteLength);try{var c=function(e,t,n,o){var a,i,s=o.attributeIDs,c=o.attributeTypes,l=t.GetEncodedGeometryType(n);if(l===e.TRIANGULAR_MESH)a=new e.Mesh,i=t.DecodeBufferToMesh(n,a);else{if(l!==e.POINT_CLOUD)throw new Error("THREE.DRACOLoader: Unexpected geometry type.");a=new e.PointCloud,i=t.DecodeBufferToPointCloud(n,a)}if(!i.ok()||0===a.ptr)throw new Error("THREE.DRACOLoader: Decoding failed: "+i.error_msg());var u={index:null,attributes:[]};for(var h in s){var p,d,f=self[c[h]];if(o.useUniqueIDs)d=s[h],p=t.GetAttributeByUniqueId(a,d);else{if(-1===(d=t.GetAttributeId(a,e[s[h]])))continue;p=t.GetAttribute(a,d)}u.attributes.push(r(e,t,a,h,f,p))}if(l===e.TRIANGULAR_MESH){for(var m=a.num_faces(),v=new Uint32Array(3*m),g=new e.DracoInt32Array,y=0;y<m;++y){t.GetFaceFromMesh(a,y,g);for(var b=0;b<3;++b)v[3*y+b]=g.GetValue(b)}u.index={array:v,itemSize:1},e.destroy(g)}return e.destroy(a),u}(t,n,s,i),l=c.attributes.map((function(e){return e.array.buffer}));c.index&&l.push(c.index.array.buffer),self.postMessage({type:"decode",id:o.id,geometry:c},l)}catch(u){console.error(u),self.postMessage({type:"error",id:o.id,error:u.message})}finally{t.destroy(s),t.destroy(n)}}))}}},M.taskCache=new WeakMap,M.setDecoderPath=function(){console.warn("THREE.DRACOLoader: The .setDecoderPath() method has been removed. Use instance methods.")},M.setDecoderConfig=function(){console.warn("THREE.DRACOLoader: The .setDecoderConfig() method has been removed. Use instance methods.")},M.releaseDecoderModule=function(){console.warn("THREE.DRACOLoader: The .releaseDecoderModule() method has been removed. Use instance methods.")},M.getDecoderModule=function(){console.warn("THREE.DRACOLoader: The .getDecoderModule() method has been removed. Use instance methods.")};!function(){function e(e){m.Loader.call(this,e),this.dracoLoader=null,this.ddsLoader=null}function t(){var e={};return{get:function(t){return e[t]},add:function(t,r){e[t]=r},remove:function(t){delete e[t]},removeAll:function(){e={}}}}e.prototype=Object.assign(Object.create(m.Loader.prototype),{constructor:e,load:function(e,t,r,n){var o,a=this;o=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:m.LoaderUtils.extractUrlBase(e),a.manager.itemStart(e);var i=function(t){n?n(t):console.error(t),a.manager.itemError(e),a.manager.itemEnd(e)},s=new m.FileLoader(a.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),"use-credentials"===a.crossOrigin&&s.setWithCredentials(!0),s.load(e,(function(r){try{a.parse(r,o,(function(r){t(r),a.manager.itemEnd(e)}),i)}catch(n){i(n)}}),r,i)},setDRACOLoader:function(e){return this.dracoLoader=e,this},setDDSLoader:function(e){return this.ddsLoader=e,this},parse:function(e,t,c,l){var d,g={};if("string"===typeof e)d=e;else if(m.LoaderUtils.decodeText(new Uint8Array(e,0,4))===s){try{g[r.KHR_BINARY_GLTF]=new u(e)}catch(E){return void(l&&l(E))}d=g[r.KHR_BINARY_GLTF].content}else d=m.LoaderUtils.decodeText(new Uint8Array(e));var y=JSON.parse(d);if(void 0===y.asset||y.asset.version[0]<2)l&&l(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));else{if(y.extensionsUsed)for(var b=0;b<y.extensionsUsed.length;++b){var w=y.extensionsUsed[b],M=y.extensionsRequired||[];switch(w){case r.KHR_LIGHTS_PUNCTUAL:g[w]=new o(y);break;case r.KHR_MATERIALS_CLEARCOAT:g[w]=new i;break;case r.KHR_MATERIALS_UNLIT:g[w]=new a;break;case r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:g[w]=new f;break;case r.KHR_DRACO_MESH_COMPRESSION:g[w]=new h(y,this.dracoLoader);break;case r.MSFT_TEXTURE_DDS:g[w]=new n(this.ddsLoader);break;case r.KHR_TEXTURE_TRANSFORM:g[w]=new p;break;case r.KHR_MESH_QUANTIZATION:g[w]=new v;break;default:M.indexOf(w)>=0&&console.warn('THREE.GLTFLoader: Unknown extension "'+w+'".')}}var x=new G(y,g,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,manager:this.manager});x.fileLoader.setRequestHeader(this.requestHeader),x.parse(c,l)}}});var r={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",MSFT_TEXTURE_DDS:"MSFT_texture_dds"};function n(e){if(!e)throw new Error("THREE.GLTFLoader: Attempting to load .dds texture without importing DDSLoader");this.name=r.MSFT_TEXTURE_DDS,this.ddsLoader=e}function o(e){this.name=r.KHR_LIGHTS_PUNCTUAL;var t=e.extensions&&e.extensions[r.KHR_LIGHTS_PUNCTUAL]||{};this.lightDefs=t.lights||[]}function a(){this.name=r.KHR_MATERIALS_UNLIT}function i(){this.name=r.KHR_MATERIALS_CLEARCOAT}o.prototype.loadLight=function(e){var t,r=this.lightDefs[e],n=new m.Color(16777215);void 0!==r.color&&n.fromArray(r.color);var o=void 0!==r.range?r.range:0;switch(r.type){case"directional":(t=new m.DirectionalLight(n)).target.position.set(0,0,-1),t.add(t.target);break;case"point":(t=new m.PointLight(n)).distance=o;break;case"spot":(t=new m.SpotLight(n)).distance=o,r.spot=r.spot||{},r.spot.innerConeAngle=void 0!==r.spot.innerConeAngle?r.spot.innerConeAngle:0,r.spot.outerConeAngle=void 0!==r.spot.outerConeAngle?r.spot.outerConeAngle:Math.PI/4,t.angle=r.spot.outerConeAngle,t.penumbra=1-r.spot.innerConeAngle/r.spot.outerConeAngle,t.target.position.set(0,0,-1),t.add(t.target);break;default:throw new Error('THREE.GLTFLoader: Unexpected light type, "'+r.type+'".')}return t.position.set(0,0,0),t.decay=2,void 0!==r.intensity&&(t.intensity=r.intensity),t.name=r.name||"light_"+e,Promise.resolve(t)},a.prototype.getMaterialType=function(){return m.MeshBasicMaterial},a.prototype.extendParams=function(e,t,r){var n=[];e.color=new m.Color(1,1,1),e.opacity=1;var o=t.pbrMetallicRoughness;if(o){if(Array.isArray(o.baseColorFactor)){var a=o.baseColorFactor;e.color.fromArray(a),e.opacity=a[3]}void 0!==o.baseColorTexture&&n.push(r.assignTexture(e,"map",o.baseColorTexture))}return Promise.all(n)},i.prototype.getMaterialType=function(){return m.MeshPhysicalMaterial},i.prototype.extendParams=function(e,t,r){var n=[],o=t.extensions[this.name];if(void 0!==o.clearcoatFactor&&(e.clearcoat=o.clearcoatFactor),void 0!==o.clearcoatTexture&&n.push(r.assignTexture(e,"clearcoatMap",o.clearcoatTexture)),void 0!==o.clearcoatRoughnessFactor&&(e.clearcoatRoughness=o.clearcoatRoughnessFactor),void 0!==o.clearcoatRoughnessTexture&&n.push(r.assignTexture(e,"clearcoatRoughnessMap",o.clearcoatRoughnessTexture)),void 0!==o.clearcoatNormalTexture&&(n.push(r.assignTexture(e,"clearcoatNormalMap",o.clearcoatNormalTexture)),void 0!==o.clearcoatNormalTexture.scale)){var a=o.clearcoatNormalTexture.scale;e.clearcoatNormalScale=new m.Vector2(a,a)}return Promise.all(n)};var s="glTF",c=1313821514,l=5130562;function u(e){this.name=r.KHR_BINARY_GLTF,this.content=null,this.body=null;var t=new DataView(e,0,12);if(this.header={magic:m.LoaderUtils.decodeText(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==s)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");for(var n=new DataView(e,12),o=0;o<n.byteLength;){var a=n.getUint32(o,!0);o+=4;var i=n.getUint32(o,!0);if(o+=4,i===c){var u=new Uint8Array(e,12+o,a);this.content=m.LoaderUtils.decodeText(u)}else if(i===l){var h=12+o;this.body=e.slice(h,h+a)}o+=a}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}function h(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=r.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}function p(){this.name=r.KHR_TEXTURE_TRANSFORM}function d(e){m.MeshStandardMaterial.call(this),this.isGLTFSpecularGlossinessMaterial=!0;var t=["#ifdef USE_SPECULARMAP","\tuniform sampler2D specularMap;","#endif"].join("\n"),r=["#ifdef USE_GLOSSINESSMAP","\tuniform sampler2D glossinessMap;","#endif"].join("\n"),n=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","\tvec4 texelSpecular = texture2D( specularMap, vUv );","\ttexelSpecular = sRGBToLinear( texelSpecular );","\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","\tspecularFactor *= texelSpecular.rgb;","#endif"].join("\n"),o=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );","\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","\tglossinessFactor *= texelGlossiness.a;","#endif"].join("\n"),a=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb;","vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );","material.specularRoughness = max( 1.0 - glossinessFactor, 0.0525 );// 0.0525 corresponds to the base mip of a 256 cubemap.","material.specularRoughness += geometryRoughness;","material.specularRoughness = min( material.specularRoughness, 1.0 );","material.specularColor = specularFactor.rgb;"].join("\n"),i={specular:{value:(new m.Color).setHex(16777215)},glossiness:{value:1},specularMap:{value:null},glossinessMap:{value:null}};this._extraUniforms=i,this.onBeforeCompile=function(e){for(var s in i)e.uniforms[s]=i[s];e.fragmentShader=e.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;"),e.fragmentShader=e.fragmentShader.replace("uniform float metalness;","uniform float glossiness;"),e.fragmentShader=e.fragmentShader.replace("#include <roughnessmap_pars_fragment>",t),e.fragmentShader=e.fragmentShader.replace("#include <metalnessmap_pars_fragment>",r),e.fragmentShader=e.fragmentShader.replace("#include <roughnessmap_fragment>",n),e.fragmentShader=e.fragmentShader.replace("#include <metalnessmap_fragment>",o),e.fragmentShader=e.fragmentShader.replace("#include <lights_physical_fragment>",a)},Object.defineProperties(this,{specular:{get:function(){return i.specular.value},set:function(e){i.specular.value=e}},specularMap:{get:function(){return i.specularMap.value},set:function(e){i.specularMap.value=e}},glossiness:{get:function(){return i.glossiness.value},set:function(e){i.glossiness.value=e}},glossinessMap:{get:function(){return i.glossinessMap.value},set:function(e){i.glossinessMap.value=e,e?(this.defines.USE_GLOSSINESSMAP="",this.defines.USE_ROUGHNESSMAP=""):(delete this.defines.USE_ROUGHNESSMAP,delete this.defines.USE_GLOSSINESSMAP)}}}),delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this.setValues(e)}function f(){return{name:r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,specularGlossinessParams:["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalMapType","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"],getMaterialType:function(){return d},extendParams:function(e,t,r){var n=t.extensions[this.name];e.color=new m.Color(1,1,1),e.opacity=1;var o=[];if(Array.isArray(n.diffuseFactor)){var a=n.diffuseFactor;e.color.fromArray(a),e.opacity=a[3]}if(void 0!==n.diffuseTexture&&o.push(r.assignTexture(e,"map",n.diffuseTexture)),e.emissive=new m.Color(0,0,0),e.glossiness=void 0!==n.glossinessFactor?n.glossinessFactor:1,e.specular=new m.Color(1,1,1),Array.isArray(n.specularFactor)&&e.specular.fromArray(n.specularFactor),void 0!==n.specularGlossinessTexture){var i=n.specularGlossinessTexture;o.push(r.assignTexture(e,"glossinessMap",i)),o.push(r.assignTexture(e,"specularMap",i))}return Promise.all(o)},createMaterial:function(e){var t=new d(e);return t.fog=!0,t.color=e.color,t.map=void 0===e.map?null:e.map,t.lightMap=null,t.lightMapIntensity=1,t.aoMap=void 0===e.aoMap?null:e.aoMap,t.aoMapIntensity=1,t.emissive=e.emissive,t.emissiveIntensity=1,t.emissiveMap=void 0===e.emissiveMap?null:e.emissiveMap,t.bumpMap=void 0===e.bumpMap?null:e.bumpMap,t.bumpScale=1,t.normalMap=void 0===e.normalMap?null:e.normalMap,t.normalMapType=m.TangentSpaceNormalMap,e.normalScale&&(t.normalScale=e.normalScale),t.displacementMap=null,t.displacementScale=1,t.displacementBias=0,t.specularMap=void 0===e.specularMap?null:e.specularMap,t.specular=e.specular,t.glossinessMap=void 0===e.glossinessMap?null:e.glossinessMap,t.glossiness=e.glossiness,t.alphaMap=null,t.envMap=void 0===e.envMap?null:e.envMap,t.envMapIntensity=1,t.refractionRatio=.98,t}}}function v(){this.name=r.KHR_MESH_QUANTIZATION}function g(e,t,r,n){m.Interpolant.call(this,e,t,r,n)}h.prototype.decodePrimitive=function(e,t){var r=this.json,n=this.dracoLoader,o=e.extensions[this.name].bufferView,a=e.extensions[this.name].attributes,i={},s={},c={};for(var l in a){var u=_[l]||l.toLowerCase();i[u]=a[l]}for(l in e.attributes){u=_[l]||l.toLowerCase();if(void 0!==a[l]){var h=r.accessors[e.attributes[l]],p=T[h.componentType];c[u]=p,s[u]=!0===h.normalized}}return t.getDependency("bufferView",o).then((function(e){return new Promise((function(t){n.decodeDracoFile(e,(function(e){for(var r in e.attributes){var n=e.attributes[r],o=s[r];void 0!==o&&(n.normalized=o)}t(e)}),i,c)}))}))},p.prototype.extendTexture=function(e,t){return e=e.clone(),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),void 0!==t.texCoord&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),e.needsUpdate=!0,e},d.prototype=Object.create(m.MeshStandardMaterial.prototype),d.prototype.constructor=d,d.prototype.copy=function(e){return m.MeshStandardMaterial.prototype.copy.call(this,e),this.specularMap=e.specularMap,this.specular.copy(e.specular),this.glossinessMap=e.glossinessMap,this.glossiness=e.glossiness,delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this},g.prototype=Object.create(m.Interpolant.prototype),g.prototype.constructor=g,g.prototype.copySampleValue_=function(e){for(var t=this.resultBuffer,r=this.sampleValues,n=this.valueSize,o=e*n*3+n,a=0;a!==n;a++)t[a]=r[o+a];return t},g.prototype.beforeStart_=g.prototype.copySampleValue_,g.prototype.afterEnd_=g.prototype.copySampleValue_,g.prototype.interpolate_=function(e,t,r,n){for(var o=this.resultBuffer,a=this.sampleValues,i=this.valueSize,s=2*i,c=3*i,l=n-t,u=(r-t)/l,h=u*u,p=h*u,d=e*c,f=d-c,m=-2*p+3*h,v=p-h,g=1-m,y=v-h+u,b=0;b!==i;b++){var w=a[f+b+i],M=a[f+b+s]*l,x=a[d+b+i],E=a[d+b]*l;o[b]=g*w+y*M+m*x+v*E}return o};var y=0,b=1,w=2,M=3,x=4,E=5,S=6,T={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},L={9728:m.NearestFilter,9729:m.LinearFilter,9984:m.NearestMipmapNearestFilter,9985:m.LinearMipmapNearestFilter,9986:m.NearestMipmapLinearFilter,9987:m.LinearMipmapLinearFilter},R={33071:m.ClampToEdgeWrapping,33648:m.MirroredRepeatWrapping,10497:m.RepeatWrapping},A={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},_={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},P={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},C={CUBICSPLINE:void 0,LINEAR:m.InterpolateLinear,STEP:m.InterpolateDiscrete},O="OPAQUE",I="MASK",j="BLEND",D={"image/png":m.RGBAFormat,"image/jpeg":m.RGBFormat};function k(e,t){return"string"!==typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}function F(e,t,r){for(var n in r.extensions)void 0===e[n]&&(t.userData.gltfExtensions=t.userData.gltfExtensions||{},t.userData.gltfExtensions[n]=r.extensions[n])}function U(e,t){void 0!==t.extras&&("object"===typeof t.extras?Object.assign(e.userData,t.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+t.extras))}function N(e,t){if(e.updateMorphTargets(),void 0!==t.weights)for(var r=0,n=t.weights.length;r<n;r++)e.morphTargetInfluences[r]=t.weights[r];if(t.extras&&Array.isArray(t.extras.targetNames)){var o=t.extras.targetNames;if(e.morphTargetInfluences.length===o.length){e.morphTargetDictionary={};for(r=0,n=o.length;r<n;r++)e.morphTargetDictionary[o[r]]=r}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function V(e){var t=e.extensions&&e.extensions[r.KHR_DRACO_MESH_COMPRESSION];return t?"draco:"+t.bufferView+":"+t.indices+":"+B(t.attributes):e.indices+":"+B(e.attributes)+":"+e.mode}function B(e){for(var t="",r=Object.keys(e).sort(),n=0,o=r.length;n<o;n++)t+=r[n]+":"+e[r[n]]+";";return t}function G(e,r,n){this.json=e||{},this.extensions=r||{},this.options=n||{},this.cache=new t,this.associations=new Map,this.primitiveCache={},this.textureLoader=new m.TextureLoader(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.fileLoader=new m.FileLoader(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}function H(e,t,r){var n=t.attributes,o=[];function a(t,n){return r.getDependency("accessor",t).then((function(t){e.setAttribute(n,t)}))}for(var i in n){var s=_[i]||i.toLowerCase();s in e.attributes||o.push(a(n[i],s))}if(void 0!==t.indices&&!e.index){var c=r.getDependency("accessor",t.indices).then((function(t){e.setIndex(t)}));o.push(c)}return U(e,t),function(e,t,r){var n=t.attributes,o=new m.Box3;if(void 0!==n.POSITION){var a=(d=r.json.accessors[n.POSITION]).min,i=d.max;if(void 0!==a&&void 0!==i){o.set(new m.Vector3(a[0],a[1],a[2]),new m.Vector3(i[0],i[1],i[2]));var s=t.targets;if(void 0!==s){for(var c=new m.Vector3,l=new m.Vector3,u=0,h=s.length;u<h;u++){var p=s[u];if(void 0!==p.POSITION){var d;a=(d=r.json.accessors[p.POSITION]).min,i=d.max;void 0!==a&&void 0!==i?(l.setX(Math.max(Math.abs(a[0]),Math.abs(i[0]))),l.setY(Math.max(Math.abs(a[1]),Math.abs(i[1]))),l.setZ(Math.max(Math.abs(a[2]),Math.abs(i[2]))),c.max(l)):console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}o.expandByVector(c)}e.boundingBox=o;var f=new m.Sphere;o.getCenter(f.center),f.radius=o.min.distanceTo(o.max)/2,e.boundingSphere=f}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}(e,t,r),Promise.all(o).then((function(){return void 0!==t.targets?function(e,t,r){for(var n=!1,o=!1,a=0,i=t.length;a<i;a++){if(void 0!==(l=t[a]).POSITION&&(n=!0),void 0!==l.NORMAL&&(o=!0),n&&o)break}if(!n&&!o)return Promise.resolve(e);var s=[],c=[];for(a=0,i=t.length;a<i;a++){var l=t[a];if(n){var u=void 0!==l.POSITION?r.getDependency("accessor",l.POSITION):e.attributes.position;s.push(u)}if(o){u=void 0!==l.NORMAL?r.getDependency("accessor",l.NORMAL):e.attributes.normal;c.push(u)}}return Promise.all([Promise.all(s),Promise.all(c)]).then((function(t){var r=t[0],a=t[1];return n&&(e.morphAttributes.position=r),o&&(e.morphAttributes.normal=a),e.morphTargetsRelative=!0,e}))}(e,t.targets,r):e}))}function X(e,t){var r=e.getIndex();if(null===r){var n=[],o=e.getAttribute("position");if(void 0===o)return console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),e;for(var a=0;a<o.count;a++)n.push(a);e.setIndex(n),r=e.getIndex()}var i=r.count-2,s=[];if(t===m.TriangleFanDrawMode)for(a=1;a<=i;a++)s.push(r.getX(0)),s.push(r.getX(a)),s.push(r.getX(a+1));else for(a=0;a<i;a++)a%2===0?(s.push(r.getX(a)),s.push(r.getX(a+1)),s.push(r.getX(a+2))):(s.push(r.getX(a+2)),s.push(r.getX(a+1)),s.push(r.getX(a)));s.length/3!==i&&console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");var c=e.clone();return c.setIndex(s),c}G.prototype.parse=function(e,t){var r=this,n=this.json,o=this.extensions;this.cache.removeAll(),this.markDefs(),Promise.all([this.getDependencies("scene"),this.getDependencies("animation"),this.getDependencies("camera")]).then((function(t){var a={scene:t[0][n.scene||0],scenes:t[0],animations:t[1],cameras:t[2],asset:n.asset,parser:r,userData:{}};F(o,a,n),U(a,n),e(a)})).catch(t)},G.prototype.markDefs=function(){for(var e=this.json.nodes||[],t=this.json.skins||[],r=this.json.meshes||[],n={},o={},a=0,i=t.length;a<i;a++)for(var s=t[a].joints,c=0,l=s.length;c<l;c++)e[s[c]].isBone=!0;for(var u=0,h=e.length;u<h;u++){var p=e[u];void 0!==p.mesh&&(void 0===n[p.mesh]&&(n[p.mesh]=o[p.mesh]=0),n[p.mesh]++,void 0!==p.skin&&(r[p.mesh].isSkinnedMesh=!0))}this.json.meshReferences=n,this.json.meshUses=o},G.prototype.getDependency=function(e,t){var n=e+":"+t,o=this.cache.get(n);if(!o){switch(e){case"scene":o=this.loadScene(t);break;case"node":o=this.loadNode(t);break;case"mesh":o=this.loadMesh(t);break;case"accessor":o=this.loadAccessor(t);break;case"bufferView":o=this.loadBufferView(t);break;case"buffer":o=this.loadBuffer(t);break;case"material":o=this.loadMaterial(t);break;case"texture":o=this.loadTexture(t);break;case"skin":o=this.loadSkin(t);break;case"animation":o=this.loadAnimation(t);break;case"camera":o=this.loadCamera(t);break;case"light":o=this.extensions[r.KHR_LIGHTS_PUNCTUAL].loadLight(t);break;default:throw new Error("Unknown type: "+e)}this.cache.add(n,o)}return o},G.prototype.getDependencies=function(e){var t=this.cache.get(e);if(!t){var r=this,n=this.json[e+("mesh"===e?"es":"s")]||[];t=Promise.all(n.map((function(t,n){return r.getDependency(e,n)}))),this.cache.add(e,t)}return t},G.prototype.loadBuffer=function(e){var t=this.json.buffers[e],n=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[r.KHR_BINARY_GLTF].body);var o=this.options;return new Promise((function(e,r){n.load(k(t.uri,o.path),e,void 0,(function(){r(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))}))}))},G.prototype.loadBufferView=function(e){var t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then((function(e){var r=t.byteLength||0,n=t.byteOffset||0;return e.slice(n,n+r)}))},G.prototype.loadAccessor=function(e){var t=this,r=this.json,n=this.json.accessors[e];if(void 0===n.bufferView&&void 0===n.sparse)return Promise.resolve(null);var o=[];return void 0!==n.bufferView?o.push(this.getDependency("bufferView",n.bufferView)):o.push(null),void 0!==n.sparse&&(o.push(this.getDependency("bufferView",n.sparse.indices.bufferView)),o.push(this.getDependency("bufferView",n.sparse.values.bufferView))),Promise.all(o).then((function(e){var o,a,i=e[0],s=A[n.type],c=T[n.componentType],l=c.BYTES_PER_ELEMENT,u=l*s,h=n.byteOffset||0,p=void 0!==n.bufferView?r.bufferViews[n.bufferView].byteStride:void 0,d=!0===n.normalized;if(p&&p!==u){var f=Math.floor(h/p),v="InterleavedBuffer:"+n.bufferView+":"+n.componentType+":"+f+":"+n.count,g=t.cache.get(v);g||(o=new c(i,f*p,n.count*p/l),g=new m.InterleavedBuffer(o,p/l),t.cache.add(v,g)),a=new m.InterleavedBufferAttribute(g,s,h%p/l,d)}else o=null===i?new c(n.count*s):new c(i,h,n.count*s),a=new m.BufferAttribute(o,s,d);if(void 0!==n.sparse){var y=A.SCALAR,b=T[n.sparse.indices.componentType],w=n.sparse.indices.byteOffset||0,M=n.sparse.values.byteOffset||0,x=new b(e[1],w,n.sparse.count*y),E=new c(e[2],M,n.sparse.count*s);null!==i&&(a=new m.BufferAttribute(a.array.slice(),a.itemSize,a.normalized));for(var S=0,L=x.length;S<L;S++){var R=x[S];if(a.setX(R,E[S*s]),s>=2&&a.setY(R,E[S*s+1]),s>=3&&a.setZ(R,E[S*s+2]),s>=4&&a.setW(R,E[S*s+3]),s>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return a}))},G.prototype.loadTexture=function(e){var t,n=this,o=this.json,a=this.options,i=this.textureLoader,s=self.URL||self.webkitURL,c=o.textures[e],l=c.extensions||{},u=(t=l[r.MSFT_TEXTURE_DDS]?o.images[l[r.MSFT_TEXTURE_DDS].source]:o.images[c.source]).uri,h=!1;return void 0!==t.bufferView&&(u=n.getDependency("bufferView",t.bufferView).then((function(e){h=!0;var r=new Blob([e],{type:t.mimeType});return u=s.createObjectURL(r)}))),Promise.resolve(u).then((function(e){var t=a.manager.getHandler(e);return t||(t=l[r.MSFT_TEXTURE_DDS]?n.extensions[r.MSFT_TEXTURE_DDS].ddsLoader:i),new Promise((function(r,n){t.load(k(e,a.path),r,void 0,n)}))})).then((function(r){!0===h&&s.revokeObjectURL(u),r.flipY=!1,c.name&&(r.name=c.name),t.mimeType in D&&(r.format=D[t.mimeType]);var a=(o.samplers||{})[c.sampler]||{};return r.magFilter=L[a.magFilter]||m.LinearFilter,r.minFilter=L[a.minFilter]||m.LinearMipmapLinearFilter,r.wrapS=R[a.wrapS]||m.RepeatWrapping,r.wrapT=R[a.wrapT]||m.RepeatWrapping,n.associations.set(r,{type:"textures",index:e}),r}))},G.prototype.assignTexture=function(e,t,n){var o=this;return this.getDependency("texture",n.index).then((function(a){if(!a.isCompressedTexture)switch(t){case"aoMap":case"emissiveMap":case"metalnessMap":case"normalMap":case"roughnessMap":a.format=m.RGBFormat}if(void 0===n.texCoord||0==n.texCoord||"aoMap"===t&&1==n.texCoord||console.warn("THREE.GLTFLoader: Custom UV set "+n.texCoord+" for texture "+t+" not yet supported."),o.extensions[r.KHR_TEXTURE_TRANSFORM]){var i=void 0!==n.extensions?n.extensions[r.KHR_TEXTURE_TRANSFORM]:void 0;if(i){var s=o.associations.get(a);a=o.extensions[r.KHR_TEXTURE_TRANSFORM].extendTexture(a,i),o.associations.set(a,s)}}e[t]=a}))},G.prototype.assignFinalMaterial=function(e){var t=e.geometry,r=e.material,n=void 0!==t.attributes.tangent,o=void 0!==t.attributes.color,a=void 0===t.attributes.normal,i=!0===e.isSkinnedMesh,s=Object.keys(t.morphAttributes).length>0,c=s&&void 0!==t.morphAttributes.normal;if(e.isPoints){var l="PointsMaterial:"+r.uuid,u=this.cache.get(l);u||(u=new m.PointsMaterial,m.Material.prototype.copy.call(u,r),u.color.copy(r.color),u.map=r.map,u.sizeAttenuation=!1,this.cache.add(l,u)),r=u}else if(e.isLine){l="LineBasicMaterial:"+r.uuid;var h=this.cache.get(l);h||(h=new m.LineBasicMaterial,m.Material.prototype.copy.call(h,r),h.color.copy(r.color),this.cache.add(l,h)),r=h}if(n||o||a||i||s){l="ClonedMaterial:"+r.uuid+":";r.isGLTFSpecularGlossinessMaterial&&(l+="specular-glossiness:"),i&&(l+="skinning:"),n&&(l+="vertex-tangents:"),o&&(l+="vertex-colors:"),a&&(l+="flat-shading:"),s&&(l+="morph-targets:"),c&&(l+="morph-normals:");var p=this.cache.get(l);p||(p=r.clone(),i&&(p.skinning=!0),n&&(p.vertexTangents=!0),o&&(p.vertexColors=!0),a&&(p.flatShading=!0),s&&(p.morphTargets=!0),c&&(p.morphNormals=!0),this.cache.add(l,p),this.associations.set(p,this.associations.get(r))),r=p}r.aoMap&&void 0===t.attributes.uv2&&void 0!==t.attributes.uv&&t.setAttribute("uv2",t.attributes.uv),r.normalScale&&!n&&(r.normalScale.y=-r.normalScale.y),r.clearcoatNormalScale&&!n&&(r.clearcoatNormalScale.y=-r.clearcoatNormalScale.y),e.material=r},G.prototype.loadMaterial=function(e){var t,n=this,o=this.json,a=this.extensions,i=o.materials[e],s={},c=i.extensions||{},l=[];if(c[r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){var u=a[r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];t=u.getMaterialType(),l.push(u.extendParams(s,i,n))}else if(c[r.KHR_MATERIALS_UNLIT]){var h=a[r.KHR_MATERIALS_UNLIT];t=h.getMaterialType(),l.push(h.extendParams(s,i,n))}else{t=m.MeshStandardMaterial;var p=i.pbrMetallicRoughness||{};if(s.color=new m.Color(1,1,1),s.opacity=1,Array.isArray(p.baseColorFactor)){var f=p.baseColorFactor;s.color.fromArray(f),s.opacity=f[3]}void 0!==p.baseColorTexture&&l.push(n.assignTexture(s,"map",p.baseColorTexture)),s.metalness=void 0!==p.metallicFactor?p.metallicFactor:1,s.roughness=void 0!==p.roughnessFactor?p.roughnessFactor:1,void 0!==p.metallicRoughnessTexture&&(l.push(n.assignTexture(s,"metalnessMap",p.metallicRoughnessTexture)),l.push(n.assignTexture(s,"roughnessMap",p.metallicRoughnessTexture)))}!0===i.doubleSided&&(s.side=m.DoubleSide);var v=i.alphaMode||O;if(v===j?(s.transparent=!0,s.depthWrite=!1):(s.transparent=!1,v===I&&(s.alphaTest=void 0!==i.alphaCutoff?i.alphaCutoff:.5)),void 0!==i.normalTexture&&t!==m.MeshBasicMaterial&&(l.push(n.assignTexture(s,"normalMap",i.normalTexture)),s.normalScale=new m.Vector2(1,1),void 0!==i.normalTexture.scale&&s.normalScale.set(i.normalTexture.scale,i.normalTexture.scale)),void 0!==i.occlusionTexture&&t!==m.MeshBasicMaterial&&(l.push(n.assignTexture(s,"aoMap",i.occlusionTexture)),void 0!==i.occlusionTexture.strength&&(s.aoMapIntensity=i.occlusionTexture.strength)),void 0!==i.emissiveFactor&&t!==m.MeshBasicMaterial&&(s.emissive=(new m.Color).fromArray(i.emissiveFactor)),void 0!==i.emissiveTexture&&t!==m.MeshBasicMaterial&&l.push(n.assignTexture(s,"emissiveMap",i.emissiveTexture)),c[r.KHR_MATERIALS_CLEARCOAT]){var g=a[r.KHR_MATERIALS_CLEARCOAT];t=g.getMaterialType(),l.push(g.extendParams(s,{extensions:c},n))}return Promise.all(l).then((function(){var o;return o=t===d?a[r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(s):new t(s),i.name&&(o.name=i.name),o.map&&(o.map.encoding=m.sRGBEncoding),o.emissiveMap&&(o.emissiveMap.encoding=m.sRGBEncoding),U(o,i),n.associations.set(o,{type:"materials",index:e}),i.extensions&&F(a,o,i),o}))},G.prototype.loadGeometries=function(e){var t=this,n=this.extensions,o=this.primitiveCache;function a(e){return n[r.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(e,t).then((function(r){return H(r,e,t)}))}for(var i=[],s=0,c=e.length;s<c;s++){var l,u=e[s],h=V(u),p=o[h];if(p)i.push(p.promise);else l=u.extensions&&u.extensions[r.KHR_DRACO_MESH_COMPRESSION]?a(u):H(new m.BufferGeometry,u,t),o[h]={primitive:u,promise:l},i.push(l)}return Promise.all(i)},G.prototype.loadMesh=function(e){for(var t,r=this,n=this.json.meshes[e],o=n.primitives,a=[],i=0,s=o.length;i<s;i++){var c=void 0===o[i].material?(void 0===(t=this.cache).DefaultMaterial&&(t.DefaultMaterial=new m.MeshStandardMaterial({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:m.FrontSide})),t.DefaultMaterial):this.getDependency("material",o[i].material);a.push(c)}return a.push(r.loadGeometries(o)),Promise.all(a).then((function(t){for(var a=t.slice(0,t.length-1),i=t[t.length-1],s=[],c=0,l=i.length;c<l;c++){var u,h=i[c],p=o[c],d=a[c];if(p.mode===x||p.mode===E||p.mode===S||void 0===p.mode)!0!==(u=!0===n.isSkinnedMesh?new m.SkinnedMesh(h,d):new m.Mesh(h,d)).isSkinnedMesh||u.geometry.attributes.skinWeight.normalized||u.normalizeSkinWeights(),p.mode===E?u.geometry=X(u.geometry,m.TriangleStripDrawMode):p.mode===S&&(u.geometry=X(u.geometry,m.TriangleFanDrawMode));else if(p.mode===b)u=new m.LineSegments(h,d);else if(p.mode===M)u=new m.Line(h,d);else if(p.mode===w)u=new m.LineLoop(h,d);else{if(p.mode!==y)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+p.mode);u=new m.Points(h,d)}Object.keys(u.geometry.morphAttributes).length>0&&N(u,n),u.name=n.name||"mesh_"+e,i.length>1&&(u.name+="_"+c),U(u,n),r.assignFinalMaterial(u),s.push(u)}if(1===s.length)return s[0];var f=new m.Group;for(c=0,l=s.length;c<l;c++)f.add(s[c]);return f}))},G.prototype.loadCamera=function(e){var t,r=this.json.cameras[e],n=r[r.type];if(n)return"perspective"===r.type?t=new m.PerspectiveCamera(m.MathUtils.radToDeg(n.yfov),n.aspectRatio||1,n.znear||1,n.zfar||2e6):"orthographic"===r.type&&(t=new m.OrthographicCamera(-n.xmag,n.xmag,n.ymag,-n.ymag,n.znear,n.zfar)),r.name&&(t.name=r.name),U(t,r),Promise.resolve(t);console.warn("THREE.GLTFLoader: Missing camera parameters.")},G.prototype.loadSkin=function(e){var t=this.json.skins[e],r={joints:t.joints};return void 0===t.inverseBindMatrices?Promise.resolve(r):this.getDependency("accessor",t.inverseBindMatrices).then((function(e){return r.inverseBindMatrices=e,r}))},G.prototype.loadAnimation=function(e){for(var t=this.json.animations[e],r=[],n=[],o=[],a=[],i=[],s=0,c=t.channels.length;s<c;s++){var l=t.channels[s],u=t.samplers[l.sampler],h=l.target,p=void 0!==h.node?h.node:h.id,d=void 0!==t.parameters?t.parameters[u.input]:u.input,f=void 0!==t.parameters?t.parameters[u.output]:u.output;r.push(this.getDependency("node",p)),n.push(this.getDependency("accessor",d)),o.push(this.getDependency("accessor",f)),a.push(u),i.push(h)}return Promise.all([Promise.all(r),Promise.all(n),Promise.all(o),Promise.all(a),Promise.all(i)]).then((function(r){for(var n=r[0],o=r[1],a=r[2],i=r[3],s=r[4],c=[],l=0,u=n.length;l<u;l++){var h=n[l],p=o[l],d=a[l],f=i[l],v=s[l];if(void 0!==h){var y;switch(h.updateMatrix(),h.matrixAutoUpdate=!0,P[v.path]){case P.weights:y=m.NumberKeyframeTrack;break;case P.rotation:y=m.QuaternionKeyframeTrack;break;case P.position:case P.scale:default:y=m.VectorKeyframeTrack}var b=h.name?h.name:h.uuid,w=void 0!==f.interpolation?C[f.interpolation]:m.InterpolateLinear,M=[];P[v.path]===P.weights?h.traverse((function(e){!0===e.isMesh&&e.morphTargetInfluences&&M.push(e.name?e.name:e.uuid)})):M.push(b);var x=d.array;if(d.normalized){var E;if(x.constructor===Int8Array)E=1/127;else if(x.constructor===Uint8Array)E=1/255;else if(x.constructor==Int16Array)E=1/32767;else{if(x.constructor!==Uint16Array)throw new Error("THREE.GLTFLoader: Unsupported output accessor component type.");E=1/65535}for(var S=new Float32Array(x.length),T=0,L=x.length;T<L;T++)S[T]=x[T]*E;x=S}for(T=0,L=M.length;T<L;T++){var R=new y(M[T]+"."+P[v.path],p.array,x,w);"CUBICSPLINE"===f.interpolation&&(R.createInterpolant=function(e){return new g(this.times,this.values,this.getValueSize()/3,e)},R.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),c.push(R)}}}var A=t.name?t.name:"animation_"+e;return new m.AnimationClip(A,void 0,c)}))},G.prototype.loadNode=function(e){var t=this.json,n=this.extensions,o=this,a=t.meshReferences,i=t.meshUses,s=t.nodes[e];return function(){var e=[];return void 0!==s.mesh&&e.push(o.getDependency("mesh",s.mesh).then((function(e){var t;if(a[s.mesh]>1){var r=i[s.mesh]++;(t=e.clone()).name+="_instance_"+r}else t=e;return void 0!==s.weights&&t.traverse((function(e){if(e.isMesh)for(var t=0,r=s.weights.length;t<r;t++)e.morphTargetInfluences[t]=s.weights[t]})),t}))),void 0!==s.camera&&e.push(o.getDependency("camera",s.camera)),s.extensions&&s.extensions[r.KHR_LIGHTS_PUNCTUAL]&&void 0!==s.extensions[r.KHR_LIGHTS_PUNCTUAL].light&&e.push(o.getDependency("light",s.extensions[r.KHR_LIGHTS_PUNCTUAL].light)),Promise.all(e)}().then((function(t){var r;if((r=!0===s.isBone?new m.Bone:t.length>1?new m.Group:1===t.length?t[0]:new m.Object3D)!==t[0])for(var a=0,i=t.length;a<i;a++)r.add(t[a]);if(s.name&&(r.userData.name=s.name,r.name=m.PropertyBinding.sanitizeNodeName(s.name)),U(r,s),s.extensions&&F(n,r,s),void 0!==s.matrix){var c=new m.Matrix4;c.fromArray(s.matrix),r.applyMatrix4(c)}else void 0!==s.translation&&r.position.fromArray(s.translation),void 0!==s.rotation&&r.quaternion.fromArray(s.rotation),void 0!==s.scale&&r.scale.fromArray(s.scale);return o.associations.set(r,{type:"nodes",index:e}),r}))},G.prototype.loadScene=function(){function e(t,r,n,o){var a=n.nodes[t];return o.getDependency("node",t).then((function(e){return void 0===a.skin?e:o.getDependency("skin",a.skin).then((function(e){for(var r=[],n=0,a=(t=e).joints.length;n<a;n++)r.push(o.getDependency("node",t.joints[n]));return Promise.all(r)})).then((function(r){return e.traverse((function(e){if(e.isMesh){for(var n=[],o=[],a=0,i=r.length;a<i;a++){var s=r[a];if(s){n.push(s);var c=new m.Matrix4;void 0!==t.inverseBindMatrices&&c.fromArray(t.inverseBindMatrices.array,16*a),o.push(c)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[a])}e.bind(new m.Skeleton(n,o),e.matrixWorld)}})),e}));var t})).then((function(t){r.add(t);var i=[];if(a.children)for(var s=a.children,c=0,l=s.length;c<l;c++){var u=s[c];i.push(e(u,t,n,o))}return Promise.all(i)}))}return function(t){var r=this.json,n=this.extensions,o=this.json.scenes[t],a=new m.Group;o.name&&(a.name=o.name),U(a,o),o.extensions&&F(n,a,o);for(var i=o.nodes||[],s=[],c=0,l=i.length;c<l;c++)s.push(e(i[c],a,r,this));return Promise.all(s).then((function(){return a}))}}()}();var x=r(34),E=r.n(x);function S(e){var t,r=new Set,n=function(e,n){var o="function"===typeof e?e(t):e;o!==t&&(t=n?o:Object.assign({},t,o),r.forEach((function(e){return e(t)})))},o=function(){return t},a={setState:n,getState:o,subscribe:function(e,n,a){return n||a?function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Object.is,i=n(t);function s(){try{var r=n(t);a(i,r)||e(i=r)}catch(o){e(null,o)}}return r.add(s),function(){return r.delete(s)}}(e,n,a):(r.add(e),function(){return r.delete(e)})},destroy:function(){return r.clear()}};return t=e(n,o,a),a}var T="undefined"===typeof window?p.useEffect:p.useLayoutEffect;var L=function(e){var t="function"===typeof e?S(e):e,r=function(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t.getState,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object.is,o=Object(p.useReducer)((function(e){return e+1}),0),a=Object(l.a)(o,2),i=a[1],s=t.getState(),c=Object(p.useRef)(s),u=Object(p.useRef)(r),h=Object(p.useRef)(n),d=Object(p.useRef)(!1),f=Object(p.useRef)();void 0===f.current&&(f.current=r(s));var m=!1;(c.current!==s||u.current!==r||h.current!==n||d.current)&&(e=r(s),m=!n(f.current,e)),T((function(){m&&(f.current=e),c.current=s,u.current=r,h.current=n,d.current=!1}));var v=Object(p.useRef)(s);return Object(p.useEffect)((function(){var e=function(){try{var e=t.getState(),r=u.current(e);h.current(f.current,r)||(c.current=e,f.current=r,i())}catch(n){d.current=!0,i()}},r=t.subscribe(e);return t.getState()!==v.current&&e(),r}),[]),m?e:f.current};return Object.assign(r,t),r[Symbol.iterator]=E.a.mark((function e(){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.warn("[useStore, api] = create() is deprecated and will be removed in v4"),e.next=3,r;case 3:return e.next=5,t;case 5:case"end":return e.stop()}}),e)})),r},R=(r(41),function e(t,r){m.Mesh.call(this,t),this.type="Reflector";var n=this,o=void 0!==(r=r||{}).color?new m.Color(r.color):new m.Color(8355711),a=r.textureWidth||512,i=r.textureHeight||512,s=r.clipBias||0,c=r.shader||e.ReflectorShader,l=void 0!==r.encoding?r.encoding:m.LinearEncoding,u=new m.Plane,h=new m.Vector3,p=new m.Vector3,d=new m.Vector3,f=new m.Matrix4,v=new m.Vector3(0,0,-1),g=new m.Vector4,y=new m.Vector3,b=new m.Vector3,w=new m.Vector4,M=new m.Matrix4,x=new m.PerspectiveCamera,E={minFilter:m.LinearFilter,magFilter:m.LinearFilter,format:m.RGBFormat,stencilBuffer:!1,encoding:l},S=new m.WebGLRenderTarget(a,i,E);m.MathUtils.isPowerOfTwo(a)&&m.MathUtils.isPowerOfTwo(i)||(S.texture.generateMipmaps=!1);var T=new m.ShaderMaterial({uniforms:m.UniformsUtils.clone(c.uniforms),fragmentShader:c.fragmentShader,vertexShader:c.vertexShader});T.uniforms.tDiffuse.value=S.texture,T.uniforms.color.value=o,T.uniforms.textureMatrix.value=M,this.material=T,this.onBeforeRender=function(e,t,r){if(p.setFromMatrixPosition(n.matrixWorld),d.setFromMatrixPosition(r.matrixWorld),f.extractRotation(n.matrixWorld),h.set(0,0,1),h.applyMatrix4(f),y.subVectors(p,d),!(y.dot(h)>0)){y.reflect(h).negate(),y.add(p),f.extractRotation(r.matrixWorld),v.set(0,0,-1),v.applyMatrix4(f),v.add(d),b.subVectors(p,v),b.reflect(h).negate(),b.add(p),x.position.copy(y),x.up.set(0,1,0),x.up.applyMatrix4(f),x.up.reflect(h),x.lookAt(b),x.far=r.far,x.updateMatrixWorld(),x.projectionMatrix.copy(r.projectionMatrix),M.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),M.multiply(x.projectionMatrix),M.multiply(x.matrixWorldInverse),M.multiply(n.matrixWorld),u.setFromNormalAndCoplanarPoint(h,p),u.applyMatrix4(x.matrixWorldInverse),g.set(u.normal.x,u.normal.y,u.normal.z,u.constant);var o=x.projectionMatrix;w.x=(Math.sign(g.x)+o.elements[8])/o.elements[0],w.y=(Math.sign(g.y)+o.elements[9])/o.elements[5],w.z=-1,w.w=(1+o.elements[10])/o.elements[14],g.multiplyScalar(2/g.dot(w)),o.elements[2]=g.x,o.elements[6]=g.y,o.elements[10]=g.z+1-s,o.elements[14]=g.w,n.visible=!1;var a=e.getRenderTarget(),i=e.xr.enabled,c=e.shadowMap.autoUpdate;e.xr.enabled=!1,e.shadowMap.autoUpdate=!1,e.setRenderTarget(S),e.state.buffers.depth.setMask(!0),!1===e.autoClear&&e.clear(),e.render(t,x),e.xr.enabled=i,e.shadowMap.autoUpdate=c,e.setRenderTarget(a);var l=r.viewport;void 0!==l&&e.state.viewport(l),n.visible=!0}},this.getRenderTarget=function(){return S}});(R.prototype=Object.create(m.Mesh.prototype)).constructor=R,R.ReflectorShader={uniforms:{color:{value:null},tDiffuse:{value:null},textureMatrix:{value:null}},vertexShader:["uniform mat4 textureMatrix;","varying vec4 vUv;","void main() {","\tvUv = textureMatrix * vec4( position, 1.0 );","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform vec3 color;","uniform sampler2D tDiffuse;","varying vec4 vUv;","float blendOverlay( float base, float blend ) {","\treturn( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );","}","vec3 blendOverlay( vec3 base, vec3 blend ) {","\treturn vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ), blendOverlay( base.b, blend.b ) );","}","void main() {","\tvec4 base = texture2DProj( tDiffuse, vUv );","\tgl_FragColor = vec4( blendOverlay( base.rgb, color ), 1.0 );","}"].join("\n")};r(255);var A=function(){};!function(){var e=new m.Vector3,t=new m.Vector3;function r(e,t){var r=e.indexOf(t);r>-1&&e.splice(r,1)}function n(e,t){var r,n,o,a=t.position.distanceTo(e.position),i=0,s=[],c=e.faces.length;for(r=0;r<c;r++)(n=e.faces[r]).hasVertex(t)&&s.push(n);for(r=0;r<c;r++){var l=1;n=e.faces[r];for(var u=0;u<s.length;u++){o=s[u];var h=n.normal.dot(o.normal);l=Math.min(l,(1.001-h)/2)}i=Math.max(i,l)}return s.length<2&&(i=1),a*i+0}function o(e){if(0===e.neighbors.length)return e.collapseNeighbor=null,void(e.collapseCost=-.01);e.collapseCost=1e5,e.collapseNeighbor=null;for(var t=0;t<e.neighbors.length;t++){var r=n(e,e.neighbors[t]);e.collapseNeighbor||(e.collapseNeighbor=e.neighbors[t],e.collapseCost=r,e.minCost=r,e.totalCost=0,e.costCount=0),e.costCount++,e.totalCost+=r,r<e.minCost&&(e.collapseNeighbor=e.neighbors[t],e.minCost=r)}e.collapseCost=e.totalCost/e.costCount}function a(e,t){for(console.assert(0===e.faces.length);e.neighbors.length;){r(e.neighbors.pop().neighbors,e)}r(t,e)}function i(e,t){r(t,e),e.v1&&r(e.v1.faces,e),e.v2&&r(e.v2.faces,e),e.v3&&r(e.v3.faces,e);for(var n,o,a=[e.v1,e.v2,e.v3],i=0;i<3;i++)o=a[(i+1)%3],(n=a[i])&&o&&(n.removeIfNonNeighbor(o),o.removeIfNonNeighbor(n))}function s(e,t,r,n){if(n){var s,c=[];for(s=0;s<r.neighbors.length;s++)c.push(r.neighbors[s]);for(s=r.faces.length-1;s>=0;s--)r.faces[s].hasVertex(n)&&i(r.faces[s],t);for(s=r.faces.length-1;s>=0;s--)r.faces[s].replaceVertex(r,n);for(a(r,e),s=0;s<c.length;s++)o(c[s])}else a(r,e)}function c(e){for(var t=e[0],r=0;r<e.length;r++)e[r].collapseCost<t.collapseCost&&(t=e[r]);return t}function l(e,t,r,n,o,a){this.a=n,this.b=o,this.c=a,this.v1=e,this.v2=t,this.v3=r,this.normal=new m.Vector3,this.computeNormal(),e.faces.push(this),e.addUniqueNeighbor(t),e.addUniqueNeighbor(r),t.faces.push(this),t.addUniqueNeighbor(e),t.addUniqueNeighbor(r),r.faces.push(this),r.addUniqueNeighbor(e),r.addUniqueNeighbor(t)}function u(e,t){this.position=e,this.id=t,this.faces=[],this.neighbors=[],this.collapseCost=0,this.collapseNeighbor=null}l.prototype.computeNormal=function(){var r=this.v1.position,n=this.v2.position,o=this.v3.position;e.subVectors(o,n),t.subVectors(r,n),e.cross(t).normalize(),this.normal.copy(e)},l.prototype.hasVertex=function(e){return e===this.v1||e===this.v2||e===this.v3},l.prototype.replaceVertex=function(e,t){e===this.v1?this.v1=t:e===this.v2?this.v2=t:e===this.v3&&(this.v3=t),r(e.faces,this),t.faces.push(this),e.removeIfNonNeighbor(this.v1),this.v1.removeIfNonNeighbor(e),e.removeIfNonNeighbor(this.v2),this.v2.removeIfNonNeighbor(e),e.removeIfNonNeighbor(this.v3),this.v3.removeIfNonNeighbor(e),this.v1.addUniqueNeighbor(this.v2),this.v1.addUniqueNeighbor(this.v3),this.v2.addUniqueNeighbor(this.v1),this.v2.addUniqueNeighbor(this.v3),this.v3.addUniqueNeighbor(this.v1),this.v3.addUniqueNeighbor(this.v2),this.computeNormal()},u.prototype.addUniqueNeighbor=function(e){var t,r;t=this.neighbors,r=e,-1===t.indexOf(r)&&t.push(r)},u.prototype.removeIfNonNeighbor=function(e){var t=this.neighbors,r=this.faces,n=t.indexOf(e);if(-1!==n){for(var o=0;o<r.length;o++)if(r[o].hasVertex(e))return;t.splice(n,1)}},A.prototype.modify=function(e,t){e.isBufferGeometry&&(e=(new m.Geometry).fromBufferGeometry(e)),e.mergeVertices();var r,n,a,i=e.vertices,h=e.faces,p=[],d=[];for(r=0,n=i.length;r<n;r++){var f=new u(i[r],r);p.push(f)}for(r=0,n=h.length;r<n;r++){var v=(S=h[r]).a,g=S.b,y=S.c,b=new l(p[v],p[g],p[y],v,g,y);d.push(b)}for(r=0,n=p.length;r<n;r++)o(p[r]);for(var w=t;w--;){if(!(a=c(p))){console.log("THREE.SimplifyModifier: No next vertex");break}s(p,d,a,a.collapseNeighbor)}var M=new m.BufferGeometry,x=[],E=[];for(r=0;r<p.length;r++){f=p[r].position;x.push(f.x,f.y,f.z)}for(r=0;r<d.length;r++){var S=d[r];v=p.indexOf(S.v1),g=p.indexOf(S.v2),y=p.indexOf(S.v3);E.push(v,g,y)}return M.setAttribute("position",new m.Float32BufferAttribute(x,3)),M.setIndex(E),M}}();var _=function(e){this.subdivisions=void 0===e?1:e};_.prototype.modify=function(e){(e=e.isBufferGeometry?(new m.Geometry).fromBufferGeometry(e):e.clone()).mergeVertices();for(var t=this.subdivisions;t-- >0;)this.smooth(e);return e.computeFaceNormals(),e.computeVertexNormals(),e},function(){var e=["a","b","c"];function t(e,t,r){return r[Math.min(e,t)+"_"+Math.max(e,t)]}function r(e,t,r,n,o,a){var i,s=Math.min(e,t),c=Math.max(e,t),l=s+"_"+c;l in n?i=n[l]:(i={a:r[s],b:r[c],newEdge:null,faces:[]},n[l]=i);i.faces.push(o),a[e].edges.push(i),a[t].edges.push(i)}function n(e,t,r,n,o){e.push(new m.Face3(t,r,n,void 0,void 0,o))}function o(e,t){return Math.abs(t-e)/2+Math.min(e,t)}function a(e,t,r,n){e.push([t.clone(),r.clone(),n.clone()])}_.prototype.smooth=function(i){var s,c,l,u,h,p,d,f,v,g,y,b,w,M=new m.Vector3,x=[];s=i.vertices,c=i.faces;var E,S,T,L,R,A,_,P,C,O,I,j,D,k,F=void 0!==(l=i.faceVertexUvs)[0]&&l[0].length>0;if(F)for(var U=0;U<l.length;U++)x.push([]);for(d in function(e,t,n,o){var a,i,s;for(a=0,i=e.length;a<i;a++)n[a]={edges:[]};for(a=0,i=t.length;a<i;a++)r((s=t[a]).a,s.b,e,o,s,n),r(s.b,s.c,e,o,s,n),r(s.c,s.a,e,o,s,n)}(s,c,g=new Array(s.length),y={}),b=[],y){for(S=y[d],T=new m.Vector3,R=3/8,A=1/8,2!=(_=S.faces.length)&&(R=.5,A=0),T.addVectors(S.a,S.b).multiplyScalar(R),M.set(0,0,0),U=0;U<_;U++){for(L=S.faces[U],v=0;v<3&&((E=s[L[e[v]]])===S.a||E===S.b);v++);M.add(E)}M.multiplyScalar(A),T.add(M),S.newEdge=b.length,b.push(T)}for(w=[],d=0,f=s.length;d<f;d++){for(D=s[d],3==(p=(j=g[d].edges).length)?P=3/16:p>3&&(P=3/(8*p)),C=1-p*P,O=P,p<=2&&2==p&&(C=3/4,O=1/8),k=D.clone().multiplyScalar(C),M.set(0,0,0),U=0;U<p;U++)E=(I=j[U]).a!==D?I.a:I.b,M.add(E);M.multiplyScalar(O),k.add(M),w.push(k)}u=w.concat(b);var N,V,B,G,H,X,z,Y=w.length;h=[];var Z=new m.Vector2,Q=new m.Vector2,q=new m.Vector2;for(d=0,f=c.length;d<f;d++)if(n(h,N=t((L=c[d]).a,L.b,y).newEdge+Y,V=t(L.b,L.c,y).newEdge+Y,B=t(L.c,L.a,y).newEdge+Y,L.materialIndex),n(h,L.a,N,B,L.materialIndex),n(h,L.b,V,N,L.materialIndex),n(h,L.c,B,V,L.materialIndex),F)for(U=0;U<l.length;U++)H=(G=l[U][d])[0],X=G[1],z=G[2],Z.set(o(H.x,X.x),o(H.y,X.y)),Q.set(o(X.x,z.x),o(X.y,z.y)),q.set(o(H.x,z.x),o(H.y,z.y)),a(x[U],Z,Q,q),a(x[U],H,Z,q),a(x[U],X,Q,Z),a(x[U],z,q,Q);i.vertices=u,i.faces=h,F&&(i.faceVertexUvs=x)}}();var P=function(e){this.maxEdgeLength=e};function C(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}P.prototype.modify=function(e){for(var t,r=[],n=[],o=this.maxEdgeLength*this.maxEdgeLength,a=0,i=e.faceVertexUvs.length;a<i;a++)n[a]=[];for(a=0,i=e.faces.length;a<i;a++){var s=e.faces[a];if(s instanceof m.Face3){var c=s.a,l=s.b,u=s.c,h=e.vertices[c],p=e.vertices[l],d=e.vertices[u],f=h.distanceToSquared(p),v=p.distanceToSquared(d),g=h.distanceToSquared(d);if(f>o||v>o||g>o){var y=e.vertices.length,b=s.clone(),w=s.clone();if(f>=v&&f>=g){if((M=h.clone()).lerp(p,.5),b.a=c,b.b=y,b.c=u,w.a=y,w.b=l,w.c=u,3===s.vertexNormals.length)(x=s.vertexNormals[0].clone()).lerp(s.vertexNormals[1],.5),b.vertexNormals[1].copy(x),w.vertexNormals[0].copy(x);if(3===s.vertexColors.length)(E=s.vertexColors[0].clone()).lerp(s.vertexColors[1],.5),b.vertexColors[1].copy(E),w.vertexColors[0].copy(E);t=0}else if(v>=f&&v>=g){if((M=p.clone()).lerp(d,.5),b.a=c,b.b=l,b.c=y,w.a=y,w.b=u,w.c=c,3===s.vertexNormals.length)(x=s.vertexNormals[1].clone()).lerp(s.vertexNormals[2],.5),b.vertexNormals[2].copy(x),w.vertexNormals[0].copy(x),w.vertexNormals[1].copy(s.vertexNormals[2]),w.vertexNormals[2].copy(s.vertexNormals[0]);if(3===s.vertexColors.length)(E=s.vertexColors[1].clone()).lerp(s.vertexColors[2],.5),b.vertexColors[2].copy(E),w.vertexColors[0].copy(E),w.vertexColors[1].copy(s.vertexColors[2]),w.vertexColors[2].copy(s.vertexColors[0]);t=1}else{var M,x,E;if((M=h.clone()).lerp(d,.5),b.a=c,b.b=l,b.c=y,w.a=y,w.b=l,w.c=u,3===s.vertexNormals.length)(x=s.vertexNormals[0].clone()).lerp(s.vertexNormals[2],.5),b.vertexNormals[2].copy(x),w.vertexNormals[0].copy(x);if(3===s.vertexColors.length)(E=s.vertexColors[0].clone()).lerp(s.vertexColors[2],.5),b.vertexColors[2].copy(E),w.vertexColors[0].copy(E);t=2}r.push(b,w),e.vertices.push(M);for(var S=0,T=e.faceVertexUvs.length;S<T;S++)if(e.faceVertexUvs[S].length){var L=e.faceVertexUvs[S][a],R=L[0],A=L[1],_=L[2];if(0===t){(O=R.clone()).lerp(A,.5);var P=[R.clone(),O.clone(),_.clone()],C=[O.clone(),A.clone(),_.clone()]}else if(1===t){(O=A.clone()).lerp(_,.5);P=[R.clone(),A.clone(),O.clone()],C=[O.clone(),_.clone(),R.clone()]}else{var O;(O=R.clone()).lerp(_,.5);P=[R.clone(),A.clone(),O.clone()],C=[O.clone(),A.clone(),_.clone()]}n[S].push(P,C)}}else{r.push(s);for(S=0,T=e.faceVertexUvs.length;S<T;S++)n[S].push(e.faceVertexUvs[S][a])}}}e.faces=r,e.faceVertexUvs=n};var O=function e(){var t=e.SkyShader,r=new m.ShaderMaterial({fragmentShader:t.fragmentShader,vertexShader:t.vertexShader,uniforms:m.UniformsUtils.clone(t.uniforms),side:m.BackSide,depthWrite:!1});m.Mesh.call(this,new m.BoxBufferGeometry(1,1,1),r)};O.prototype=Object.create(m.Mesh.prototype),O.SkyShader={uniforms:{luminance:{value:1},turbidity:{value:2},rayleigh:{value:1},mieCoefficient:{value:.005},mieDirectionalG:{value:.8},sunPosition:{value:new m.Vector3},up:{value:new m.Vector3(0,1,0)}},vertexShader:["uniform vec3 sunPosition;","uniform float rayleigh;","uniform float turbidity;","uniform float mieCoefficient;","uniform vec3 up;","varying vec3 vWorldPosition;","varying vec3 vSunDirection;","varying float vSunfade;","varying vec3 vBetaR;","varying vec3 vBetaM;","varying float vSunE;","const float e = 2.71828182845904523536028747135266249775724709369995957;","const float pi = 3.141592653589793238462643383279502884197169;","const vec3 lambda = vec3( 680E-9, 550E-9, 450E-9 );","const vec3 totalRayleigh = vec3( 5.804542996261093E-6, 1.3562911419845635E-5, 3.0265902468824876E-5 );","const float v = 4.0;","const vec3 K = vec3( 0.686, 0.678, 0.666 );","const vec3 MieConst = vec3( 1.8399918514433978E14, 2.7798023919660528E14, 4.0790479543861094E14 );","const float cutoffAngle = 1.6110731556870734;","const float steepness = 1.5;","const float EE = 1000.0;","float sunIntensity( float zenithAngleCos ) {","\tzenithAngleCos = clamp( zenithAngleCos, -1.0, 1.0 );","\treturn EE * max( 0.0, 1.0 - pow( e, -( ( cutoffAngle - acos( zenithAngleCos ) ) / steepness ) ) );","}","vec3 totalMie( float T ) {","\tfloat c = ( 0.2 * T ) * 10E-18;","\treturn 0.434 * c * MieConst;","}","void main() {","\tvec4 worldPosition = modelMatrix * vec4( position, 1.0 );","\tvWorldPosition = worldPosition.xyz;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","\tgl_Position.z = gl_Position.w;","\tvSunDirection = normalize( sunPosition );","\tvSunE = sunIntensity( dot( vSunDirection, up ) );","\tvSunfade = 1.0 - clamp( 1.0 - exp( ( sunPosition.y / 450000.0 ) ), 0.0, 1.0 );","\tfloat rayleighCoefficient = rayleigh - ( 1.0 * ( 1.0 - vSunfade ) );","\tvBetaR = totalRayleigh * rayleighCoefficient;","\tvBetaM = totalMie( turbidity ) * mieCoefficient;","}"].join("\n"),fragmentShader:["varying vec3 vWorldPosition;","varying vec3 vSunDirection;","varying float vSunfade;","varying vec3 vBetaR;","varying vec3 vBetaM;","varying float vSunE;","uniform float luminance;","uniform float mieDirectionalG;","uniform vec3 up;","const vec3 cameraPos = vec3( 0.0, 0.0, 0.0 );","const float pi = 3.141592653589793238462643383279502884197169;","const float n = 1.0003;","const float N = 2.545E25;","const float rayleighZenithLength = 8.4E3;","const float mieZenithLength = 1.25E3;","const float sunAngularDiameterCos = 0.999956676946448443553574619906976478926848692873900859324;","const float THREE_OVER_SIXTEENPI = 0.05968310365946075;","const float ONE_OVER_FOURPI = 0.07957747154594767;","float rayleighPhase( float cosTheta ) {","\treturn THREE_OVER_SIXTEENPI * ( 1.0 + pow( cosTheta, 2.0 ) );","}","float hgPhase( float cosTheta, float g ) {","\tfloat g2 = pow( g, 2.0 );","\tfloat inverse = 1.0 / pow( 1.0 - 2.0 * g * cosTheta + g2, 1.5 );","\treturn ONE_OVER_FOURPI * ( ( 1.0 - g2 ) * inverse );","}","const float A = 0.15;","const float B = 0.50;","const float C = 0.10;","const float D = 0.20;","const float E = 0.02;","const float F = 0.30;","const float whiteScale = 1.0748724675633854;","vec3 Uncharted2Tonemap( vec3 x ) {","\treturn ( ( x * ( A * x + C * B ) + D * E ) / ( x * ( A * x + B ) + D * F ) ) - E / F;","}","void main() {","\tvec3 direction = normalize( vWorldPosition - cameraPos );","\tfloat zenithAngle = acos( max( 0.0, dot( up, direction ) ) );","\tfloat inverse = 1.0 / ( cos( zenithAngle ) + 0.15 * pow( 93.885 - ( ( zenithAngle * 180.0 ) / pi ), -1.253 ) );","\tfloat sR = rayleighZenithLength * inverse;","\tfloat sM = mieZenithLength * inverse;","\tvec3 Fex = exp( -( vBetaR * sR + vBetaM * sM ) );","\tfloat cosTheta = dot( direction, vSunDirection );","\tfloat rPhase = rayleighPhase( cosTheta * 0.5 + 0.5 );","\tvec3 betaRTheta = vBetaR * rPhase;","\tfloat mPhase = hgPhase( cosTheta, mieDirectionalG );","\tvec3 betaMTheta = vBetaM * mPhase;","\tvec3 Lin = pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * ( 1.0 - Fex ), vec3( 1.5 ) );","\tLin *= mix( vec3( 1.0 ), pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * Fex, vec3( 1.0 / 2.0 ) ), clamp( pow( 1.0 - dot( up, vSunDirection ), 5.0 ), 0.0, 1.0 ) );","\tfloat theta = acos( direction.y ); // elevation --\x3e y-axis, [-pi/2, pi/2]","\tfloat phi = atan( direction.z, direction.x ); // azimuth --\x3e x-axis [-pi/2, pi/2]","\tvec2 uv = vec2( phi, theta ) / vec2( 2.0 * pi, pi ) + vec2( 0.5, 0.0 );","\tvec3 L0 = vec3( 0.1 ) * Fex;","\tfloat sundisk = smoothstep( sunAngularDiameterCos, sunAngularDiameterCos + 0.00002, cosTheta );","\tL0 += ( vSunE * 19000.0 * Fex ) * sundisk;","\tvec3 texColor = ( Lin + L0 ) * 0.04 + vec3( 0.0, 0.0003, 0.00075 );","\tvec3 curr = Uncharted2Tonemap( ( log2( 2.0 / pow( luminance, 4.0 ) ) ) * texColor );","\tvec3 color = curr * whiteScale;","\tvec3 retColor = pow( color, vec3( 1.0 / ( 1.2 + ( 1.2 * vSunfade ) ) ) );","\tgl_FragColor = vec4( retColor, 1.0 );","}"].join("\n")};r(119);function I(e){var t=e+"BufferGeometry";return Object(p.forwardRef)((function(e,r){var n=e.args,o=e.children,a=Object(h.a)(e,["args","children"]);return d.a.createElement("mesh",Object(u.a)({ref:r},a),d.a.createElement(t,{attach:"geometry",args:n}),o)}))}I("box"),I("circle"),I("cone"),I("cylinder"),I("sphere"),I("plane"),I("tube"),I("torus"),I("torusKnot"),I("tetrahedron"),I("ring"),I("polyhedron"),I("icosahedron"),I("octahedron"),I("dodecahedron"),I("extrude"),I("lathe"),I("parametric");var j=Object(p.forwardRef)((function(e,t){var r=Object(f.i)(),n=r.camera,o=r.gl,a=r.invalidate,i=Object(p.useMemo)((function(){return new v.a(n,o.domElement)}),[n,o]);return Object(f.g)((function(){return i.update()})),Object(p.useEffect)((function(){return null==i||null==i.addEventListener||i.addEventListener("change",a),function(){return null==i||null==i.removeEventListener?void 0:i.removeEventListener("change",a)}}),[i,a]),d.a.createElement("primitive",Object(u.a)({dispose:null,object:i,ref:t},e))}));L((function(e){return m.DefaultLoadingManager.onStart=function(t,r,n){return e({active:!0,item:t,loaded:r,total:n,progress:r/n*100})},m.DefaultLoadingManager.onLoad=function(){return e({active:!1})},m.DefaultLoadingManager.onError=function(t){return e((function(e){return{errors:[].concat(Object(c.a)(e.errors),[t])}}))},m.DefaultLoadingManager.onProgress=function(t,r,n){return e({item:t,loaded:r,total:n,progress:r/n*100})},{errors:[],active:!1,progress:0,item:"",loaded:0,total:0}}));new m.Vector3,new m.Vector3,new m.Vector3;new m.Matrix4,new m.Ray,new m.Sphere,new m.Vector3;m.MeshPhysicalMaterial,m.MeshStandardMaterial;m.ShaderMaterial}}]);
//# sourceMappingURL=19.9ff49a76.chunk.js.map
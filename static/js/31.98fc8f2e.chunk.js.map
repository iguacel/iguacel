{"version":3,"sources":["data/caaSpain.js","exp/Exp19.js","exp/comp/Canvas.js"],"names":["cas","id","abv","sim","name","x","y","pop","linksId","source","target","Map","width","height","setSelected","setIsOpen","data","refSvg","useRef","radiusScale","scaleSqrt","domain","range","nodes","map","area","deaths","length","useEffect","svg","select","current","simulation","forceSimulation","force","forceLink","d","distance","strength","iterations","forceX","forceY","k","i","n","a","j","b","vx","vy","lx","Math","abs","ly","r","tick","on","rect","selectAll","enter","append","attr","style","text","total","ref","overflow","viewBox","stroke","fill","points","opacity","strokeDasharray","Tip","selected","dates","colors","isOpen","dark","useMeasure","polyfill","ResizeObserver","bounds","language","useContext","LanguageContext","isEnglish","tipAnimation","useSpring","pointerEvents","maxYScale","max","maxIndex","indexOf","maxDate","maxNumber","div","className","position","top","left","transform","zIndex","background","border","maxWidth","boxShadow","display","justifyContent","alignItems","borderBottom","margin","padding","onClick","cursor","marginLeft","xmlns","aria-hidden","strokeWidth","Date","toLocaleString","split","replace","textAlign","fontSize","upd","TooltipCanvas","foreground","xScale","scaleTime","yScaleLinear","scaleLinear","TipCanvasCell","this","center","row","column","cellSize","cell","code","eu","first","ctx","areaGen","y0","curve","curveBasis","context","lineGen","line","beginPath","translate","fillStyle","bg","point","closePath","strokeStyle","main","lineWidth","xAxis","yAxis","legendLines","draw","tickCount","ticks","tickFormat","forEach","moveTo","lineTo","textBaseline","font","fillText","setLineDash","save","rotate","PI","restore","quarantine","Canvas","canvas","update","useState","setData","setDates","isLoaded","setIsLoaded","closeTip","ThemeContext","fetch","then","res","ok","Promise","reject","status","csvParse","format","reduce","acc","arr","ca","cod","key","Object","keys","values","flexDirection","canvasRef","getContext","ratio","window","devicePixelRatio","scale"],"mappings":"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","file":"static/js/31.98fc8f2e.chunk.js","sourcesContent":["export const cas = [\n  {\n    id: \"c01\",\n    abv: \"And.\",\n    sim: \"AN\",\n    name: \"Andalucía\",\n    x: 321,\n    y: 571,\n    pop: 8414240,\n  },\n  {\n    id: \"c02\",\n    abv: \"Ar.\",\n    sim: \"AR\",\n    name: \"Aragón\",\n    x: 575,\n    y: 231,\n    pop: 1319291,\n  },\n  {\n    id: \"c03\",\n    abv: \"Ast.\",\n    sim: \"AS\",\n    name: \"Asturias\",\n    x: 253,\n    y: 71,\n    pop: 1022800,\n  },\n  {\n    id: \"c04\",\n    abv: \"Bal.\",\n    sim: \"IB\",\n    name: \"Illes Balears\",\n    x: 801,\n    y: 400,\n    pop: 1149460,\n  },\n  {\n    id: \"c05\",\n    abv: \"Can.\",\n    sim: \"CN\",\n    name: \"Canarias\",\n    x: 76,\n    y: 816,\n    pop: 2153389,\n  },\n  {\n    id: \"c06\",\n    abv: \"Cantb.\",\n    sim: \"CB\",\n    name: \"Cantabria\",\n    x: 367,\n    y: 71,\n    pop: 581078,\n  },\n  {\n    id: \"c07\",\n    abv: \"C. y L.\",\n    sim: \"CL\",\n    name: \"Castilla y León\",\n    x: 309,\n    y: 211,\n    pop: 2399548,\n  },\n  {\n    id: \"c08\",\n    abv: \"C-L. M.\",\n    sim: \"CM\",\n    name: \"Castilla - La Mancha\",\n    x: 432,\n    y: 400,\n    pop: 2032863,\n  },\n  {\n    id: \"c09\",\n    abv: \"Cat.\",\n    sim: \"CT\",\n    name: \"Cataluña\",\n    x: 727,\n    y: 196,\n    pop: 7675217,\n  },\n  {\n    id: \"c10\",\n    abv: \"Com. V\",\n    sim: \"VC\",\n    name: \"Comunitat Valenciana\",\n    x: 575,\n    y: 400,\n    pop: 5003769,\n  },\n  {\n    id: \"c11\",\n    abv: \"Ext.\",\n    sim: \"EX\",\n    name: \"Extremadura\",\n    x: 225,\n    y: 400,\n    pop: 1067710,\n  },\n  {\n    id: \"c12\",\n    abv: \"Gal.\",\n    sim: \"GA\",\n    name: \"Galicia\",\n    x: 121,\n    y: 119,\n    pop: 2699499,\n  },\n  {\n    id: \"c13\",\n    abv: \"Mad.\",\n    sim: \"MD\",\n    name: \"Madrid\",\n    x: 384,\n    y: 312,\n    pop: 6663394,\n  },\n  {\n    id: \"c14\",\n    abv: \"Mur.\",\n    sim: \"MC\",\n    name: \"Murcia\",\n    x: 536,\n    y: 531,\n    pop: 1493898,\n  },\n  {\n    id: \"c15\",\n    abv: \"Nav.\",\n    sim: \"NC\",\n    name: \"Navarra\",\n    x: 526,\n    y: 126,\n    pop: 654214,\n  },\n  {\n    id: \"c16\",\n    abv: \"P. V.\",\n    sim: \"PV\",\n    name: \"País Vasco\",\n    x: 459,\n    y: 71,\n    pop: 2207776,\n  },\n  {\n    id: \"c17\",\n    abv: \"L.R.\",\n    sim: \"RI\",\n    name: \"La Rioja\",\n    x: 459,\n    y: 167,\n    pop: 316798,\n  },\n  {\n    id: \"c18\",\n    abv: \"Ceu.\",\n    sim: \"CE\",\n    name: \"Ceuta\",\n    x: 266,\n    y: 703,\n    pop: 84777,\n  },\n  {\n    id: \"c19\",\n    abv: \"Mel.\",\n    sim: \"ME\",\n    name: \"Melilla\",\n    x: 438,\n    y: 741,\n    pop: 86487,\n  },\n];\n\nexport const linksId = [\n  {\n    source: \"c01\",\n    target: \"c11\",\n  },\n  {\n    source: \"c01\",\n    target: \"c08\",\n  },\n  {\n    source: \"c01\",\n    target: \"c14\",\n  },\n  {\n    source: \"c02\",\n    target: \"c15\",\n  },\n  {\n    source: \"c02\",\n    target: \"c09\",\n  },\n  {\n    source: \"c02\",\n    target: \"c10\",\n  },\n  {\n    source: \"c02\",\n    target: \"c08\",\n  },\n  {\n    source: \"c02\",\n    target: \"c07\",\n  },\n  {\n    source: \"c02\",\n    target: \"c17\",\n  },\n  {\n    source: \"c03\",\n    target: \"c12\",\n  },\n  {\n    source: \"c03\",\n    target: \"c07\",\n  },\n  {\n    source: \"c03\",\n    target: \"c06\",\n  },\n  {\n    source: \"c06\",\n    target: \"c03\",\n  },\n  {\n    source: \"c06\",\n    target: \"c16\",\n  },\n  {\n    source: \"c06\",\n    target: \"c07\",\n  },\n  {\n    source: \"c07\",\n    target: \"c12\",\n  },\n  {\n    source: \"c07\",\n    target: \"c03\",\n  },\n  {\n    source: \"c07\",\n    target: \"c06\",\n  },\n  {\n    source: \"c07\",\n    target: \"c16\",\n  },\n  {\n    source: \"c07\",\n    target: \"c17\",\n  },\n  {\n    source: \"c07\",\n    target: \"c02\",\n  },\n  {\n    source: \"c07\",\n    target: \"c08\",\n  },\n  {\n    source: \"c07\",\n    target: \"c13\",\n  },\n  {\n    source: \"c07\",\n    target: \"c11\",\n  },\n  {\n    source: \"c08\",\n    target: \"c13\",\n  },\n  {\n    source: \"c08\",\n    target: \"c07\",\n  },\n  {\n    source: \"c08\",\n    target: \"c02\",\n  },\n  {\n    source: \"c08\",\n    target: \"c10\",\n  },\n  {\n    source: \"c08\",\n    target: \"c14\",\n  },\n  {\n    source: \"c08\",\n    target: \"c01\",\n  },\n  {\n    source: \"c08\",\n    target: \"c11\",\n  },\n  {\n    source: \"c09\",\n    target: \"c02\",\n  },\n  {\n    source: \"c09\",\n    target: \"c11\",\n  },\n  {\n    source: \"c10\",\n    target: \"c14\",\n  },\n  {\n    source: \"c10\",\n    target: \"c08\",\n  },\n  {\n    source: \"c10\",\n    target: \"c02\",\n  },\n  {\n    source: \"c10\",\n    target: \"c09\",\n  },\n  {\n    source: \"c11\",\n    target: \"c01\",\n  },\n  {\n    source: \"c11\",\n    target: \"c07\",\n  },\n  {\n    source: \"c11\",\n    target: \"c08\",\n  },\n  {\n    source: \"c11\",\n    target: \"c14\",\n  },\n  {\n    source: \"c12\",\n    target: \"c03\",\n  },\n  {\n    source: \"c12\",\n    target: \"c07\",\n  },\n  {\n    source: \"c13\",\n    target: \"c07\",\n  },\n  {\n    source: \"c13\",\n    target: \"c08\",\n  },\n  {\n    source: \"c13\",\n    target: \"c11\",\n  },\n  {\n    source: \"c14\",\n    target: \"c10\",\n  },\n  {\n    source: \"c14\",\n    target: \"c08\",\n  },\n  {\n    source: \"c14\",\n    target: \"c01\",\n  },\n  {\n    source: \"c15\",\n    target: \"c16\",\n  },\n  {\n    source: \"c15\",\n    target: \"c17\",\n  },\n  {\n    source: \"c15\",\n    target: \"c02\",\n  },\n  {\n    source: \"c16\",\n    target: \"c06\",\n  },\n  {\n    source: \"c16\",\n    target: \"c07\",\n  },\n  {\n    source: \"c16\",\n    target: \"c17\",\n  },\n  {\n    source: \"c16\",\n    target: \"c15\",\n  },\n  {\n    source: \"c17\",\n    target: \"c07\",\n  },\n  {\n    source: \"c17\",\n    target: \"c16\",\n  },\n  {\n    source: \"c17\",\n    target: \"c15\",\n  },\n  {\n    source: \"c17\",\n    target: \"c02\",\n  },\n];\n\n// export const popTotal = 47026208;\n// https://www.ine.es/jaxiT3/Datos.htm?t=2915#!tabs-tabla\n","import React, { useEffect, useState, useRef, useContext } from \"react\";\n// Data\nimport { cas, linksId } from \"../data/caaSpain\";\n// D3\nimport { select } from \"d3-selection\";\nimport { forceX, forceY, forceSimulation, forceLink } from \"d3-force\";\nimport { scaleSqrt, scaleLinear, scaleTime } from \"d3-scale\";\nimport { area, line, curveBasis } from \"d3-shape\";\nimport { csvParse } from \"d3-dsv\";\n// Etc\nimport useMeasure from \"react-use-measure\";\nimport { ResizeObserver } from \"@juggle/resize-observer\";\nimport { animated, useSpring } from \"react-spring\";\nimport ThemeContext from \"../context/ThemeContext\";\nimport LanguageContext from \"../context/LanguageContext\";\n// Comp\nimport Canvas from \"./comp/Canvas\";\n\n// MAP\nconst Map = ({\n  // ignore-prettier\n  width = 900,\n  height = 900,\n  setSelected,\n  setIsOpen,\n  data,\n}) => {\n  const refSvg = useRef();\n\n  const radiusScale = scaleSqrt().domain([0, 10000]).range([5, 310]);\n\n  const nodes = cas.map((x) => {\n    return {\n      ...x,\n      area: radiusScale(data[x.id].deaths[data[x.id].deaths.length - 1]),\n    };\n  });\n\n  useEffect(() => {\n    const svg = select(refSvg.current);\n\n    const collision = () => {\n      const padding = 10;\n      for (let k = 0, iterations = 4, strength = 0.5; k < iterations; ++k) {\n        for (let i = 0, n = nodes.length; i < n; ++i) {\n          for (let a = nodes[i], j = i + 1; j < n; ++j) {\n            let b = nodes[j],\n              x = a.x + a.vx - b.x - b.vx,\n              y = a.y + a.vy - b.y - b.vy,\n              lx = Math.abs(x),\n              ly = Math.abs(y),\n              r = a.area / 2 + b.area / 2 + padding;\n            if (lx < r && ly < r) {\n              if (lx > ly) {\n                lx = (lx - r) * (x < 0 ? -strength : strength);\n                a[\"vx\"] -= lx;\n                b[\"vx\"] += lx;\n              } else {\n                ly = (ly - r) * (y < 0 ? -strength : strength);\n                a[\"vy\"] -= ly;\n                b[\"vy\"] += ly;\n              }\n            }\n          }\n        }\n      }\n    };\n\n    const simulation = forceSimulation(nodes)\n      .force(\n        \"link\",\n        forceLink(linksId)\n          .id((d) => d.id)\n          .distance(0)\n          .strength(0.0025)\n          .iterations(6)\n      )\n      .force(\"x\", forceX((d) => d.x).strength(0.1))\n      .force(\"y\", forceY((d) => d.y).strength(0.1))\n      .force(\"collide\", collision);\n\n    for (let i = 0; i < 120; ++i) {\n      simulation.tick();\n    }\n\n    simulation.on(\"tick\", () => {\n      const rect = svg\n        .selectAll(\"g\")\n        .data(nodes)\n        .enter()\n        .append(\"g\")\n        .attr(\"transform\", (d) => `translate(${d.x}, ${d.y})`);\n\n      // Rect\n      rect\n        .append(\"rect\")\n        .attr(\"width\", (d) => d.area)\n        .attr(\"height\", (d) => d.area)\n        .attr(\"x\", (d) => -d.area / 2)\n        .attr(\"y\", (d) => -d.area / 2)\n        .attr(\"fill\", \"var(--foreground-color)\")\n        // .attr(\"stroke\", \"var(--background-color)\")\n        .style(\"cursor\", \"pointer\");\n\n      rect.on(\"click\", (d) => {\n        setSelected({ ...d, ...data[d.id] });\n        setIsOpen(true);\n      });\n\n      // Text\n      rect\n        .append(\"text\")\n        .style(\"font-size\", `22px`)\n        .style(\"fill\", \"var(--background-color)\")\n        .style(\"pointer-events\", \"none\")\n        .attr(\"text-anchor\", \"middle\")\n        .attr(\"dominant-baseline\", \"middle\")\n        .attr(\"dy\", (d) => {\n          return d.area > 90 ? -15 : \"\";\n        })\n        .text((d) => (d.area > 30 ? d.sim : \"\"));\n\n      rect\n        .append(\"text\")\n        .style(\"font-weight\", `700`)\n        .style(\"font-size\", `26px`)\n        .style(\"pointer-events\", \"none\")\n        .style(\"fill\", \"var(--background-color)\")\n        .style(\"opacity\", \"0.5\")\n        .attr(\"text-anchor\", \"middle\")\n        .attr(\"dy\", 15)\n        .attr(\"dominant-baseline\", \"middle\")\n        .text((d) => {\n          return d.area > 90 ? data[d.id].total : \"\";\n        });\n    });\n  }, [nodes]);\n\n  return (\n    <>\n      <svg\n        ref={refSvg}\n        style={{\n          width: \"100%\",\n          overflow: \"visible\",\n        }}\n        viewBox={`0 0 ${width} ${height}`}\n      >\n        {/* Canarias */}\n        <polyline\n          stroke=\"var(--foreground-color)\"\n          fill=\"none\"\n          points=\"0,745 175,745 175,900\"\n          style={{ opacity: \"0.5\", strokeDasharray: \"4 2\" }}\n        />\n      </svg>\n    </>\n  );\n};\n\nconst Tip = ({ selected, dates, colors, isOpen, setIsOpen, dark }) => {\n  const size = 50;\n\n  const [ref, bounds] = useMeasure({ polyfill: ResizeObserver });\n\n  const { language } = useContext(LanguageContext);\n  const isEnglish = language.isEnglish;\n\n  const tipAnimation = useSpring({\n    opacity: isOpen ? 1 : 0,\n    pointerEvents: isOpen ? \"auto\" : \"none\",\n  });\n\n  // Data\n  const maxYScale = Math.max(...selected.deaths);\n  const maxIndex = selected.deaths.indexOf(maxYScale);\n  const maxDate = dates[maxIndex];\n  const maxNumber = selected.deaths[maxIndex];\n\n  return (\n    <animated.div\n      className=\"tooltip\"\n      style={{\n        ...tipAnimation,\n        position: \"absolute\",\n        top: \"50%\",\n        left: \"50%\",\n        transform: \"translate(-50%, -50%)\",\n        overflow: \"visible\",\n        zIndex: 2,\n        background: \"var(--background-color)\",\n        border: \"1px solid var(--foreground-color)\",\n        width: \"calc(100% - 60px)\",\n        maxWidth: \"800px\",\n        height: \"390px\",\n        boxShadow: dark\n          ? \"5px -5px 3px -3px rgba(0,0,0,0.2)\"\n          : \"5px -5px 3px -3px rgba(255,255,255,0.2)\",\n      }}\n      width={`${size}px`}\n      height={`${size}px`}\n      viewBox={`0 0 ${size} ${size}`}\n    >\n      {/* Header */}\n      <div\n        style={{\n          display: \"flex\",\n          justifyContent: \"center\",\n          alignItems: \"center\",\n          height: \"50px\",\n          borderBottom: \"1px solid var(--foreground-color)\",\n        }}\n      >\n        <p style={{ margin: 0, padding: \"1em\" }} className=\"h4\">\n          {selected?.name}\n        </p>\n        <div\n          onClick={() => setIsOpen(!isOpen)}\n          style={{\n            cursor: \"pointer\",\n            height: \"100%\",\n            marginLeft: \"auto\",\n            width: \"50px\",\n            height: \"50px\",\n            background: \"var(--foreground-color)\",\n            display: \"flex\",\n            justifyContent: \"center\",\n            alignItems: \"center\",\n          }}\n        >\n          <svg\n            xmlns=\"http://www.w3.org/2000/svg\"\n            width={32}\n            height={32}\n            aria-hidden=\"true\"\n          >\n            <path\n              fill=\"var(--background-color)\"\n              strokeWidth=\"1\"\n              stroke=\"var(--background-color)\"\n              d=\"M24 9.4L22.6 8 16 14.6 9.4 8 8 9.4l6.6 6.6L8 22.6 9.4 24l6.6-6.6 6.6 6.6 1.4-1.4-6.6-6.6L24 9.4z\"\n            />\n          </svg>\n        </div>\n      </div>\n      {/* Canvas */}\n      <div\n        ref={ref}\n        className=\"tooltipGraph\"\n        style={{ margin: \"1em\", height: \"230px\" }}\n      >\n        <div\n          className=\"keyCanvas\"\n          style={{\n            display: \"flex\",\n            justifyContent: \"space-between\",\n            alignItems: \"center\",\n          }}\n        >\n          <p style={{ margin: 0, padding: 0 }}>\n            {isEnglish ? \"Quarantine\" : \"Cuarentena\"}\n            <br />\n            {new Date(new Date(\"2020-03-15\"))\n              .toLocaleString(language.id)\n              .split(\" \")[0]\n              .replace(\",\", \"\")}\n          </p>\n\n          <p style={{ textAlign: \"right\" }}>\n            {isEnglish ? \"Deaths:\" : \"Muertes:\"}\n            <br />\n            <strong>{selected.total}</strong>\n          </p>\n        </div>\n\n        <TooltipCanvas\n          dates={dates}\n          width={bounds.width}\n          height={bounds.height}\n          selected={selected}\n          colors={colors}\n          isEnglish={isEnglish}\n          dark={dark}\n          maxYScale={maxYScale}\n          maxIndex={maxIndex}\n          maxDate={maxDate}\n          maxNumber={maxNumber}\n        />\n      </div>\n\n      {/* Notes */}\n      <div className=\"notes\" style={{ margin: \"3em 1em 0 1em\" }}>\n        <p style={{ opacity: \"0.5\", fontSize: \"90%\" }}>\n          {isEnglish ? \"Updated\" : \"Actualizado\"}{\" \"}\n          {new Date(dates.upd)\n            .toLocaleString(language.id)\n            .split(\" \")[0]\n            .replace(\",\", \"\")}\n          .\n        </p>\n      </div>\n    </animated.div>\n  );\n};\n\nconst TooltipCanvas = ({\n  selected,\n  width,\n  height,\n  colors,\n  dark,\n  maxYScale,\n  dates,\n}) => {\n  // color\n  const foreground = dark\n    ? \"RGBA(255, 255, 255, 0.8)\"\n    : \"RGBA(26, 27, 30, 0.6)\";\n\n  // d3\n  const margin = { top: 50, right: 0, left: 50, bottom: 40 };\n\n  const xScale = scaleTime()\n    .domain([dates.dates[0], dates.upd])\n    .range([0, width - margin.right - margin.left]);\n\n  const yScaleLinear = scaleLinear()\n    .domain([0, maxYScale])\n    .range([height - margin.top - margin.bottom, 0]);\n\n  class TipCanvasCell {\n    constructor({ selected }) {\n      this.id = selected.id;\n      this.position = selected.position;\n      this.center = selected.center;\n      this.row = selected.row;\n      this.column = selected.column;\n      this.cellSize = selected.cellSize;\n      this.cell = selected.cell;\n      this.name = selected.name;\n      this.code = selected.code;\n      this.eu = selected.eu;\n      this.first = dates.dates[0];\n      this.deaths = selected.deaths;\n    }\n\n    draw(ctx) {\n      const areaGen = area()\n        .y0(height - margin.top - margin.bottom)\n        .curve(curveBasis)\n        .context(ctx);\n\n      const lineGen = line().context(ctx);\n\n      ctx.beginPath();\n\n      ctx.translate(margin.left, margin.top);\n\n      ctx.fillStyle = colors.bg;\n\n      areaGen(\n        this.deaths.map((point, i) => {\n          return [xScale(dates.dates[i]), yScaleLinear(point)];\n        })\n      );\n\n      ctx.closePath();\n      ctx.fill();\n\n      ctx.strokeStyle = colors.main;\n      ctx.lineWidth = 3;\n      ctx.beginPath();\n\n      lineGen(\n        this.deaths.map((point, i) => {\n          return [xScale(dates.dates[i]), yScaleLinear(point)];\n        })\n      );\n\n      ctx.stroke();\n\n      ctx.lineWidth = 0.5;\n      xAxis(ctx);\n      yAxis(ctx);\n      legendLines(ctx);\n    }\n\n    update(ctx) {\n      this.draw(ctx);\n    }\n\n    animate(ctx) {\n      this.draw(ctx);\n    }\n  }\n\n  const draw = (canvas, ctx) => {\n    new TipCanvasCell({\n      selected,\n    }).update(ctx);\n  };\n\n  const xAxis = (ctx) => {\n    let tickCount = width / 150;\n    let tickSize = 6;\n    let ticks = xScale.ticks(tickCount);\n    let tickFormat = xScale.tickFormat();\n    let tickPadding = 7;\n\n    ctx.beginPath();\n    ticks.forEach(function (d) {\n      ctx.moveTo(xScale(d), height - margin.top - margin.bottom);\n      ctx.lineTo(xScale(d), height - margin.top - margin.bottom + tickSize);\n    });\n    ctx.strokeStyle = \"gray\";\n    ctx.fillStyle = \"gray\";\n    ctx.stroke();\n\n    ctx.textAlign = \"center\";\n    ctx.textBaseline = \"top\";\n    ctx.font = \"12px Inter\";\n\n    ticks.forEach(function (d) {\n      ctx.fillText(\n        tickFormat(d),\n        xScale(d),\n        height - margin.top - margin.bottom + tickSize + tickPadding\n      );\n    });\n  };\n\n  const yAxis = (ctx) => {\n    let tickCount = 3;\n    let ticks = yScaleLinear.ticks(tickCount);\n    let tickFormat = yScaleLinear.tickFormat(tickCount);\n\n    ctx.beginPath();\n    ticks.forEach(function (d) {\n      ctx.moveTo(-margin.left, yScaleLinear(d));\n      ctx.lineTo(width - margin.left - margin.right, yScaleLinear(d));\n    });\n\n    ctx.fillStyle = \"gray\";\n    ctx.strokeStyle = foreground;\n    ctx.setLineDash([2, 1]);\n\n    ctx.stroke();\n    ctx.setLineDash([]);\n\n    ctx.textAlign = \"left\";\n    ctx.textBaseline = \"left\";\n    ctx.font = \"12px Inter\";\n    ticks.forEach(function (d) {\n      ctx.fillText(tickFormat(d), -margin.left, yScaleLinear(d) - 20);\n    });\n\n    ctx.save();\n    ctx.rotate(-Math.PI / 2);\n    ctx.textAlign = \"right\";\n    ctx.textBaseline = \"top\";\n    ctx.restore();\n  };\n\n  const legendLines = (ctx) => {\n    const legendTop = 10;\n\n    ctx.strokeStyle = foreground;\n\n    let quarantine = new Date(\"2020-03-15\");\n\n    ctx.beginPath();\n    ctx.moveTo(-margin.left, -margin.top + legendTop);\n    ctx.lineTo(xScale(quarantine), -margin.top + legendTop);\n    ctx.lineTo(xScale(quarantine), height - margin.top - margin.bottom);\n    ctx.stroke();\n  };\n\n  return (\n    <Canvas\n      style={{\n        overflow: \"visible\",\n      }}\n      draw={(canvas, ctx) => {\n        draw(canvas, ctx);\n      }}\n      width={width}\n      height={height}\n    />\n  );\n};\n\n// MAIN\nexport default () => {\n  const [data, setData] = useState(null);\n  const [dates, setDates] = useState(null);\n  const [isLoaded, setIsLoaded] = useState(false);\n  const [selected, setSelected] = useState(null);\n  const [isOpen, setIsOpen] = useState(false);\n\n  const closeTip = () => {\n    setSelected(null);\n    isOpen(false);\n  };\n\n  const { dark } = useContext(ThemeContext);\n  const { language } = useContext(LanguageContext);\n\n  // DATA\n  // Force\n\n  useEffect(() => {\n    const fetchData = () => {\n      const uri =\n        \"https://raw.githubusercontent.com/datadista/datasets/master/COVID%2019/ccaa_covid19_fallecidos.csv\";\n      fetch(uri)\n        .then((res) => (res.ok ? res.text() : Promise.reject(res.status)))\n        .then((text) => csvParse(text))\n        .then((data) => {\n          const format = data.reduce((acc, x, i, arr) => {\n            const ca = x[\"CCAA\"];\n            const cod = x[\"cod_ine\"];\n            const key = `c${cod}`;\n            // delete\n            delete x[\"CCAA\"];\n            delete x[\"cod_ine\"];\n            // save dates\n            if (i === 0) {\n              const dates = [...Object.keys(x)].map((x) => new Date(x));\n              setDates({ dates, upd: dates[dates.length - 1] });\n            }\n            // array\n            const deaths = [...Object.values(x)].map((x) => +x);\n\n            acc[key] = {\n              key,\n              cod,\n              ca,\n              deaths,\n              total: deaths[deaths.length - 1],\n            };\n            return acc;\n          }, {});\n          // save data\n          setData(format);\n          setIsLoaded(true);\n        });\n    };\n\n    fetchData();\n  }, []);\n\n  // Colors\n  const colors = {\n    bg: dark ? \"RGBA(234, 234, 234, 0.20)\" : \"RGBA(26, 27, 30, 0.10)\",\n    main: dark ? \"RGBA(234, 234, 234, 1.00)\" : \"RGBA(26, 27, 30, 1.00)\",\n  };\n\n  return (\n    <div\n      style={{\n        width: \"100%\",\n        maxWidth: \"600px\",\n        margin: \"0 auto\",\n        height: \"100vh\",\n        display: \"flex\",\n        justifyContent: \"center\",\n        alignItems: \"center\",\n        flexDirection: \"column\",\n      }}\n    >\n      {isLoaded && data && dates && (\n        <Map\n          data={data}\n          closeTip={closeTip}\n          setSelected={setSelected}\n          setIsOpen={setIsOpen}\n          language={language}\n        />\n      )}\n\n      {isLoaded && selected && dates && (\n        <Tip\n          dates={dates}\n          selected={selected}\n          closeTip={closeTip}\n          colors={colors}\n          isOpen={isOpen}\n          setIsOpen={setIsOpen}\n          dark={dark}\n        />\n      )}\n    </div>\n  );\n};\n","import React, { useRef, useEffect } from \"react\";\n\nexport default ({ width, height, draw, border }) => {\n  let canvasRef = useRef();\n\n  const scale = (canvas, ctx) => {\n    const ratio = window.devicePixelRatio || 1;\n\n    canvas.width = width * ratio;\n    canvas.height = height * ratio;\n\n    canvas.style.width = `${width}px`;\n    canvas.style.height = `${height}px`;\n\n    ctx.scale(ratio, ratio);\n  };\n\n  useEffect(() => {\n    const canvas = canvasRef.current;\n    const ctx = canvas.getContext(\"2d\");\n    scale(canvas, ctx);\n    draw(canvas, ctx);\n  });\n\n  return (\n    <canvas\n      style={{ border: border ? \"1px solid white\" : \"\" }}\n      ref={canvasRef}\n      width={width}\n      height={height}\n    />\n  );\n};\n"],"sourceRoot":""}
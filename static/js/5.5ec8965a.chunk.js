(this["webpackJsonpraster-react-canvas2"]=this["webpackJsonpraster-react-canvas2"]||[]).push([[5],{105:function(t,e,r){"use strict";r.d(e,"b",(function(){return a})),r.d(e,"a",(function(){return i}));var n=r(72),a=function(t,e){void 0===e&&console.warn('THREE.OrbitControls: The second parameter "domElement" is now mandatory.'),e===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.object=t,this.domElement=e,this.enabled=!0,this.target=new n.Vector3,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!1,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={LEFT:n.MOUSE.ROTATE,MIDDLE:n.MOUSE.DOLLY,RIGHT:n.MOUSE.PAN},this.touches={ONE:n.TOUCH.ROTATE,TWO:n.TOUCH.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=function(){return l.phi},this.getAzimuthalAngle=function(){return l.theta},this.saveState=function(){r.target0.copy(r.target),r.position0.copy(r.object.position),r.zoom0=r.object.zoom},this.reset=function(){r.target.copy(r.target0),r.object.position.copy(r.position0),r.object.zoom=r.zoom0,r.object.updateProjectionMatrix(),r.dispatchEvent(a),r.update(),u=s.NONE},this.update=function(){var e=new n.Vector3,i=(new n.Quaternion).setFromUnitVectors(t.up,new n.Vector3(0,1,0)),o=i.clone().inverse(),v=new n.Vector3,m=new n.Quaternion;return function(){var t=r.object.position;return e.copy(t).sub(r.target),e.applyQuaternion(i),l.setFromVector3(e),r.autoRotate&&u===s.NONE&&T(2*Math.PI/60/60*r.autoRotateSpeed),r.enableDamping?(l.theta+=f.theta*r.dampingFactor,l.phi+=f.phi*r.dampingFactor):(l.theta+=f.theta,l.phi+=f.phi),l.theta=Math.max(r.minAzimuthAngle,Math.min(r.maxAzimuthAngle,l.theta)),l.phi=Math.max(r.minPolarAngle,Math.min(r.maxPolarAngle,l.phi)),l.makeSafe(),l.radius*=h,l.radius=Math.max(r.minDistance,Math.min(r.maxDistance,l.radius)),!0===r.enableDamping?r.target.addScaledVector(d,r.dampingFactor):r.target.add(d),e.setFromSpherical(l),e.applyQuaternion(o),t.copy(r.target).add(e),r.object.lookAt(r.target),!0===r.enableDamping?(f.theta*=1-r.dampingFactor,f.phi*=1-r.dampingFactor,d.multiplyScalar(1-r.dampingFactor)):(f.set(0,0,0),d.set(0,0,0)),h=1,!!(p||v.distanceToSquared(r.object.position)>c||8*(1-m.dot(r.object.quaternion))>c)&&(r.dispatchEvent(a),v.copy(r.object.position),m.copy(r.object.quaternion),p=!1,!0)}}(),this.dispose=function(){r.domElement.removeEventListener("contextmenu",Z,!1),r.domElement.removeEventListener("mousedown",R,!1),r.domElement.removeEventListener("wheel",N,!1),r.domElement.removeEventListener("touchstart",H,!1),r.domElement.removeEventListener("touchend",X,!1),r.domElement.removeEventListener("touchmove",Y,!1),document.removeEventListener("mousemove",j,!1),document.removeEventListener("mouseup",V,!1),r.domElement.removeEventListener("keydown",W,!1)};var r=this,a={type:"change"},i={type:"start"},o={type:"end"},s={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},u=s.NONE,c=1e-6,l=new n.Spherical,f=new n.Spherical,h=1,d=new n.Vector3,p=!1,v=new n.Vector2,m=new n.Vector2,g=new n.Vector2,y=new n.Vector2,b=new n.Vector2,S=new n.Vector2,x=new n.Vector2,U=new n.Vector2,w=new n.Vector2;function _(){return Math.pow(.95,r.zoomSpeed)}function T(t){f.theta-=t}function M(t){f.phi-=t}var k=function(){var t=new n.Vector3;return function(e,r){t.setFromMatrixColumn(r,0),t.multiplyScalar(-e),d.add(t)}}(),C=function(){var t=new n.Vector3;return function(e,n){!0===r.screenSpacePanning?t.setFromMatrixColumn(n,1):(t.setFromMatrixColumn(n,0),t.crossVectors(r.object.up,t)),t.multiplyScalar(e),d.add(t)}}(),F=function(){var t=new n.Vector3;return function(e,n){var a=r.domElement;if(r.object.isPerspectiveCamera){var i=r.object.position;t.copy(i).sub(r.target);var o=t.length();o*=Math.tan(r.object.fov/2*Math.PI/180),k(2*e*o/a.clientHeight,r.object.matrix),C(2*n*o/a.clientHeight,r.object.matrix)}else r.object.isOrthographicCamera?(k(e*(r.object.right-r.object.left)/r.object.zoom/a.clientWidth,r.object.matrix),C(n*(r.object.top-r.object.bottom)/r.object.zoom/a.clientHeight,r.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),r.enablePan=!1)}}();function O(t){r.object.isPerspectiveCamera?h/=t:r.object.isOrthographicCamera?(r.object.zoom=Math.max(r.minZoom,Math.min(r.maxZoom,r.object.zoom*t)),r.object.updateProjectionMatrix(),p=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),r.enableZoom=!1)}function A(t){r.object.isPerspectiveCamera?h*=t:r.object.isOrthographicCamera?(r.object.zoom=Math.max(r.minZoom,Math.min(r.maxZoom,r.object.zoom/t)),r.object.updateProjectionMatrix(),p=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),r.enableZoom=!1)}function D(t){v.set(t.clientX,t.clientY)}function P(t){y.set(t.clientX,t.clientY)}function E(t){if(1==t.touches.length)v.set(t.touches[0].pageX,t.touches[0].pageY);else{var e=.5*(t.touches[0].pageX+t.touches[1].pageX),r=.5*(t.touches[0].pageY+t.touches[1].pageY);v.set(e,r)}}function I(t){if(1==t.touches.length)y.set(t.touches[0].pageX,t.touches[0].pageY);else{var e=.5*(t.touches[0].pageX+t.touches[1].pageX),r=.5*(t.touches[0].pageY+t.touches[1].pageY);y.set(e,r)}}function B(t){var e=t.touches[0].pageX-t.touches[1].pageX,r=t.touches[0].pageY-t.touches[1].pageY,n=Math.sqrt(e*e+r*r);x.set(0,n)}function L(t){if(1==t.touches.length)m.set(t.touches[0].pageX,t.touches[0].pageY);else{var e=.5*(t.touches[0].pageX+t.touches[1].pageX),n=.5*(t.touches[0].pageY+t.touches[1].pageY);m.set(e,n)}g.subVectors(m,v).multiplyScalar(r.rotateSpeed);var a=r.domElement;T(2*Math.PI*g.x/a.clientHeight),M(2*Math.PI*g.y/a.clientHeight),v.copy(m)}function G(t){if(1==t.touches.length)b.set(t.touches[0].pageX,t.touches[0].pageY);else{var e=.5*(t.touches[0].pageX+t.touches[1].pageX),n=.5*(t.touches[0].pageY+t.touches[1].pageY);b.set(e,n)}S.subVectors(b,y).multiplyScalar(r.panSpeed),F(S.x,S.y),y.copy(b)}function z(t){var e=t.touches[0].pageX-t.touches[1].pageX,n=t.touches[0].pageY-t.touches[1].pageY,a=Math.sqrt(e*e+n*n);U.set(0,a),w.set(0,Math.pow(U.y/x.y,r.zoomSpeed)),O(w.y),x.copy(U)}function R(t){if(!1!==r.enabled){var e;switch(t.preventDefault(),r.domElement.focus?r.domElement.focus():window.focus(),t.button){case 0:e=r.mouseButtons.LEFT;break;case 1:e=r.mouseButtons.MIDDLE;break;case 2:e=r.mouseButtons.RIGHT;break;default:e=-1}switch(e){case n.MOUSE.DOLLY:if(!1===r.enableZoom)return;!function(t){x.set(t.clientX,t.clientY)}(t),u=s.DOLLY;break;case n.MOUSE.ROTATE:if(t.ctrlKey||t.metaKey||t.shiftKey){if(!1===r.enablePan)return;P(t),u=s.PAN}else{if(!1===r.enableRotate)return;D(t),u=s.ROTATE}break;case n.MOUSE.PAN:if(t.ctrlKey||t.metaKey||t.shiftKey){if(!1===r.enableRotate)return;D(t),u=s.ROTATE}else{if(!1===r.enablePan)return;P(t),u=s.PAN}break;default:u=s.NONE}u!==s.NONE&&(document.addEventListener("mousemove",j,!1),document.addEventListener("mouseup",V,!1),r.dispatchEvent(i))}}function j(t){if(!1!==r.enabled)switch(t.preventDefault(),u){case s.ROTATE:if(!1===r.enableRotate)return;!function(t){m.set(t.clientX,t.clientY),g.subVectors(m,v).multiplyScalar(r.rotateSpeed);var e=r.domElement;T(2*Math.PI*g.x/e.clientHeight),M(2*Math.PI*g.y/e.clientHeight),v.copy(m),r.update()}(t);break;case s.DOLLY:if(!1===r.enableZoom)return;!function(t){U.set(t.clientX,t.clientY),w.subVectors(U,x),w.y>0?O(_()):w.y<0&&A(_()),x.copy(U),r.update()}(t);break;case s.PAN:if(!1===r.enablePan)return;!function(t){b.set(t.clientX,t.clientY),S.subVectors(b,y).multiplyScalar(r.panSpeed),F(S.x,S.y),y.copy(b),r.update()}(t)}}function V(t){!1!==r.enabled&&(document.removeEventListener("mousemove",j,!1),document.removeEventListener("mouseup",V,!1),r.dispatchEvent(o),u=s.NONE)}function N(t){!1===r.enabled||!1===r.enableZoom||u!==s.NONE&&u!==s.ROTATE||(t.preventDefault(),t.stopPropagation(),r.dispatchEvent(i),function(t){t.deltaY<0?A(_()):t.deltaY>0&&O(_()),r.update()}(t),r.dispatchEvent(o))}function W(t){!1!==r.enabled&&!1!==r.enableKeys&&!1!==r.enablePan&&function(t){var e=!1;switch(t.keyCode){case r.keys.UP:F(0,r.keyPanSpeed),e=!0;break;case r.keys.BOTTOM:F(0,-r.keyPanSpeed),e=!0;break;case r.keys.LEFT:F(r.keyPanSpeed,0),e=!0;break;case r.keys.RIGHT:F(-r.keyPanSpeed,0),e=!0}e&&(t.preventDefault(),r.update())}(t)}function H(t){if(!1!==r.enabled){switch(t.preventDefault(),t.touches.length){case 1:switch(r.touches.ONE){case n.TOUCH.ROTATE:if(!1===r.enableRotate)return;E(t),u=s.TOUCH_ROTATE;break;case n.TOUCH.PAN:if(!1===r.enablePan)return;I(t),u=s.TOUCH_PAN;break;default:u=s.NONE}break;case 2:switch(r.touches.TWO){case n.TOUCH.DOLLY_PAN:if(!1===r.enableZoom&&!1===r.enablePan)return;!function(t){r.enableZoom&&B(t),r.enablePan&&I(t)}(t),u=s.TOUCH_DOLLY_PAN;break;case n.TOUCH.DOLLY_ROTATE:if(!1===r.enableZoom&&!1===r.enableRotate)return;!function(t){r.enableZoom&&B(t),r.enableRotate&&E(t)}(t),u=s.TOUCH_DOLLY_ROTATE;break;default:u=s.NONE}break;default:u=s.NONE}u!==s.NONE&&r.dispatchEvent(i)}}function Y(t){if(!1!==r.enabled)switch(t.preventDefault(),t.stopPropagation(),u){case s.TOUCH_ROTATE:if(!1===r.enableRotate)return;L(t),r.update();break;case s.TOUCH_PAN:if(!1===r.enablePan)return;G(t),r.update();break;case s.TOUCH_DOLLY_PAN:if(!1===r.enableZoom&&!1===r.enablePan)return;!function(t){r.enableZoom&&z(t),r.enablePan&&G(t)}(t),r.update();break;case s.TOUCH_DOLLY_ROTATE:if(!1===r.enableZoom&&!1===r.enableRotate)return;!function(t){r.enableZoom&&z(t),r.enableRotate&&L(t)}(t),r.update();break;default:u=s.NONE}}function X(t){!1!==r.enabled&&(r.dispatchEvent(o),u=s.NONE)}function Z(t){!1!==r.enabled&&t.preventDefault()}r.domElement.addEventListener("contextmenu",Z,!1),r.domElement.addEventListener("mousedown",R,!1),r.domElement.addEventListener("wheel",N,!1),r.domElement.addEventListener("touchstart",H,!1),r.domElement.addEventListener("touchend",X,!1),r.domElement.addEventListener("touchmove",Y,!1),r.domElement.addEventListener("keydown",W,!1),-1===r.domElement.tabIndex&&(r.domElement.tabIndex=0),this.update()};a.prototype=Object.create(n.EventDispatcher.prototype),a.prototype.constructor=a;var i=function(t,e){a.call(this,t,e),this.mouseButtons.LEFT=n.MOUSE.PAN,this.mouseButtons.RIGHT=n.MOUSE.ROTATE,this.touches.ONE=n.TOUCH.PAN,this.touches.TWO=n.TOUCH.DOLLY_ROTATE};i.prototype=Object.create(n.EventDispatcher.prototype),i.prototype.constructor=i},109:function(t,e,r){"use strict";r.d(e,"a",(function(){return u}));var n=r(72),a=r(94),i=r(84),o=function(t,e){n.Mesh.call(this),this.type="LineSegments2",this.geometry=void 0!==t?t:new a.a,this.material=void 0!==e?e:new i.a({color:16777215*Math.random()})};o.prototype=Object.assign(Object.create(n.Mesh.prototype),{constructor:o,isLineSegments2:!0,computeLineDistances:function(){var t=new n.Vector3,e=new n.Vector3;return function(){for(var r=this.geometry,a=r.attributes.instanceStart,i=r.attributes.instanceEnd,o=new Float32Array(2*a.data.count),s=0,u=0,c=a.data.count;s<c;s++,u+=2)t.fromBufferAttribute(a,s),e.fromBufferAttribute(i,s),o[u]=0===u?0:o[u-1],o[u+1]=o[u]+t.distanceTo(e);var l=new n.InstancedInterleavedBuffer(o,2,1);return r.setAttribute("instanceDistanceStart",new n.InterleavedBufferAttribute(l,1,0)),r.setAttribute("instanceDistanceEnd",new n.InterleavedBufferAttribute(l,1,1)),this}}(),raycast:function(){var t=new n.Vector4,e=new n.Vector4,r=new n.Vector4,a=new n.Vector3,i=new n.Matrix4,o=new n.Line3,s=new n.Vector3;return function(u,c){null===u.camera&&console.error('LineSegments2: "Raycaster.camera" needs to be set in order to raycast against LineSegments2.');var l=u.ray,f=u.camera,h=f.projectionMatrix,d=this.geometry,p=this.material,v=p.resolution,m=p.linewidth,g=d.attributes.instanceStart,y=d.attributes.instanceEnd;l.at(1,r),r.w=1,r.applyMatrix4(f.matrixWorldInverse),r.applyMatrix4(h),r.multiplyScalar(1/r.w),r.x*=v.x/2,r.y*=v.y/2,r.z=0,a.copy(r);var b=this.matrixWorld;i.multiplyMatrices(f.matrixWorldInverse,b);for(var S=0,x=g.count;S<x;S++){t.fromBufferAttribute(g,S),e.fromBufferAttribute(y,S),t.w=1,e.w=1,t.applyMatrix4(i),e.applyMatrix4(i),t.applyMatrix4(h),e.applyMatrix4(h),t.multiplyScalar(1/t.w),e.multiplyScalar(1/e.w);var U=t.z<-1&&e.z<-1,w=t.z>1&&e.z>1;if(!U&&!w){t.x*=v.x/2,t.y*=v.y/2,e.x*=v.x/2,e.y*=v.y/2,o.start.copy(t),o.start.z=0,o.end.copy(e),o.end.z=0;var _=o.closestPointToPointParameter(a,!0);o.at(_,s);var T=n.MathUtils.lerp(t.z,e.z,_),M=T>=-1&&T<=1,k=a.distanceTo(s)<.5*m;if(M&&k){o.start.fromBufferAttribute(g,S),o.end.fromBufferAttribute(y,S),o.start.applyMatrix4(b),o.end.applyMatrix4(b);var C=new n.Vector3,F=new n.Vector3;l.distanceSqToSegment(o.start,o.end,F,C),c.push({point:F,pointOnLine:C,distance:l.origin.distanceTo(F),object:this,face:null,faceIndex:S,uv:null,uv2:null})}}}}}()});var s=r(87),u=function(t,e){o.call(this),this.type="Line2",this.geometry=void 0!==t?t:new s.a,this.material=void 0!==e?e:new i.a({color:16777215*Math.random()})};u.prototype=Object.assign(Object.create(o.prototype),{constructor:u,isLine2:!0})},141:function(t,e,r){"use strict";function n(){return(n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t}).apply(this,arguments)}r.d(e,"a",(function(){return n}))},142:function(t,e,r){"use strict";function n(t,e){if(null==t)return{};var r,n,a={},i=Object.keys(t);for(n=0;n<i.length;n++)r=i[n],e.indexOf(r)>=0||(a[r]=t[r]);return a}r.d(e,"a",(function(){return n}))},143:function(t,e,r){!function(t,e,r,n){"use strict";var a,i=r.defineWorkerModule({name:"Typr Font Parser",dependencies:[function(){var t=self,e={parse:function(t){var r=e._bin,n=new Uint8Array(t);if("ttcf"==r.readASCII(n,0,4)){var a=4;r.readUshort(n,a),a+=2,r.readUshort(n,a),a+=2;var i=r.readUint(n,a);a+=4;for(var o=[],s=0;s<i;s++){var u=r.readUint(n,a);a+=4,o.push(e._readFont(n,u))}return o}return[e._readFont(n,0)]},_readFont:function(t,r){var n=e._bin,a=r;n.readFixed(t,r),r+=4;var i=n.readUshort(t,r);r+=2,n.readUshort(t,r),r+=2,n.readUshort(t,r),r+=2,n.readUshort(t,r),r+=2;for(var o=["cmap","head","hhea","maxp","hmtx","name","OS/2","post","loca","glyf","kern","CFF ","GPOS","GSUB","SVG "],s={_data:t,_offset:a},u={},c=0;c<i;c++){var l=n.readASCII(t,r,4);r+=4,n.readUint(t,r),r+=4;var f=n.readUint(t,r);r+=4;var h=n.readUint(t,r);r+=4,u[l]={offset:f,length:h}}for(c=0;c<o.length;c++){var d=o[c];u[d]&&(s[d.trim()]=e[d.trim()].parse(t,u[d].offset,u[d].length,s))}return s},_tabOffset:function(t,r,n){for(var a=e._bin,i=a.readUshort(t,n+4),o=n+12,s=0;s<i;s++){var u=a.readASCII(t,o,4);o+=4,a.readUint(t,o),o+=4;var c=a.readUint(t,o);if(o+=4,a.readUint(t,o),o+=4,u==r)return c}return 0}};return e._bin={readFixed:function(t,e){return(t[e]<<8|t[e+1])+(t[e+2]<<8|t[e+3])/65540},readF2dot14:function(t,r){return e._bin.readShort(t,r)/16384},readInt:function(t,r){var n=e._bin.t.uint8;return n[0]=t[r+3],n[1]=t[r+2],n[2]=t[r+1],n[3]=t[r],e._bin.t.int32[0]},readInt8:function(t,r){return e._bin.t.uint8[0]=t[r],e._bin.t.int8[0]},readShort:function(t,r){var n=e._bin.t.uint8;return n[1]=t[r],n[0]=t[r+1],e._bin.t.int16[0]},readUshort:function(t,e){return t[e]<<8|t[e+1]},readUshorts:function(t,r,n){for(var a=[],i=0;i<n;i++)a.push(e._bin.readUshort(t,r+2*i));return a},readUint:function(t,r){var n=e._bin.t.uint8;return n[3]=t[r],n[2]=t[r+1],n[1]=t[r+2],n[0]=t[r+3],e._bin.t.uint32[0]},readUint64:function(t,r){return 4294967296*e._bin.readUint(t,r)+e._bin.readUint(t,r+4)},readASCII:function(t,e,r){for(var n="",a=0;a<r;a++)n+=String.fromCharCode(t[e+a]);return n},readUnicode:function(t,e,r){for(var n="",a=0;a<r;a++){var i=t[e++]<<8|t[e++];n+=String.fromCharCode(i)}return n},_tdec:t.TextDecoder?new t.TextDecoder:null,readUTF8:function(t,r,n){var a=e._bin._tdec;return a&&0==r&&n==t.length?a.decode(t):e._bin.readASCII(t,r,n)},readBytes:function(t,e,r){for(var n=[],a=0;a<r;a++)n.push(t[e+a]);return n},readASCIIArray:function(t,e,r){for(var n=[],a=0;a<r;a++)n.push(String.fromCharCode(t[e+a]));return n}},e._bin.t={buff:new ArrayBuffer(8)},e._bin.t.int8=new Int8Array(e._bin.t.buff),e._bin.t.uint8=new Uint8Array(e._bin.t.buff),e._bin.t.int16=new Int16Array(e._bin.t.buff),e._bin.t.uint16=new Uint16Array(e._bin.t.buff),e._bin.t.int32=new Int32Array(e._bin.t.buff),e._bin.t.uint32=new Uint32Array(e._bin.t.buff),e._lctf={},e._lctf.parse=function(t,r,n,a,i){var o=e._bin,s={},u=r;o.readFixed(t,r),r+=4;var c=o.readUshort(t,r);r+=2;var l=o.readUshort(t,r);r+=2;var f=o.readUshort(t,r);return r+=2,s.scriptList=e._lctf.readScriptList(t,u+c),s.featureList=e._lctf.readFeatureList(t,u+l),s.lookupList=e._lctf.readLookupList(t,u+f,i),s},e._lctf.readLookupList=function(t,r,n){var a=e._bin,i=r,o=[],s=a.readUshort(t,r);r+=2;for(var u=0;u<s;u++){var c=a.readUshort(t,r);r+=2;var l=e._lctf.readLookupTable(t,i+c,n);o.push(l)}return o},e._lctf.readLookupTable=function(t,r,n){var a=e._bin,i=r,o={tabs:[]};o.ltype=a.readUshort(t,r),r+=2,o.flag=a.readUshort(t,r),r+=2;var s=a.readUshort(t,r);r+=2;for(var u=0;u<s;u++){var c=a.readUshort(t,r);r+=2;var l=n(t,o.ltype,i+c);o.tabs.push(l)}return o},e._lctf.numOfOnes=function(t){for(var e=0,r=0;r<32;r++)0!=(t>>>r&1)&&e++;return e},e._lctf.readClassDef=function(t,r){var n=e._bin,a=[],i=n.readUshort(t,r);if(r+=2,1==i){var o=n.readUshort(t,r);r+=2;var s=n.readUshort(t,r);r+=2;for(var u=0;u<s;u++)a.push(o+u),a.push(o+u),a.push(n.readUshort(t,r)),r+=2}if(2==i){var c=n.readUshort(t,r);for(r+=2,u=0;u<c;u++)a.push(n.readUshort(t,r)),r+=2,a.push(n.readUshort(t,r)),r+=2,a.push(n.readUshort(t,r)),r+=2}return a},e._lctf.getInterval=function(t,e){for(var r=0;r<t.length;r+=3){var n=t[r],a=t[r+1];if(t[r+2],n<=e&&e<=a)return r}return-1},e._lctf.readCoverage=function(t,r){var n=e._bin,a={};a.fmt=n.readUshort(t,r),r+=2;var i=n.readUshort(t,r);return r+=2,1==a.fmt&&(a.tab=n.readUshorts(t,r,i)),2==a.fmt&&(a.tab=n.readUshorts(t,r,3*i)),a},e._lctf.coverageIndex=function(t,r){var n=t.tab;if(1==t.fmt)return n.indexOf(r);if(2==t.fmt){var a=e._lctf.getInterval(n,r);if(-1!=a)return n[a+2]+(r-n[a])}return-1},e._lctf.readFeatureList=function(t,r){var n=e._bin,a=r,i=[],o=n.readUshort(t,r);r+=2;for(var s=0;s<o;s++){var u=n.readASCII(t,r,4);r+=4;var c=n.readUshort(t,r);r+=2,i.push({tag:u.trim(),tab:e._lctf.readFeatureTable(t,a+c)})}return i},e._lctf.readFeatureTable=function(t,r){var n=e._bin;n.readUshort(t,r),r+=2;var a=n.readUshort(t,r);r+=2;for(var i=[],o=0;o<a;o++)i.push(n.readUshort(t,r+2*o));return i},e._lctf.readScriptList=function(t,r){var n=e._bin,a=r,i={},o=n.readUshort(t,r);r+=2;for(var s=0;s<o;s++){var u=n.readASCII(t,r,4);r+=4;var c=n.readUshort(t,r);r+=2,i[u.trim()]=e._lctf.readScriptTable(t,a+c)}return i},e._lctf.readScriptTable=function(t,r){var n=e._bin,a=r,i={},o=n.readUshort(t,r);r+=2,i.default=e._lctf.readLangSysTable(t,a+o);var s=n.readUshort(t,r);r+=2;for(var u=0;u<s;u++){var c=n.readASCII(t,r,4);r+=4;var l=n.readUshort(t,r);r+=2,i[c.trim()]=e._lctf.readLangSysTable(t,a+l)}return i},e._lctf.readLangSysTable=function(t,r){var n=e._bin,a={};n.readUshort(t,r),r+=2,a.reqFeature=n.readUshort(t,r),r+=2;var i=n.readUshort(t,r);return r+=2,a.features=n.readUshorts(t,r,i),a},e.CFF={},e.CFF.parse=function(t,r,n){var a=e._bin;(t=new Uint8Array(t.buffer,r,n))[r=0],t[++r],t[++r],t[++r],r++;var i=[];r=e.CFF.readIndex(t,r,i);for(var o=[],s=0;s<i.length-1;s++)o.push(a.readASCII(t,r+i[s],i[s+1]-i[s]));r+=i[i.length-1];var u=[];r=e.CFF.readIndex(t,r,u);var c=[];for(s=0;s<u.length-1;s++)c.push(e.CFF.readDict(t,r+u[s],r+u[s+1]));r+=u[u.length-1];var l=c[0],f=[];r=e.CFF.readIndex(t,r,f);var h=[];for(s=0;s<f.length-1;s++)h.push(a.readASCII(t,r+f[s],f[s+1]-f[s]));if(r+=f[f.length-1],e.CFF.readSubrs(t,r,l),l.CharStrings){r=l.CharStrings,f=[],r=e.CFF.readIndex(t,r,f);var d=[];for(s=0;s<f.length-1;s++)d.push(a.readBytes(t,r+f[s],f[s+1]-f[s]));l.CharStrings=d}if(l.ROS){r=l.FDArray;var p=[];for(r=e.CFF.readIndex(t,r,p),l.FDArray=[],s=0;s<p.length-1;s++){var v=e.CFF.readDict(t,r+p[s],r+p[s+1]);e.CFF._readFDict(t,v,h),l.FDArray.push(v)}r+=p[p.length-1],r=l.FDSelect,l.FDSelect=[];var m=t[r];if(r++,3!=m)throw m;var g=a.readUshort(t,r);for(r+=2,s=0;s<g+1;s++)l.FDSelect.push(a.readUshort(t,r),t[r+2]),r+=3}return l.Encoding&&(l.Encoding=e.CFF.readEncoding(t,l.Encoding,l.CharStrings.length)),l.charset&&(l.charset=e.CFF.readCharset(t,l.charset,l.CharStrings.length)),e.CFF._readFDict(t,l,h),l},e.CFF._readFDict=function(t,r,n){var a;for(var i in r.Private&&(a=r.Private[1],r.Private=e.CFF.readDict(t,a,a+r.Private[0]),r.Private.Subrs&&e.CFF.readSubrs(t,a+r.Private.Subrs,r.Private)),r)-1!=["FamilyName","FontName","FullName","Notice","version","Copyright"].indexOf(i)&&(r[i]=n[r[i]-426+35])},e.CFF.readSubrs=function(t,r,n){var a=e._bin,i=[];r=e.CFF.readIndex(t,r,i);var o,s=i.length;o=s<1240?107:s<33900?1131:32768,n.Bias=o,n.Subrs=[];for(var u=0;u<i.length-1;u++)n.Subrs.push(a.readBytes(t,r+i[u],i[u+1]-i[u]))},e.CFF.tableSE=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,0,111,112,113,114,0,115,116,117,118,119,120,121,122,0,123,0,124,125,126,127,128,129,130,131,0,132,133,0,134,135,136,137,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,138,0,139,0,0,0,0,140,141,142,143,0,0,0,0,0,144,0,0,0,145,0,0,146,147,148,149,0,0,0,0],e.CFF.glyphByUnicode=function(t,e){for(var r=0;r<t.charset.length;r++)if(t.charset[r]==e)return r;return-1},e.CFF.glyphBySE=function(t,r){return r<0||r>255?-1:e.CFF.glyphByUnicode(t,e.CFF.tableSE[r])},e.CFF.readEncoding=function(t,r,n){e._bin;var a=[".notdef"],i=t[r];if(r++,0!=i)throw"error: unknown encoding format: "+i;var o=t[r];r++;for(var s=0;s<o;s++)a.push(t[r+s]);return a},e.CFF.readCharset=function(t,r,n){var a=e._bin,i=[".notdef"],o=t[r];if(r++,0==o)for(var s=0;s<n;s++){var u=a.readUshort(t,r);r+=2,i.push(u)}else{if(1!=o&&2!=o)throw"error: format: "+o;for(;i.length<n;){u=a.readUshort(t,r),r+=2;var c=0;for(1==o?(c=t[r],r++):(c=a.readUshort(t,r),r+=2),s=0;s<=c;s++)i.push(u),u++}}return i},e.CFF.readIndex=function(t,r,n){var a=e._bin,i=a.readUshort(t,r)+1,o=t[r+=2];if(r++,1==o)for(var s=0;s<i;s++)n.push(t[r+s]);else if(2==o)for(s=0;s<i;s++)n.push(a.readUshort(t,r+2*s));else if(3==o)for(s=0;s<i;s++)n.push(16777215&a.readUint(t,r+3*s-1));else if(1!=i)throw"unsupported offset size: "+o+", count: "+i;return(r+=i*o)-1},e.CFF.getCharString=function(t,r,n){var a=e._bin,i=t[r],o=t[r+1],s=(t[r+2],t[r+3],t[r+4],1),u=null,c=null;i<=20&&(u=i,s=1),12==i&&(u=100*i+o,s=2),21<=i&&i<=27&&(u=i,s=1),28==i&&(c=a.readShort(t,r+1),s=3),29<=i&&i<=31&&(u=i,s=1),32<=i&&i<=246&&(c=i-139,s=1),247<=i&&i<=250&&(c=256*(i-247)+o+108,s=2),251<=i&&i<=254&&(c=256*-(i-251)-o-108,s=2),255==i&&(c=a.readInt(t,r+1)/65535,s=5),n.val=null!=c?c:"o"+u,n.size=s},e.CFF.readCharString=function(t,r,n){for(var a=r+n,i=e._bin,o=[];r<a;){var s=t[r],u=t[r+1],c=(t[r+2],t[r+3],t[r+4],1),l=null,f=null;s<=20&&(l=s,c=1),12==s&&(l=100*s+u,c=2),19!=s&&20!=s||(l=s,c=2),21<=s&&s<=27&&(l=s,c=1),28==s&&(f=i.readShort(t,r+1),c=3),29<=s&&s<=31&&(l=s,c=1),32<=s&&s<=246&&(f=s-139,c=1),247<=s&&s<=250&&(f=256*(s-247)+u+108,c=2),251<=s&&s<=254&&(f=256*-(s-251)-u-108,c=2),255==s&&(f=i.readInt(t,r+1)/65535,c=5),o.push(null!=f?f:"o"+l),r+=c}return o},e.CFF.readDict=function(t,r,n){for(var a=e._bin,i={},o=[];r<n;){var s=t[r],u=t[r+1],c=(t[r+2],t[r+3],t[r+4],1),l=null,f=null;if(28==s&&(f=a.readShort(t,r+1),c=3),29==s&&(f=a.readInt(t,r+1),c=5),32<=s&&s<=246&&(f=s-139,c=1),247<=s&&s<=250&&(f=256*(s-247)+u+108,c=2),251<=s&&s<=254&&(f=256*-(s-251)-u-108,c=2),255==s)throw f=a.readInt(t,r+1)/65535,c=5,"unknown number";if(30==s){var h=[];for(c=1;;){var d=t[r+c];c++;var p=d>>4,v=15&d;if(15!=p&&h.push(p),15!=v&&h.push(v),15==v)break}for(var m="",g=[0,1,2,3,4,5,6,7,8,9,".","e","e-","reserved","-","endOfNumber"],y=0;y<h.length;y++)m+=g[h[y]];f=parseFloat(m)}s<=21&&(l=["version","Notice","FullName","FamilyName","Weight","FontBBox","BlueValues","OtherBlues","FamilyBlues","FamilyOtherBlues","StdHW","StdVW","escape","UniqueID","XUID","charset","Encoding","CharStrings","Private","Subrs","defaultWidthX","nominalWidthX"][s],c=1,12==s&&(l=["Copyright","isFixedPitch","ItalicAngle","UnderlinePosition","UnderlineThickness","PaintType","CharstringType","FontMatrix","StrokeWidth","BlueScale","BlueShift","BlueFuzz","StemSnapH","StemSnapV","ForceBold",0,0,"LanguageGroup","ExpansionFactor","initialRandomSeed","SyntheticBase","PostScript","BaseFontName","BaseFontBlend",0,0,0,0,0,0,"ROS","CIDFontVersion","CIDFontRevision","CIDFontType","CIDCount","UIDBase","FDArray","FDSelect","FontName"][u],c=2)),null!=l?(i[l]=1==o.length?o[0]:o,o=[]):o.push(f),r+=c}return i},e.cmap={},e.cmap.parse=function(t,r,n){t=new Uint8Array(t.buffer,r,n),r=0;var a=e._bin,i={};a.readUshort(t,r),r+=2;var o=a.readUshort(t,r);r+=2;var s=[];i.tables=[];for(var u=0;u<o;u++){var c=a.readUshort(t,r);r+=2;var l=a.readUshort(t,r);r+=2;var f=a.readUint(t,r);r+=4;var h="p"+c+"e"+l,d=s.indexOf(f);if(-1==d){var p;d=i.tables.length,s.push(f);var v=a.readUshort(t,f);0==v?p=e.cmap.parse0(t,f):4==v?p=e.cmap.parse4(t,f):6==v?p=e.cmap.parse6(t,f):12==v?p=e.cmap.parse12(t,f):console.log("unknown format: "+v,c,l,f),i.tables.push(p)}if(null!=i[h])throw"multiple tables for one platform+encoding";i[h]=d}return i},e.cmap.parse0=function(t,r){var n=e._bin,a={};a.format=n.readUshort(t,r),r+=2;var i=n.readUshort(t,r);r+=2,n.readUshort(t,r),r+=2,a.map=[];for(var o=0;o<i-6;o++)a.map.push(t[r+o]);return a},e.cmap.parse4=function(t,r){var n=e._bin,a=r,i={};i.format=n.readUshort(t,r),r+=2;var o=n.readUshort(t,r);r+=2,n.readUshort(t,r),r+=2;var s=n.readUshort(t,r);r+=2;var u=s/2;i.searchRange=n.readUshort(t,r),r+=2,i.entrySelector=n.readUshort(t,r),r+=2,i.rangeShift=n.readUshort(t,r),r+=2,i.endCount=n.readUshorts(t,r,u),r+=2*u,r+=2,i.startCount=n.readUshorts(t,r,u),r+=2*u,i.idDelta=[];for(var c=0;c<u;c++)i.idDelta.push(n.readShort(t,r)),r+=2;for(i.idRangeOffset=n.readUshorts(t,r,u),r+=2*u,i.glyphIdArray=[];r<a+o;)i.glyphIdArray.push(n.readUshort(t,r)),r+=2;return i},e.cmap.parse6=function(t,r){var n=e._bin,a={};a.format=n.readUshort(t,r),r+=2,n.readUshort(t,r),r+=2,n.readUshort(t,r),r+=2,a.firstCode=n.readUshort(t,r),r+=2;var i=n.readUshort(t,r);r+=2,a.glyphIdArray=[];for(var o=0;o<i;o++)a.glyphIdArray.push(n.readUshort(t,r)),r+=2;return a},e.cmap.parse12=function(t,r){var n=e._bin,a={};a.format=n.readUshort(t,r),r+=2,r+=2,n.readUint(t,r),r+=4,n.readUint(t,r),r+=4;var i=n.readUint(t,r);r+=4,a.groups=[];for(var o=0;o<i;o++){var s=r+12*o,u=n.readUint(t,s+0),c=n.readUint(t,s+4),l=n.readUint(t,s+8);a.groups.push([u,c,l])}return a},e.glyf={},e.glyf.parse=function(t,e,r,n){for(var a=[],i=0;i<n.maxp.numGlyphs;i++)a.push(null);return a},e.glyf._parseGlyf=function(t,r){var n=e._bin,a=t._data,i=e._tabOffset(a,"glyf",t._offset)+t.loca[r];if(t.loca[r]==t.loca[r+1])return null;var o={};if(o.noc=n.readShort(a,i),i+=2,o.xMin=n.readShort(a,i),i+=2,o.yMin=n.readShort(a,i),i+=2,o.xMax=n.readShort(a,i),i+=2,o.yMax=n.readShort(a,i),i+=2,o.xMin>=o.xMax||o.yMin>=o.yMax)return null;if(o.noc>0){o.endPts=[];for(var s=0;s<o.noc;s++)o.endPts.push(n.readUshort(a,i)),i+=2;var u=n.readUshort(a,i);if(i+=2,a.length-i<u)return null;o.instructions=n.readBytes(a,i,u),i+=u;var c=o.endPts[o.noc-1]+1;for(o.flags=[],s=0;s<c;s++){var l=a[i];if(i++,o.flags.push(l),0!=(8&l)){var f=a[i];i++;for(var h=0;h<f;h++)o.flags.push(l),s++}}for(o.xs=[],s=0;s<c;s++){var d=0!=(2&o.flags[s]),p=0!=(16&o.flags[s]);d?(o.xs.push(p?a[i]:-a[i]),i++):p?o.xs.push(0):(o.xs.push(n.readShort(a,i)),i+=2)}for(o.ys=[],s=0;s<c;s++)d=0!=(4&o.flags[s]),p=0!=(32&o.flags[s]),d?(o.ys.push(p?a[i]:-a[i]),i++):p?o.ys.push(0):(o.ys.push(n.readShort(a,i)),i+=2);var v=0,m=0;for(s=0;s<c;s++)v+=o.xs[s],m+=o.ys[s],o.xs[s]=v,o.ys[s]=m}else{var g;o.parts=[];do{g=n.readUshort(a,i),i+=2;var y={m:{a:1,b:0,c:0,d:1,tx:0,ty:0},p1:-1,p2:-1};if(o.parts.push(y),y.glyphIndex=n.readUshort(a,i),i+=2,1&g){var b=n.readShort(a,i);i+=2;var S=n.readShort(a,i);i+=2}else b=n.readInt8(a,i),i++,S=n.readInt8(a,i),i++;2&g?(y.m.tx=b,y.m.ty=S):(y.p1=b,y.p2=S),8&g?(y.m.a=y.m.d=n.readF2dot14(a,i),i+=2):64&g?(y.m.a=n.readF2dot14(a,i),i+=2,y.m.d=n.readF2dot14(a,i),i+=2):128&g&&(y.m.a=n.readF2dot14(a,i),i+=2,y.m.b=n.readF2dot14(a,i),i+=2,y.m.c=n.readF2dot14(a,i),i+=2,y.m.d=n.readF2dot14(a,i),i+=2)}while(32&g);if(256&g){var x=n.readUshort(a,i);for(i+=2,o.instr=[],s=0;s<x;s++)o.instr.push(a[i]),i++}}return o},e.GPOS={},e.GPOS.parse=function(t,r,n,a){return e._lctf.parse(t,r,n,a,e.GPOS.subt)},e.GPOS.subt=function(t,r,n){var a=e._bin,i=n,o={};if(o.fmt=a.readUshort(t,n),n+=2,1==r||2==r||3==r||7==r||8==r&&o.fmt<=2){var s=a.readUshort(t,n);n+=2,o.coverage=e._lctf.readCoverage(t,s+i)}if(1==r&&1==o.fmt){var u=a.readUshort(t,n);n+=2;var c=e._lctf.numOfOnes(u);0!=u&&(o.pos=e.GPOS.readValueRecord(t,n,u))}else if(2==r){u=a.readUshort(t,n),n+=2;var l=a.readUshort(t,n);n+=2,c=e._lctf.numOfOnes(u);var f=e._lctf.numOfOnes(l);if(1==o.fmt){o.pairsets=[];var h=a.readUshort(t,n);n+=2;for(var d=0;d<h;d++){var p=i+a.readUshort(t,n);n+=2;var v=a.readUshort(t,p);p+=2;for(var m=[],g=0;g<v;g++){var y=a.readUshort(t,p);p+=2,0!=u&&(_=e.GPOS.readValueRecord(t,p,u),p+=2*c),0!=l&&(T=e.GPOS.readValueRecord(t,p,l),p+=2*f),m.push({gid2:y,val1:_,val2:T})}o.pairsets.push(m)}}if(2==o.fmt){var b=a.readUshort(t,n);n+=2;var S=a.readUshort(t,n);n+=2;var x=a.readUshort(t,n);n+=2;var U=a.readUshort(t,n);for(n+=2,o.classDef1=e._lctf.readClassDef(t,i+b),o.classDef2=e._lctf.readClassDef(t,i+S),o.matrix=[],d=0;d<x;d++){var w=[];for(g=0;g<U;g++){var _=null,T=null;0!=o.valFmt1&&(_=e.GPOS.readValueRecord(t,n,o.valFmt1),n+=2*c),0!=o.valFmt2&&(T=e.GPOS.readValueRecord(t,n,o.valFmt2),n+=2*f),w.push({val1:_,val2:T})}o.matrix.push(w)}}}return o},e.GPOS.readValueRecord=function(t,r,n){var a=e._bin,i=[];return i.push(1&n?a.readShort(t,r):0),r+=1&n?2:0,i.push(2&n?a.readShort(t,r):0),r+=2&n?2:0,i.push(4&n?a.readShort(t,r):0),r+=4&n?2:0,i.push(8&n?a.readShort(t,r):0),r+=8&n?2:0,i},e.GSUB={},e.GSUB.parse=function(t,r,n,a){return e._lctf.parse(t,r,n,a,e.GSUB.subt)},e.GSUB.subt=function(t,r,n){var a=e._bin,i=n,o={};if(o.fmt=a.readUshort(t,n),n+=2,1!=r&&4!=r&&5!=r&&6!=r)return null;if(1==r||4==r||5==r&&o.fmt<=2||6==r&&o.fmt<=2){var s=a.readUshort(t,n);n+=2,o.coverage=e._lctf.readCoverage(t,i+s)}if(1==r){if(1==o.fmt)o.delta=a.readShort(t,n),n+=2;else if(2==o.fmt){var u=a.readUshort(t,n);n+=2,o.newg=a.readUshorts(t,n,u),n+=2*o.newg.length}}else if(4==r){o.vals=[],u=a.readUshort(t,n),n+=2;for(var c=0;c<u;c++){var l=a.readUshort(t,n);n+=2,o.vals.push(e.GSUB.readLigatureSet(t,i+l))}}else if(5==r){if(2==o.fmt){var f=a.readUshort(t,n);n+=2,o.cDef=e._lctf.readClassDef(t,i+f),o.scset=[];var h=a.readUshort(t,n);for(n+=2,c=0;c<h;c++){var d=a.readUshort(t,n);n+=2,o.scset.push(0==d?null:e.GSUB.readSubClassSet(t,i+d))}}}else if(6==r&&3==o.fmt){for(c=0;c<3;c++){u=a.readUshort(t,n),n+=2;for(var p=[],v=0;v<u;v++)p.push(e._lctf.readCoverage(t,i+a.readUshort(t,n+2*v)));n+=2*u,0==c&&(o.backCvg=p),1==c&&(o.inptCvg=p),2==c&&(o.ahedCvg=p)}u=a.readUshort(t,n),n+=2,o.lookupRec=e.GSUB.readSubstLookupRecords(t,n,u)}return o},e.GSUB.readSubClassSet=function(t,r){var n=e._bin.readUshort,a=r,i=[],o=n(t,r);r+=2;for(var s=0;s<o;s++){var u=n(t,r);r+=2,i.push(e.GSUB.readSubClassRule(t,a+u))}return i},e.GSUB.readSubClassRule=function(t,r){var n=e._bin.readUshort,a={},i=n(t,r),o=n(t,r+=2);r+=2,a.input=[];for(var s=0;s<i-1;s++)a.input.push(n(t,r)),r+=2;return a.substLookupRecords=e.GSUB.readSubstLookupRecords(t,r,o),a},e.GSUB.readSubstLookupRecords=function(t,r,n){for(var a=e._bin.readUshort,i=[],o=0;o<n;o++)i.push(a(t,r),a(t,r+2)),r+=4;return i},e.GSUB.readChainSubClassSet=function(t,r){var n=e._bin,a=r,i=[],o=n.readUshort(t,r);r+=2;for(var s=0;s<o;s++){var u=n.readUshort(t,r);r+=2,i.push(e.GSUB.readChainSubClassRule(t,a+u))}return i},e.GSUB.readChainSubClassRule=function(t,r){for(var n=e._bin,a={},i=["backtrack","input","lookahead"],o=0;o<i.length;o++){var s=n.readUshort(t,r);r+=2,1==o&&s--,a[i[o]]=n.readUshorts(t,r,s),r+=2*a[i[o]].length}return s=n.readUshort(t,r),r+=2,a.subst=n.readUshorts(t,r,2*s),r+=2*a.subst.length,a},e.GSUB.readLigatureSet=function(t,r){var n=e._bin,a=r,i=[],o=n.readUshort(t,r);r+=2;for(var s=0;s<o;s++){var u=n.readUshort(t,r);r+=2,i.push(e.GSUB.readLigature(t,a+u))}return i},e.GSUB.readLigature=function(t,r){var n=e._bin,a={chain:[]};a.nglyph=n.readUshort(t,r),r+=2;var i=n.readUshort(t,r);r+=2;for(var o=0;o<i-1;o++)a.chain.push(n.readUshort(t,r)),r+=2;return a},e.head={},e.head.parse=function(t,r,n){var a=e._bin,i={};return a.readFixed(t,r),r+=4,i.fontRevision=a.readFixed(t,r),r+=4,a.readUint(t,r),r+=4,a.readUint(t,r),r+=4,i.flags=a.readUshort(t,r),r+=2,i.unitsPerEm=a.readUshort(t,r),r+=2,i.created=a.readUint64(t,r),r+=8,i.modified=a.readUint64(t,r),r+=8,i.xMin=a.readShort(t,r),r+=2,i.yMin=a.readShort(t,r),r+=2,i.xMax=a.readShort(t,r),r+=2,i.yMax=a.readShort(t,r),r+=2,i.macStyle=a.readUshort(t,r),r+=2,i.lowestRecPPEM=a.readUshort(t,r),r+=2,i.fontDirectionHint=a.readShort(t,r),r+=2,i.indexToLocFormat=a.readShort(t,r),r+=2,i.glyphDataFormat=a.readShort(t,r),r+=2,i},e.hhea={},e.hhea.parse=function(t,r,n){var a=e._bin,i={};return a.readFixed(t,r),r+=4,i.ascender=a.readShort(t,r),r+=2,i.descender=a.readShort(t,r),r+=2,i.lineGap=a.readShort(t,r),r+=2,i.advanceWidthMax=a.readUshort(t,r),r+=2,i.minLeftSideBearing=a.readShort(t,r),r+=2,i.minRightSideBearing=a.readShort(t,r),r+=2,i.xMaxExtent=a.readShort(t,r),r+=2,i.caretSlopeRise=a.readShort(t,r),r+=2,i.caretSlopeRun=a.readShort(t,r),r+=2,i.caretOffset=a.readShort(t,r),r+=2,r+=8,i.metricDataFormat=a.readShort(t,r),r+=2,i.numberOfHMetrics=a.readUshort(t,r),r+=2,i},e.hmtx={},e.hmtx.parse=function(t,r,n,a){for(var i=e._bin,o={aWidth:[],lsBearing:[]},s=0,u=0,c=0;c<a.maxp.numGlyphs;c++)c<a.hhea.numberOfHMetrics&&(s=i.readUshort(t,r),r+=2,u=i.readShort(t,r),r+=2),o.aWidth.push(s),o.lsBearing.push(u);return o},e.kern={},e.kern.parse=function(t,r,n,a){var i=e._bin,o=i.readUshort(t,r);if(r+=2,1==o)return e.kern.parseV1(t,r-2,n,a);var s=i.readUshort(t,r);r+=2;for(var u={glyph1:[],rval:[]},c=0;c<s;c++){r+=2,n=i.readUshort(t,r),r+=2;var l=i.readUshort(t,r);r+=2;var f=l>>>8;if(0!=(f&=15))throw"unknown kern table format: "+f;r=e.kern.readFormat0(t,r,u)}return u},e.kern.parseV1=function(t,r,n,a){var i=e._bin;i.readFixed(t,r),r+=4;var o=i.readUint(t,r);r+=4;for(var s={glyph1:[],rval:[]},u=0;u<o;u++){i.readUint(t,r),r+=4;var c=i.readUshort(t,r);r+=2,i.readUshort(t,r),r+=2;var l=c>>>8;if(0!=(l&=15))throw"unknown kern table format: "+l;r=e.kern.readFormat0(t,r,s)}return s},e.kern.readFormat0=function(t,r,n){var a=e._bin,i=-1,o=a.readUshort(t,r);r+=2,a.readUshort(t,r),r+=2,a.readUshort(t,r),r+=2,a.readUshort(t,r),r+=2;for(var s=0;s<o;s++){var u=a.readUshort(t,r);r+=2;var c=a.readUshort(t,r);r+=2;var l=a.readShort(t,r);r+=2,u!=i&&(n.glyph1.push(u),n.rval.push({glyph2:[],vals:[]}));var f=n.rval[n.rval.length-1];f.glyph2.push(c),f.vals.push(l),i=u}return r},e.loca={},e.loca.parse=function(t,r,n,a){var i=e._bin,o=[],s=a.head.indexToLocFormat,u=a.maxp.numGlyphs+1;if(0==s)for(var c=0;c<u;c++)o.push(i.readUshort(t,r+(c<<1))<<1);if(1==s)for(c=0;c<u;c++)o.push(i.readUint(t,r+(c<<2)));return o},e.maxp={},e.maxp.parse=function(t,r,n){var a=e._bin,i={},o=a.readUint(t,r);return r+=4,i.numGlyphs=a.readUshort(t,r),r+=2,65536==o&&(i.maxPoints=a.readUshort(t,r),r+=2,i.maxContours=a.readUshort(t,r),r+=2,i.maxCompositePoints=a.readUshort(t,r),r+=2,i.maxCompositeContours=a.readUshort(t,r),r+=2,i.maxZones=a.readUshort(t,r),r+=2,i.maxTwilightPoints=a.readUshort(t,r),r+=2,i.maxStorage=a.readUshort(t,r),r+=2,i.maxFunctionDefs=a.readUshort(t,r),r+=2,i.maxInstructionDefs=a.readUshort(t,r),r+=2,i.maxStackElements=a.readUshort(t,r),r+=2,i.maxSizeOfInstructions=a.readUshort(t,r),r+=2,i.maxComponentElements=a.readUshort(t,r),r+=2,i.maxComponentDepth=a.readUshort(t,r),r+=2),i},e.name={},e.name.parse=function(t,r,n){var a=e._bin,i={};a.readUshort(t,r),r+=2;var o=a.readUshort(t,r);r+=2,a.readUshort(t,r);for(var s,u=["copyright","fontFamily","fontSubfamily","ID","fullName","version","postScriptName","trademark","manufacturer","designer","description","urlVendor","urlDesigner","licence","licenceURL","---","typoFamilyName","typoSubfamilyName","compatibleFull","sampleText","postScriptCID","wwsFamilyName","wwsSubfamilyName","lightPalette","darkPalette"],c=r+=2,l=0;l<o;l++){var f=a.readUshort(t,r);r+=2;var h=a.readUshort(t,r);r+=2;var d=a.readUshort(t,r);r+=2;var p=a.readUshort(t,r);r+=2;var v=a.readUshort(t,r);r+=2;var m=a.readUshort(t,r);r+=2;var g,y=u[p],b=c+12*o+m;if(0==f)g=a.readUnicode(t,b,v/2);else if(3==f&&0==h)g=a.readUnicode(t,b,v/2);else if(0==h)g=a.readASCII(t,b,v);else if(1==h)g=a.readUnicode(t,b,v/2);else if(3==h)g=a.readUnicode(t,b,v/2);else{if(1!=f)throw"unknown encoding "+h+", platformID: "+f;g=a.readASCII(t,b,v),console.log("reading unknown MAC encoding "+h+" as ASCII")}var S="p"+f+","+d.toString(16);null==i[S]&&(i[S]={}),i[S][y]=g,i[S]._lang=d}for(var x in i)if(null!=i[x].postScriptName&&1033==i[x]._lang)return i[x];for(var x in i)if(null!=i[x].postScriptName&&0==i[x]._lang)return i[x];for(var x in i)if(null!=i[x].postScriptName&&3084==i[x]._lang)return i[x];for(var x in i)if(null!=i[x].postScriptName)return i[x];for(var x in i){s=x;break}return console.log("returning name table with languageID "+i[s]._lang),i[s]},e["OS/2"]={},e["OS/2"].parse=function(t,r,n){var a=e._bin.readUshort(t,r);r+=2;var i={};if(0==a)e["OS/2"].version0(t,r,i);else if(1==a)e["OS/2"].version1(t,r,i);else if(2==a||3==a||4==a)e["OS/2"].version2(t,r,i);else{if(5!=a)throw"unknown OS/2 table version: "+a;e["OS/2"].version5(t,r,i)}return i},e["OS/2"].version0=function(t,r,n){var a=e._bin;return n.xAvgCharWidth=a.readShort(t,r),r+=2,n.usWeightClass=a.readUshort(t,r),r+=2,n.usWidthClass=a.readUshort(t,r),r+=2,n.fsType=a.readUshort(t,r),r+=2,n.ySubscriptXSize=a.readShort(t,r),r+=2,n.ySubscriptYSize=a.readShort(t,r),r+=2,n.ySubscriptXOffset=a.readShort(t,r),r+=2,n.ySubscriptYOffset=a.readShort(t,r),r+=2,n.ySuperscriptXSize=a.readShort(t,r),r+=2,n.ySuperscriptYSize=a.readShort(t,r),r+=2,n.ySuperscriptXOffset=a.readShort(t,r),r+=2,n.ySuperscriptYOffset=a.readShort(t,r),r+=2,n.yStrikeoutSize=a.readShort(t,r),r+=2,n.yStrikeoutPosition=a.readShort(t,r),r+=2,n.sFamilyClass=a.readShort(t,r),r+=2,n.panose=a.readBytes(t,r,10),r+=10,n.ulUnicodeRange1=a.readUint(t,r),r+=4,n.ulUnicodeRange2=a.readUint(t,r),r+=4,n.ulUnicodeRange3=a.readUint(t,r),r+=4,n.ulUnicodeRange4=a.readUint(t,r),r+=4,n.achVendID=[a.readInt8(t,r),a.readInt8(t,r+1),a.readInt8(t,r+2),a.readInt8(t,r+3)],r+=4,n.fsSelection=a.readUshort(t,r),r+=2,n.usFirstCharIndex=a.readUshort(t,r),r+=2,n.usLastCharIndex=a.readUshort(t,r),r+=2,n.sTypoAscender=a.readShort(t,r),r+=2,n.sTypoDescender=a.readShort(t,r),r+=2,n.sTypoLineGap=a.readShort(t,r),r+=2,n.usWinAscent=a.readUshort(t,r),r+=2,n.usWinDescent=a.readUshort(t,r),r+=2},e["OS/2"].version1=function(t,r,n){var a=e._bin;return r=e["OS/2"].version0(t,r,n),n.ulCodePageRange1=a.readUint(t,r),r+=4,n.ulCodePageRange2=a.readUint(t,r),r+=4},e["OS/2"].version2=function(t,r,n){var a=e._bin;return r=e["OS/2"].version1(t,r,n),n.sxHeight=a.readShort(t,r),r+=2,n.sCapHeight=a.readShort(t,r),r+=2,n.usDefault=a.readUshort(t,r),r+=2,n.usBreak=a.readUshort(t,r),r+=2,n.usMaxContext=a.readUshort(t,r),r+=2},e["OS/2"].version5=function(t,r,n){var a=e._bin;return r=e["OS/2"].version2(t,r,n),n.usLowerOpticalPointSize=a.readUshort(t,r),r+=2,n.usUpperOpticalPointSize=a.readUshort(t,r),r+=2},e.post={},e.post.parse=function(t,r,n){var a=e._bin,i={};return i.version=a.readFixed(t,r),r+=4,i.italicAngle=a.readFixed(t,r),r+=4,i.underlinePosition=a.readShort(t,r),r+=2,i.underlineThickness=a.readShort(t,r),r+=2,i},e.SVG={},e.SVG.parse=function(t,r,n){var a=e._bin,i={entries:[]},o=r;a.readUshort(t,r),r+=2;var s=a.readUint(t,r);r+=4,a.readUint(t,r),r+=4,r=s+o;var u=a.readUshort(t,r);r+=2;for(var c=0;c<u;c++){var l=a.readUshort(t,r);r+=2;var f=a.readUshort(t,r);r+=2;var h=a.readUint(t,r);r+=4;var d=a.readUint(t,r);r+=4;for(var p=new Uint8Array(t.buffer,o+h+s,d),v=a.readUTF8(p,0,p.length),m=l;m<=f;m++)i.entries[m]=v}return i},e.SVG.toPath=function(t){var r={cmds:[],crds:[]};if(null==t)return r;for(var n=(new DOMParser).parseFromString(t,"image/svg+xml").firstChild;"svg"!=n.tagName;)n=n.nextSibling;var a=n.getAttribute("viewBox");a=a?a.trim().split(" ").map(parseFloat):[0,0,1e3,1e3],e.SVG._toPath(n.children,r);for(var i=0;i<r.crds.length;i+=2){var o=r.crds[i],s=r.crds[i+1];o-=a[0],s=-(s-=a[1]),r.crds[i]=o,r.crds[i+1]=s}return r},e.SVG._toPath=function(t,r,n){for(var a=0;a<t.length;a++){var i=t[a],o=i.tagName,s=i.getAttribute("fill");if(null==s&&(s=n),"g"==o)e.SVG._toPath(i.children,r,s);else if("path"==o){r.cmds.push(s||"#000000");var u=i.getAttribute("d"),c=e.SVG._tokens(u);e.SVG._toksToPath(c,r),r.cmds.push("X")}else"defs"==o||console.log(o,i)}},e.SVG._tokens=function(t){for(var e=[],r=0,n=!1,a="";r<t.length;){var i=t.charCodeAt(r),o=t.charAt(r);r++;var s=48<=i&&i<=57||"."==o||"-"==o;n?"-"==o?(e.push(parseFloat(a)),a=o):s?a+=o:(e.push(parseFloat(a)),","!=o&&" "!=o&&e.push(o),n=!1):s?(a=o,n=!0):","!=o&&" "!=o&&e.push(o)}return n&&e.push(parseFloat(a)),e},e.SVG._toksToPath=function(t,r){for(var n=0,a=0,i=0,o=0,s=0,u={M:2,L:2,H:1,V:1,S:4,C:6},c=r.cmds,l=r.crds;n<t.length;){var f=t[n];if(n++,"z"==f)c.push("Z"),a=o,i=s;else for(var h=f.toUpperCase(),d=u[h],p=e.SVG._reps(t,n,d),v=0;v<p;v++){var m=0,g=0;if(f!=h&&(m=a,g=i),"M"==h)a=m+t[n++],i=g+t[n++],c.push("M"),l.push(a,i),o=a,s=i;else if("L"==h)a=m+t[n++],i=g+t[n++],c.push("L"),l.push(a,i);else if("H"==h)a=m+t[n++],c.push("L"),l.push(a,i);else if("V"==h)i=g+t[n++],c.push("L"),l.push(a,i);else if("C"==h){var y=m+t[n++],b=g+t[n++],S=m+t[n++],x=g+t[n++],U=m+t[n++],w=g+t[n++];c.push("C"),l.push(y,b,S,x,U,w),a=U,i=w}else if("S"==h){var _=Math.max(l.length-4,0);y=a+a-l[_],b=i+i-l[_+1],S=m+t[n++],x=g+t[n++],U=m+t[n++],w=g+t[n++],c.push("C"),l.push(y,b,S,x,U,w),a=U,i=w}else console.log("Unknown SVG command "+f)}}},e.SVG._reps=function(t,e,r){for(var n=e;n<t.length&&"string"!=typeof t[n];)n+=r;return(n-e)/r},null==e&&(e={}),null==e.U&&(e.U={}),e.U.codeToGlyph=function(t,e){var r=t.cmap,n=-1;if(null!=r.p0e4?n=r.p0e4:null!=r.p3e1?n=r.p3e1:null!=r.p1e0?n=r.p1e0:null!=r.p0e3&&(n=r.p0e3),-1==n)throw"no familiar platform and encoding!";var a=r.tables[n];if(0==a.format)return e>=a.map.length?0:a.map[e];if(4==a.format){for(var i=-1,o=0;o<a.endCount.length;o++)if(e<=a.endCount[o]){i=o;break}return-1==i||a.startCount[i]>e?0:65535&(0!=a.idRangeOffset[i]?a.glyphIdArray[e-a.startCount[i]+(a.idRangeOffset[i]>>1)-(a.idRangeOffset.length-i)]:e+a.idDelta[i])}if(12==a.format){if(e>a.groups[a.groups.length-1][1])return 0;for(o=0;o<a.groups.length;o++){var s=a.groups[o];if(s[0]<=e&&e<=s[1])return s[2]+(e-s[0])}return 0}throw"unknown cmap table format "+a.format},e.U.glyphToPath=function(t,r){var n={cmds:[],crds:[]};if(t.SVG&&t.SVG.entries[r]){var a=t.SVG.entries[r];return null==a?n:("string"==typeof a&&(a=e.SVG.toPath(a),t.SVG.entries[r]=a),a)}if(t.CFF){var i={x:0,y:0,stack:[],nStems:0,haveWidth:!1,width:t.CFF.Private?t.CFF.Private.defaultWidthX:0,open:!1},o=t.CFF,s=t.CFF.Private;if(o.ROS){for(var u=0;o.FDSelect[u+2]<=r;)u+=2;s=o.FDArray[o.FDSelect[u+1]].Private}e.U._drawCFF(t.CFF.CharStrings[r],i,o,s,n)}else t.glyf&&e.U._drawGlyf(r,t,n);return n},e.U._drawGlyf=function(t,r,n){var a=r.glyf[t];null==a&&(a=r.glyf[t]=e.glyf._parseGlyf(r,t)),null!=a&&(a.noc>-1?e.U._simpleGlyph(a,n):e.U._compoGlyph(a,r,n))},e.U._simpleGlyph=function(t,r){for(var n=0;n<t.noc;n++){for(var a=0==n?0:t.endPts[n-1]+1,i=t.endPts[n],o=a;o<=i;o++){var s=o==a?i:o-1,u=o==i?a:o+1,c=1&t.flags[o],l=1&t.flags[s],f=1&t.flags[u],h=t.xs[o],d=t.ys[o];if(o==a)if(c){if(!l){e.U.P.moveTo(r,h,d);continue}e.U.P.moveTo(r,t.xs[s],t.ys[s])}else l?e.U.P.moveTo(r,t.xs[s],t.ys[s]):e.U.P.moveTo(r,(t.xs[s]+h)/2,(t.ys[s]+d)/2);c?l&&e.U.P.lineTo(r,h,d):f?e.U.P.qcurveTo(r,h,d,t.xs[u],t.ys[u]):e.U.P.qcurveTo(r,h,d,(h+t.xs[u])/2,(d+t.ys[u])/2)}e.U.P.closePath(r)}},e.U._compoGlyph=function(t,r,n){for(var a=0;a<t.parts.length;a++){var i={cmds:[],crds:[]},o=t.parts[a];e.U._drawGlyf(o.glyphIndex,r,i);for(var s=o.m,u=0;u<i.crds.length;u+=2){var c=i.crds[u],l=i.crds[u+1];n.crds.push(c*s.a+l*s.b+s.tx),n.crds.push(c*s.c+l*s.d+s.ty)}for(u=0;u<i.cmds.length;u++)n.cmds.push(i.cmds[u])}},e.U._getGlyphClass=function(t,r){var n=e._lctf.getInterval(r,t);return-1==n?0:r[n+2]},e.U.getPairAdjustment=function(t,r,n){if(t.GPOS)for(var a=t.GPOS,i=a.lookupList,o=a.featureList,s=[],u=0;u<o.length;u++){var c=o[u];if("kern"==c.tag)for(var l=0;l<c.tab.length;l++)if(!s[c.tab[l]]){s[c.tab[l]]=!0;for(var f=i[c.tab[l]],h=0;h<f.tabs.length;h++)if(null!=f.tabs[u]){var d,p=f.tabs[h];if(!p.coverage||-1!=(d=e._lctf.coverageIndex(p.coverage,r)))if(1==f.ltype);else if(2==f.ltype){var v;if(1==p.fmt){var m=p.pairsets[d];for(u=0;u<m.length;u++)m[u].gid2==n&&(v=m[u])}else if(2==p.fmt){var g=e.U._getGlyphClass(r,p.classDef1),y=e.U._getGlyphClass(n,p.classDef2);v=p.matrix[g][y]}if(v&&v.val2)return v.val2[2]}}}}if(t.kern){var b=t.kern.glyph1.indexOf(r);if(-1!=b){var S=t.kern.rval[b].glyph2.indexOf(n);if(-1!=S)return t.kern.rval[b].vals[S]}}return 0},e.U.stringToGlyphs=function(t,r){for(var n=[],a=0;a<r.length;a++)(i=r.codePointAt(a))>65535&&a++,n.push(e.U.codeToGlyph(t,i));for(a=0;a<r.length;a++){var i;if(2367==(i=r.codePointAt(a))){var o=n[a-1];n[a-1]=n[a],n[a]=o}i>65535&&a++}var s=t.GSUB;if(null==s)return n;for(var u=s.lookupList,c=s.featureList,l=["rlig","liga","mset","isol","init","fina","medi","half","pres","blws"],f=[],h=0;h<c.length;h++){var d=c[h];if(-1!=l.indexOf(d.tag))for(var p=0;p<d.tab.length;p++)if(!f[d.tab[p]]){f[d.tab[p]]=!0;for(var v=u[d.tab[p]],m=0;m<n.length;m++){var g=e.U._getWPfeature(r,m);-1!="isol,init,fina,medi".indexOf(d.tag)&&d.tag!=g||e.U._applySubs(n,m,v,u)}}}return n},e.U._getWPfeature=function(t,e){var r='\n\t" ,.:;!?()  \u060c',n="\u0622\u0623\u0624\u0625\u0627\u0629\u062f\u0630\u0631\u0632\u0648\u0671\u0672\u0673\u0675\u0676\u0677\u0688\u0689\u068a\u068b\u068c\u068d\u068e\u068f\u0690\u0691\u0692\u0693\u0694\u0695\u0696\u0697\u0698\u0699\u06c0\u06c3\u06c4\u06c5\u06c6\u06c7\u06c8\u06c9\u06ca\u06cb\u06cd\u06cf\u06d2\u06d3\u06d5\u06ee\u06ef\u0710\u0715\u0716\u0717\u0718\u0719\u071e\u0728\u072a\u072c\u072f\u074d\u0759\u075a\u075b\u076b\u076c\u0771\u0773\u0774\u0778\u0779\u0840\u0846\u0847\u0849\u0854\u0867\u0869\u086a\u08aa\u08ab\u08ac\u08ae\u08b1\u08b2\u08b9\u0ac5\u0ac7\u0ac9\u0aca\u0ace\u0acf\u0ad0\u0ad1\u0ad2\u0add\u0ae1\u0ae4\u0aef\u0b81\u0b83\u0b84\u0b85\u0b89\u0b8c\u0b8e\u0b8f\u0b91\u0ba9\u0baa\u0bab\u0bac",a=0==e||-1!=r.indexOf(t[e-1]),i=e==t.length-1||-1!=r.indexOf(t[e+1]);return a||-1==n.indexOf(t[e-1])||(a=!0),i||-1==n.indexOf(t[e])||(i=!0),i||-1=="\ua872\u0acd\u0ad7".indexOf(t[e+1])||(i=!0),a||-1=="\ua872\u0acd\u0ad7".indexOf(t[e])||(a=!0),a?i?"isol":"init":i?"fina":"medi"},e.U._applySubs=function(t,r,n,a){for(var i=t.length-r-1,o=0;o<n.tabs.length;o++)if(null!=n.tabs[o]){var s,u=n.tabs[o];if(!u.coverage||-1!=(s=e._lctf.coverageIndex(u.coverage,t[r])))if(1==n.ltype)t[r],1==u.fmt?t[r]=t[r]+u.delta:t[r]=u.newg[s];else if(4==n.ltype)for(var c=u.vals[s],l=0;l<c.length;l++){var f=c[l],h=f.chain.length;if(!(h>i)){for(var d=!0,p=0,v=0;v<h;v++){for(;-1==t[r+p+(1+v)];)p++;f.chain[v]!=t[r+p+(1+v)]&&(d=!1)}if(d){for(t[r]=f.nglyph,v=0;v<h+p;v++)t[r+v+1]=-1;break}}}else if(5==n.ltype&&2==u.fmt)for(var m=e._lctf.getInterval(u.cDef,t[r]),g=u.cDef[m+2],y=u.scset[g],b=0;b<y.length;b++){var S=y[b],x=S.input;if(!(x.length>i)){for(d=!0,v=0;v<x.length;v++){var U=e._lctf.getInterval(u.cDef,t[r+1+v]);if(-1==m&&u.cDef[U+2]!=x[v]){d=!1;break}}if(d){var w=S.substLookupRecords;for(l=0;l<w.length;l+=2)w[l],w[l+1]}}}else if(6==n.ltype&&3==u.fmt){if(!e.U._glsCovered(t,u.backCvg,r-u.backCvg.length))continue;if(!e.U._glsCovered(t,u.inptCvg,r))continue;if(!e.U._glsCovered(t,u.ahedCvg,r+u.inptCvg.length))continue;var _=u.lookupRec;for(b=0;b<_.length;b+=2){m=_[b];var T=a[_[b+1]];e.U._applySubs(t,r+m,T,a)}}}},e.U._glsCovered=function(t,r,n){for(var a=0;a<r.length;a++)if(-1==e._lctf.coverageIndex(r[a],t[n+a]))return!1;return!0},e.U.glyphsToPath=function(t,r,n){for(var a={cmds:[],crds:[]},i=0,o=0;o<r.length;o++){var s=r[o];if(-1!=s){for(var u=o<r.length-1&&-1!=r[o+1]?r[o+1]:0,c=e.U.glyphToPath(t,s),l=0;l<c.crds.length;l+=2)a.crds.push(c.crds[l]+i),a.crds.push(c.crds[l+1]);for(n&&a.cmds.push(n),l=0;l<c.cmds.length;l++)a.cmds.push(c.cmds[l]);n&&a.cmds.push("X"),i+=t.hmtx.aWidth[s],o<r.length-1&&(i+=e.U.getPairAdjustment(t,s,u))}}return a},e.U.pathToSVG=function(t,e){null==e&&(e=5);for(var r=[],n=0,a={M:2,L:2,Q:4,C:6},i=0;i<t.cmds.length;i++){var o=t.cmds[i],s=n+(a[o]?a[o]:0);for(r.push(o);n<s;){var u=t.crds[n++];r.push(parseFloat(u.toFixed(e))+(n==s?"":" "))}}return r.join("")},e.U.pathToContext=function(t,e){for(var r=0,n=t.crds,a=0;a<t.cmds.length;a++){var i=t.cmds[a];"M"==i?(e.moveTo(n[r],n[r+1]),r+=2):"L"==i?(e.lineTo(n[r],n[r+1]),r+=2):"C"==i?(e.bezierCurveTo(n[r],n[r+1],n[r+2],n[r+3],n[r+4],n[r+5]),r+=6):"Q"==i?(e.quadraticCurveTo(n[r],n[r+1],n[r+2],n[r+3]),r+=4):"#"==i.charAt(0)?(e.beginPath(),e.fillStyle=i):"Z"==i?e.closePath():"X"==i&&e.fill()}},e.U.P={},e.U.P.moveTo=function(t,e,r){t.cmds.push("M"),t.crds.push(e,r)},e.U.P.lineTo=function(t,e,r){t.cmds.push("L"),t.crds.push(e,r)},e.U.P.curveTo=function(t,e,r,n,a,i,o){t.cmds.push("C"),t.crds.push(e,r,n,a,i,o)},e.U.P.qcurveTo=function(t,e,r,n,a){t.cmds.push("Q"),t.crds.push(e,r,n,a)},e.U.P.closePath=function(t){t.cmds.push("Z")},e.U._drawCFF=function(t,r,n,a,i){for(var o=r.stack,s=r.nStems,u=r.haveWidth,c=r.width,l=r.open,f=0,h=r.x,d=r.y,p=0,v=0,m=0,g=0,y=0,b=0,S=0,x=0,U=0,w=0,_={val:0,size:0};f<t.length;){e.CFF.getCharString(t,f,_);var T=_.val;if(f+=_.size,"o1"==T||"o18"==T)o.length%2!==0&&!u&&(c=o.shift()+a.nominalWidthX),s+=o.length>>1,o.length=0,u=!0;else if("o3"==T||"o23"==T)o.length%2!==0&&!u&&(c=o.shift()+a.nominalWidthX),s+=o.length>>1,o.length=0,u=!0;else if("o4"==T)o.length>1&&!u&&(c=o.shift()+a.nominalWidthX,u=!0),l&&e.U.P.closePath(i),d+=o.pop(),e.U.P.moveTo(i,h,d),l=!0;else if("o5"==T)for(;o.length>0;)h+=o.shift(),d+=o.shift(),e.U.P.lineTo(i,h,d);else if("o6"==T||"o7"==T)for(var M=o.length,k="o6"==T,C=0;C<M;C++){var F=o.shift();k?h+=F:d+=F,k=!k,e.U.P.lineTo(i,h,d)}else if("o8"==T||"o24"==T){M=o.length;for(var O=0;O+6<=M;)p=h+o.shift(),v=d+o.shift(),m=p+o.shift(),g=v+o.shift(),h=m+o.shift(),d=g+o.shift(),e.U.P.curveTo(i,p,v,m,g,h,d),O+=6;"o24"==T&&(h+=o.shift(),d+=o.shift(),e.U.P.lineTo(i,h,d))}else{if("o11"==T)break;if("o1234"==T||"o1235"==T||"o1236"==T||"o1237"==T)"o1234"==T&&(v=d,m=(p=h+o.shift())+o.shift(),w=g=v+o.shift(),b=g,x=d,h=(S=(y=(U=m+o.shift())+o.shift())+o.shift())+o.shift(),e.U.P.curveTo(i,p,v,m,g,U,w),e.U.P.curveTo(i,y,b,S,x,h,d)),"o1235"==T&&(p=h+o.shift(),v=d+o.shift(),m=p+o.shift(),g=v+o.shift(),U=m+o.shift(),w=g+o.shift(),y=U+o.shift(),b=w+o.shift(),S=y+o.shift(),x=b+o.shift(),h=S+o.shift(),d=x+o.shift(),o.shift(),e.U.P.curveTo(i,p,v,m,g,U,w),e.U.P.curveTo(i,y,b,S,x,h,d)),"o1236"==T&&(p=h+o.shift(),v=d+o.shift(),m=p+o.shift(),w=g=v+o.shift(),b=g,S=(y=(U=m+o.shift())+o.shift())+o.shift(),x=b+o.shift(),h=S+o.shift(),e.U.P.curveTo(i,p,v,m,g,U,w),e.U.P.curveTo(i,y,b,S,x,h,d)),"o1237"==T&&(p=h+o.shift(),v=d+o.shift(),m=p+o.shift(),g=v+o.shift(),U=m+o.shift(),w=g+o.shift(),y=U+o.shift(),b=w+o.shift(),S=y+o.shift(),x=b+o.shift(),Math.abs(S-h)>Math.abs(x-d)?h=S+o.shift():d=x+o.shift(),e.U.P.curveTo(i,p,v,m,g,U,w),e.U.P.curveTo(i,y,b,S,x,h,d));else if("o14"==T){if(o.length>0&&!u&&(c=o.shift()+n.nominalWidthX,u=!0),4==o.length){var A=o.shift(),D=o.shift(),P=o.shift(),E=o.shift(),I=e.CFF.glyphBySE(n,P),B=e.CFF.glyphBySE(n,E);e.U._drawCFF(n.CharStrings[I],r,n,a,i),r.x=A,r.y=D,e.U._drawCFF(n.CharStrings[B],r,n,a,i)}l&&(e.U.P.closePath(i),l=!1)}else if("o19"==T||"o20"==T)o.length%2!==0&&!u&&(c=o.shift()+a.nominalWidthX),s+=o.length>>1,o.length=0,u=!0,f+=s+7>>3;else if("o21"==T)o.length>2&&!u&&(c=o.shift()+a.nominalWidthX,u=!0),d+=o.pop(),h+=o.pop(),l&&e.U.P.closePath(i),e.U.P.moveTo(i,h,d),l=!0;else if("o22"==T)o.length>1&&!u&&(c=o.shift()+a.nominalWidthX,u=!0),h+=o.pop(),l&&e.U.P.closePath(i),e.U.P.moveTo(i,h,d),l=!0;else if("o25"==T){for(;o.length>6;)h+=o.shift(),d+=o.shift(),e.U.P.lineTo(i,h,d);p=h+o.shift(),v=d+o.shift(),m=p+o.shift(),g=v+o.shift(),h=m+o.shift(),d=g+o.shift(),e.U.P.curveTo(i,p,v,m,g,h,d)}else if("o26"==T)for(o.length%2&&(h+=o.shift());o.length>0;)p=h,v=d+o.shift(),h=m=p+o.shift(),d=(g=v+o.shift())+o.shift(),e.U.P.curveTo(i,p,v,m,g,h,d);else if("o27"==T)for(o.length%2&&(d+=o.shift());o.length>0;)v=d,m=(p=h+o.shift())+o.shift(),g=v+o.shift(),h=m+o.shift(),d=g,e.U.P.curveTo(i,p,v,m,g,h,d);else if("o10"==T||"o29"==T){var L="o10"==T?a:n;if(0==o.length)console.log("error: empty stack");else{var G=o.pop(),z=L.Subrs[G+L.Bias];r.x=h,r.y=d,r.nStems=s,r.haveWidth=u,r.width=c,r.open=l,e.U._drawCFF(z,r,n,a,i),h=r.x,d=r.y,s=r.nStems,u=r.haveWidth,c=r.width,l=r.open}}else if("o30"==T||"o31"==T){var R=o.length,j=(O=0,"o31"==T);for(O+=R-(M=-3&R);O<M;)j?(v=d,m=(p=h+o.shift())+o.shift(),d=(g=v+o.shift())+o.shift(),M-O==5?(h=m+o.shift(),O++):h=m,j=!1):(p=h,v=d+o.shift(),m=p+o.shift(),g=v+o.shift(),h=m+o.shift(),M-O==5?(d=g+o.shift(),O++):d=g,j=!0),e.U.P.curveTo(i,p,v,m,g,h,d),O+=4}else{if("o"==(T+"").charAt(0))throw console.log("Unknown operation: "+T,t),T;o.push(T)}}}r.x=h,r.y=d,r.nStems=s,r.haveWidth=u,r.width=c,r.open=l},e},function(){var t=function(){var t={};function e(){this.table=new Uint16Array(16),this.trans=new Uint16Array(288)}function r(t,r){this.source=t,this.sourceIndex=0,this.tag=0,this.bitcount=0,this.dest=r,this.destLen=0,this.ltree=new e,this.dtree=new e}var n=new e,a=new e,i=new Uint8Array(30),o=new Uint16Array(30),s=new Uint8Array(30),u=new Uint16Array(30),c=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),l=new e,f=new Uint8Array(320);function h(t,e,r,n){var a,i;for(a=0;a<r;++a)t[a]=0;for(a=0;a<30-r;++a)t[a+r]=a/r|0;for(i=n,a=0;a<30;++a)e[a]=i,i+=1<<t[a]}var d=new Uint16Array(16);function p(t,e,r,n){var a,i;for(a=0;a<16;++a)t.table[a]=0;for(a=0;a<n;++a)t.table[e[r+a]]++;for(t.table[0]=0,i=0,a=0;a<16;++a)d[a]=i,i+=t.table[a];for(a=0;a<n;++a)e[r+a]&&(t.trans[d[e[r+a]]++]=a)}function v(t){t.bitcount--||(t.tag=t.source[t.sourceIndex++],t.bitcount=7);var e=1&t.tag;return t.tag>>>=1,e}function m(t,e,r){if(!e)return r;for(;t.bitcount<24;)t.tag|=t.source[t.sourceIndex++]<<t.bitcount,t.bitcount+=8;var n=t.tag&65535>>>16-e;return t.tag>>>=e,t.bitcount-=e,n+r}function g(t,e){for(;t.bitcount<24;)t.tag|=t.source[t.sourceIndex++]<<t.bitcount,t.bitcount+=8;var r=0,n=0,a=0,i=t.tag;do{n=2*n+(1&i),i>>>=1,++a,r+=e.table[a],n-=e.table[a]}while(n>=0);return t.tag=i,t.bitcount-=a,e.trans[r+n]}function y(t,e,r){var n,a,i,o,s,u;for(n=m(t,5,257),a=m(t,5,1),i=m(t,4,4),o=0;o<19;++o)f[o]=0;for(o=0;o<i;++o){var h=m(t,3,0);f[c[o]]=h}for(p(l,f,0,19),s=0;s<n+a;){var d=g(t,l);switch(d){case 16:var v=f[s-1];for(u=m(t,2,3);u;--u)f[s++]=v;break;case 17:for(u=m(t,3,3);u;--u)f[s++]=0;break;case 18:for(u=m(t,7,11);u;--u)f[s++]=0;break;default:f[s++]=d}}p(e,f,0,n),p(r,f,n,a)}function b(t,e,r){for(;;){var n,a,c,l,f=g(t,e);if(256===f)return 0;if(f<256)t.dest[t.destLen++]=f;else for(n=m(t,i[f-=257],o[f]),a=g(t,r),l=c=t.destLen-m(t,s[a],u[a]);l<c+n;++l)t.dest[t.destLen++]=t.dest[l]}}function S(t){for(var e,r;t.bitcount>8;)t.sourceIndex--,t.bitcount-=8;if((e=256*(e=t.source[t.sourceIndex+1])+t.source[t.sourceIndex])!==(65535&~(256*t.source[t.sourceIndex+3]+t.source[t.sourceIndex+2])))return-3;for(t.sourceIndex+=4,r=e;r;--r)t.dest[t.destLen++]=t.source[t.sourceIndex++];return t.bitcount=0,0}return function(t,e){var r;for(r=0;r<7;++r)t.table[r]=0;for(t.table[7]=24,t.table[8]=152,t.table[9]=112,r=0;r<24;++r)t.trans[r]=256+r;for(r=0;r<144;++r)t.trans[24+r]=r;for(r=0;r<8;++r)t.trans[168+r]=280+r;for(r=0;r<112;++r)t.trans[176+r]=144+r;for(r=0;r<5;++r)e.table[r]=0;for(e.table[5]=32,r=0;r<32;++r)e.trans[r]=r}(n,a),h(i,o,4,3),h(s,u,2,1),i[28]=0,o[28]=258,t.exports=function(t,e){var i,o,s=new r(t,e);do{switch(i=v(s),m(s,2,0)){case 0:o=S(s);break;case 1:o=b(s,n,a);break;case 2:y(s,s.ltree,s.dtree),o=b(s,s.ltree,s.dtree);break;default:o=-3}if(0!==o)throw new Error("Data error")}while(!i);return s.destLen<s.dest.length?"function"===typeof s.dest.slice?s.dest.slice(0,s.destLen):s.dest.subarray(0,s.destLen):s.dest},t.exports}();return function(e){return function(t,e){var r=new DataView(t),n=0;function a(){var t=r.getUint16(n);return n+=2,t}function i(){var t=r.getUint32(n);return n+=4,t}function o(t){y.setUint16(b,t),b+=2}function s(t){y.setUint32(b,t),b+=4}for(var u={signature:i(),flavor:i(),length:i(),numTables:a(),reserved:a(),totalSfntSize:i(),majorVersion:a(),minorVersion:a(),metaOffset:i(),metaLength:i(),metaOrigLength:i(),privOffset:i(),privLength:i()},c=0;Math.pow(2,c)<=u.numTables;)c++;c--;for(var l=16*Math.pow(2,c),f=16*u.numTables-l,h=12,d=[],p=0;p<u.numTables;p++)d.push({tag:i(),offset:i(),compLength:i(),origLength:i(),origChecksum:i()}),h+=16;var v,m=new Uint8Array(12+16*d.length+d.reduce((function(t,e){return t+e.origLength+4}),0)),g=m.buffer,y=new DataView(g),b=0;return s(u.flavor),o(u.numTables),o(l),o(c),o(f),d.forEach((function(t){s(t.tag),s(t.origChecksum),s(h),s(t.origLength),t.outOffset=h,(h+=t.origLength)%4!=0&&(h+=4-h%4)})),d.forEach((function(r){var n=t.slice(r.offset,r.offset+r.compLength);if(r.compLength!=r.origLength){var a=new Uint8Array(r.origLength);e(new Uint8Array(n,2),a)}else a=new Uint8Array(n);m.set(a,r.outOffset);var i=0;(h=r.outOffset+r.origLength)%4!=0&&(i=4-h%4),m.set(new Uint8Array(i).buffer,r.outOffset+r.origLength),v=h+i})),g.slice(0,v)}(e,t)}},function(t,e){var r={M:2,L:2,Q:4,C:6,Z:0};return function(n){var a=new Uint8Array(n,0,4),i=t._bin.readASCII(a,0,4);if("wOFF"===i)n=e(n);else if("wOF2"===i)throw new Error("woff2 fonts not supported");return function(e){var n=Object.create(null),a={unitsPerEm:e.head.unitsPerEm,ascender:e.hhea.ascender,descender:e.hhea.descender,forEachGlyph:function(i,o,s,u){var c=0,l=1/a.unitsPerEm*o,f=t.U.stringToGlyphs(e,i),h=0;return f.forEach((function(a){if(-1!==a){var f=n[a];if(!f){var d,p,v,m,g=t.U.glyphToPath(e,a),y=g.cmds,b=g.crds;if(b.length){d=p=1/0,v=m=-1/0;for(var S=0,x=b.length;S<x;S+=2){var U=b[S],w=b[S+1];U<d&&(d=U),w<p&&(p=w),U>v&&(v=U),w>m&&(m=w)}}else d=v=p=m=0;f=n[a]={index:a,advanceWidth:e.hmtx.aWidth[a],xMin:d,yMin:p,xMax:v,yMax:m,pathCommandCount:y.length,forEachPathCommand:function(t){for(var e=0,n=[],a=0,i=y.length;a<i;a++){var o=r[y[a]];n.length=1+o,n[0]=y[a];for(var s=1;s<=o;s++)n[s]=b[e++];t.apply(null,n)}}}}u.call(null,f,c,h),f.advanceWidth&&(c+=f.advanceWidth*l),s&&(c+=s*o)}h+=i.codePointAt(h)>65535?2:1})),c}};return a}(t.parse(n)[0])}}],init:function(t,e,r){return r(t(),e())}}),o={defaultFontURL:"https://fonts.gstatic.com/s/roboto/v18/KFOmCnqEu92Fr1Mu4mxM.woff",sdfGlyphSize:64,textureWidth:2048},s=new e.Color,u=Object.create(null);function c(t,r){if((t=l({},t)).font=(f=t.font||o.defaultFontURL,a||(a="undefined"===typeof document?{}:document.createElement("a")),a.href=f,a.href),t.text=""+t.text,t.sdfGlyphSize=t.sdfGlyphSize||o.sdfGlyphSize,null!=t.colorRanges){var n={};for(var i in t.colorRanges)if(t.colorRanges.hasOwnProperty(i)){var c=t.colorRanges[i];"number"!==typeof c&&(c=s.set(c).getHex()),n[i]=c}t.colorRanges=n}var f;Object.freeze(t);var d=o.textureWidth,p=t.sdfGlyphSize,v=t.font+"@"+p,m=u[v];m||((m=u[v]={sdfTexture:new e.DataTexture(new Uint8Array(p*d),d,p,e.LuminanceFormat,void 0,void 0,void 0,void 0,e.LinearFilter,e.LinearFilter)}).sdfTexture.font=t.font),h(t).then((function(e){e.newGlyphSDFs&&(e.newGlyphSDFs.forEach((function(t){for(var e=t.textureData,r=t.atlasIndex,n=m.sdfTexture.image;n.data.length<(r+1)*p*p;){var a=new Uint8Array(2*n.data.length);a.set(n.data),n.data=a,n.height*=2}for(var i=n.width/p,o=0;o<p;o++)for(var s=o*p,u=n.width*p*Math.floor(r/i)+r%i*p+o*n.width,c=0;c<p;c++)n.data[u+c]=e[s+c]})),m.sdfTexture.needsUpdate=!0),r(Object.freeze({parameters:t,sdfTexture:m.sdfTexture,sdfGlyphSize:p,sdfMinDistancePercent:1/8,glyphBounds:e.glyphBounds,glyphAtlasIndices:e.glyphAtlasIndices,glyphColors:e.glyphColors,caretPositions:e.caretPositions,caretHeight:e.caretHeight,chunkedBounds:e.chunkedBounds,ascender:e.ascender,descender:e.descender,lineHeight:e.lineHeight,topBaseline:e.topBaseline,totalBounds:e.totalBounds,totalBlockSize:e.totalBlockSize,timings:e.timings}))}))}function l(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);return t}var f=r.defineWorkerModule({name:"FontProcessor",dependencies:[o,1/8,i,function(t){var e=t.xMin,r=t.yMin,n=t.xMax-e,a=t.yMax-r,i={0:null,1:null,2:null,3:null,data:null,cx:Math.round(e+n/2),cy:Math.round(r+a/2),r:Math.pow(2,Math.floor(Math.log(Math.max(n,a))*Math.LOG2E)),minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};function o(t){!function t(e,r){if(!1!==r(e)&&!e.data)for(var n=0;n<4;n++)null!==e[n]&&t(e[n],r)}(i,t)}function s(t,e,r,n,a,i){var o=a-r,s=i-n,u=o*o+s*s,c=u?Math.max(0,Math.min(1,((t-r)*o+(e-n)*s)/u)):0,l=t-(r+c*o),f=e-(n+c*s);return l*l+f*f}return{addLineSegment:function(t,e,r,n){!function t(e,r){var n=e.minX,a=e.minY,i=e.maxX,o=e.maxY,s=e.cx,u=e.cy;n<r.minX&&(r.minX=n),a<r.minY&&(r.minY=a),i>r.maxX&&(r.maxX=i),o>r.maxY&&(r.maxY=o);var c=r.data;if(c)if(c.cx===s&&c.cy===u){for(;c.next;)c=c.next;c.next=e}else r.data=null,t(c,r),t(e,r);else{var l=(u<r.cy?0:2)+(s<r.cx?0:1);r[l]?t(e,r[l]):r[l]={0:null,1:null,2:null,3:null,data:e,cx:r.cx+r.r/2*(l%2?1:-1),cy:r.cy+r.r/2*(l<2?-1:1),r:r.r/2,minX:n,minY:a,maxX:i,maxY:o}}}({x0:t,y0:e,x1:r,y1:n,cx:(t+r)/2,cy:(e+n)/2,minX:Math.min(t,r),minY:Math.min(e,n),maxX:Math.max(t,r),maxY:Math.max(e,n),next:null},i)},findNearestSignedDistance:function(t,e,r){var n=r,a=n*n;return o((function(r){if(t-n>r.maxX||t+n<r.minX||e-n>r.maxY||e+n<r.minY)return!1;for(var i=r.data;i;i=i.next){var o=s(t,e,i.x0,i.y0,i.x1,i.y1);o<a&&(a=o,n=Math.sqrt(o))}})),function(t,e){var r=!1;return o((function(n){if(n.maxX<t||n.minY>e||n.maxY<e)return!1;for(var a=n.data;a;a=a.next){var i=a.x0,o=a.y0,s=a.x1,u=a.y1;o>e!==u>e&&t<(s-i)*(e-o)/(u-o)+i&&(r=!r)}})),r}(t,e)||(n=-n),n}}},function(t,e){var r=e.sdfDistancePercent;function n(t,e,r,n,a,i,o){var s=1-o;return{x:s*s*t+2*s*o*r+o*o*a,y:s*s*e+2*s*o*n+o*o*i}}function a(t,e,r,n,a,i,o,s,u){var c=1-u;return{x:c*c*c*t+3*c*c*u*r+3*c*u*u*a+u*u*u*o,y:c*c*c*e+3*c*c*u*n+3*c*u*u*i+u*u*u*s}}return function(e,i){var o=new Uint8Array(i*i),s=e.xMax-e.xMin,u=e.yMax-e.yMin,c=Math.max(s,u)*r,l=(s+2*c)/i,f=(u+2*c)/i,h=e.xMin-c-l,d=e.yMin-c-f,p=e.xMax+c+l,v=e.yMax+c+f;if(e.pathCommandCount){var m,g,y,b,S=t(e);e.forEachPathCommand((function(t,e,r,i,o,s,u){switch(t){case"M":y=m=e,b=g=r;break;case"L":e===y&&r===b||S.addLineSegment(y,b,y=e,b=r);break;case"Q":for(var c={x:y,y:b},l=1;l<16;l++){var f=n(y,b,e,r,i,o,l/15);S.addLineSegment(c.x,c.y,f.x,f.y),c=f}y=i,b=o;break;case"C":for(var h={x:y,y:b},d=1;d<16;d++){var p=a(y,b,e,r,i,o,s,u,d/15);S.addLineSegment(h.x,h.y,p.x,p.y),h=p}y=s,b=u;break;case"Z":y===m&&b===g||S.addLineSegment(y,b,m,g)}}));for(var x=0;x<i;x++)for(var U=0;U<i;U++){var w=S.findNearestSignedDistance(h+(p-h)*(x+.5)/i,d+(v-d)*(U+.5)/i,c),_=isFinite(w)?Math.round(255*(1+w/c)*.5):w;_=Math.max(0,Math.min(255,_)),o[U*i+x]=_}}return{textureData:o,renderingBounds:[h,d,p,v]}}},function(t,e,r){var n=r.defaultFontUrl,a=Object.create(null),i=Object.create(null);function o(e,r){e||(e=n);var a=i[e];a?a.pending?a.pending.push(r):r(a):(i[e]={pending:[r]},function(e,r){!function a(){var i=function(t){console.error("Failure loading font "+e+(e===n?"":"; trying fallback"),t),e!==n&&(e=n,a())};try{var o=new XMLHttpRequest;o.open("get",e,!0),o.responseType="arraybuffer",o.onload=function(){if(o.status>=400)i(new Error(o.statusText));else if(o.status>0)try{var e=t(o.response);r(e)}catch(n){i(n)}},o.onerror=i,o.send()}catch(s){i(s)}}()}(e,(function(t){var r=i[e].pending;i[e]=t,r.forEach((function(e){return e(t)}))})))}function s(t,r,i){var s=t.text;void 0===s&&(s="");var f=t.font;void 0===f&&(f=n);var h=t.sdfGlyphSize;void 0===h&&(h=64);var d=t.fontSize;void 0===d&&(d=1);var p=t.letterSpacing;void 0===p&&(p=0);var v=t.lineHeight;void 0===v&&(v="normal");var m=t.maxWidth;void 0===m&&(m=1/0);var g=t.textAlign;void 0===g&&(g="left");var y=t.textIndent;void 0===y&&(y=0);var b=t.whiteSpace;void 0===b&&(b="normal");var S=t.overflowWrap;void 0===S&&(S="normal");var x=t.anchorX;void 0===x&&(x=0);var U=t.anchorY;void 0===U&&(U=0);var w=t.includeCaretPositions;void 0===w&&(w=!1);var _=t.chunkedBoundsSize;void 0===_&&(_=8192);var T=t.colorRanges;void 0===T&&(T=null),void 0===i&&(i=!1);var M=c(),k={total:0,fontLoad:0,layout:0,sdf:{},sdfTotal:0};s.indexOf("\r")>-1&&(console.warn("FontProcessor.process: got text with \\r chars; normalizing to \\n"),s=s.replace(/\r\n/g,"\n").replace(/\r/g,"\n")),d=+d,p=+p,m=+m,v=v||"normal",y=+y,function(t,e,r){t||(t=n);var i=t+"@"+e,s=a[i];s?r(s):o(t,(function(t){s=a[i]||(a[i]={fontObj:t,glyphs:{},glyphCount:0}),r(s)}))}(f,h,(function(t){var n=t.fontObj,a=isFinite(m),o=null,f=null,C=null,F=null,O=null,A=null,D=null,P=0,E=0,I="nowrap"!==b,B=n.ascender,L=n.descender,G=n.unitsPerEm;k.fontLoad=c()-M;var z=c(),R=d/G;"normal"===v&&(v=(B-L)/G);var j=((v*=d)-(B-L)*R)/2,V=-(d+j),N=Math.min(v,(B-L)*R),W=(B+L)/2*R-N/2,H=y,Y=new l,X=[Y];if(n.forEachGlyph(s,d,p,(function(t,e,r){var n,i=s.charAt(r),o=t.advanceWidth*R,u=Y.count;if("isEmpty"in t||(t.isWhitespace=!!i&&/\s/.test(i),t.isEmpty=t.xMin===t.xMax||t.yMin===t.yMax),t.isWhitespace||t.isEmpty||E++,I&&a&&!t.isWhitespace&&e+o+H>m&&u){if(Y.glyphAt(u-1).glyphObj.isWhitespace)n=new l,H=-e;else for(var c=u;c--;){if(0===c&&"break-word"===S){n=new l,H=-e;break}if(Y.glyphAt(c).glyphObj.isWhitespace){var f=(n=Y.splitAt(c+1)).glyphAt(0).x;H-=f;for(var h=n.count;h--;)n.glyphAt(h).x-=f;break}}n&&(Y.isSoftWrapped=!0,Y=n,X.push(Y),P=m)}var v=Y.glyphAt(Y.count);v.glyphObj=t,v.x=e+H,v.width=o,v.charIndex=r,"\n"===i&&(Y=new l,X.push(Y),H=-(e+o+p*d)+y)})),X.forEach((function(t){for(var e=t.count;e--;){var r=t.glyphAt(e),n=r.glyphObj,a=r.x,i=r.width;if(!n.isWhitespace)return t.width=a+i,void(t.width>P&&(P=t.width))}})),!i){var Z=0,q=0;if(x&&("number"===typeof x?Z=-x:"string"===typeof x&&(Z=-P*("left"===x?0:"center"===x?.5:"right"===x?1:u(x)))),U)if("number"===typeof U)q=-U;else if("string"===typeof U){var K=X.length*v;q="top"===U?0:"top-baseline"===U?-V:"middle"===U?K/2:"bottom"===U?K:"bottom-baseline"===U?K-j+L*R:u(U)*K}f=new Float32Array(4*E),C=new Float32Array(E),A=[1/0,1/0,-1/0,-1/0],D=[];var Q=V;w&&(O=new Float32Array(3*s.length)),T&&(F=new Uint8Array(3*E));var $,J,tt=0,et=-1,rt=-1;X.forEach((function(r){var n=r.count,a=r.width;if(n>0){var i=0,u=0;if("center"===g)i=(P-a)/2;else if("right"===g)i=P-a;else if("justify"===g&&r.isSoftWrapped){for(var l=0,d=n;d--;)if(!r.glyphAt(d).glyphObj.isWhitespace){for(;d--;)r.glyphAt(d).glyphObj,r.glyphAt(d).glyphObj.isWhitespace&&l++;break}u=(P-a)/l}for(var p=0;p<n;p++){var m=r.glyphAt(p),y=m.glyphObj;if(i&&(m.x+=i),0!==u&&y.isWhitespace&&(i+=u,m.width+=u),w){var b=m.charIndex;for(O[3*b]=m.x+Z,O[3*b+1]=m.x+m.width+Z,O[3*b+2]=Q+W+q;b-et>1;)O[3*(et+1)]=O[3*et+1],O[3*(et+1)+1]=O[3*et+1],O[3*(et+1)+2]=O[3*et+2],et++;et=b}if(T)for(var S=m.charIndex;S>rt;)rt++,T.hasOwnProperty(rt)&&(J=T[rt]);if(!y.isWhitespace&&!y.isEmpty){var x=tt++,U=t.glyphs[y.index];if(!U){var M=c(),E=e(y,h);k.sdf[s.charAt(m.charIndex)]=c()-M,E.atlasIndex=t.glyphCount++,o||(o=[]),o.push(E),U=t.glyphs[y.index]={atlasIndex:E.atlasIndex,glyphObj:y,renderingBounds:E.renderingBounds}}var I=U.renderingBounds,B=4*x,L=f[B]=m.x+I[0]*R+Z,G=f[B+1]=Q+I[1]*R+q,z=f[B+2]=m.x+I[2]*R+Z,j=f[B+3]=Q+I[3]*R+q;if(L<A[0]&&(A[0]=L),G<A[1]&&(A[1]=G),z>A[2]&&(A[2]=z),j>A[3]&&(A[3]=j),x%_===0&&($={start:x,end:x,rect:[1/0,1/0,-1/0,-1/0]},D.push($)),$.end++,L<$.rect[0]&&($.rect[0]=L),G<$.rect[1]&&($.rect[1]=G),z>$.rect[2]&&($.rect[2]=z),j>$.rect[3]&&($.rect[3]=j),C[x]=U.atlasIndex,T){var V=3*x;F[V]=J>>16&255,F[V+1]=J>>8&255,F[V+2]=255&J}}}}Q-=v}))}for(var nt in k.sdf)k.sdfTotal+=k.sdf[nt];k.layout=c()-z-k.sdfTotal,k.total=c()-M,r({glyphBounds:f,glyphAtlasIndices:C,caretPositions:O,caretHeight:N,glyphColors:F,chunkedBounds:D,ascender:B*R,descender:L*R,lineHeight:v,topBaseline:V,totalBounds:A,totalBlockSize:[P,X.length*v],newGlyphSDFs:o,timings:k})}))}function u(t){var e=t.match(/^([\d.]+)%$/),r=e?parseFloat(e[1]):NaN;return isNaN(r)?0:r/100}function c(){return(self.performance||Date).now()}function l(){this.data=[]}return l.prototype={width:0,isSoftWrapped:!1,get count(){return Math.ceil(this.data.length/4)},glyphAt:function(t){var e=l.flyweight;return e.data=this.data,e.index=t,e},splitAt:function(t){var e=new l;return e.data=this.data.splice(4*t),e}},l.flyweight=["glyphObj","x","width","charIndex"].reduce((function(t,e,r,n){return Object.defineProperty(t,e,{get:function(){return this.data[4*this.index+r]},set:function(t){this.data[4*this.index+r]=t}}),t}),{data:null,index:0}),{process:s,measure:function(t,e){s(t,(function(t){e({width:t.totalBlockSize[0],height:t.totalBlockSize[1]})}),{metricsOnly:!0})},loadFont:o}}],init:function(t,e,r,n,a,i){return i(r,a(n,{sdfDistancePercent:e}),{defaultFontUrl:t.defaultFontURL})}}),h=r.defineWorkerModule({name:"TextBuilder",dependencies:[f,r.ThenableWorkerModule],init:function(t,e){return function(r){var n=new e;return t.process(r,n.resolve),n}},getTransferables:function(t){var e=[t.glyphBounds.buffer,t.glyphAtlasIndices.buffer];return t.caretPositions&&e.push(t.caretPositions.buffer),t.newGlyphSDFs&&t.newGlyphSDFs.forEach((function(t){e.push(t.textureData.buffer)})),e}}),d={},p=new e.Vector3,v=function(t){function r(){t.call(this),this.detail=1,this.boundingSphere=new e.Sphere,this.boundingBox=new e.Box3}t&&(r.__proto__=t),r.prototype=Object.create(t&&t.prototype),r.prototype.constructor=r;var n={detail:{configurable:!0}};return r.prototype.computeBoundingSphere=function(){},r.prototype.computeBoundingBox=function(){},n.detail.set=function(t){var r=this;if(t!==this._detail){this._detail=t,("number"!==typeof t||t<1)&&(t=1);var n=function(t){var r=d[t];return r||(r=d[t]=new e.PlaneBufferGeometry(1,1,t,t).translate(.5,.5,0)),r}(t);["position","normal","uv"].forEach((function(t){r.attributes[t]=n.attributes[t].clone()})),this.setIndex(n.getIndex().clone())}},n.detail.get=function(){return this._detail},r.prototype.updateGlyphs=function(t,e,r,n,a){m(this,"aTroikaGlyphBounds",t,4),m(this,"aTroikaGlyphIndex",e,1),m(this,"aTroikaGlyphColor",a,3),this._chunkedBounds=n,g(this,e.length);var i=this.boundingSphere;i.center.set((r[0]+r[2])/2,(r[1]+r[3])/2,0),i.radius=i.center.distanceTo(p.set(r[0],r[1],0));var o=this.boundingBox;o.min.set(r[0],r[1],0),o.max.set(r[2],r[3],0)},r.prototype.applyClipRect=function(t){var e=this.getAttribute("aTroikaGlyphIndex").count,r=this._chunkedBounds;if(r)for(var n=r.length;n--;){e=r[n].end;var a=r[n].rect;if(a[1]<t.w&&a[3]>t.y&&a[0]<t.z&&a[2]>t.x)break}g(this,e)},Object.defineProperties(r.prototype,n),r}(e.InstancedBufferGeometry);function m(t,r,n,a){var i=t.getAttribute(r);n?i&&i.array.length===n.length?(i.array.set(n),i.needsUpdate=!0):(t.setAttribute(r,new e.InstancedBufferAttribute(n,a)),delete t._maxInstanceCount,t.dispose()):i&&t.deleteAttribute(r)}function g(t,e){t[t.hasOwnProperty("instanceCount")?"instanceCount":"maxInstancedCount"]=e}function y(t){var r=n.createDerivedMaterial(t,{extensions:{derivatives:!0},uniforms:{uTroikaSDFTexture:{value:null},uTroikaSDFTextureSize:{value:new e.Vector2},uTroikaSDFGlyphSize:{value:0},uTroikaSDFMinDistancePct:{value:0},uTroikaTotalBounds:{value:new e.Vector4(0,0,0,0)},uTroikaClipRect:{value:new e.Vector4(0,0,0,0)},uTroikaOrient:{value:new e.Matrix3},uTroikaUseGlyphColors:{value:!0},uTroikaSDFDebug:{value:!1}},vertexDefs:"\nuniform vec2 uTroikaSDFTextureSize;\nuniform float uTroikaSDFGlyphSize;\nuniform vec4 uTroikaTotalBounds;\nuniform vec4 uTroikaClipRect;\nuniform mat3 uTroikaOrient;\nuniform bool uTroikaUseGlyphColors;\nattribute vec4 aTroikaGlyphBounds;\nattribute float aTroikaGlyphIndex;\nattribute vec3 aTroikaGlyphColor;\nvarying vec2 vTroikaSDFTextureUV;\nvarying vec2 vTroikaGlyphUV;\nvarying vec3 vTroikaGlyphColor;\n",vertexTransform:"\nvec4 bounds = aTroikaGlyphBounds;\nvec4 clippedBounds = vec4(\n  clamp(bounds.xy, uTroikaClipRect.xy, uTroikaClipRect.zw),\n  clamp(bounds.zw, uTroikaClipRect.xy, uTroikaClipRect.zw)\n);\nvec2 clippedXY = (mix(clippedBounds.xy, clippedBounds.zw, position.xy) - bounds.xy) / (bounds.zw - bounds.xy);\nvTroikaGlyphUV = clippedXY.xy;\n\nfloat cols = uTroikaSDFTextureSize.x / uTroikaSDFGlyphSize;\nvTroikaSDFTextureUV = vec2(\n  mod(aTroikaGlyphIndex, cols) + clippedXY.x,\n  floor(aTroikaGlyphIndex / cols) + clippedXY.y\n) * uTroikaSDFGlyphSize / uTroikaSDFTextureSize;\n\nposition.xy = mix(bounds.xy, bounds.zw, clippedXY);\n\nuv = vec2(\n  (position.x - uTroikaTotalBounds.x) / (uTroikaTotalBounds.z - uTroikaTotalBounds.x),\n  (position.y - uTroikaTotalBounds.y) / (uTroikaTotalBounds.w - uTroikaTotalBounds.y)\n);\n\nposition = uTroikaOrient * position;\nnormal = uTroikaOrient * normal;\n",fragmentDefs:"\nuniform sampler2D uTroikaSDFTexture;\nuniform float uTroikaSDFMinDistancePct;\nuniform bool uTroikaSDFDebug;\nvarying vec2 vTroikaSDFTextureUV;\nvarying vec2 vTroikaGlyphUV;\n\nfloat troikaGetTextAlpha() {\n  float troikaSDFValue = texture2D(uTroikaSDFTexture, vTroikaSDFTextureUV).r;\n  \n  #if defined(IS_DEPTH_MATERIAL) || defined(IS_DISTANCE_MATERIAL)\n  float alpha = step(0.5, troikaSDFValue);\n  #else\n  \n  #if defined(GL_OES_standard_derivatives) || __VERSION__ >= 300\n  float aaDist = min(\n    0.5,\n    0.5 * min(\n      fwidth(vTroikaGlyphUV.x),\n      fwidth(vTroikaGlyphUV.y)\n    )\n  ) / uTroikaSDFMinDistancePct;\n  #else\n  float aaDist = 0.01;\n  #endif\n  \n  float alpha = uTroikaSDFDebug ? troikaSDFValue : smoothstep(\n    0.5 - aaDist,\n    0.5 + aaDist,\n    troikaSDFValue\n  );\n  #endif\n  \n  return alpha;\n}\n",fragmentColorTransform:"\nfloat troikaAlphaMult = troikaGetTextAlpha();\nif (troikaAlphaMult == 0.0) {\n  discard;\n} else {\n  gl_FragColor.a *= troikaAlphaMult;\n}\n",customRewriter:function(t){var e=t.vertexShader,r=t.fragmentShader,a=/\buniform\s+vec3\s+diffuse\b/;return a.test(r)&&(r=r.replace(a,"varying vec3 vTroikaGlyphColor").replace(/\bdiffuse\b/g,"vTroikaGlyphColor"),a.test(e)||(e=e.replace(n.voidMainRegExp,"uniform vec3 diffuse;\n$&\nvTroikaGlyphColor = uTroikaUseGlyphColors ? aTroikaGlyphColor / 255.0 : diffuse;\n"))),{vertexShader:e,fragmentShader:r}}});return r.transparent=!0,Object.defineProperties(r,{isTroikaTextMaterial:{value:!0},shadowSide:{get:function(){return this.side},set:function(){}}}),r}v.prototype.setAttribute||(v.prototype.setAttribute=function(t,e){return this.attributes[t]=e,this});var b=new e.MeshBasicMaterial({color:16777215,side:e.DoubleSide,transparent:!0}),S=new e.Matrix4,x=new e.Vector3,U=new e.Vector3,w=[],_=new e.Vector3,T=new e.Mesh(new e.PlaneBufferGeometry(1,1).translate(.5,.5,0),b),M={type:"syncstart"},k={type:"synccomplete"},C=["font","fontSize","letterSpacing","lineHeight","maxWidth","overflowWrap","text","textAlign","textIndent","whiteSpace","anchorX","anchorY","colorRanges","sdfGlyphSize"],F=C.concat("material","color","depthOffset","clipRect","orientation","glyphGeometryDetail"),O=function(t){function e(){var e=new v;t.call(this,e,null),this.text="",this.anchorX=0,this.anchorY=0,this.font=null,this.fontSize=.1,this.letterSpacing=0,this.lineHeight="normal",this.maxWidth=1/0,this.overflowWrap="normal",this.textAlign="left",this.textIndent=0,this.whiteSpace="normal",this.material=null,this.color=null,this.colorRanges=null,this.depthOffset=0,this.clipRect=null,this.orientation="+x+y",this.glyphGeometryDetail=1,this.sdfGlyphSize=null,this.debugSDF=!1}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var r={textRenderInfo:{configurable:!0},material:{configurable:!0},glyphGeometryDetail:{configurable:!0},customDepthMaterial:{configurable:!0},customDistanceMaterial:{configurable:!0}};return e.prototype.sync=function(t){var e=this;this._needsSync&&(this._needsSync=!1,this._isSyncing?(this._queuedSyncs||(this._queuedSyncs=[])).push(t):(this._isSyncing=!0,this.dispatchEvent(M),c({text:this.text,font:this.font,fontSize:this.fontSize||.1,letterSpacing:this.letterSpacing||0,lineHeight:this.lineHeight||"normal",maxWidth:this.maxWidth,textAlign:this.textAlign,textIndent:this.textIndent,whiteSpace:this.whiteSpace,overflowWrap:this.overflowWrap,anchorX:this.anchorX,anchorY:this.anchorY,colorRanges:this.colorRanges,includeCaretPositions:!0,sdfGlyphSize:this.sdfGlyphSize},(function(r){e._isSyncing=!1,e._textRenderInfo=r,e.geometry.updateGlyphs(r.glyphBounds,r.glyphAtlasIndices,r.totalBounds,r.chunkedBounds,r.glyphColors);var n=e._queuedSyncs;n&&(e._queuedSyncs=null,e._needsSync=!0,e.sync((function(){n.forEach((function(t){return t&&t()}))}))),e.dispatchEvent(k),t&&t()}))))},e.prototype.onBeforeRender=function(){this.sync(),this._prepareForRender()},e.prototype.dispose=function(){this.geometry.dispose()},r.textRenderInfo.get=function(){return this._textRenderInfo||null},r.material.get=function(){var t=this._derivedMaterial,e=this._baseMaterial||b;return t&&t.baseMaterial===e||(t=this._derivedMaterial=y(e),e.addEventListener("dispose",(function r(){e.removeEventListener("dispose",r),t.dispose()}))),t},r.material.set=function(t){t&&t.isTroikaTextMaterial?(this._derivedMaterial=t,this._baseMaterial=t.baseMaterial):this._baseMaterial=t},r.glyphGeometryDetail.get=function(){return this.geometry.detail},r.glyphGeometryDetail.set=function(t){this.geometry.detail=t},r.customDepthMaterial.get=function(){return this.material.getDepthMaterial()},r.customDistanceMaterial.get=function(){return this.material.getDistanceMaterial()},e.prototype._prepareForRender=function(){var t=this._derivedMaterial,e=t.uniforms,r=this.textRenderInfo;if(r){var n=r.sdfTexture,a=r.totalBounds;e.uTroikaSDFTexture.value=n,e.uTroikaSDFTextureSize.value.set(n.image.width,n.image.height),e.uTroikaSDFGlyphSize.value=r.sdfGlyphSize,e.uTroikaSDFMinDistancePct.value=r.sdfMinDistancePercent,e.uTroikaTotalBounds.value.fromArray(a),e.uTroikaUseGlyphColors.value=!!r.glyphColors;var i=this.clipRect;i&&Array.isArray(i)&&4===i.length?e.uTroikaClipRect.value.set(Math.max(a[0],i[0]),Math.max(a[1],i[1]),Math.min(a[2],i[2]),Math.min(a[3],i[3])):e.uTroikaClipRect.value.fromArray(a),this.geometry.applyClipRect(e.uTroikaClipRect.value)}e.uTroikaSDFDebug.value=!!this.debugSDF,t.polygonOffset=!!this.depthOffset,t.polygonOffsetFactor=t.polygonOffsetUnits=this.depthOffset||0;var o=this.color;null!=o&&t.color&&t.color.isColor&&o!==t._troikaColor&&t.color.set(t._troikaColor=o);var s=this.orientation||"+x+y";if(s!==t._orientation){var u=e.uTroikaOrient.value,c="+x+y"!==(s=s.replace(/[^-+xyz]/g,""))&&s.match(/^([-+])([xyz])([-+])([xyz])$/);if(c){var l=c[1],f=c[2],h=c[3],d=c[4];x.set(0,0,0)[f]="-"===l?1:-1,U.set(0,0,0)[d]="-"===h?-1:1,S.lookAt(_,x.cross(U),U),u.setFromMatrix4(S)}else u.identity();t._orientation=s}},e.prototype.raycast=function(t,e){var r=this.textRenderInfo;if(r){var n=r.totalBounds;T.matrixWorld.multiplyMatrices(this.matrixWorld,S.set(n[2]-n[0],0,0,n[0],0,n[3]-n[1],0,n[1],0,0,1,0,0,0,0,1)),w.length=0,T.raycast(t,w);for(var a=0;a<w.length;a++)w[a].object=this,e.push(w[a])}},e.prototype.copy=function(e){var r=this;return t.prototype.copy.call(this,e),F.forEach((function(t){r[t]=e[t]})),this},e.prototype.clone=function(){return(new this.constructor).copy(this)},Object.defineProperties(e.prototype,r),e}(e.Mesh);C.forEach((function(t){var e="_private_"+t;Object.defineProperty(O.prototype,t,{get:function(){return this[e]},set:function(t){t!==this[e]&&(this[e]=t,this._needsSync=!0)}})}));var A=!1;Object.defineProperty(O.prototype,"anchor",{get:function(){return this._deprecated_anchor},set:function(t){this._deprecated_anchor=t,A||(console.warn("TextMesh: `anchor` has been deprecated; use `anchorX` and `anchorY` instead."),A=!0),Array.isArray(t)?(this.anchorX=100*(+t[0]||0)+"%",this.anchorY=100*(+t[1]||0)+"%"):this.anchorX=this.anchorY=0}});var D=new WeakMap,P=new WeakMap;t.GlyphsGeometry=v,t.Text=O,t.configureTextBuilder=function(t){l(o,t)},t.createTextDerivedMaterial=y,t.fontProcessorWorkerModule=f,t.getCaretAtPoint=function(t,e,r){var n=null,a=t.caretHeight,i=function(t){var e=P.get(t);if(!e){var r=t.caretPositions,n=t.caretHeight;e=new Map;for(var a=0;a<r.length;a+=3){var i=r[a+2],o=e.get(i);o||e.set(i,o=[]),o.push({x:r[a],y:i,height:n,charIndex:a/3}),a+3>=r.length&&o.push({x:r[a+1],y:i,height:n,charIndex:a/3+1})}}return P.set(t,e),e}(t),o=1/0;return i.forEach((function(t,e){Math.abs(r-(e+a/2))<Math.abs(r-(o+a/2))&&(o=e)})),i.get(o).forEach((function(t){(!n||Math.abs(e-t.x)<Math.abs(e-n.x))&&(n=t)})),n},t.getSelectionRects=function(t,e,r){var n;if(t){var a=D.get(t);if(a&&a.start===e&&a.end===r)return a.rects;var i=t.caretPositions,o=t.caretHeight,s=t.totalBounds;if(r<e){var u=e;e=r,r=u}e=Math.max(e,0),r=Math.min(r,i.length+1);for(var c=new Map,l=e;l<r;l++){var f=i[3*l],h=i[3*l+1],d=i[3*l+2],p=c.get(d);p?(p.left=Math.max(Math.min(p.left,f),s[0]),p.right=Math.min(Math.max(p.right,h),s[2])):(p={left:f,right:h,bottom:d,top:d+o},c.set(d,p))}n=[],c.forEach((function(t){n.push(t)})),D.set(t,{start:e,end:r,rects:n})}return n},t.preloadFont=function(t,e){var r=t.font,n=t.characters;c({font:r,sdfGlyphSize:t.sdfGlyphSize,text:Array.isArray(n)?n.join("\n"):""+n},e)},Object.defineProperty(t,"__esModule",{value:!0})}(e,r(72),r(251),r(252))},251:function(t,e,r){!function(t){"use strict";function e(){var t,r=0,n=[],a=0,i=0,o=d((function(t){i||u(1,t)})),s=d((function(t){i||u(-1,t)}));function u(e,n){i++;var a=0;try{n===m&&p();var o=e>0&&h(n);o?o.call(n,d((function(t){a++,u(1,t)})),d((function(t){a++,u(-1,t)}))):(r=e,t=n,c())}catch(s){r||a||u(-1,s)}}function c(){a||(setTimeout(l,0),a=1)}function l(){var t=n;a=0,n=[],t.forEach(f)}function f(t){t()}function h(t){var e=t&&(v(t)||"object"===typeof t)&&t.then;return v(e)&&e}function d(t){var e=0;return function(){for(var r=[],n=arguments.length;n--;)r[n]=arguments[n];e++||t.apply(this,r)}}function p(){throw new TypeError("Chaining cycle detected")}var v=function(t){return"function"===typeof t},m={then:function(a,i){var o=e();return n.push((function(){var e=r>0?a:i;if(v(e))try{var n=e(t);n===o&&p();var s=h(n);s?s.call(n,o.resolve,o.reject):o.resolve(n)}catch(u){o.reject(u)}else o[r>0?"resolve":"reject"](t)})),r&&c(),o},resolve:o,reject:s};return m}function r(){var t,e,r=new Promise((function(r,n){t=r,e=n}));return{then:r.then.bind(r),resolve:t,reject:e}}e.all=r.all=function(t){var e=0,r=[],a=n();return 0===t.length?a.resolve([]):t.forEach((function(i,o){var s=n();s.resolve(i),s.then((function(n){e++,r[o]=n,e===t.length&&a.resolve(r)}),a.reject)})),a};var n="function"===typeof Promise?r:e;function a(){var t=Object.create(null);function e(t,e){var r=void 0;self.troikaDefine=function(t){return r=t};var n=URL.createObjectURL(new Blob(["/** "+t.replace(/\*/g,"")+" **/\n\ntroikaDefine(\n"+e+"\n)"],{type:"application/javascript"}));try{importScripts(n)}catch(a){console.error(a)}return URL.revokeObjectURL(n),delete self.troikaDefine,r}self.addEventListener("message",(function(r){var n=r.data,a=n.messageId,i=n.action,o=n.data;try{"registerModule"===i&&function r(n,a){var i=n.id,o=n.name,s=n.dependencies;void 0===s&&(s=[]);var u=n.init;void 0===u&&(u=function(){});var c=n.getTransferables;if(void 0===c&&(c=null),!t[i])try{s=s.map((function(e){return e&&e.isWorkerModule&&(r(e,(function(t){if(t instanceof Error)throw t})),e=t[e.id].value),e})),u=e("<"+o+">.init",u),c&&(c=e("<"+o+">.getTransferables",c));var l=null;"function"===typeof u?l=u.apply(void 0,s):console.error("worker module init function failed to rehydrate"),t[i]={id:i,value:l,getTransferables:c},a(l)}catch(f){f&&f.noLog||console.error(f),a(f)}}(o,(function(t){t instanceof Error?postMessage({messageId:a,success:!1,error:t.message}):postMessage({messageId:a,success:!0,result:{isCallable:"function"===typeof t}})})),"callModule"===i&&function(e,r){var n,a=e.id,i=e.args;t[a]&&"function"===typeof t[a].value||r(new Error("Worker module "+a+": not found or its 'init' did not return a function"));try{var o=(n=t[a]).value.apply(n,i);o&&"function"===typeof o.then?o.then(s,(function(t){return r(t instanceof Error?t:new Error(""+t))})):s(o)}catch(u){r(u)}function s(e){try{var n=t[a].getTransferables&&t[a].getTransferables(e);n&&Array.isArray(n)&&n.length||(n=void 0),r(e,n)}catch(u){console.error(u),r(u)}}}(o,(function(t,e){t instanceof Error?postMessage({messageId:a,success:!1,error:t.message}):postMessage({messageId:a,success:!0,result:t},e||void 0)}))}catch(s){postMessage({messageId:a,success:!1,error:s.stack})}}))}var i=function(){var t=!1;if("undefined"!==typeof window&&"undefined"!==typeof window.document)try{new Worker(URL.createObjectURL(new Blob([""],{type:"application/javascript"}))).terminate(),t=!0}catch(e){console.log("Troika createWorkerModule: web workers not allowed; falling back to main thread execution. Cause: ["+e.message+"]")}return i=function(){return t},t},o=0,s=0,u=!1,c=Object.create(null),l=Object.create(null);function f(t){if((!t||"function"!==typeof t.init)&&!u)throw new Error("requires `options.init` function");var e=t.dependencies,r=t.init,a=t.getTransferables,s=t.workerId;if(!i())return function(t){var e=function t(){for(var e=[],r=arguments.length;r--;)e[r]=arguments[r];return t._getInitResult().then((function(t){if("function"===typeof t)return t.apply(void 0,e);throw new Error("Worker module function was called but `init` did not return a callable function")}))};return e._getInitResult=function(){var r=t.dependencies,a=t.init;r=Array.isArray(r)?r.map((function(t){return t&&t._getInitResult?t._getInitResult():t})):[];var i=n.all(r).then((function(t){return a.apply(null,t)}));return e._getInitResult=function(){return i},i},e}(t);null==s&&(s="#default");var c="workerModule"+ ++o,l=t.name||c,p=null;function v(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return p||(p=d(s,"registerModule",v.workerModuleData)),p.then((function(e){if(e.isCallable)return d(s,"callModule",{id:c,args:t});throw new Error("Worker module function was called but `init` did not return a callable function")}))}return e=e&&e.map((function(t){return"function"!==typeof t||t.workerModuleData||(u=!0,t=f({workerId:s,name:"<"+l+"> function dependency: "+t.name,init:"function(){return (\n"+h(t)+"\n)}"}),u=!1),t&&t.workerModuleData&&(t=t.workerModuleData),t})),v.workerModuleData={isWorkerModule:!0,id:c,name:l,dependencies:e,init:h(r),getTransferables:a&&h(a)},v}function h(t){var e=t.toString();return!/^function/.test(e)&&/^\w+\s*\(/.test(e)&&(e="function "+e),e}function d(t,e,r){var i=n(),o=++s;return l[o]=function(t){t.success?i.resolve(t.result):i.reject(new Error("Error in worker "+e+" call: "+t.error))},l._count++,l.count>1e3&&console.warn("Large number of open WorkerModule requests, some may not be returning"),function(t){var e=c[t];if(!e){var r=h(a);(e=c[t]=new Worker(URL.createObjectURL(new Blob(["/** Worker Module Bootstrap: "+t.replace(/\*/g,"")+" **/\n\n;("+r+")()"],{type:"application/javascript"})))).onmessage=function(t){var e=t.data,r=e.messageId,n=l[r];if(!n)throw new Error("WorkerModule response with empty or unknown messageId");delete l[r],l.count--,n(e)}}return e}(t).postMessage({messageId:o,action:e,data:r}),i}l._count=0;var p=f({name:"Thenable",dependencies:[n],init:function(t){return t}});t.Thenable=n,t.ThenableWorkerModule=p,t.defineWorkerModule=f,t.stringifyFunction=h,Object.defineProperty(t,"__esModule",{value:!0})}(e)},252:function(t,e,r){!function(t,e){"use strict";var r=/\bvoid\s+main\s*\(\s*\)\s*{/g;function n(t){return t.replace(/^[ \t]*#include +<([\w\d./]+)>/gm,(function(t,r){var a=e.ShaderChunk[r];return a?n(a):t}))}var a=Object.assign||function(){for(var t=arguments,e=arguments[0],r=1,n=arguments.length;r<n;r++){var a=t[r];if(a)for(var i in a)a.hasOwnProperty(i)&&(e[i]=a[i])}return e},i=Date.now(),o=new WeakMap;function s(t,r){var h=function(t){return JSON.stringify(t,c)}(r),d=o.get(t);if(d||(d=Object.create(null),o.set(t,d)),d[h])return d[h].clone();var p,v,m=function(t){var e=f.get(t);return null==e&&f.set(t,e=++l),e}(h),g="_derivedShaders"+m,y="_onBeforeCompile"+m;function b(e){t.onBeforeCompile.call(this,e);var o=this[g]||(this[g]={vertex:{},fragment:{}}),s=o.vertex,c=o.fragment;if(s.source!==e.vertexShader||c.source!==e.fragmentShader){var l=function(t,e,r){var a=t.vertexShader,i=t.fragmentShader,o=e.vertexDefs,s=e.vertexMainIntro,c=e.vertexMainOutro,l=e.vertexTransform,f=e.fragmentDefs,h=e.fragmentMainIntro,d=e.fragmentMainOutro,p=e.fragmentColorTransform,v=e.customRewriter,m=e.timeUniform;if(o=o||"",s=s||"",c=c||"",f=f||"",h=h||"",d=d||"",(l||v)&&(a=n(a)),(p||v)&&(i=n(i=i.replace(/^[ \t]*#include <((?:tonemapping|encodings|fog|premultiplied_alpha|dithering)_fragment)>/gm,"\n//!BEGIN_POST_CHUNK $1\n$&\n//!END_POST_CHUNK\n"))),v){var g=v({vertexShader:a,fragmentShader:i});a=g.vertexShader,i=g.fragmentShader}if(p){var y=[];i=i.replace(/^\/\/!BEGIN_POST_CHUNK[^]+?^\/\/!END_POST_CHUNK/gm,(function(t){return y.push(t),""})),d=p+"\n"+y.join("\n")+"\n"+d}if(m){var b="\nuniform float "+m+";\n";o=b+o,f=b+f}return l&&(o=o+"\nvec3 troika_position_"+r+";\nvec3 troika_normal_"+r+";\nvec2 troika_uv_"+r+";\nvoid troikaVertexTransform"+r+"(inout vec3 position, inout vec3 normal, inout vec2 uv) {\n  "+l+"\n}\n",s="\ntroika_position_"+r+" = vec3(position);\ntroika_normal_"+r+" = vec3(normal);\ntroika_uv_"+r+" = vec2(uv);\ntroikaVertexTransform"+r+"(troika_position_"+r+", troika_normal_"+r+", troika_uv_"+r+");\n"+s+"\n",a=a.replace(/\b(position|normal|uv)\b/g,(function(t,e,n,a){return/\battribute\s+vec[23]\s+$/.test(a.substr(0,n))?e:"troika_"+e+"_"+r}))),a=u(a,r,o,s,c),i=u(i,r,f,h,d),{vertexShader:a,fragmentShader:i}}(e,r,m);s.source=e.vertexShader,s.result=l.vertexShader,c.source=e.fragmentShader,c.result=l.fragmentShader}e.vertexShader=s.result,e.fragmentShader=c.result,a(e.uniforms,this.uniforms),r.timeUniform&&(e.uniforms[r.timeUniform]={get value(){return Date.now()-i}}),this[y]&&this[y](e)}function S(){t.constructor.apply(this,arguments),this._listeners=void 0}S.prototype=Object.create(t,{constructor:{value:S},isDerivedMaterial:{value:!0},baseMaterial:{value:t},onBeforeCompile:{get:function(){return b},set:function(t){this[y]=t}},copy:{value:function(r){return t.copy.call(this,r),t.isShaderMaterial||t.isDerivedMaterial||(this.extensions=a({},r.extensions),this.defines=a({},r.defines),this.uniforms=e.UniformsUtils.clone(r.uniforms)),this}},getDepthMaterial:{value:function(){var n=this._depthMaterial;return n||(v||((v=s(t.isDerivedMaterial?t.getDepthMaterial():new e.MeshDepthMaterial({depthPacking:e.RGBADepthPacking}),r)).defines.IS_DEPTH_MATERIAL=""),(n=this._depthMaterial=v.clone()).uniforms=this.uniforms),n}},getDistanceMaterial:{value:function(){var n=this._distanceMaterial;return n||(p||((p=s(t.isDerivedMaterial?t.getDistanceMaterial():new e.MeshDistanceMaterial,r)).defines.IS_DISTANCE_MATERIAL=""),(n=this._distanceMaterial=p.clone()).uniforms=this.uniforms),n}},dispose:{value:function(){var e=this._depthMaterial,r=this._distanceMaterial;e&&e.dispose(),r&&r.dispose(),t.dispose.call(this)}}});var x=new S;return x.copy(t),x.uniforms=a(e.UniformsUtils.clone(t.uniforms||{}),r.uniforms),x.defines=a({},t.defines,r.defines),x.defines["TROIKA_DERIVED_MATERIAL_"+m]="",x.extensions=a({},t.extensions,r.extensions),d[h]=x,x.clone()}function u(t,e,n,a,i){return(a||i||n)&&(t=t.replace(r,"\n"+n+"\nvoid troikaOrigMain"+e+"() {"),t+="\nvoid main() {\n  "+a+"\n  troikaOrigMain"+e+"();\n  "+i+"\n}"),t}function c(t,e){return"uniforms"===t?void 0:"function"===typeof e?e.toString():e}var l=0,f=new Map,h={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"phong",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},d=function(t){this.name=t,this.textureUniform="dataTex_"+t,this.textureSizeUniform="dataTexSize_"+t,this.multiplierUniform="dataMultiplier_"+t,this.dataSizeUniform="dataSize_"+t,this.readFunction="readData_"+t,this._raw=new Float32Array(0),this._texture=new e.DataTexture(new Uint8Array(0),0,1),this._length=0,this._multiplier=1},p={length:{configurable:!0}};function v(t,e,r){var n=255*t,a=n%1*255,i=a%1*255,o=i%1*255;return n&=255,a&=255,i&=255,o=255&Math.round(o),e[r]=n,e[r+1]=a,e[r+2]=i,e[r+3]=o,e}p.length.set=function(t){if(t!==this._length){var e=Math.pow(2,Math.ceil(Math.log2(t))),r=this._raw;e<r.length?this._raw=r.subarray(0,e):e>r.length&&(this._raw=new Float32Array(e),this._raw.set(r)),this._length=t}},p.length.get=function(){return this._length},d.prototype.push=function(t){return this.set(this.length++,t)},d.prototype.setArray=function(t){this.length=t.length,this._raw.set(t),this._needsRepack=!0},d.prototype.get=function(t){return this._raw[t]},d.prototype.set=function(t,e){t+1>this._length&&(this.length=t+1),e!==this._raw[t]&&(this._raw[t]=e,v(e/this._multiplier,this._texture.image.data,4*t),this._needsMultCheck=!0)},d.prototype.clone=function(){var t=new d(this.name);return t.setArray(this._raw),t},d.prototype.getShaderUniforms=function(){var t,e=this;return(t={})[this.textureUniform]={get value(){return e._sync(),e._texture}},t[this.textureSizeUniform]={get value(){return e._sync(),e._texture.image.width}},t[this.dataSizeUniform]={get value(){return e._sync(),e.length}},t[this.multiplierUniform]={get value(){return e._sync(),e._multiplier}},t},d.prototype.getShaderHeaderCode=function(){var t=this.textureUniform,e=this.textureSizeUniform,r=this.dataSizeUniform,n=this.multiplierUniform;return"\nuniform sampler2D "+t+";\nuniform float "+e+";\nuniform float "+r+";\nuniform float "+n+";\n\nfloat "+this.readFunction+"(float index) {\n  vec2 texUV = vec2((index + 0.5) / "+e+", 0.5);\n  vec4 pixel = texture2D("+t+", texUV);\n  return dot(pixel, 1.0 / vec4(1.0, 255.0, 65025.0, 16581375.0)) * "+n+";\n}\n"},d.prototype._sync=function(){var t=this._texture,e=this._raw,r=this._needsRepack;if(e.length!==t.image.width&&(t.image={data:new Uint8Array(4*e.length),width:e.length,height:1},r=!0),r||this._needsMultCheck){var n=this._raw.reduce((function(t,e){return Math.max(t,e)}),0),a=Math.pow(2,Math.ceil(Math.log2(n)));a!==this._multiplier&&(this._multiplier=a,r=!0),t.needsUpdate=!0,this._needsMultCheck=!1}if(r){for(var i=0,o=e.length,s=this._multiplier;i<o;i++)v(e[i]/s,t.image.data,4*i);this._needsRepack=!1}},Object.defineProperties(d.prototype,p);var m=null,g=new e.MeshStandardMaterial({color:16777215,side:e.DoubleSide}),y=function(t){function r(){t.call(this,r.getGeometry(),g),this.pointA=new e.Vector3,this.controlA=new e.Vector3,this.controlB=new e.Vector3,this.pointB=new e.Vector3,this.radius=.01,this.dashArray=new e.Vector2,this.dashOffset=0,this.frustumCulled=!1}t&&(r.__proto__=t),r.prototype=Object.create(t&&t.prototype),r.prototype.constructor=r;var n={material:{configurable:!0},customDepthMaterial:{configurable:!0},customDistanceMaterial:{configurable:!0}};return r.getGeometry=function(){return m||(m=new e.CylinderBufferGeometry(1,1,1,6,64).translate(0,.5,0))},n.material.get=function(){var t=this._derivedMaterial,r=this._baseMaterial||g;return t&&t.baseMaterial===r||(t=this._derivedMaterial=function(t){return s(t,{uniforms:{pointA:{value:new e.Vector3},controlA:{value:new e.Vector3},controlB:{value:new e.Vector3},pointB:{value:new e.Vector3},radius:{value:.01},dashing:{value:new e.Vector3}},vertexDefs:"\nuniform vec3 pointA;\nuniform vec3 controlA;\nuniform vec3 controlB;\nuniform vec3 pointB;\nuniform float radius;\nvarying float bezierT;\n\nvec3 cubicBezier(vec3 p1, vec3 c1, vec3 c2, vec3 p2, float t) {\n  float t2 = 1.0 - t;\n  float b0 = t2 * t2 * t2;\n  float b1 = 3.0 * t * t2 * t2;\n  float b2 = 3.0 * t * t * t2;\n  float b3 = t * t * t;\n  return b0 * p1 + b1 * c1 + b2 * c2 + b3 * p2;\n}\n\nvec3 cubicBezierDerivative(vec3 p1, vec3 c1, vec3 c2, vec3 p2, float t) {\n  float t2 = 1.0 - t;\n  return -3.0 * p1 * t2 * t2 +\n    c1 * (3.0 * t2 * t2 - 6.0 * t2 * t) +\n    c2 * (6.0 * t2 * t - 3.0 * t * t) +\n    3.0 * p2 * t * t;\n}\n",vertexTransform:'\nfloat t = position.y;\nbezierT = t;\nvec3 bezierCenterPos = cubicBezier(pointA, controlA, controlB, pointB, t);\nvec3 bezierDir = normalize(cubicBezierDerivative(pointA, controlA, controlB, pointB, t));\n\n// Make "sideways" always perpendicular to the camera ray; this ensures that any twists\n// in the cylinder occur where you won\'t see them: \nvec3 viewDirection = normalMatrix * vec3(0.0, 0.0, 1.0);\nif (bezierDir == viewDirection) {\n  bezierDir = normalize(cubicBezierDerivative(pointA, controlA, controlB, pointB, t == 1.0 ? t - 0.0001 : t + 0.0001));\n}\nvec3 sideways = normalize(cross(bezierDir, viewDirection));\nvec3 upish = normalize(cross(sideways, bezierDir));\n\n// Build a matrix for transforming this disc in the cylinder:\nmat4 discTx;\ndiscTx[0].xyz = sideways * radius;\ndiscTx[1].xyz = bezierDir * radius;\ndiscTx[2].xyz = upish * radius;\ndiscTx[3].xyz = bezierCenterPos;\ndiscTx[3][3] = 1.0;\n\n// Apply transform, ignoring original y\nposition = (discTx * vec4(position.x, 0.0, position.z, 1.0)).xyz;\nnormal = normalize(mat3(discTx) * normal);\n',fragmentDefs:"\nuniform vec3 dashing;\nvarying float bezierT;\n",fragmentMainIntro:"\nif (dashing.x + dashing.y > 0.0) {\n  float dashFrac = mod(bezierT - dashing.z, dashing.x + dashing.y);\n  if (dashFrac > dashing.x) {\n    discard;\n  }\n}\n"})}(r),r.addEventListener("dispose",(function e(){r.removeEventListener("dispose",e),t.dispose()}))),t},n.material.set=function(t){this._baseMaterial=t},n.customDepthMaterial.get=function(){return this.material.getDepthMaterial()},n.customDistanceMaterial.get=function(){return this.material.getDistanceMaterial()},r.prototype.onBeforeRender=function(t){var e=this.material.uniforms,r=this.pointA,n=this.controlA,a=this.controlB,i=this.pointB,o=this.radius,s=this.dashArray,u=this.dashOffset;e.pointA.value.copy(r),e.controlA.value.copy(n),e.controlB.value.copy(a),e.pointB.value.copy(i),e.radius.value=o,e.dashing.value.set(s.x,s.y,u||0)},r.prototype.raycast=function(t,e){},Object.defineProperties(r.prototype,n),r}(e.Mesh);t.BezierMesh=y,t.ShaderFloatArray=d,t.createDerivedMaterial=s,t.expandShaderIncludes=n,t.getShaderUniformTypes=function(t){for(var e,r=/\buniform\s+(int|float|vec[234])\s+([A-Za-z_][\w]*)/g,n=Object.create(null);null!==(e=r.exec(t));)n[e[2]]=e[1];return n},t.getShadersForMaterial=function(t){var r=h[t.type];return r?e.ShaderLib[r]:t},t.voidMainRegExp=r,Object.defineProperty(t,"__esModule",{value:!0})}(e,r(72))},84:function(t,e,r){"use strict";r.d(e,"a",(function(){return a}));var n=r(72);n.UniformsLib.line={linewidth:{value:1},resolution:{value:new n.Vector2(1,1)},dashScale:{value:1},dashSize:{value:1},gapSize:{value:1},opacity:{value:1}},n.ShaderLib.line={uniforms:n.UniformsUtils.merge([n.UniformsLib.common,n.UniformsLib.fog,n.UniformsLib.line]),vertexShader:"\n\t\t#include <common>\n\t\t#include <color_pars_vertex>\n\t\t#include <fog_pars_vertex>\n\t\t#include <logdepthbuf_pars_vertex>\n\t\t#include <clipping_planes_pars_vertex>\n\n\t\tuniform float linewidth;\n\t\tuniform vec2 resolution;\n\n\t\tattribute vec3 instanceStart;\n\t\tattribute vec3 instanceEnd;\n\n\t\tattribute vec3 instanceColorStart;\n\t\tattribute vec3 instanceColorEnd;\n\n\t\tvarying vec2 vUv;\n\n\t\t#ifdef USE_DASH\n\n\t\t\tuniform float dashScale;\n\t\t\tattribute float instanceDistanceStart;\n\t\t\tattribute float instanceDistanceEnd;\n\t\t\tvarying float vLineDistance;\n\n\t\t#endif\n\n\t\tvoid trimSegment( const in vec4 start, inout vec4 end ) {\n\n\t\t\t// trim end segment so it terminates between the camera plane and the near plane\n\n\t\t\t// conservative estimate of the near plane\n\t\t\tfloat a = projectionMatrix[ 2 ][ 2 ]; // 3nd entry in 3th column\n\t\t\tfloat b = projectionMatrix[ 3 ][ 2 ]; // 3nd entry in 4th column\n\t\t\tfloat nearEstimate = - 0.5 * b / a;\n\n\t\t\tfloat alpha = ( nearEstimate - start.z ) / ( end.z - start.z );\n\n\t\t\tend.xyz = mix( start.xyz, end.xyz, alpha );\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\t#ifdef USE_COLOR\n\n\t\t\t\tvColor.xyz = ( position.y < 0.5 ) ? instanceColorStart : instanceColorEnd;\n\n\t\t\t#endif\n\n\t\t\t#ifdef USE_DASH\n\n\t\t\t\tvLineDistance = ( position.y < 0.5 ) ? dashScale * instanceDistanceStart : dashScale * instanceDistanceEnd;\n\n\t\t\t#endif\n\n\t\t\tfloat aspect = resolution.x / resolution.y;\n\n\t\t\tvUv = uv;\n\n\t\t\t// camera space\n\t\t\tvec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );\n\t\t\tvec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );\n\n\t\t\t// special case for perspective projection, and segments that terminate either in, or behind, the camera plane\n\t\t\t// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space\n\t\t\t// but we need to perform ndc-space calculations in the shader, so we must address this issue directly\n\t\t\t// perhaps there is a more elegant solution -- WestLangley\n\n\t\t\tbool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 ); // 4th entry in the 3rd column\n\n\t\t\tif ( perspective ) {\n\n\t\t\t\tif ( start.z < 0.0 && end.z >= 0.0 ) {\n\n\t\t\t\t\ttrimSegment( start, end );\n\n\t\t\t\t} else if ( end.z < 0.0 && start.z >= 0.0 ) {\n\n\t\t\t\t\ttrimSegment( end, start );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// clip space\n\t\t\tvec4 clipStart = projectionMatrix * start;\n\t\t\tvec4 clipEnd = projectionMatrix * end;\n\n\t\t\t// ndc space\n\t\t\tvec2 ndcStart = clipStart.xy / clipStart.w;\n\t\t\tvec2 ndcEnd = clipEnd.xy / clipEnd.w;\n\n\t\t\t// direction\n\t\t\tvec2 dir = ndcEnd - ndcStart;\n\n\t\t\t// account for clip-space aspect ratio\n\t\t\tdir.x *= aspect;\n\t\t\tdir = normalize( dir );\n\n\t\t\t// perpendicular to dir\n\t\t\tvec2 offset = vec2( dir.y, - dir.x );\n\n\t\t\t// undo aspect ratio adjustment\n\t\t\tdir.x /= aspect;\n\t\t\toffset.x /= aspect;\n\n\t\t\t// sign flip\n\t\t\tif ( position.x < 0.0 ) offset *= - 1.0;\n\n\t\t\t// endcaps\n\t\t\tif ( position.y < 0.0 ) {\n\n\t\t\t\toffset += - dir;\n\n\t\t\t} else if ( position.y > 1.0 ) {\n\n\t\t\t\toffset += dir;\n\n\t\t\t}\n\n\t\t\t// adjust for linewidth\n\t\t\toffset *= linewidth;\n\n\t\t\t// adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...\n\t\t\toffset /= resolution.y;\n\n\t\t\t// select end\n\t\t\tvec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;\n\n\t\t\t// back to clip space\n\t\t\toffset *= clip.w;\n\n\t\t\tclip.xy += offset;\n\n\t\t\tgl_Position = clip;\n\n\t\t\tvec4 mvPosition = ( position.y < 0.5 ) ? start : end; // this is an approximation\n\n\t\t\t#include <logdepthbuf_vertex>\n\t\t\t#include <clipping_planes_vertex>\n\t\t\t#include <fog_vertex>\n\n\t\t}\n\t\t",fragmentShader:"\n\t\tuniform vec3 diffuse;\n\t\tuniform float opacity;\n\n\t\t#ifdef USE_DASH\n\n\t\t\tuniform float dashSize;\n\t\t\tuniform float gapSize;\n\n\t\t#endif\n\n\t\tvarying float vLineDistance;\n\n\t\t#include <common>\n\t\t#include <color_pars_fragment>\n\t\t#include <fog_pars_fragment>\n\t\t#include <logdepthbuf_pars_fragment>\n\t\t#include <clipping_planes_pars_fragment>\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\t#include <clipping_planes_fragment>\n\n\t\t\t#ifdef USE_DASH\n\n\t\t\t\tif ( vUv.y < - 1.0 || vUv.y > 1.0 ) discard; // discard endcaps\n\n\t\t\t\tif ( mod( vLineDistance, dashSize + gapSize ) > dashSize ) discard; // todo - FIX\n\n\t\t\t#endif\n\n\t\t\tif ( abs( vUv.y ) > 1.0 ) {\n\n\t\t\t\tfloat a = vUv.x;\n\t\t\t\tfloat b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;\n\t\t\t\tfloat len2 = a * a + b * b;\n\n\t\t\t\tif ( len2 > 1.0 ) discard;\n\n\t\t\t}\n\n\t\t\tvec4 diffuseColor = vec4( diffuse, opacity );\n\n\t\t\t#include <logdepthbuf_fragment>\n\t\t\t#include <color_fragment>\n\n\t\t\tgl_FragColor = vec4( diffuseColor.rgb, diffuseColor.a );\n\n\t\t\t#include <tonemapping_fragment>\n\t\t\t#include <encodings_fragment>\n\t\t\t#include <fog_fragment>\n\t\t\t#include <premultiplied_alpha_fragment>\n\n\t\t}\n\t\t"};var a=function(t){n.ShaderMaterial.call(this,{type:"LineMaterial",uniforms:n.UniformsUtils.clone(n.ShaderLib.line.uniforms),vertexShader:n.ShaderLib.line.vertexShader,fragmentShader:n.ShaderLib.line.fragmentShader,clipping:!0}),this.dashed=!1,Object.defineProperties(this,{color:{enumerable:!0,get:function(){return this.uniforms.diffuse.value},set:function(t){this.uniforms.diffuse.value=t}},linewidth:{enumerable:!0,get:function(){return this.uniforms.linewidth.value},set:function(t){this.uniforms.linewidth.value=t}},dashScale:{enumerable:!0,get:function(){return this.uniforms.dashScale.value},set:function(t){this.uniforms.dashScale.value=t}},dashSize:{enumerable:!0,get:function(){return this.uniforms.dashSize.value},set:function(t){this.uniforms.dashSize.value=t}},gapSize:{enumerable:!0,get:function(){return this.uniforms.gapSize.value},set:function(t){this.uniforms.gapSize.value=t}},opacity:{enumerable:!0,get:function(){return this.uniforms.opacity.value},set:function(t){this.uniforms.opacity.value=t}},resolution:{enumerable:!0,get:function(){return this.uniforms.resolution.value},set:function(t){this.uniforms.resolution.value.copy(t)}}}),this.setValues(t)};a.prototype=Object.create(n.ShaderMaterial.prototype),a.prototype.constructor=a,a.prototype.isLineMaterial=!0},87:function(t,e,r){"use strict";r.d(e,"a",(function(){return a}));var n=r(94),a=function(){n.a.call(this),this.type="LineGeometry"};a.prototype=Object.assign(Object.create(n.a.prototype),{constructor:a,isLineGeometry:!0,setPositions:function(t){for(var e=t.length-3,r=new Float32Array(2*e),a=0;a<e;a+=3)r[2*a]=t[a],r[2*a+1]=t[a+1],r[2*a+2]=t[a+2],r[2*a+3]=t[a+3],r[2*a+4]=t[a+4],r[2*a+5]=t[a+5];return n.a.prototype.setPositions.call(this,r),this},setColors:function(t){for(var e=t.length-3,r=new Float32Array(2*e),a=0;a<e;a+=3)r[2*a]=t[a],r[2*a+1]=t[a+1],r[2*a+2]=t[a+2],r[2*a+3]=t[a+3],r[2*a+4]=t[a+4],r[2*a+5]=t[a+5];return n.a.prototype.setColors.call(this,r),this},fromLine:function(t){var e=t.geometry;return e.isGeometry?this.setPositions(e.vertices):e.isBufferGeometry&&this.setPositions(e.attributes.position.array),this},copy:function(){return this}})},94:function(t,e,r){"use strict";r.d(e,"a",(function(){return a}));var n=r(72),a=function(){n.InstancedBufferGeometry.call(this),this.type="LineSegmentsGeometry";this.setIndex([0,2,1,2,3,1,2,4,3,4,5,3,4,6,5,6,7,5]),this.setAttribute("position",new n.Float32BufferAttribute([-1,2,0,1,2,0,-1,1,0,1,1,0,-1,0,0,1,0,0,-1,-1,0,1,-1,0],3)),this.setAttribute("uv",new n.Float32BufferAttribute([-1,2,1,2,-1,1,1,1,-1,-1,1,-1,-1,-2,1,-2],2))};a.prototype=Object.assign(Object.create(n.InstancedBufferGeometry.prototype),{constructor:a,isLineSegmentsGeometry:!0,applyMatrix4:function(t){var e=this.attributes.instanceStart,r=this.attributes.instanceEnd;return void 0!==e&&(e.applyMatrix4(t),r.applyMatrix4(t),e.data.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},setPositions:function(t){var e;t instanceof Float32Array?e=t:Array.isArray(t)&&(e=new Float32Array(t));var r=new n.InstancedInterleavedBuffer(e,6,1);return this.setAttribute("instanceStart",new n.InterleavedBufferAttribute(r,3,0)),this.setAttribute("instanceEnd",new n.InterleavedBufferAttribute(r,3,3)),this.computeBoundingBox(),this.computeBoundingSphere(),this},setColors:function(t){var e;t instanceof Float32Array?e=t:Array.isArray(t)&&(e=new Float32Array(t));var r=new n.InstancedInterleavedBuffer(e,6,1);return this.setAttribute("instanceColorStart",new n.InterleavedBufferAttribute(r,3,0)),this.setAttribute("instanceColorEnd",new n.InterleavedBufferAttribute(r,3,3)),this},fromWireframeGeometry:function(t){return this.setPositions(t.attributes.position.array),this},fromEdgesGeometry:function(t){return this.setPositions(t.attributes.position.array),this},fromMesh:function(t){return this.fromWireframeGeometry(new n.WireframeGeometry(t.geometry)),this},fromLineSegments:function(t){var e=t.geometry;return e.isGeometry?this.setPositions(e.vertices):e.isBufferGeometry&&this.setPositions(e.attributes.position.array),this},computeBoundingBox:function(){var t=new n.Box3;return function(){null===this.boundingBox&&(this.boundingBox=new n.Box3);var e=this.attributes.instanceStart,r=this.attributes.instanceEnd;void 0!==e&&void 0!==r&&(this.boundingBox.setFromBufferAttribute(e),t.setFromBufferAttribute(r),this.boundingBox.union(t))}}(),computeBoundingSphere:function(){var t=new n.Vector3;return function(){null===this.boundingSphere&&(this.boundingSphere=new n.Sphere),null===this.boundingBox&&this.computeBoundingBox();var e=this.attributes.instanceStart,r=this.attributes.instanceEnd;if(void 0!==e&&void 0!==r){var a=this.boundingSphere.center;this.boundingBox.getCenter(a);for(var i=0,o=0,s=e.count;o<s;o++)t.fromBufferAttribute(e,o),i=Math.max(i,a.distanceToSquared(t)),t.fromBufferAttribute(r,o),i=Math.max(i,a.distanceToSquared(t));this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error("THREE.LineSegmentsGeometry.computeBoundingSphere(): Computed radius is NaN. The instanced position data is likely to have NaN values.",this)}}}(),toJSON:function(){},applyMatrix:function(t){return console.warn("THREE.LineSegmentsGeometry: applyMatrix() has been renamed to applyMatrix4()."),this.applyMatrix4(t)}})}}]);
//# sourceMappingURL=5.5ec8965a.chunk.js.map
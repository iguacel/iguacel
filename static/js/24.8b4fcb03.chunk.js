(this["webpackJsonpraster-react-canvas2"]=this["webpackJsonpraster-react-canvas2"]||[]).push([[24],{125:function(e,r,t){!function(e,r,t,n){"use strict";var a,i=t.defineWorkerModule({name:"Typr Font Parser",dependencies:[function(){var e=self,r={parse:function(e){var t=r._bin,n=new Uint8Array(e);if("ttcf"==t.readASCII(n,0,4)){var a=4;t.readUshort(n,a),a+=2,t.readUshort(n,a),a+=2;var i=t.readUint(n,a);a+=4;for(var o=[],s=0;s<i;s++){var u=t.readUint(n,a);a+=4,o.push(r._readFont(n,u))}return o}return[r._readFont(n,0)]},_readFont:function(e,t){var n=r._bin,a=t;n.readFixed(e,t),t+=4;var i=n.readUshort(e,t);t+=2,n.readUshort(e,t),t+=2,n.readUshort(e,t),t+=2,n.readUshort(e,t),t+=2;for(var o=["cmap","head","hhea","maxp","hmtx","name","OS/2","post","loca","glyf","kern","CFF ","GPOS","GSUB","SVG "],s={_data:e,_offset:a},u={},l=0;l<i;l++){var f=n.readASCII(e,t,4);t+=4,n.readUint(e,t),t+=4;var c=n.readUint(e,t);t+=4;var h=n.readUint(e,t);t+=4,u[f]={offset:c,length:h}}for(l=0;l<o.length;l++){var d=o[l];u[d]&&(s[d.trim()]=r[d.trim()].parse(e,u[d].offset,u[d].length,s))}return s},_tabOffset:function(e,t,n){for(var a=r._bin,i=a.readUshort(e,n+4),o=n+12,s=0;s<i;s++){var u=a.readASCII(e,o,4);o+=4,a.readUint(e,o),o+=4;var l=a.readUint(e,o);if(o+=4,a.readUint(e,o),o+=4,u==t)return l}return 0}};return r._bin={readFixed:function(e,r){return(e[r]<<8|e[r+1])+(e[r+2]<<8|e[r+3])/65540},readF2dot14:function(e,t){return r._bin.readShort(e,t)/16384},readInt:function(e,t){var n=r._bin.t.uint8;return n[0]=e[t+3],n[1]=e[t+2],n[2]=e[t+1],n[3]=e[t],r._bin.t.int32[0]},readInt8:function(e,t){return r._bin.t.uint8[0]=e[t],r._bin.t.int8[0]},readShort:function(e,t){var n=r._bin.t.uint8;return n[1]=e[t],n[0]=e[t+1],r._bin.t.int16[0]},readUshort:function(e,r){return e[r]<<8|e[r+1]},readUshorts:function(e,t,n){for(var a=[],i=0;i<n;i++)a.push(r._bin.readUshort(e,t+2*i));return a},readUint:function(e,t){var n=r._bin.t.uint8;return n[3]=e[t],n[2]=e[t+1],n[1]=e[t+2],n[0]=e[t+3],r._bin.t.uint32[0]},readUint64:function(e,t){return 4294967296*r._bin.readUint(e,t)+r._bin.readUint(e,t+4)},readASCII:function(e,r,t){for(var n="",a=0;a<t;a++)n+=String.fromCharCode(e[r+a]);return n},readUnicode:function(e,r,t){for(var n="",a=0;a<t;a++){var i=e[r++]<<8|e[r++];n+=String.fromCharCode(i)}return n},_tdec:e.TextDecoder?new e.TextDecoder:null,readUTF8:function(e,t,n){var a=r._bin._tdec;return a&&0==t&&n==e.length?a.decode(e):r._bin.readASCII(e,t,n)},readBytes:function(e,r,t){for(var n=[],a=0;a<t;a++)n.push(e[r+a]);return n},readASCIIArray:function(e,r,t){for(var n=[],a=0;a<t;a++)n.push(String.fromCharCode(e[r+a]));return n}},r._bin.t={buff:new ArrayBuffer(8)},r._bin.t.int8=new Int8Array(r._bin.t.buff),r._bin.t.uint8=new Uint8Array(r._bin.t.buff),r._bin.t.int16=new Int16Array(r._bin.t.buff),r._bin.t.uint16=new Uint16Array(r._bin.t.buff),r._bin.t.int32=new Int32Array(r._bin.t.buff),r._bin.t.uint32=new Uint32Array(r._bin.t.buff),r._lctf={},r._lctf.parse=function(e,t,n,a,i){var o=r._bin,s={},u=t;o.readFixed(e,t),t+=4;var l=o.readUshort(e,t);t+=2;var f=o.readUshort(e,t);t+=2;var c=o.readUshort(e,t);return t+=2,s.scriptList=r._lctf.readScriptList(e,u+l),s.featureList=r._lctf.readFeatureList(e,u+f),s.lookupList=r._lctf.readLookupList(e,u+c,i),s},r._lctf.readLookupList=function(e,t,n){var a=r._bin,i=t,o=[],s=a.readUshort(e,t);t+=2;for(var u=0;u<s;u++){var l=a.readUshort(e,t);t+=2;var f=r._lctf.readLookupTable(e,i+l,n);o.push(f)}return o},r._lctf.readLookupTable=function(e,t,n){var a=r._bin,i=t,o={tabs:[]};o.ltype=a.readUshort(e,t),t+=2,o.flag=a.readUshort(e,t),t+=2;var s=a.readUshort(e,t);t+=2;for(var u=0;u<s;u++){var l=a.readUshort(e,t);t+=2;var f=n(e,o.ltype,i+l);o.tabs.push(f)}return o},r._lctf.numOfOnes=function(e){for(var r=0,t=0;t<32;t++)0!=(e>>>t&1)&&r++;return r},r._lctf.readClassDef=function(e,t){var n=r._bin,a=[],i=n.readUshort(e,t);if(t+=2,1==i){var o=n.readUshort(e,t);t+=2;var s=n.readUshort(e,t);t+=2;for(var u=0;u<s;u++)a.push(o+u),a.push(o+u),a.push(n.readUshort(e,t)),t+=2}if(2==i){var l=n.readUshort(e,t);for(t+=2,u=0;u<l;u++)a.push(n.readUshort(e,t)),t+=2,a.push(n.readUshort(e,t)),t+=2,a.push(n.readUshort(e,t)),t+=2}return a},r._lctf.getInterval=function(e,r){for(var t=0;t<e.length;t+=3){var n=e[t],a=e[t+1];if(e[t+2],n<=r&&r<=a)return t}return-1},r._lctf.readCoverage=function(e,t){var n=r._bin,a={};a.fmt=n.readUshort(e,t),t+=2;var i=n.readUshort(e,t);return t+=2,1==a.fmt&&(a.tab=n.readUshorts(e,t,i)),2==a.fmt&&(a.tab=n.readUshorts(e,t,3*i)),a},r._lctf.coverageIndex=function(e,t){var n=e.tab;if(1==e.fmt)return n.indexOf(t);if(2==e.fmt){var a=r._lctf.getInterval(n,t);if(-1!=a)return n[a+2]+(t-n[a])}return-1},r._lctf.readFeatureList=function(e,t){var n=r._bin,a=t,i=[],o=n.readUshort(e,t);t+=2;for(var s=0;s<o;s++){var u=n.readASCII(e,t,4);t+=4;var l=n.readUshort(e,t);t+=2,i.push({tag:u.trim(),tab:r._lctf.readFeatureTable(e,a+l)})}return i},r._lctf.readFeatureTable=function(e,t){var n=r._bin;n.readUshort(e,t),t+=2;var a=n.readUshort(e,t);t+=2;for(var i=[],o=0;o<a;o++)i.push(n.readUshort(e,t+2*o));return i},r._lctf.readScriptList=function(e,t){var n=r._bin,a=t,i={},o=n.readUshort(e,t);t+=2;for(var s=0;s<o;s++){var u=n.readASCII(e,t,4);t+=4;var l=n.readUshort(e,t);t+=2,i[u.trim()]=r._lctf.readScriptTable(e,a+l)}return i},r._lctf.readScriptTable=function(e,t){var n=r._bin,a=t,i={},o=n.readUshort(e,t);t+=2,i.default=r._lctf.readLangSysTable(e,a+o);var s=n.readUshort(e,t);t+=2;for(var u=0;u<s;u++){var l=n.readASCII(e,t,4);t+=4;var f=n.readUshort(e,t);t+=2,i[l.trim()]=r._lctf.readLangSysTable(e,a+f)}return i},r._lctf.readLangSysTable=function(e,t){var n=r._bin,a={};n.readUshort(e,t),t+=2,a.reqFeature=n.readUshort(e,t),t+=2;var i=n.readUshort(e,t);return t+=2,a.features=n.readUshorts(e,t,i),a},r.CFF={},r.CFF.parse=function(e,t,n){var a=r._bin;(e=new Uint8Array(e.buffer,t,n))[t=0],e[++t],e[++t],e[++t],t++;var i=[];t=r.CFF.readIndex(e,t,i);for(var o=[],s=0;s<i.length-1;s++)o.push(a.readASCII(e,t+i[s],i[s+1]-i[s]));t+=i[i.length-1];var u=[];t=r.CFF.readIndex(e,t,u);var l=[];for(s=0;s<u.length-1;s++)l.push(r.CFF.readDict(e,t+u[s],t+u[s+1]));t+=u[u.length-1];var f=l[0],c=[];t=r.CFF.readIndex(e,t,c);var h=[];for(s=0;s<c.length-1;s++)h.push(a.readASCII(e,t+c[s],c[s+1]-c[s]));if(t+=c[c.length-1],r.CFF.readSubrs(e,t,f),f.CharStrings){t=f.CharStrings,c=[],t=r.CFF.readIndex(e,t,c);var d=[];for(s=0;s<c.length-1;s++)d.push(a.readBytes(e,t+c[s],c[s+1]-c[s]));f.CharStrings=d}if(f.ROS){t=f.FDArray;var p=[];for(t=r.CFF.readIndex(e,t,p),f.FDArray=[],s=0;s<p.length-1;s++){var v=r.CFF.readDict(e,t+p[s],t+p[s+1]);r.CFF._readFDict(e,v,h),f.FDArray.push(v)}t+=p[p.length-1],t=f.FDSelect,f.FDSelect=[];var g=e[t];if(t++,3!=g)throw g;var m=a.readUshort(e,t);for(t+=2,s=0;s<m+1;s++)f.FDSelect.push(a.readUshort(e,t),e[t+2]),t+=3}return f.Encoding&&(f.Encoding=r.CFF.readEncoding(e,f.Encoding,f.CharStrings.length)),f.charset&&(f.charset=r.CFF.readCharset(e,f.charset,f.CharStrings.length)),r.CFF._readFDict(e,f,h),f},r.CFF._readFDict=function(e,t,n){var a;for(var i in t.Private&&(a=t.Private[1],t.Private=r.CFF.readDict(e,a,a+t.Private[0]),t.Private.Subrs&&r.CFF.readSubrs(e,a+t.Private.Subrs,t.Private)),t)-1!=["FamilyName","FontName","FullName","Notice","version","Copyright"].indexOf(i)&&(t[i]=n[t[i]-426+35])},r.CFF.readSubrs=function(e,t,n){var a=r._bin,i=[];t=r.CFF.readIndex(e,t,i);var o,s=i.length;o=s<1240?107:s<33900?1131:32768,n.Bias=o,n.Subrs=[];for(var u=0;u<i.length-1;u++)n.Subrs.push(a.readBytes(e,t+i[u],i[u+1]-i[u]))},r.CFF.tableSE=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,0,111,112,113,114,0,115,116,117,118,119,120,121,122,0,123,0,124,125,126,127,128,129,130,131,0,132,133,0,134,135,136,137,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,138,0,139,0,0,0,0,140,141,142,143,0,0,0,0,0,144,0,0,0,145,0,0,146,147,148,149,0,0,0,0],r.CFF.glyphByUnicode=function(e,r){for(var t=0;t<e.charset.length;t++)if(e.charset[t]==r)return t;return-1},r.CFF.glyphBySE=function(e,t){return t<0||t>255?-1:r.CFF.glyphByUnicode(e,r.CFF.tableSE[t])},r.CFF.readEncoding=function(e,t,n){r._bin;var a=[".notdef"],i=e[t];if(t++,0!=i)throw"error: unknown encoding format: "+i;var o=e[t];t++;for(var s=0;s<o;s++)a.push(e[t+s]);return a},r.CFF.readCharset=function(e,t,n){var a=r._bin,i=[".notdef"],o=e[t];if(t++,0==o)for(var s=0;s<n;s++){var u=a.readUshort(e,t);t+=2,i.push(u)}else{if(1!=o&&2!=o)throw"error: format: "+o;for(;i.length<n;){u=a.readUshort(e,t),t+=2;var l=0;for(1==o?(l=e[t],t++):(l=a.readUshort(e,t),t+=2),s=0;s<=l;s++)i.push(u),u++}}return i},r.CFF.readIndex=function(e,t,n){var a=r._bin,i=a.readUshort(e,t)+1,o=e[t+=2];if(t++,1==o)for(var s=0;s<i;s++)n.push(e[t+s]);else if(2==o)for(s=0;s<i;s++)n.push(a.readUshort(e,t+2*s));else if(3==o)for(s=0;s<i;s++)n.push(16777215&a.readUint(e,t+3*s-1));else if(1!=i)throw"unsupported offset size: "+o+", count: "+i;return(t+=i*o)-1},r.CFF.getCharString=function(e,t,n){var a=r._bin,i=e[t],o=e[t+1],s=(e[t+2],e[t+3],e[t+4],1),u=null,l=null;i<=20&&(u=i,s=1),12==i&&(u=100*i+o,s=2),21<=i&&i<=27&&(u=i,s=1),28==i&&(l=a.readShort(e,t+1),s=3),29<=i&&i<=31&&(u=i,s=1),32<=i&&i<=246&&(l=i-139,s=1),247<=i&&i<=250&&(l=256*(i-247)+o+108,s=2),251<=i&&i<=254&&(l=256*-(i-251)-o-108,s=2),255==i&&(l=a.readInt(e,t+1)/65535,s=5),n.val=null!=l?l:"o"+u,n.size=s},r.CFF.readCharString=function(e,t,n){for(var a=t+n,i=r._bin,o=[];t<a;){var s=e[t],u=e[t+1],l=(e[t+2],e[t+3],e[t+4],1),f=null,c=null;s<=20&&(f=s,l=1),12==s&&(f=100*s+u,l=2),19!=s&&20!=s||(f=s,l=2),21<=s&&s<=27&&(f=s,l=1),28==s&&(c=i.readShort(e,t+1),l=3),29<=s&&s<=31&&(f=s,l=1),32<=s&&s<=246&&(c=s-139,l=1),247<=s&&s<=250&&(c=256*(s-247)+u+108,l=2),251<=s&&s<=254&&(c=256*-(s-251)-u-108,l=2),255==s&&(c=i.readInt(e,t+1)/65535,l=5),o.push(null!=c?c:"o"+f),t+=l}return o},r.CFF.readDict=function(e,t,n){for(var a=r._bin,i={},o=[];t<n;){var s=e[t],u=e[t+1],l=(e[t+2],e[t+3],e[t+4],1),f=null,c=null;if(28==s&&(c=a.readShort(e,t+1),l=3),29==s&&(c=a.readInt(e,t+1),l=5),32<=s&&s<=246&&(c=s-139,l=1),247<=s&&s<=250&&(c=256*(s-247)+u+108,l=2),251<=s&&s<=254&&(c=256*-(s-251)-u-108,l=2),255==s)throw c=a.readInt(e,t+1)/65535,l=5,"unknown number";if(30==s){var h=[];for(l=1;;){var d=e[t+l];l++;var p=d>>4,v=15&d;if(15!=p&&h.push(p),15!=v&&h.push(v),15==v)break}for(var g="",m=[0,1,2,3,4,5,6,7,8,9,".","e","e-","reserved","-","endOfNumber"],y=0;y<h.length;y++)g+=m[h[y]];c=parseFloat(g)}s<=21&&(f=["version","Notice","FullName","FamilyName","Weight","FontBBox","BlueValues","OtherBlues","FamilyBlues","FamilyOtherBlues","StdHW","StdVW","escape","UniqueID","XUID","charset","Encoding","CharStrings","Private","Subrs","defaultWidthX","nominalWidthX"][s],l=1,12==s&&(f=["Copyright","isFixedPitch","ItalicAngle","UnderlinePosition","UnderlineThickness","PaintType","CharstringType","FontMatrix","StrokeWidth","BlueScale","BlueShift","BlueFuzz","StemSnapH","StemSnapV","ForceBold",0,0,"LanguageGroup","ExpansionFactor","initialRandomSeed","SyntheticBase","PostScript","BaseFontName","BaseFontBlend",0,0,0,0,0,0,"ROS","CIDFontVersion","CIDFontRevision","CIDFontType","CIDCount","UIDBase","FDArray","FDSelect","FontName"][u],l=2)),null!=f?(i[f]=1==o.length?o[0]:o,o=[]):o.push(c),t+=l}return i},r.cmap={},r.cmap.parse=function(e,t,n){e=new Uint8Array(e.buffer,t,n),t=0;var a=r._bin,i={};a.readUshort(e,t),t+=2;var o=a.readUshort(e,t);t+=2;var s=[];i.tables=[];for(var u=0;u<o;u++){var l=a.readUshort(e,t);t+=2;var f=a.readUshort(e,t);t+=2;var c=a.readUint(e,t);t+=4;var h="p"+l+"e"+f,d=s.indexOf(c);if(-1==d){var p;d=i.tables.length,s.push(c);var v=a.readUshort(e,c);0==v?p=r.cmap.parse0(e,c):4==v?p=r.cmap.parse4(e,c):6==v?p=r.cmap.parse6(e,c):12==v?p=r.cmap.parse12(e,c):console.log("unknown format: "+v,l,f,c),i.tables.push(p)}if(null!=i[h])throw"multiple tables for one platform+encoding";i[h]=d}return i},r.cmap.parse0=function(e,t){var n=r._bin,a={};a.format=n.readUshort(e,t),t+=2;var i=n.readUshort(e,t);t+=2,n.readUshort(e,t),t+=2,a.map=[];for(var o=0;o<i-6;o++)a.map.push(e[t+o]);return a},r.cmap.parse4=function(e,t){var n=r._bin,a=t,i={};i.format=n.readUshort(e,t),t+=2;var o=n.readUshort(e,t);t+=2,n.readUshort(e,t),t+=2;var s=n.readUshort(e,t);t+=2;var u=s/2;i.searchRange=n.readUshort(e,t),t+=2,i.entrySelector=n.readUshort(e,t),t+=2,i.rangeShift=n.readUshort(e,t),t+=2,i.endCount=n.readUshorts(e,t,u),t+=2*u,t+=2,i.startCount=n.readUshorts(e,t,u),t+=2*u,i.idDelta=[];for(var l=0;l<u;l++)i.idDelta.push(n.readShort(e,t)),t+=2;for(i.idRangeOffset=n.readUshorts(e,t,u),t+=2*u,i.glyphIdArray=[];t<a+o;)i.glyphIdArray.push(n.readUshort(e,t)),t+=2;return i},r.cmap.parse6=function(e,t){var n=r._bin,a={};a.format=n.readUshort(e,t),t+=2,n.readUshort(e,t),t+=2,n.readUshort(e,t),t+=2,a.firstCode=n.readUshort(e,t),t+=2;var i=n.readUshort(e,t);t+=2,a.glyphIdArray=[];for(var o=0;o<i;o++)a.glyphIdArray.push(n.readUshort(e,t)),t+=2;return a},r.cmap.parse12=function(e,t){var n=r._bin,a={};a.format=n.readUshort(e,t),t+=2,t+=2,n.readUint(e,t),t+=4,n.readUint(e,t),t+=4;var i=n.readUint(e,t);t+=4,a.groups=[];for(var o=0;o<i;o++){var s=t+12*o,u=n.readUint(e,s+0),l=n.readUint(e,s+4),f=n.readUint(e,s+8);a.groups.push([u,l,f])}return a},r.glyf={},r.glyf.parse=function(e,r,t,n){for(var a=[],i=0;i<n.maxp.numGlyphs;i++)a.push(null);return a},r.glyf._parseGlyf=function(e,t){var n=r._bin,a=e._data,i=r._tabOffset(a,"glyf",e._offset)+e.loca[t];if(e.loca[t]==e.loca[t+1])return null;var o={};if(o.noc=n.readShort(a,i),i+=2,o.xMin=n.readShort(a,i),i+=2,o.yMin=n.readShort(a,i),i+=2,o.xMax=n.readShort(a,i),i+=2,o.yMax=n.readShort(a,i),i+=2,o.xMin>=o.xMax||o.yMin>=o.yMax)return null;if(o.noc>0){o.endPts=[];for(var s=0;s<o.noc;s++)o.endPts.push(n.readUshort(a,i)),i+=2;var u=n.readUshort(a,i);if(i+=2,a.length-i<u)return null;o.instructions=n.readBytes(a,i,u),i+=u;var l=o.endPts[o.noc-1]+1;for(o.flags=[],s=0;s<l;s++){var f=a[i];if(i++,o.flags.push(f),0!=(8&f)){var c=a[i];i++;for(var h=0;h<c;h++)o.flags.push(f),s++}}for(o.xs=[],s=0;s<l;s++){var d=0!=(2&o.flags[s]),p=0!=(16&o.flags[s]);d?(o.xs.push(p?a[i]:-a[i]),i++):p?o.xs.push(0):(o.xs.push(n.readShort(a,i)),i+=2)}for(o.ys=[],s=0;s<l;s++)d=0!=(4&o.flags[s]),p=0!=(32&o.flags[s]),d?(o.ys.push(p?a[i]:-a[i]),i++):p?o.ys.push(0):(o.ys.push(n.readShort(a,i)),i+=2);var v=0,g=0;for(s=0;s<l;s++)v+=o.xs[s],g+=o.ys[s],o.xs[s]=v,o.ys[s]=g}else{var m;o.parts=[];do{m=n.readUshort(a,i),i+=2;var y={m:{a:1,b:0,c:0,d:1,tx:0,ty:0},p1:-1,p2:-1};if(o.parts.push(y),y.glyphIndex=n.readUshort(a,i),i+=2,1&m){var b=n.readShort(a,i);i+=2;var x=n.readShort(a,i);i+=2}else b=n.readInt8(a,i),i++,x=n.readInt8(a,i),i++;2&m?(y.m.tx=b,y.m.ty=x):(y.p1=b,y.p2=x),8&m?(y.m.a=y.m.d=n.readF2dot14(a,i),i+=2):64&m?(y.m.a=n.readF2dot14(a,i),i+=2,y.m.d=n.readF2dot14(a,i),i+=2):128&m&&(y.m.a=n.readF2dot14(a,i),i+=2,y.m.b=n.readF2dot14(a,i),i+=2,y.m.c=n.readF2dot14(a,i),i+=2,y.m.d=n.readF2dot14(a,i),i+=2)}while(32&m);if(256&m){var S=n.readUshort(a,i);for(i+=2,o.instr=[],s=0;s<S;s++)o.instr.push(a[i]),i++}}return o},r.GPOS={},r.GPOS.parse=function(e,t,n,a){return r._lctf.parse(e,t,n,a,r.GPOS.subt)},r.GPOS.subt=function(e,t,n){var a=r._bin,i=n,o={};if(o.fmt=a.readUshort(e,n),n+=2,1==t||2==t||3==t||7==t||8==t&&o.fmt<=2){var s=a.readUshort(e,n);n+=2,o.coverage=r._lctf.readCoverage(e,s+i)}if(1==t&&1==o.fmt){var u=a.readUshort(e,n);n+=2;var l=r._lctf.numOfOnes(u);0!=u&&(o.pos=r.GPOS.readValueRecord(e,n,u))}else if(2==t){u=a.readUshort(e,n),n+=2;var f=a.readUshort(e,n);n+=2,l=r._lctf.numOfOnes(u);var c=r._lctf.numOfOnes(f);if(1==o.fmt){o.pairsets=[];var h=a.readUshort(e,n);n+=2;for(var d=0;d<h;d++){var p=i+a.readUshort(e,n);n+=2;var v=a.readUshort(e,p);p+=2;for(var g=[],m=0;m<v;m++){var y=a.readUshort(e,p);p+=2,0!=u&&(w=r.GPOS.readValueRecord(e,p,u),p+=2*l),0!=f&&(M=r.GPOS.readValueRecord(e,p,f),p+=2*c),g.push({gid2:y,val1:w,val2:M})}o.pairsets.push(g)}}if(2==o.fmt){var b=a.readUshort(e,n);n+=2;var x=a.readUshort(e,n);n+=2;var S=a.readUshort(e,n);n+=2;var U=a.readUshort(e,n);for(n+=2,o.classDef1=r._lctf.readClassDef(e,i+b),o.classDef2=r._lctf.readClassDef(e,i+x),o.matrix=[],d=0;d<S;d++){var _=[];for(m=0;m<U;m++){var w=null,M=null;0!=o.valFmt1&&(w=r.GPOS.readValueRecord(e,n,o.valFmt1),n+=2*l),0!=o.valFmt2&&(M=r.GPOS.readValueRecord(e,n,o.valFmt2),n+=2*c),_.push({val1:w,val2:M})}o.matrix.push(_)}}}return o},r.GPOS.readValueRecord=function(e,t,n){var a=r._bin,i=[];return i.push(1&n?a.readShort(e,t):0),t+=1&n?2:0,i.push(2&n?a.readShort(e,t):0),t+=2&n?2:0,i.push(4&n?a.readShort(e,t):0),t+=4&n?2:0,i.push(8&n?a.readShort(e,t):0),t+=8&n?2:0,i},r.GSUB={},r.GSUB.parse=function(e,t,n,a){return r._lctf.parse(e,t,n,a,r.GSUB.subt)},r.GSUB.subt=function(e,t,n){var a=r._bin,i=n,o={};if(o.fmt=a.readUshort(e,n),n+=2,1!=t&&4!=t&&5!=t&&6!=t)return null;if(1==t||4==t||5==t&&o.fmt<=2||6==t&&o.fmt<=2){var s=a.readUshort(e,n);n+=2,o.coverage=r._lctf.readCoverage(e,i+s)}if(1==t){if(1==o.fmt)o.delta=a.readShort(e,n),n+=2;else if(2==o.fmt){var u=a.readUshort(e,n);n+=2,o.newg=a.readUshorts(e,n,u),n+=2*o.newg.length}}else if(4==t){o.vals=[],u=a.readUshort(e,n),n+=2;for(var l=0;l<u;l++){var f=a.readUshort(e,n);n+=2,o.vals.push(r.GSUB.readLigatureSet(e,i+f))}}else if(5==t){if(2==o.fmt){var c=a.readUshort(e,n);n+=2,o.cDef=r._lctf.readClassDef(e,i+c),o.scset=[];var h=a.readUshort(e,n);for(n+=2,l=0;l<h;l++){var d=a.readUshort(e,n);n+=2,o.scset.push(0==d?null:r.GSUB.readSubClassSet(e,i+d))}}}else if(6==t&&3==o.fmt){for(l=0;l<3;l++){u=a.readUshort(e,n),n+=2;for(var p=[],v=0;v<u;v++)p.push(r._lctf.readCoverage(e,i+a.readUshort(e,n+2*v)));n+=2*u,0==l&&(o.backCvg=p),1==l&&(o.inptCvg=p),2==l&&(o.ahedCvg=p)}u=a.readUshort(e,n),n+=2,o.lookupRec=r.GSUB.readSubstLookupRecords(e,n,u)}return o},r.GSUB.readSubClassSet=function(e,t){var n=r._bin.readUshort,a=t,i=[],o=n(e,t);t+=2;for(var s=0;s<o;s++){var u=n(e,t);t+=2,i.push(r.GSUB.readSubClassRule(e,a+u))}return i},r.GSUB.readSubClassRule=function(e,t){var n=r._bin.readUshort,a={},i=n(e,t),o=n(e,t+=2);t+=2,a.input=[];for(var s=0;s<i-1;s++)a.input.push(n(e,t)),t+=2;return a.substLookupRecords=r.GSUB.readSubstLookupRecords(e,t,o),a},r.GSUB.readSubstLookupRecords=function(e,t,n){for(var a=r._bin.readUshort,i=[],o=0;o<n;o++)i.push(a(e,t),a(e,t+2)),t+=4;return i},r.GSUB.readChainSubClassSet=function(e,t){var n=r._bin,a=t,i=[],o=n.readUshort(e,t);t+=2;for(var s=0;s<o;s++){var u=n.readUshort(e,t);t+=2,i.push(r.GSUB.readChainSubClassRule(e,a+u))}return i},r.GSUB.readChainSubClassRule=function(e,t){for(var n=r._bin,a={},i=["backtrack","input","lookahead"],o=0;o<i.length;o++){var s=n.readUshort(e,t);t+=2,1==o&&s--,a[i[o]]=n.readUshorts(e,t,s),t+=2*a[i[o]].length}return s=n.readUshort(e,t),t+=2,a.subst=n.readUshorts(e,t,2*s),t+=2*a.subst.length,a},r.GSUB.readLigatureSet=function(e,t){var n=r._bin,a=t,i=[],o=n.readUshort(e,t);t+=2;for(var s=0;s<o;s++){var u=n.readUshort(e,t);t+=2,i.push(r.GSUB.readLigature(e,a+u))}return i},r.GSUB.readLigature=function(e,t){var n=r._bin,a={chain:[]};a.nglyph=n.readUshort(e,t),t+=2;var i=n.readUshort(e,t);t+=2;for(var o=0;o<i-1;o++)a.chain.push(n.readUshort(e,t)),t+=2;return a},r.head={},r.head.parse=function(e,t,n){var a=r._bin,i={};return a.readFixed(e,t),t+=4,i.fontRevision=a.readFixed(e,t),t+=4,a.readUint(e,t),t+=4,a.readUint(e,t),t+=4,i.flags=a.readUshort(e,t),t+=2,i.unitsPerEm=a.readUshort(e,t),t+=2,i.created=a.readUint64(e,t),t+=8,i.modified=a.readUint64(e,t),t+=8,i.xMin=a.readShort(e,t),t+=2,i.yMin=a.readShort(e,t),t+=2,i.xMax=a.readShort(e,t),t+=2,i.yMax=a.readShort(e,t),t+=2,i.macStyle=a.readUshort(e,t),t+=2,i.lowestRecPPEM=a.readUshort(e,t),t+=2,i.fontDirectionHint=a.readShort(e,t),t+=2,i.indexToLocFormat=a.readShort(e,t),t+=2,i.glyphDataFormat=a.readShort(e,t),t+=2,i},r.hhea={},r.hhea.parse=function(e,t,n){var a=r._bin,i={};return a.readFixed(e,t),t+=4,i.ascender=a.readShort(e,t),t+=2,i.descender=a.readShort(e,t),t+=2,i.lineGap=a.readShort(e,t),t+=2,i.advanceWidthMax=a.readUshort(e,t),t+=2,i.minLeftSideBearing=a.readShort(e,t),t+=2,i.minRightSideBearing=a.readShort(e,t),t+=2,i.xMaxExtent=a.readShort(e,t),t+=2,i.caretSlopeRise=a.readShort(e,t),t+=2,i.caretSlopeRun=a.readShort(e,t),t+=2,i.caretOffset=a.readShort(e,t),t+=2,t+=8,i.metricDataFormat=a.readShort(e,t),t+=2,i.numberOfHMetrics=a.readUshort(e,t),t+=2,i},r.hmtx={},r.hmtx.parse=function(e,t,n,a){for(var i=r._bin,o={aWidth:[],lsBearing:[]},s=0,u=0,l=0;l<a.maxp.numGlyphs;l++)l<a.hhea.numberOfHMetrics&&(s=i.readUshort(e,t),t+=2,u=i.readShort(e,t),t+=2),o.aWidth.push(s),o.lsBearing.push(u);return o},r.kern={},r.kern.parse=function(e,t,n,a){var i=r._bin,o=i.readUshort(e,t);if(t+=2,1==o)return r.kern.parseV1(e,t-2,n,a);var s=i.readUshort(e,t);t+=2;for(var u={glyph1:[],rval:[]},l=0;l<s;l++){t+=2,n=i.readUshort(e,t),t+=2;var f=i.readUshort(e,t);t+=2;var c=f>>>8;if(0!=(c&=15))throw"unknown kern table format: "+c;t=r.kern.readFormat0(e,t,u)}return u},r.kern.parseV1=function(e,t,n,a){var i=r._bin;i.readFixed(e,t),t+=4;var o=i.readUint(e,t);t+=4;for(var s={glyph1:[],rval:[]},u=0;u<o;u++){i.readUint(e,t),t+=4;var l=i.readUshort(e,t);t+=2,i.readUshort(e,t),t+=2;var f=l>>>8;if(0!=(f&=15))throw"unknown kern table format: "+f;t=r.kern.readFormat0(e,t,s)}return s},r.kern.readFormat0=function(e,t,n){var a=r._bin,i=-1,o=a.readUshort(e,t);t+=2,a.readUshort(e,t),t+=2,a.readUshort(e,t),t+=2,a.readUshort(e,t),t+=2;for(var s=0;s<o;s++){var u=a.readUshort(e,t);t+=2;var l=a.readUshort(e,t);t+=2;var f=a.readShort(e,t);t+=2,u!=i&&(n.glyph1.push(u),n.rval.push({glyph2:[],vals:[]}));var c=n.rval[n.rval.length-1];c.glyph2.push(l),c.vals.push(f),i=u}return t},r.loca={},r.loca.parse=function(e,t,n,a){var i=r._bin,o=[],s=a.head.indexToLocFormat,u=a.maxp.numGlyphs+1;if(0==s)for(var l=0;l<u;l++)o.push(i.readUshort(e,t+(l<<1))<<1);if(1==s)for(l=0;l<u;l++)o.push(i.readUint(e,t+(l<<2)));return o},r.maxp={},r.maxp.parse=function(e,t,n){var a=r._bin,i={},o=a.readUint(e,t);return t+=4,i.numGlyphs=a.readUshort(e,t),t+=2,65536==o&&(i.maxPoints=a.readUshort(e,t),t+=2,i.maxContours=a.readUshort(e,t),t+=2,i.maxCompositePoints=a.readUshort(e,t),t+=2,i.maxCompositeContours=a.readUshort(e,t),t+=2,i.maxZones=a.readUshort(e,t),t+=2,i.maxTwilightPoints=a.readUshort(e,t),t+=2,i.maxStorage=a.readUshort(e,t),t+=2,i.maxFunctionDefs=a.readUshort(e,t),t+=2,i.maxInstructionDefs=a.readUshort(e,t),t+=2,i.maxStackElements=a.readUshort(e,t),t+=2,i.maxSizeOfInstructions=a.readUshort(e,t),t+=2,i.maxComponentElements=a.readUshort(e,t),t+=2,i.maxComponentDepth=a.readUshort(e,t),t+=2),i},r.name={},r.name.parse=function(e,t,n){var a=r._bin,i={};a.readUshort(e,t),t+=2;var o=a.readUshort(e,t);t+=2,a.readUshort(e,t);for(var s,u=["copyright","fontFamily","fontSubfamily","ID","fullName","version","postScriptName","trademark","manufacturer","designer","description","urlVendor","urlDesigner","licence","licenceURL","---","typoFamilyName","typoSubfamilyName","compatibleFull","sampleText","postScriptCID","wwsFamilyName","wwsSubfamilyName","lightPalette","darkPalette"],l=t+=2,f=0;f<o;f++){var c=a.readUshort(e,t);t+=2;var h=a.readUshort(e,t);t+=2;var d=a.readUshort(e,t);t+=2;var p=a.readUshort(e,t);t+=2;var v=a.readUshort(e,t);t+=2;var g=a.readUshort(e,t);t+=2;var m,y=u[p],b=l+12*o+g;if(0==c)m=a.readUnicode(e,b,v/2);else if(3==c&&0==h)m=a.readUnicode(e,b,v/2);else if(0==h)m=a.readASCII(e,b,v);else if(1==h)m=a.readUnicode(e,b,v/2);else if(3==h)m=a.readUnicode(e,b,v/2);else{if(1!=c)throw"unknown encoding "+h+", platformID: "+c;m=a.readASCII(e,b,v),console.log("reading unknown MAC encoding "+h+" as ASCII")}var x="p"+c+","+d.toString(16);null==i[x]&&(i[x]={}),i[x][y]=m,i[x]._lang=d}for(var S in i)if(null!=i[S].postScriptName&&1033==i[S]._lang)return i[S];for(var S in i)if(null!=i[S].postScriptName&&0==i[S]._lang)return i[S];for(var S in i)if(null!=i[S].postScriptName&&3084==i[S]._lang)return i[S];for(var S in i)if(null!=i[S].postScriptName)return i[S];for(var S in i){s=S;break}return console.log("returning name table with languageID "+i[s]._lang),i[s]},r["OS/2"]={},r["OS/2"].parse=function(e,t,n){var a=r._bin.readUshort(e,t);t+=2;var i={};if(0==a)r["OS/2"].version0(e,t,i);else if(1==a)r["OS/2"].version1(e,t,i);else if(2==a||3==a||4==a)r["OS/2"].version2(e,t,i);else{if(5!=a)throw"unknown OS/2 table version: "+a;r["OS/2"].version5(e,t,i)}return i},r["OS/2"].version0=function(e,t,n){var a=r._bin;return n.xAvgCharWidth=a.readShort(e,t),t+=2,n.usWeightClass=a.readUshort(e,t),t+=2,n.usWidthClass=a.readUshort(e,t),t+=2,n.fsType=a.readUshort(e,t),t+=2,n.ySubscriptXSize=a.readShort(e,t),t+=2,n.ySubscriptYSize=a.readShort(e,t),t+=2,n.ySubscriptXOffset=a.readShort(e,t),t+=2,n.ySubscriptYOffset=a.readShort(e,t),t+=2,n.ySuperscriptXSize=a.readShort(e,t),t+=2,n.ySuperscriptYSize=a.readShort(e,t),t+=2,n.ySuperscriptXOffset=a.readShort(e,t),t+=2,n.ySuperscriptYOffset=a.readShort(e,t),t+=2,n.yStrikeoutSize=a.readShort(e,t),t+=2,n.yStrikeoutPosition=a.readShort(e,t),t+=2,n.sFamilyClass=a.readShort(e,t),t+=2,n.panose=a.readBytes(e,t,10),t+=10,n.ulUnicodeRange1=a.readUint(e,t),t+=4,n.ulUnicodeRange2=a.readUint(e,t),t+=4,n.ulUnicodeRange3=a.readUint(e,t),t+=4,n.ulUnicodeRange4=a.readUint(e,t),t+=4,n.achVendID=[a.readInt8(e,t),a.readInt8(e,t+1),a.readInt8(e,t+2),a.readInt8(e,t+3)],t+=4,n.fsSelection=a.readUshort(e,t),t+=2,n.usFirstCharIndex=a.readUshort(e,t),t+=2,n.usLastCharIndex=a.readUshort(e,t),t+=2,n.sTypoAscender=a.readShort(e,t),t+=2,n.sTypoDescender=a.readShort(e,t),t+=2,n.sTypoLineGap=a.readShort(e,t),t+=2,n.usWinAscent=a.readUshort(e,t),t+=2,n.usWinDescent=a.readUshort(e,t),t+=2},r["OS/2"].version1=function(e,t,n){var a=r._bin;return t=r["OS/2"].version0(e,t,n),n.ulCodePageRange1=a.readUint(e,t),t+=4,n.ulCodePageRange2=a.readUint(e,t),t+=4},r["OS/2"].version2=function(e,t,n){var a=r._bin;return t=r["OS/2"].version1(e,t,n),n.sxHeight=a.readShort(e,t),t+=2,n.sCapHeight=a.readShort(e,t),t+=2,n.usDefault=a.readUshort(e,t),t+=2,n.usBreak=a.readUshort(e,t),t+=2,n.usMaxContext=a.readUshort(e,t),t+=2},r["OS/2"].version5=function(e,t,n){var a=r._bin;return t=r["OS/2"].version2(e,t,n),n.usLowerOpticalPointSize=a.readUshort(e,t),t+=2,n.usUpperOpticalPointSize=a.readUshort(e,t),t+=2},r.post={},r.post.parse=function(e,t,n){var a=r._bin,i={};return i.version=a.readFixed(e,t),t+=4,i.italicAngle=a.readFixed(e,t),t+=4,i.underlinePosition=a.readShort(e,t),t+=2,i.underlineThickness=a.readShort(e,t),t+=2,i},r.SVG={},r.SVG.parse=function(e,t,n){var a=r._bin,i={entries:[]},o=t;a.readUshort(e,t),t+=2;var s=a.readUint(e,t);t+=4,a.readUint(e,t),t+=4,t=s+o;var u=a.readUshort(e,t);t+=2;for(var l=0;l<u;l++){var f=a.readUshort(e,t);t+=2;var c=a.readUshort(e,t);t+=2;var h=a.readUint(e,t);t+=4;var d=a.readUint(e,t);t+=4;for(var p=new Uint8Array(e.buffer,o+h+s,d),v=a.readUTF8(p,0,p.length),g=f;g<=c;g++)i.entries[g]=v}return i},r.SVG.toPath=function(e){var t={cmds:[],crds:[]};if(null==e)return t;for(var n=(new DOMParser).parseFromString(e,"image/svg+xml").firstChild;"svg"!=n.tagName;)n=n.nextSibling;var a=n.getAttribute("viewBox");a=a?a.trim().split(" ").map(parseFloat):[0,0,1e3,1e3],r.SVG._toPath(n.children,t);for(var i=0;i<t.crds.length;i+=2){var o=t.crds[i],s=t.crds[i+1];o-=a[0],s=-(s-=a[1]),t.crds[i]=o,t.crds[i+1]=s}return t},r.SVG._toPath=function(e,t,n){for(var a=0;a<e.length;a++){var i=e[a],o=i.tagName,s=i.getAttribute("fill");if(null==s&&(s=n),"g"==o)r.SVG._toPath(i.children,t,s);else if("path"==o){t.cmds.push(s||"#000000");var u=i.getAttribute("d"),l=r.SVG._tokens(u);r.SVG._toksToPath(l,t),t.cmds.push("X")}else"defs"==o||console.log(o,i)}},r.SVG._tokens=function(e){for(var r=[],t=0,n=!1,a="";t<e.length;){var i=e.charCodeAt(t),o=e.charAt(t);t++;var s=48<=i&&i<=57||"."==o||"-"==o;n?"-"==o?(r.push(parseFloat(a)),a=o):s?a+=o:(r.push(parseFloat(a)),","!=o&&" "!=o&&r.push(o),n=!1):s?(a=o,n=!0):","!=o&&" "!=o&&r.push(o)}return n&&r.push(parseFloat(a)),r},r.SVG._toksToPath=function(e,t){for(var n=0,a=0,i=0,o=0,s=0,u={M:2,L:2,H:1,V:1,S:4,C:6},l=t.cmds,f=t.crds;n<e.length;){var c=e[n];if(n++,"z"==c)l.push("Z"),a=o,i=s;else for(var h=c.toUpperCase(),d=u[h],p=r.SVG._reps(e,n,d),v=0;v<p;v++){var g=0,m=0;if(c!=h&&(g=a,m=i),"M"==h)a=g+e[n++],i=m+e[n++],l.push("M"),f.push(a,i),o=a,s=i;else if("L"==h)a=g+e[n++],i=m+e[n++],l.push("L"),f.push(a,i);else if("H"==h)a=g+e[n++],l.push("L"),f.push(a,i);else if("V"==h)i=m+e[n++],l.push("L"),f.push(a,i);else if("C"==h){var y=g+e[n++],b=m+e[n++],x=g+e[n++],S=m+e[n++],U=g+e[n++],_=m+e[n++];l.push("C"),f.push(y,b,x,S,U,_),a=U,i=_}else if("S"==h){var w=Math.max(f.length-4,0);y=a+a-f[w],b=i+i-f[w+1],x=g+e[n++],S=m+e[n++],U=g+e[n++],_=m+e[n++],l.push("C"),f.push(y,b,x,S,U,_),a=U,i=_}else console.log("Unknown SVG command "+c)}}},r.SVG._reps=function(e,r,t){for(var n=r;n<e.length&&"string"!=typeof e[n];)n+=t;return(n-r)/t},null==r&&(r={}),null==r.U&&(r.U={}),r.U.codeToGlyph=function(e,r){var t=e.cmap,n=-1;if(null!=t.p0e4?n=t.p0e4:null!=t.p3e1?n=t.p3e1:null!=t.p1e0?n=t.p1e0:null!=t.p0e3&&(n=t.p0e3),-1==n)throw"no familiar platform and encoding!";var a=t.tables[n];if(0==a.format)return r>=a.map.length?0:a.map[r];if(4==a.format){for(var i=-1,o=0;o<a.endCount.length;o++)if(r<=a.endCount[o]){i=o;break}return-1==i||a.startCount[i]>r?0:65535&(0!=a.idRangeOffset[i]?a.glyphIdArray[r-a.startCount[i]+(a.idRangeOffset[i]>>1)-(a.idRangeOffset.length-i)]:r+a.idDelta[i])}if(12==a.format){if(r>a.groups[a.groups.length-1][1])return 0;for(o=0;o<a.groups.length;o++){var s=a.groups[o];if(s[0]<=r&&r<=s[1])return s[2]+(r-s[0])}return 0}throw"unknown cmap table format "+a.format},r.U.glyphToPath=function(e,t){var n={cmds:[],crds:[]};if(e.SVG&&e.SVG.entries[t]){var a=e.SVG.entries[t];return null==a?n:("string"==typeof a&&(a=r.SVG.toPath(a),e.SVG.entries[t]=a),a)}if(e.CFF){var i={x:0,y:0,stack:[],nStems:0,haveWidth:!1,width:e.CFF.Private?e.CFF.Private.defaultWidthX:0,open:!1},o=e.CFF,s=e.CFF.Private;if(o.ROS){for(var u=0;o.FDSelect[u+2]<=t;)u+=2;s=o.FDArray[o.FDSelect[u+1]].Private}r.U._drawCFF(e.CFF.CharStrings[t],i,o,s,n)}else e.glyf&&r.U._drawGlyf(t,e,n);return n},r.U._drawGlyf=function(e,t,n){var a=t.glyf[e];null==a&&(a=t.glyf[e]=r.glyf._parseGlyf(t,e)),null!=a&&(a.noc>-1?r.U._simpleGlyph(a,n):r.U._compoGlyph(a,t,n))},r.U._simpleGlyph=function(e,t){for(var n=0;n<e.noc;n++){for(var a=0==n?0:e.endPts[n-1]+1,i=e.endPts[n],o=a;o<=i;o++){var s=o==a?i:o-1,u=o==i?a:o+1,l=1&e.flags[o],f=1&e.flags[s],c=1&e.flags[u],h=e.xs[o],d=e.ys[o];if(o==a)if(l){if(!f){r.U.P.moveTo(t,h,d);continue}r.U.P.moveTo(t,e.xs[s],e.ys[s])}else f?r.U.P.moveTo(t,e.xs[s],e.ys[s]):r.U.P.moveTo(t,(e.xs[s]+h)/2,(e.ys[s]+d)/2);l?f&&r.U.P.lineTo(t,h,d):c?r.U.P.qcurveTo(t,h,d,e.xs[u],e.ys[u]):r.U.P.qcurveTo(t,h,d,(h+e.xs[u])/2,(d+e.ys[u])/2)}r.U.P.closePath(t)}},r.U._compoGlyph=function(e,t,n){for(var a=0;a<e.parts.length;a++){var i={cmds:[],crds:[]},o=e.parts[a];r.U._drawGlyf(o.glyphIndex,t,i);for(var s=o.m,u=0;u<i.crds.length;u+=2){var l=i.crds[u],f=i.crds[u+1];n.crds.push(l*s.a+f*s.b+s.tx),n.crds.push(l*s.c+f*s.d+s.ty)}for(u=0;u<i.cmds.length;u++)n.cmds.push(i.cmds[u])}},r.U._getGlyphClass=function(e,t){var n=r._lctf.getInterval(t,e);return-1==n?0:t[n+2]},r.U.getPairAdjustment=function(e,t,n){if(e.GPOS)for(var a=e.GPOS,i=a.lookupList,o=a.featureList,s=[],u=0;u<o.length;u++){var l=o[u];if("kern"==l.tag)for(var f=0;f<l.tab.length;f++)if(!s[l.tab[f]]){s[l.tab[f]]=!0;for(var c=i[l.tab[f]],h=0;h<c.tabs.length;h++)if(null!=c.tabs[u]){var d,p=c.tabs[h];if(!p.coverage||-1!=(d=r._lctf.coverageIndex(p.coverage,t)))if(1==c.ltype);else if(2==c.ltype){var v;if(1==p.fmt){var g=p.pairsets[d];for(u=0;u<g.length;u++)g[u].gid2==n&&(v=g[u])}else if(2==p.fmt){var m=r.U._getGlyphClass(t,p.classDef1),y=r.U._getGlyphClass(n,p.classDef2);v=p.matrix[m][y]}if(v&&v.val2)return v.val2[2]}}}}if(e.kern){var b=e.kern.glyph1.indexOf(t);if(-1!=b){var x=e.kern.rval[b].glyph2.indexOf(n);if(-1!=x)return e.kern.rval[b].vals[x]}}return 0},r.U.stringToGlyphs=function(e,t){for(var n=[],a=0;a<t.length;a++)(i=t.codePointAt(a))>65535&&a++,n.push(r.U.codeToGlyph(e,i));for(a=0;a<t.length;a++){var i;if(2367==(i=t.codePointAt(a))){var o=n[a-1];n[a-1]=n[a],n[a]=o}i>65535&&a++}var s=e.GSUB;if(null==s)return n;for(var u=s.lookupList,l=s.featureList,f=["rlig","liga","mset","isol","init","fina","medi","half","pres","blws"],c=[],h=0;h<l.length;h++){var d=l[h];if(-1!=f.indexOf(d.tag))for(var p=0;p<d.tab.length;p++)if(!c[d.tab[p]]){c[d.tab[p]]=!0;for(var v=u[d.tab[p]],g=0;g<n.length;g++){var m=r.U._getWPfeature(t,g);-1!="isol,init,fina,medi".indexOf(d.tag)&&d.tag!=m||r.U._applySubs(n,g,v,u)}}}return n},r.U._getWPfeature=function(e,r){var t='\n\t" ,.:;!?()  \u060c',n="\u0622\u0623\u0624\u0625\u0627\u0629\u062f\u0630\u0631\u0632\u0648\u0671\u0672\u0673\u0675\u0676\u0677\u0688\u0689\u068a\u068b\u068c\u068d\u068e\u068f\u0690\u0691\u0692\u0693\u0694\u0695\u0696\u0697\u0698\u0699\u06c0\u06c3\u06c4\u06c5\u06c6\u06c7\u06c8\u06c9\u06ca\u06cb\u06cd\u06cf\u06d2\u06d3\u06d5\u06ee\u06ef\u0710\u0715\u0716\u0717\u0718\u0719\u071e\u0728\u072a\u072c\u072f\u074d\u0759\u075a\u075b\u076b\u076c\u0771\u0773\u0774\u0778\u0779\u0840\u0846\u0847\u0849\u0854\u0867\u0869\u086a\u08aa\u08ab\u08ac\u08ae\u08b1\u08b2\u08b9\u0ac5\u0ac7\u0ac9\u0aca\u0ace\u0acf\u0ad0\u0ad1\u0ad2\u0add\u0ae1\u0ae4\u0aef\u0b81\u0b83\u0b84\u0b85\u0b89\u0b8c\u0b8e\u0b8f\u0b91\u0ba9\u0baa\u0bab\u0bac",a=0==r||-1!=t.indexOf(e[r-1]),i=r==e.length-1||-1!=t.indexOf(e[r+1]);return a||-1==n.indexOf(e[r-1])||(a=!0),i||-1==n.indexOf(e[r])||(i=!0),i||-1=="\ua872\u0acd\u0ad7".indexOf(e[r+1])||(i=!0),a||-1=="\ua872\u0acd\u0ad7".indexOf(e[r])||(a=!0),a?i?"isol":"init":i?"fina":"medi"},r.U._applySubs=function(e,t,n,a){for(var i=e.length-t-1,o=0;o<n.tabs.length;o++)if(null!=n.tabs[o]){var s,u=n.tabs[o];if(!u.coverage||-1!=(s=r._lctf.coverageIndex(u.coverage,e[t])))if(1==n.ltype)e[t],1==u.fmt?e[t]=e[t]+u.delta:e[t]=u.newg[s];else if(4==n.ltype)for(var l=u.vals[s],f=0;f<l.length;f++){var c=l[f],h=c.chain.length;if(!(h>i)){for(var d=!0,p=0,v=0;v<h;v++){for(;-1==e[t+p+(1+v)];)p++;c.chain[v]!=e[t+p+(1+v)]&&(d=!1)}if(d){for(e[t]=c.nglyph,v=0;v<h+p;v++)e[t+v+1]=-1;break}}}else if(5==n.ltype&&2==u.fmt)for(var g=r._lctf.getInterval(u.cDef,e[t]),m=u.cDef[g+2],y=u.scset[m],b=0;b<y.length;b++){var x=y[b],S=x.input;if(!(S.length>i)){for(d=!0,v=0;v<S.length;v++){var U=r._lctf.getInterval(u.cDef,e[t+1+v]);if(-1==g&&u.cDef[U+2]!=S[v]){d=!1;break}}if(d){var _=x.substLookupRecords;for(f=0;f<_.length;f+=2)_[f],_[f+1]}}}else if(6==n.ltype&&3==u.fmt){if(!r.U._glsCovered(e,u.backCvg,t-u.backCvg.length))continue;if(!r.U._glsCovered(e,u.inptCvg,t))continue;if(!r.U._glsCovered(e,u.ahedCvg,t+u.inptCvg.length))continue;var w=u.lookupRec;for(b=0;b<w.length;b+=2){g=w[b];var M=a[w[b+1]];r.U._applySubs(e,t+g,M,a)}}}},r.U._glsCovered=function(e,t,n){for(var a=0;a<t.length;a++)if(-1==r._lctf.coverageIndex(t[a],e[n+a]))return!1;return!0},r.U.glyphsToPath=function(e,t,n){for(var a={cmds:[],crds:[]},i=0,o=0;o<t.length;o++){var s=t[o];if(-1!=s){for(var u=o<t.length-1&&-1!=t[o+1]?t[o+1]:0,l=r.U.glyphToPath(e,s),f=0;f<l.crds.length;f+=2)a.crds.push(l.crds[f]+i),a.crds.push(l.crds[f+1]);for(n&&a.cmds.push(n),f=0;f<l.cmds.length;f++)a.cmds.push(l.cmds[f]);n&&a.cmds.push("X"),i+=e.hmtx.aWidth[s],o<t.length-1&&(i+=r.U.getPairAdjustment(e,s,u))}}return a},r.U.pathToSVG=function(e,r){null==r&&(r=5);for(var t=[],n=0,a={M:2,L:2,Q:4,C:6},i=0;i<e.cmds.length;i++){var o=e.cmds[i],s=n+(a[o]?a[o]:0);for(t.push(o);n<s;){var u=e.crds[n++];t.push(parseFloat(u.toFixed(r))+(n==s?"":" "))}}return t.join("")},r.U.pathToContext=function(e,r){for(var t=0,n=e.crds,a=0;a<e.cmds.length;a++){var i=e.cmds[a];"M"==i?(r.moveTo(n[t],n[t+1]),t+=2):"L"==i?(r.lineTo(n[t],n[t+1]),t+=2):"C"==i?(r.bezierCurveTo(n[t],n[t+1],n[t+2],n[t+3],n[t+4],n[t+5]),t+=6):"Q"==i?(r.quadraticCurveTo(n[t],n[t+1],n[t+2],n[t+3]),t+=4):"#"==i.charAt(0)?(r.beginPath(),r.fillStyle=i):"Z"==i?r.closePath():"X"==i&&r.fill()}},r.U.P={},r.U.P.moveTo=function(e,r,t){e.cmds.push("M"),e.crds.push(r,t)},r.U.P.lineTo=function(e,r,t){e.cmds.push("L"),e.crds.push(r,t)},r.U.P.curveTo=function(e,r,t,n,a,i,o){e.cmds.push("C"),e.crds.push(r,t,n,a,i,o)},r.U.P.qcurveTo=function(e,r,t,n,a){e.cmds.push("Q"),e.crds.push(r,t,n,a)},r.U.P.closePath=function(e){e.cmds.push("Z")},r.U._drawCFF=function(e,t,n,a,i){for(var o=t.stack,s=t.nStems,u=t.haveWidth,l=t.width,f=t.open,c=0,h=t.x,d=t.y,p=0,v=0,g=0,m=0,y=0,b=0,x=0,S=0,U=0,_=0,w={val:0,size:0};c<e.length;){r.CFF.getCharString(e,c,w);var M=w.val;if(c+=w.size,"o1"==M||"o18"==M)o.length%2!==0&&!u&&(l=o.shift()+a.nominalWidthX),s+=o.length>>1,o.length=0,u=!0;else if("o3"==M||"o23"==M)o.length%2!==0&&!u&&(l=o.shift()+a.nominalWidthX),s+=o.length>>1,o.length=0,u=!0;else if("o4"==M)o.length>1&&!u&&(l=o.shift()+a.nominalWidthX,u=!0),f&&r.U.P.closePath(i),d+=o.pop(),r.U.P.moveTo(i,h,d),f=!0;else if("o5"==M)for(;o.length>0;)h+=o.shift(),d+=o.shift(),r.U.P.lineTo(i,h,d);else if("o6"==M||"o7"==M)for(var F=o.length,T="o6"==M,k=0;k<F;k++){var C=o.shift();T?h+=C:d+=C,T=!T,r.U.P.lineTo(i,h,d)}else if("o8"==M||"o24"==M){F=o.length;for(var D=0;D+6<=F;)p=h+o.shift(),v=d+o.shift(),g=p+o.shift(),m=v+o.shift(),h=g+o.shift(),d=m+o.shift(),r.U.P.curveTo(i,p,v,g,m,h,d),D+=6;"o24"==M&&(h+=o.shift(),d+=o.shift(),r.U.P.lineTo(i,h,d))}else{if("o11"==M)break;if("o1234"==M||"o1235"==M||"o1236"==M||"o1237"==M)"o1234"==M&&(v=d,g=(p=h+o.shift())+o.shift(),_=m=v+o.shift(),b=m,S=d,h=(x=(y=(U=g+o.shift())+o.shift())+o.shift())+o.shift(),r.U.P.curveTo(i,p,v,g,m,U,_),r.U.P.curveTo(i,y,b,x,S,h,d)),"o1235"==M&&(p=h+o.shift(),v=d+o.shift(),g=p+o.shift(),m=v+o.shift(),U=g+o.shift(),_=m+o.shift(),y=U+o.shift(),b=_+o.shift(),x=y+o.shift(),S=b+o.shift(),h=x+o.shift(),d=S+o.shift(),o.shift(),r.U.P.curveTo(i,p,v,g,m,U,_),r.U.P.curveTo(i,y,b,x,S,h,d)),"o1236"==M&&(p=h+o.shift(),v=d+o.shift(),g=p+o.shift(),_=m=v+o.shift(),b=m,x=(y=(U=g+o.shift())+o.shift())+o.shift(),S=b+o.shift(),h=x+o.shift(),r.U.P.curveTo(i,p,v,g,m,U,_),r.U.P.curveTo(i,y,b,x,S,h,d)),"o1237"==M&&(p=h+o.shift(),v=d+o.shift(),g=p+o.shift(),m=v+o.shift(),U=g+o.shift(),_=m+o.shift(),y=U+o.shift(),b=_+o.shift(),x=y+o.shift(),S=b+o.shift(),Math.abs(x-h)>Math.abs(S-d)?h=x+o.shift():d=S+o.shift(),r.U.P.curveTo(i,p,v,g,m,U,_),r.U.P.curveTo(i,y,b,x,S,h,d));else if("o14"==M){if(o.length>0&&!u&&(l=o.shift()+n.nominalWidthX,u=!0),4==o.length){var O=o.shift(),P=o.shift(),I=o.shift(),A=o.shift(),B=r.CFF.glyphBySE(n,I),G=r.CFF.glyphBySE(n,A);r.U._drawCFF(n.CharStrings[B],t,n,a,i),t.x=O,t.y=P,r.U._drawCFF(n.CharStrings[G],t,n,a,i)}f&&(r.U.P.closePath(i),f=!1)}else if("o19"==M||"o20"==M)o.length%2!==0&&!u&&(l=o.shift()+a.nominalWidthX),s+=o.length>>1,o.length=0,u=!0,c+=s+7>>3;else if("o21"==M)o.length>2&&!u&&(l=o.shift()+a.nominalWidthX,u=!0),d+=o.pop(),h+=o.pop(),f&&r.U.P.closePath(i),r.U.P.moveTo(i,h,d),f=!0;else if("o22"==M)o.length>1&&!u&&(l=o.shift()+a.nominalWidthX,u=!0),h+=o.pop(),f&&r.U.P.closePath(i),r.U.P.moveTo(i,h,d),f=!0;else if("o25"==M){for(;o.length>6;)h+=o.shift(),d+=o.shift(),r.U.P.lineTo(i,h,d);p=h+o.shift(),v=d+o.shift(),g=p+o.shift(),m=v+o.shift(),h=g+o.shift(),d=m+o.shift(),r.U.P.curveTo(i,p,v,g,m,h,d)}else if("o26"==M)for(o.length%2&&(h+=o.shift());o.length>0;)p=h,v=d+o.shift(),h=g=p+o.shift(),d=(m=v+o.shift())+o.shift(),r.U.P.curveTo(i,p,v,g,m,h,d);else if("o27"==M)for(o.length%2&&(d+=o.shift());o.length>0;)v=d,g=(p=h+o.shift())+o.shift(),m=v+o.shift(),h=g+o.shift(),d=m,r.U.P.curveTo(i,p,v,g,m,h,d);else if("o10"==M||"o29"==M){var L="o10"==M?a:n;if(0==o.length)console.log("error: empty stack");else{var R=o.pop(),E=L.Subrs[R+L.Bias];t.x=h,t.y=d,t.nStems=s,t.haveWidth=u,t.width=l,t.open=f,r.U._drawCFF(E,t,n,a,i),h=t.x,d=t.y,s=t.nStems,u=t.haveWidth,l=t.width,f=t.open}}else if("o30"==M||"o31"==M){var z=o.length,W=(D=0,"o31"==M);for(D+=z-(F=-3&z);D<F;)W?(v=d,g=(p=h+o.shift())+o.shift(),d=(m=v+o.shift())+o.shift(),F-D==5?(h=g+o.shift(),D++):h=g,W=!1):(p=h,v=d+o.shift(),g=p+o.shift(),m=v+o.shift(),h=g+o.shift(),F-D==5?(d=m+o.shift(),D++):d=m,W=!0),r.U.P.curveTo(i,p,v,g,m,h,d),D+=4}else{if("o"==(M+"").charAt(0))throw console.log("Unknown operation: "+M,e),M;o.push(M)}}}t.x=h,t.y=d,t.nStems=s,t.haveWidth=u,t.width=l,t.open=f},r},function(){var e=function(){var e={};function r(){this.table=new Uint16Array(16),this.trans=new Uint16Array(288)}function t(e,t){this.source=e,this.sourceIndex=0,this.tag=0,this.bitcount=0,this.dest=t,this.destLen=0,this.ltree=new r,this.dtree=new r}var n=new r,a=new r,i=new Uint8Array(30),o=new Uint16Array(30),s=new Uint8Array(30),u=new Uint16Array(30),l=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),f=new r,c=new Uint8Array(320);function h(e,r,t,n){var a,i;for(a=0;a<t;++a)e[a]=0;for(a=0;a<30-t;++a)e[a+t]=a/t|0;for(i=n,a=0;a<30;++a)r[a]=i,i+=1<<e[a]}var d=new Uint16Array(16);function p(e,r,t,n){var a,i;for(a=0;a<16;++a)e.table[a]=0;for(a=0;a<n;++a)e.table[r[t+a]]++;for(e.table[0]=0,i=0,a=0;a<16;++a)d[a]=i,i+=e.table[a];for(a=0;a<n;++a)r[t+a]&&(e.trans[d[r[t+a]]++]=a)}function v(e){e.bitcount--||(e.tag=e.source[e.sourceIndex++],e.bitcount=7);var r=1&e.tag;return e.tag>>>=1,r}function g(e,r,t){if(!r)return t;for(;e.bitcount<24;)e.tag|=e.source[e.sourceIndex++]<<e.bitcount,e.bitcount+=8;var n=e.tag&65535>>>16-r;return e.tag>>>=r,e.bitcount-=r,n+t}function m(e,r){for(;e.bitcount<24;)e.tag|=e.source[e.sourceIndex++]<<e.bitcount,e.bitcount+=8;var t=0,n=0,a=0,i=e.tag;do{n=2*n+(1&i),i>>>=1,++a,t+=r.table[a],n-=r.table[a]}while(n>=0);return e.tag=i,e.bitcount-=a,r.trans[t+n]}function y(e,r,t){var n,a,i,o,s,u;for(n=g(e,5,257),a=g(e,5,1),i=g(e,4,4),o=0;o<19;++o)c[o]=0;for(o=0;o<i;++o){var h=g(e,3,0);c[l[o]]=h}for(p(f,c,0,19),s=0;s<n+a;){var d=m(e,f);switch(d){case 16:var v=c[s-1];for(u=g(e,2,3);u;--u)c[s++]=v;break;case 17:for(u=g(e,3,3);u;--u)c[s++]=0;break;case 18:for(u=g(e,7,11);u;--u)c[s++]=0;break;default:c[s++]=d}}p(r,c,0,n),p(t,c,n,a)}function b(e,r,t){for(;;){var n,a,l,f,c=m(e,r);if(256===c)return 0;if(c<256)e.dest[e.destLen++]=c;else for(n=g(e,i[c-=257],o[c]),a=m(e,t),f=l=e.destLen-g(e,s[a],u[a]);f<l+n;++f)e.dest[e.destLen++]=e.dest[f]}}function x(e){for(var r,t;e.bitcount>8;)e.sourceIndex--,e.bitcount-=8;if((r=256*(r=e.source[e.sourceIndex+1])+e.source[e.sourceIndex])!==(65535&~(256*e.source[e.sourceIndex+3]+e.source[e.sourceIndex+2])))return-3;for(e.sourceIndex+=4,t=r;t;--t)e.dest[e.destLen++]=e.source[e.sourceIndex++];return e.bitcount=0,0}return function(e,r){var t;for(t=0;t<7;++t)e.table[t]=0;for(e.table[7]=24,e.table[8]=152,e.table[9]=112,t=0;t<24;++t)e.trans[t]=256+t;for(t=0;t<144;++t)e.trans[24+t]=t;for(t=0;t<8;++t)e.trans[168+t]=280+t;for(t=0;t<112;++t)e.trans[176+t]=144+t;for(t=0;t<5;++t)r.table[t]=0;for(r.table[5]=32,t=0;t<32;++t)r.trans[t]=t}(n,a),h(i,o,4,3),h(s,u,2,1),i[28]=0,o[28]=258,e.exports=function(e,r){var i,o,s=new t(e,r);do{switch(i=v(s),g(s,2,0)){case 0:o=x(s);break;case 1:o=b(s,n,a);break;case 2:y(s,s.ltree,s.dtree),o=b(s,s.ltree,s.dtree);break;default:o=-3}if(0!==o)throw new Error("Data error")}while(!i);return s.destLen<s.dest.length?"function"===typeof s.dest.slice?s.dest.slice(0,s.destLen):s.dest.subarray(0,s.destLen):s.dest},e.exports}();return function(r){return function(e,r){var t=new DataView(e),n=0;function a(){var e=t.getUint16(n);return n+=2,e}function i(){var e=t.getUint32(n);return n+=4,e}function o(e){y.setUint16(b,e),b+=2}function s(e){y.setUint32(b,e),b+=4}for(var u={signature:i(),flavor:i(),length:i(),numTables:a(),reserved:a(),totalSfntSize:i(),majorVersion:a(),minorVersion:a(),metaOffset:i(),metaLength:i(),metaOrigLength:i(),privOffset:i(),privLength:i()},l=0;Math.pow(2,l)<=u.numTables;)l++;l--;for(var f=16*Math.pow(2,l),c=16*u.numTables-f,h=12,d=[],p=0;p<u.numTables;p++)d.push({tag:i(),offset:i(),compLength:i(),origLength:i(),origChecksum:i()}),h+=16;var v,g=new Uint8Array(12+16*d.length+d.reduce((function(e,r){return e+r.origLength+4}),0)),m=g.buffer,y=new DataView(m),b=0;return s(u.flavor),o(u.numTables),o(f),o(l),o(c),d.forEach((function(e){s(e.tag),s(e.origChecksum),s(h),s(e.origLength),e.outOffset=h,(h+=e.origLength)%4!=0&&(h+=4-h%4)})),d.forEach((function(t){var n=e.slice(t.offset,t.offset+t.compLength);if(t.compLength!=t.origLength){var a=new Uint8Array(t.origLength);r(new Uint8Array(n,2),a)}else a=new Uint8Array(n);g.set(a,t.outOffset);var i=0;(h=t.outOffset+t.origLength)%4!=0&&(i=4-h%4),g.set(new Uint8Array(i).buffer,t.outOffset+t.origLength),v=h+i})),m.slice(0,v)}(r,e)}},function(e,r){var t={M:2,L:2,Q:4,C:6,Z:0};return function(n){var a=new Uint8Array(n,0,4),i=e._bin.readASCII(a,0,4);if("wOFF"===i)n=r(n);else if("wOF2"===i)throw new Error("woff2 fonts not supported");return function(r){var n=Object.create(null),a={unitsPerEm:r.head.unitsPerEm,ascender:r.hhea.ascender,descender:r.hhea.descender,forEachGlyph:function(i,o,s,u){var l=0,f=1/a.unitsPerEm*o,c=e.U.stringToGlyphs(r,i),h=0;return c.forEach((function(a){if(-1!==a){var c=n[a];if(!c){var d,p,v,g,m=e.U.glyphToPath(r,a),y=m.cmds,b=m.crds;if(b.length){d=p=1/0,v=g=-1/0;for(var x=0,S=b.length;x<S;x+=2){var U=b[x],_=b[x+1];U<d&&(d=U),_<p&&(p=_),U>v&&(v=U),_>g&&(g=_)}}else d=v=p=g=0;c=n[a]={index:a,advanceWidth:r.hmtx.aWidth[a],xMin:d,yMin:p,xMax:v,yMax:g,pathCommandCount:y.length,forEachPathCommand:function(e){for(var r=0,n=[],a=0,i=y.length;a<i;a++){var o=t[y[a]];n.length=1+o,n[0]=y[a];for(var s=1;s<=o;s++)n[s]=b[r++];e.apply(null,n)}}}}u.call(null,c,l,h),c.advanceWidth&&(l+=c.advanceWidth*f),s&&(l+=s*o)}h+=i.codePointAt(h)>65535?2:1})),l}};return a}(e.parse(n)[0])}}],init:function(e,r,t){return t(e(),r())}}),o={defaultFontURL:"https://fonts.gstatic.com/s/roboto/v18/KFOmCnqEu92Fr1Mu4mxM.woff",sdfGlyphSize:64,textureWidth:2048},s=new r.Color,u=Object.create(null);function l(e,t){if((e=f({},e)).font=(c=e.font||o.defaultFontURL,a||(a="undefined"===typeof document?{}:document.createElement("a")),a.href=c,a.href),e.text=""+e.text,e.sdfGlyphSize=e.sdfGlyphSize||o.sdfGlyphSize,null!=e.colorRanges){var n={};for(var i in e.colorRanges)if(e.colorRanges.hasOwnProperty(i)){var l=e.colorRanges[i];"number"!==typeof l&&(l=s.set(l).getHex()),n[i]=l}e.colorRanges=n}var c;Object.freeze(e);var d=o.textureWidth,p=e.sdfGlyphSize,v=e.font+"@"+p,g=u[v];g||((g=u[v]={sdfTexture:new r.DataTexture(new Uint8Array(p*d),d,p,r.LuminanceFormat,void 0,void 0,void 0,void 0,r.LinearFilter,r.LinearFilter)}).sdfTexture.font=e.font),h(e).then((function(r){r.newGlyphSDFs&&(r.newGlyphSDFs.forEach((function(e){for(var r=e.textureData,t=e.atlasIndex,n=g.sdfTexture.image;n.data.length<(t+1)*p*p;){var a=new Uint8Array(2*n.data.length);a.set(n.data),n.data=a,n.height*=2}for(var i=n.width/p,o=0;o<p;o++)for(var s=o*p,u=n.width*p*Math.floor(t/i)+t%i*p+o*n.width,l=0;l<p;l++)n.data[u+l]=r[s+l]})),g.sdfTexture.needsUpdate=!0),t(Object.freeze({parameters:e,sdfTexture:g.sdfTexture,sdfGlyphSize:p,sdfMinDistancePercent:1/8,glyphBounds:r.glyphBounds,glyphAtlasIndices:r.glyphAtlasIndices,glyphColors:r.glyphColors,caretPositions:r.caretPositions,caretHeight:r.caretHeight,chunkedBounds:r.chunkedBounds,ascender:r.ascender,descender:r.descender,lineHeight:r.lineHeight,topBaseline:r.topBaseline,totalBounds:r.totalBounds,totalBlockSize:r.totalBlockSize,timings:r.timings}))}))}function f(e,r){for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t]);return e}var c=t.defineWorkerModule({name:"FontProcessor",dependencies:[o,1/8,i,function(e){var r=e.xMin,t=e.yMin,n=e.xMax-r,a=e.yMax-t,i={0:null,1:null,2:null,3:null,data:null,cx:Math.round(r+n/2),cy:Math.round(t+a/2),r:Math.pow(2,Math.floor(Math.log(Math.max(n,a))*Math.LOG2E)),minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};function o(e){!function e(r,t){if(!1!==t(r)&&!r.data)for(var n=0;n<4;n++)null!==r[n]&&e(r[n],t)}(i,e)}function s(e,r,t,n,a,i){var o=a-t,s=i-n,u=o*o+s*s,l=u?Math.max(0,Math.min(1,((e-t)*o+(r-n)*s)/u)):0,f=e-(t+l*o),c=r-(n+l*s);return f*f+c*c}return{addLineSegment:function(e,r,t,n){!function e(r,t){var n=r.minX,a=r.minY,i=r.maxX,o=r.maxY,s=r.cx,u=r.cy;n<t.minX&&(t.minX=n),a<t.minY&&(t.minY=a),i>t.maxX&&(t.maxX=i),o>t.maxY&&(t.maxY=o);var l=t.data;if(l)if(l.cx===s&&l.cy===u){for(;l.next;)l=l.next;l.next=r}else t.data=null,e(l,t),e(r,t);else{var f=(u<t.cy?0:2)+(s<t.cx?0:1);t[f]?e(r,t[f]):t[f]={0:null,1:null,2:null,3:null,data:r,cx:t.cx+t.r/2*(f%2?1:-1),cy:t.cy+t.r/2*(f<2?-1:1),r:t.r/2,minX:n,minY:a,maxX:i,maxY:o}}}({x0:e,y0:r,x1:t,y1:n,cx:(e+t)/2,cy:(r+n)/2,minX:Math.min(e,t),minY:Math.min(r,n),maxX:Math.max(e,t),maxY:Math.max(r,n),next:null},i)},findNearestSignedDistance:function(e,r,t){var n=t,a=n*n;return o((function(t){if(e-n>t.maxX||e+n<t.minX||r-n>t.maxY||r+n<t.minY)return!1;for(var i=t.data;i;i=i.next){var o=s(e,r,i.x0,i.y0,i.x1,i.y1);o<a&&(a=o,n=Math.sqrt(o))}})),function(e,r){var t=!1;return o((function(n){if(n.maxX<e||n.minY>r||n.maxY<r)return!1;for(var a=n.data;a;a=a.next){var i=a.x0,o=a.y0,s=a.x1,u=a.y1;o>r!==u>r&&e<(s-i)*(r-o)/(u-o)+i&&(t=!t)}})),t}(e,r)||(n=-n),n}}},function(e,r){var t=r.sdfDistancePercent;function n(e,r,t,n,a,i,o){var s=1-o;return{x:s*s*e+2*s*o*t+o*o*a,y:s*s*r+2*s*o*n+o*o*i}}function a(e,r,t,n,a,i,o,s,u){var l=1-u;return{x:l*l*l*e+3*l*l*u*t+3*l*u*u*a+u*u*u*o,y:l*l*l*r+3*l*l*u*n+3*l*u*u*i+u*u*u*s}}return function(r,i){var o=new Uint8Array(i*i),s=r.xMax-r.xMin,u=r.yMax-r.yMin,l=Math.max(s,u)*t,f=(s+2*l)/i,c=(u+2*l)/i,h=r.xMin-l-f,d=r.yMin-l-c,p=r.xMax+l+f,v=r.yMax+l+c;if(r.pathCommandCount){var g,m,y,b,x=e(r);r.forEachPathCommand((function(e,r,t,i,o,s,u){switch(e){case"M":y=g=r,b=m=t;break;case"L":r===y&&t===b||x.addLineSegment(y,b,y=r,b=t);break;case"Q":for(var l={x:y,y:b},f=1;f<16;f++){var c=n(y,b,r,t,i,o,f/15);x.addLineSegment(l.x,l.y,c.x,c.y),l=c}y=i,b=o;break;case"C":for(var h={x:y,y:b},d=1;d<16;d++){var p=a(y,b,r,t,i,o,s,u,d/15);x.addLineSegment(h.x,h.y,p.x,p.y),h=p}y=s,b=u;break;case"Z":y===g&&b===m||x.addLineSegment(y,b,g,m)}}));for(var S=0;S<i;S++)for(var U=0;U<i;U++){var _=x.findNearestSignedDistance(h+(p-h)*(S+.5)/i,d+(v-d)*(U+.5)/i,l),w=isFinite(_)?Math.round(255*(1+_/l)*.5):_;w=Math.max(0,Math.min(255,w)),o[U*i+S]=w}}return{textureData:o,renderingBounds:[h,d,p,v]}}},function(e,r,t){var n=t.defaultFontUrl,a=Object.create(null),i=Object.create(null);function o(r,t){r||(r=n);var a=i[r];a?a.pending?a.pending.push(t):t(a):(i[r]={pending:[t]},function(r,t){!function a(){var i=function(e){console.error("Failure loading font "+r+(r===n?"":"; trying fallback"),e),r!==n&&(r=n,a())};try{var o=new XMLHttpRequest;o.open("get",r,!0),o.responseType="arraybuffer",o.onload=function(){if(o.status>=400)i(new Error(o.statusText));else if(o.status>0)try{var r=e(o.response);t(r)}catch(n){i(n)}},o.onerror=i,o.send()}catch(s){i(s)}}()}(r,(function(e){var t=i[r].pending;i[r]=e,t.forEach((function(r){return r(e)}))})))}function s(e,t,i){var s=e.text;void 0===s&&(s="");var c=e.font;void 0===c&&(c=n);var h=e.sdfGlyphSize;void 0===h&&(h=64);var d=e.fontSize;void 0===d&&(d=1);var p=e.letterSpacing;void 0===p&&(p=0);var v=e.lineHeight;void 0===v&&(v="normal");var g=e.maxWidth;void 0===g&&(g=1/0);var m=e.textAlign;void 0===m&&(m="left");var y=e.textIndent;void 0===y&&(y=0);var b=e.whiteSpace;void 0===b&&(b="normal");var x=e.overflowWrap;void 0===x&&(x="normal");var S=e.anchorX;void 0===S&&(S=0);var U=e.anchorY;void 0===U&&(U=0);var _=e.includeCaretPositions;void 0===_&&(_=!1);var w=e.chunkedBoundsSize;void 0===w&&(w=8192);var M=e.colorRanges;void 0===M&&(M=null),void 0===i&&(i=!1);var F=l(),T={total:0,fontLoad:0,layout:0,sdf:{},sdfTotal:0};s.indexOf("\r")>-1&&(console.warn("FontProcessor.process: got text with \\r chars; normalizing to \\n"),s=s.replace(/\r\n/g,"\n").replace(/\r/g,"\n")),d=+d,p=+p,g=+g,v=v||"normal",y=+y,function(e,r,t){e||(e=n);var i=e+"@"+r,s=a[i];s?t(s):o(e,(function(e){s=a[i]||(a[i]={fontObj:e,glyphs:{},glyphCount:0}),t(s)}))}(c,h,(function(e){var n=e.fontObj,a=isFinite(g),o=null,c=null,k=null,C=null,D=null,O=null,P=null,I=0,A=0,B="nowrap"!==b,G=n.ascender,L=n.descender,R=n.unitsPerEm;T.fontLoad=l()-F;var E=l(),z=d/R;"normal"===v&&(v=(G-L)/R);var W=((v*=d)-(G-L)*z)/2,j=-(d+W),V=Math.min(v,(G-L)*z),X=(G+L)/2*z-V/2,N=y,Y=new f,H=[Y];if(n.forEachGlyph(s,d,p,(function(e,r,t){var n,i=s.charAt(t),o=e.advanceWidth*z,u=Y.count;if("isEmpty"in e||(e.isWhitespace=!!i&&/\s/.test(i),e.isEmpty=e.xMin===e.xMax||e.yMin===e.yMax),e.isWhitespace||e.isEmpty||A++,B&&a&&!e.isWhitespace&&r+o+N>g&&u){if(Y.glyphAt(u-1).glyphObj.isWhitespace)n=new f,N=-r;else for(var l=u;l--;){if(0===l&&"break-word"===x){n=new f,N=-r;break}if(Y.glyphAt(l).glyphObj.isWhitespace){var c=(n=Y.splitAt(l+1)).glyphAt(0).x;N-=c;for(var h=n.count;h--;)n.glyphAt(h).x-=c;break}}n&&(Y.isSoftWrapped=!0,Y=n,H.push(Y),I=g)}var v=Y.glyphAt(Y.count);v.glyphObj=e,v.x=r+N,v.width=o,v.charIndex=t,"\n"===i&&(Y=new f,H.push(Y),N=-(r+o+p*d)+y)})),H.forEach((function(e){for(var r=e.count;r--;){var t=e.glyphAt(r),n=t.glyphObj,a=t.x,i=t.width;if(!n.isWhitespace)return e.width=a+i,void(e.width>I&&(I=e.width))}})),!i){var q=0,K=0;if(S&&("number"===typeof S?q=-S:"string"===typeof S&&(q=-I*("left"===S?0:"center"===S?.5:"right"===S?1:u(S)))),U)if("number"===typeof U)K=-U;else if("string"===typeof U){var Z=H.length*v;K="top"===U?0:"top-baseline"===U?-j:"middle"===U?Z/2:"bottom"===U?Z:"bottom-baseline"===U?Z-W+L*z:u(U)*Z}c=new Float32Array(4*A),k=new Float32Array(A),O=[1/0,1/0,-1/0,-1/0],P=[];var $=j;_&&(D=new Float32Array(3*s.length)),M&&(C=new Uint8Array(3*A));var Q,J,ee=0,re=-1,te=-1;H.forEach((function(t){var n=t.count,a=t.width;if(n>0){var i=0,u=0;if("center"===m)i=(I-a)/2;else if("right"===m)i=I-a;else if("justify"===m&&t.isSoftWrapped){for(var f=0,d=n;d--;)if(!t.glyphAt(d).glyphObj.isWhitespace){for(;d--;)t.glyphAt(d).glyphObj,t.glyphAt(d).glyphObj.isWhitespace&&f++;break}u=(I-a)/f}for(var p=0;p<n;p++){var g=t.glyphAt(p),y=g.glyphObj;if(i&&(g.x+=i),0!==u&&y.isWhitespace&&(i+=u,g.width+=u),_){var b=g.charIndex;for(D[3*b]=g.x+q,D[3*b+1]=g.x+g.width+q,D[3*b+2]=$+X+K;b-re>1;)D[3*(re+1)]=D[3*re+1],D[3*(re+1)+1]=D[3*re+1],D[3*(re+1)+2]=D[3*re+2],re++;re=b}if(M)for(var x=g.charIndex;x>te;)te++,M.hasOwnProperty(te)&&(J=M[te]);if(!y.isWhitespace&&!y.isEmpty){var S=ee++,U=e.glyphs[y.index];if(!U){var F=l(),A=r(y,h);T.sdf[s.charAt(g.charIndex)]=l()-F,A.atlasIndex=e.glyphCount++,o||(o=[]),o.push(A),U=e.glyphs[y.index]={atlasIndex:A.atlasIndex,glyphObj:y,renderingBounds:A.renderingBounds}}var B=U.renderingBounds,G=4*S,L=c[G]=g.x+B[0]*z+q,R=c[G+1]=$+B[1]*z+K,E=c[G+2]=g.x+B[2]*z+q,W=c[G+3]=$+B[3]*z+K;if(L<O[0]&&(O[0]=L),R<O[1]&&(O[1]=R),E>O[2]&&(O[2]=E),W>O[3]&&(O[3]=W),S%w===0&&(Q={start:S,end:S,rect:[1/0,1/0,-1/0,-1/0]},P.push(Q)),Q.end++,L<Q.rect[0]&&(Q.rect[0]=L),R<Q.rect[1]&&(Q.rect[1]=R),E>Q.rect[2]&&(Q.rect[2]=E),W>Q.rect[3]&&(Q.rect[3]=W),k[S]=U.atlasIndex,M){var j=3*S;C[j]=J>>16&255,C[j+1]=J>>8&255,C[j+2]=255&J}}}}$-=v}))}for(var ne in T.sdf)T.sdfTotal+=T.sdf[ne];T.layout=l()-E-T.sdfTotal,T.total=l()-F,t({glyphBounds:c,glyphAtlasIndices:k,caretPositions:D,caretHeight:V,glyphColors:C,chunkedBounds:P,ascender:G*z,descender:L*z,lineHeight:v,topBaseline:j,totalBounds:O,totalBlockSize:[I,H.length*v],newGlyphSDFs:o,timings:T})}))}function u(e){var r=e.match(/^([\d.]+)%$/),t=r?parseFloat(r[1]):NaN;return isNaN(t)?0:t/100}function l(){return(self.performance||Date).now()}function f(){this.data=[]}return f.prototype={width:0,isSoftWrapped:!1,get count(){return Math.ceil(this.data.length/4)},glyphAt:function(e){var r=f.flyweight;return r.data=this.data,r.index=e,r},splitAt:function(e){var r=new f;return r.data=this.data.splice(4*e),r}},f.flyweight=["glyphObj","x","width","charIndex"].reduce((function(e,r,t,n){return Object.defineProperty(e,r,{get:function(){return this.data[4*this.index+t]},set:function(e){this.data[4*this.index+t]=e}}),e}),{data:null,index:0}),{process:s,measure:function(e,r){s(e,(function(e){r({width:e.totalBlockSize[0],height:e.totalBlockSize[1]})}),{metricsOnly:!0})},loadFont:o}}],init:function(e,r,t,n,a,i){return i(t,a(n,{sdfDistancePercent:r}),{defaultFontUrl:e.defaultFontURL})}}),h=t.defineWorkerModule({name:"TextBuilder",dependencies:[c,t.ThenableWorkerModule],init:function(e,r){return function(t){var n=new r;return e.process(t,n.resolve),n}},getTransferables:function(e){var r=[e.glyphBounds.buffer,e.glyphAtlasIndices.buffer];return e.caretPositions&&r.push(e.caretPositions.buffer),e.newGlyphSDFs&&e.newGlyphSDFs.forEach((function(e){r.push(e.textureData.buffer)})),r}}),d={},p=new r.Vector3,v=function(e){function t(){e.call(this),this.detail=1,this.boundingSphere=new r.Sphere,this.boundingBox=new r.Box3}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={detail:{configurable:!0}};return t.prototype.computeBoundingSphere=function(){},t.prototype.computeBoundingBox=function(){},n.detail.set=function(e){var t=this;if(e!==this._detail){this._detail=e,("number"!==typeof e||e<1)&&(e=1);var n=function(e){var t=d[e];return t||(t=d[e]=new r.PlaneBufferGeometry(1,1,e,e).translate(.5,.5,0)),t}(e);["position","normal","uv"].forEach((function(e){t.attributes[e]=n.attributes[e].clone()})),this.setIndex(n.getIndex().clone())}},n.detail.get=function(){return this._detail},t.prototype.updateGlyphs=function(e,r,t,n,a){g(this,"aTroikaGlyphBounds",e,4),g(this,"aTroikaGlyphIndex",r,1),g(this,"aTroikaGlyphColor",a,3),this._chunkedBounds=n,m(this,r.length);var i=this.boundingSphere;i.center.set((t[0]+t[2])/2,(t[1]+t[3])/2,0),i.radius=i.center.distanceTo(p.set(t[0],t[1],0));var o=this.boundingBox;o.min.set(t[0],t[1],0),o.max.set(t[2],t[3],0)},t.prototype.applyClipRect=function(e){var r=this.getAttribute("aTroikaGlyphIndex").count,t=this._chunkedBounds;if(t)for(var n=t.length;n--;){r=t[n].end;var a=t[n].rect;if(a[1]<e.w&&a[3]>e.y&&a[0]<e.z&&a[2]>e.x)break}m(this,r)},Object.defineProperties(t.prototype,n),t}(r.InstancedBufferGeometry);function g(e,t,n,a){var i=e.getAttribute(t);n?i&&i.array.length===n.length?(i.array.set(n),i.needsUpdate=!0):(e.setAttribute(t,new r.InstancedBufferAttribute(n,a)),delete e._maxInstanceCount,e.dispose()):i&&e.deleteAttribute(t)}function m(e,r){e[e.hasOwnProperty("instanceCount")?"instanceCount":"maxInstancedCount"]=r}function y(e){var t=n.createDerivedMaterial(e,{extensions:{derivatives:!0},uniforms:{uTroikaSDFTexture:{value:null},uTroikaSDFTextureSize:{value:new r.Vector2},uTroikaSDFGlyphSize:{value:0},uTroikaSDFMinDistancePct:{value:0},uTroikaTotalBounds:{value:new r.Vector4(0,0,0,0)},uTroikaClipRect:{value:new r.Vector4(0,0,0,0)},uTroikaOrient:{value:new r.Matrix3},uTroikaUseGlyphColors:{value:!0},uTroikaSDFDebug:{value:!1}},vertexDefs:"\nuniform vec2 uTroikaSDFTextureSize;\nuniform float uTroikaSDFGlyphSize;\nuniform vec4 uTroikaTotalBounds;\nuniform vec4 uTroikaClipRect;\nuniform mat3 uTroikaOrient;\nuniform bool uTroikaUseGlyphColors;\nattribute vec4 aTroikaGlyphBounds;\nattribute float aTroikaGlyphIndex;\nattribute vec3 aTroikaGlyphColor;\nvarying vec2 vTroikaSDFTextureUV;\nvarying vec2 vTroikaGlyphUV;\nvarying vec3 vTroikaGlyphColor;\n",vertexTransform:"\nvec4 bounds = aTroikaGlyphBounds;\nvec4 clippedBounds = vec4(\n  clamp(bounds.xy, uTroikaClipRect.xy, uTroikaClipRect.zw),\n  clamp(bounds.zw, uTroikaClipRect.xy, uTroikaClipRect.zw)\n);\nvec2 clippedXY = (mix(clippedBounds.xy, clippedBounds.zw, position.xy) - bounds.xy) / (bounds.zw - bounds.xy);\nvTroikaGlyphUV = clippedXY.xy;\n\nfloat cols = uTroikaSDFTextureSize.x / uTroikaSDFGlyphSize;\nvTroikaSDFTextureUV = vec2(\n  mod(aTroikaGlyphIndex, cols) + clippedXY.x,\n  floor(aTroikaGlyphIndex / cols) + clippedXY.y\n) * uTroikaSDFGlyphSize / uTroikaSDFTextureSize;\n\nposition.xy = mix(bounds.xy, bounds.zw, clippedXY);\n\nuv = vec2(\n  (position.x - uTroikaTotalBounds.x) / (uTroikaTotalBounds.z - uTroikaTotalBounds.x),\n  (position.y - uTroikaTotalBounds.y) / (uTroikaTotalBounds.w - uTroikaTotalBounds.y)\n);\n\nposition = uTroikaOrient * position;\nnormal = uTroikaOrient * normal;\n",fragmentDefs:"\nuniform sampler2D uTroikaSDFTexture;\nuniform float uTroikaSDFMinDistancePct;\nuniform bool uTroikaSDFDebug;\nvarying vec2 vTroikaSDFTextureUV;\nvarying vec2 vTroikaGlyphUV;\n\nfloat troikaGetTextAlpha() {\n  float troikaSDFValue = texture2D(uTroikaSDFTexture, vTroikaSDFTextureUV).r;\n  \n  #if defined(IS_DEPTH_MATERIAL) || defined(IS_DISTANCE_MATERIAL)\n  float alpha = step(0.5, troikaSDFValue);\n  #else\n  \n  #if defined(GL_OES_standard_derivatives) || __VERSION__ >= 300\n  float aaDist = min(\n    0.5,\n    0.5 * min(\n      fwidth(vTroikaGlyphUV.x),\n      fwidth(vTroikaGlyphUV.y)\n    )\n  ) / uTroikaSDFMinDistancePct;\n  #else\n  float aaDist = 0.01;\n  #endif\n  \n  float alpha = uTroikaSDFDebug ? troikaSDFValue : smoothstep(\n    0.5 - aaDist,\n    0.5 + aaDist,\n    troikaSDFValue\n  );\n  #endif\n  \n  return alpha;\n}\n",fragmentColorTransform:"\nfloat troikaAlphaMult = troikaGetTextAlpha();\nif (troikaAlphaMult == 0.0) {\n  discard;\n} else {\n  gl_FragColor.a *= troikaAlphaMult;\n}\n",customRewriter:function(e){var r=e.vertexShader,t=e.fragmentShader,a=/\buniform\s+vec3\s+diffuse\b/;return a.test(t)&&(t=t.replace(a,"varying vec3 vTroikaGlyphColor").replace(/\bdiffuse\b/g,"vTroikaGlyphColor"),a.test(r)||(r=r.replace(n.voidMainRegExp,"uniform vec3 diffuse;\n$&\nvTroikaGlyphColor = uTroikaUseGlyphColors ? aTroikaGlyphColor / 255.0 : diffuse;\n"))),{vertexShader:r,fragmentShader:t}}});return t.transparent=!0,Object.defineProperties(t,{isTroikaTextMaterial:{value:!0},shadowSide:{get:function(){return this.side},set:function(){}}}),t}v.prototype.setAttribute||(v.prototype.setAttribute=function(e,r){return this.attributes[e]=r,this});var b=new r.MeshBasicMaterial({color:16777215,side:r.DoubleSide,transparent:!0}),x=new r.Matrix4,S=new r.Vector3,U=new r.Vector3,_=[],w=new r.Vector3,M=new r.Mesh(new r.PlaneBufferGeometry(1,1).translate(.5,.5,0),b),F={type:"syncstart"},T={type:"synccomplete"},k=["font","fontSize","letterSpacing","lineHeight","maxWidth","overflowWrap","text","textAlign","textIndent","whiteSpace","anchorX","anchorY","colorRanges","sdfGlyphSize"],C=k.concat("material","color","depthOffset","clipRect","orientation","glyphGeometryDetail"),D=function(e){function r(){var r=new v;e.call(this,r,null),this.text="",this.anchorX=0,this.anchorY=0,this.font=null,this.fontSize=.1,this.letterSpacing=0,this.lineHeight="normal",this.maxWidth=1/0,this.overflowWrap="normal",this.textAlign="left",this.textIndent=0,this.whiteSpace="normal",this.material=null,this.color=null,this.colorRanges=null,this.depthOffset=0,this.clipRect=null,this.orientation="+x+y",this.glyphGeometryDetail=1,this.sdfGlyphSize=null,this.debugSDF=!1}e&&(r.__proto__=e),r.prototype=Object.create(e&&e.prototype),r.prototype.constructor=r;var t={textRenderInfo:{configurable:!0},material:{configurable:!0},glyphGeometryDetail:{configurable:!0},customDepthMaterial:{configurable:!0},customDistanceMaterial:{configurable:!0}};return r.prototype.sync=function(e){var r=this;this._needsSync&&(this._needsSync=!1,this._isSyncing?(this._queuedSyncs||(this._queuedSyncs=[])).push(e):(this._isSyncing=!0,this.dispatchEvent(F),l({text:this.text,font:this.font,fontSize:this.fontSize||.1,letterSpacing:this.letterSpacing||0,lineHeight:this.lineHeight||"normal",maxWidth:this.maxWidth,textAlign:this.textAlign,textIndent:this.textIndent,whiteSpace:this.whiteSpace,overflowWrap:this.overflowWrap,anchorX:this.anchorX,anchorY:this.anchorY,colorRanges:this.colorRanges,includeCaretPositions:!0,sdfGlyphSize:this.sdfGlyphSize},(function(t){r._isSyncing=!1,r._textRenderInfo=t,r.geometry.updateGlyphs(t.glyphBounds,t.glyphAtlasIndices,t.totalBounds,t.chunkedBounds,t.glyphColors);var n=r._queuedSyncs;n&&(r._queuedSyncs=null,r._needsSync=!0,r.sync((function(){n.forEach((function(e){return e&&e()}))}))),r.dispatchEvent(T),e&&e()}))))},r.prototype.onBeforeRender=function(){this.sync(),this._prepareForRender()},r.prototype.dispose=function(){this.geometry.dispose()},t.textRenderInfo.get=function(){return this._textRenderInfo||null},t.material.get=function(){var e=this._derivedMaterial,r=this._baseMaterial||b;return e&&e.baseMaterial===r||(e=this._derivedMaterial=y(r),r.addEventListener("dispose",(function t(){r.removeEventListener("dispose",t),e.dispose()}))),e},t.material.set=function(e){e&&e.isTroikaTextMaterial?(this._derivedMaterial=e,this._baseMaterial=e.baseMaterial):this._baseMaterial=e},t.glyphGeometryDetail.get=function(){return this.geometry.detail},t.glyphGeometryDetail.set=function(e){this.geometry.detail=e},t.customDepthMaterial.get=function(){return this.material.getDepthMaterial()},t.customDistanceMaterial.get=function(){return this.material.getDistanceMaterial()},r.prototype._prepareForRender=function(){var e=this._derivedMaterial,r=e.uniforms,t=this.textRenderInfo;if(t){var n=t.sdfTexture,a=t.totalBounds;r.uTroikaSDFTexture.value=n,r.uTroikaSDFTextureSize.value.set(n.image.width,n.image.height),r.uTroikaSDFGlyphSize.value=t.sdfGlyphSize,r.uTroikaSDFMinDistancePct.value=t.sdfMinDistancePercent,r.uTroikaTotalBounds.value.fromArray(a),r.uTroikaUseGlyphColors.value=!!t.glyphColors;var i=this.clipRect;i&&Array.isArray(i)&&4===i.length?r.uTroikaClipRect.value.set(Math.max(a[0],i[0]),Math.max(a[1],i[1]),Math.min(a[2],i[2]),Math.min(a[3],i[3])):r.uTroikaClipRect.value.fromArray(a),this.geometry.applyClipRect(r.uTroikaClipRect.value)}r.uTroikaSDFDebug.value=!!this.debugSDF,e.polygonOffset=!!this.depthOffset,e.polygonOffsetFactor=e.polygonOffsetUnits=this.depthOffset||0;var o=this.color;null!=o&&e.color&&e.color.isColor&&o!==e._troikaColor&&e.color.set(e._troikaColor=o);var s=this.orientation||"+x+y";if(s!==e._orientation){var u=r.uTroikaOrient.value,l="+x+y"!==(s=s.replace(/[^-+xyz]/g,""))&&s.match(/^([-+])([xyz])([-+])([xyz])$/);if(l){var f=l[1],c=l[2],h=l[3],d=l[4];S.set(0,0,0)[c]="-"===f?1:-1,U.set(0,0,0)[d]="-"===h?-1:1,x.lookAt(w,S.cross(U),U),u.setFromMatrix4(x)}else u.identity();e._orientation=s}},r.prototype.raycast=function(e,r){var t=this.textRenderInfo;if(t){var n=t.totalBounds;M.matrixWorld.multiplyMatrices(this.matrixWorld,x.set(n[2]-n[0],0,0,n[0],0,n[3]-n[1],0,n[1],0,0,1,0,0,0,0,1)),_.length=0,M.raycast(e,_);for(var a=0;a<_.length;a++)_[a].object=this,r.push(_[a])}},r.prototype.copy=function(r){var t=this;return e.prototype.copy.call(this,r),C.forEach((function(e){t[e]=r[e]})),this},r.prototype.clone=function(){return(new this.constructor).copy(this)},Object.defineProperties(r.prototype,t),r}(r.Mesh);k.forEach((function(e){var r="_private_"+e;Object.defineProperty(D.prototype,e,{get:function(){return this[r]},set:function(e){e!==this[r]&&(this[r]=e,this._needsSync=!0)}})}));var O=!1;Object.defineProperty(D.prototype,"anchor",{get:function(){return this._deprecated_anchor},set:function(e){this._deprecated_anchor=e,O||(console.warn("TextMesh: `anchor` has been deprecated; use `anchorX` and `anchorY` instead."),O=!0),Array.isArray(e)?(this.anchorX=100*(+e[0]||0)+"%",this.anchorY=100*(+e[1]||0)+"%"):this.anchorX=this.anchorY=0}});var P=new WeakMap,I=new WeakMap;e.GlyphsGeometry=v,e.Text=D,e.configureTextBuilder=function(e){f(o,e)},e.createTextDerivedMaterial=y,e.fontProcessorWorkerModule=c,e.getCaretAtPoint=function(e,r,t){var n=null,a=e.caretHeight,i=function(e){var r=I.get(e);if(!r){var t=e.caretPositions,n=e.caretHeight;r=new Map;for(var a=0;a<t.length;a+=3){var i=t[a+2],o=r.get(i);o||r.set(i,o=[]),o.push({x:t[a],y:i,height:n,charIndex:a/3}),a+3>=t.length&&o.push({x:t[a+1],y:i,height:n,charIndex:a/3+1})}}return I.set(e,r),r}(e),o=1/0;return i.forEach((function(e,r){Math.abs(t-(r+a/2))<Math.abs(t-(o+a/2))&&(o=r)})),i.get(o).forEach((function(e){(!n||Math.abs(r-e.x)<Math.abs(r-n.x))&&(n=e)})),n},e.getSelectionRects=function(e,r,t){var n;if(e){var a=P.get(e);if(a&&a.start===r&&a.end===t)return a.rects;var i=e.caretPositions,o=e.caretHeight,s=e.totalBounds;if(t<r){var u=r;r=t,t=u}r=Math.max(r,0),t=Math.min(t,i.length+1);for(var l=new Map,f=r;f<t;f++){var c=i[3*f],h=i[3*f+1],d=i[3*f+2],p=l.get(d);p?(p.left=Math.max(Math.min(p.left,c),s[0]),p.right=Math.min(Math.max(p.right,h),s[2])):(p={left:c,right:h,bottom:d,top:d+o},l.set(d,p))}n=[],l.forEach((function(e){n.push(e)})),P.set(e,{start:r,end:t,rects:n})}return n},e.preloadFont=function(e,r){var t=e.font,n=e.characters;l({font:t,sdfGlyphSize:e.sdfGlyphSize,text:Array.isArray(n)?n.join("\n"):""+n},r)},Object.defineProperty(e,"__esModule",{value:!0})}(r,t(72),t(126),t(127))},126:function(e,r,t){!function(e){"use strict";function r(){var e,t=0,n=[],a=0,i=0,o=d((function(e){i||u(1,e)})),s=d((function(e){i||u(-1,e)}));function u(r,n){i++;var a=0;try{n===g&&p();var o=r>0&&h(n);o?o.call(n,d((function(e){a++,u(1,e)})),d((function(e){a++,u(-1,e)}))):(t=r,e=n,l())}catch(s){t||a||u(-1,s)}}function l(){a||(setTimeout(f,0),a=1)}function f(){var e=n;a=0,n=[],e.forEach(c)}function c(e){e()}function h(e){var r=e&&(v(e)||"object"===typeof e)&&e.then;return v(r)&&r}function d(e){var r=0;return function(){for(var t=[],n=arguments.length;n--;)t[n]=arguments[n];r++||e.apply(this,t)}}function p(){throw new TypeError("Chaining cycle detected")}var v=function(e){return"function"===typeof e},g={then:function(a,i){var o=r();return n.push((function(){var r=t>0?a:i;if(v(r))try{var n=r(e);n===o&&p();var s=h(n);s?s.call(n,o.resolve,o.reject):o.resolve(n)}catch(u){o.reject(u)}else o[t>0?"resolve":"reject"](e)})),t&&l(),o},resolve:o,reject:s};return g}function t(){var e,r,t=new Promise((function(t,n){e=t,r=n}));return{then:t.then.bind(t),resolve:e,reject:r}}r.all=t.all=function(e){var r=0,t=[],a=n();return 0===e.length?a.resolve([]):e.forEach((function(i,o){var s=n();s.resolve(i),s.then((function(n){r++,t[o]=n,r===e.length&&a.resolve(t)}),a.reject)})),a};var n="function"===typeof Promise?t:r;function a(){var e=Object.create(null);function r(e,r){var t=void 0;self.troikaDefine=function(e){return t=e};var n=URL.createObjectURL(new Blob(["/** "+e.replace(/\*/g,"")+" **/\n\ntroikaDefine(\n"+r+"\n)"],{type:"application/javascript"}));try{importScripts(n)}catch(a){console.error(a)}return URL.revokeObjectURL(n),delete self.troikaDefine,t}self.addEventListener("message",(function(t){var n=t.data,a=n.messageId,i=n.action,o=n.data;try{"registerModule"===i&&function t(n,a){var i=n.id,o=n.name,s=n.dependencies;void 0===s&&(s=[]);var u=n.init;void 0===u&&(u=function(){});var l=n.getTransferables;if(void 0===l&&(l=null),!e[i])try{s=s.map((function(r){return r&&r.isWorkerModule&&(t(r,(function(e){if(e instanceof Error)throw e})),r=e[r.id].value),r})),u=r("<"+o+">.init",u),l&&(l=r("<"+o+">.getTransferables",l));var f=null;"function"===typeof u?f=u.apply(void 0,s):console.error("worker module init function failed to rehydrate"),e[i]={id:i,value:f,getTransferables:l},a(f)}catch(c){c&&c.noLog||console.error(c),a(c)}}(o,(function(e){e instanceof Error?postMessage({messageId:a,success:!1,error:e.message}):postMessage({messageId:a,success:!0,result:{isCallable:"function"===typeof e}})})),"callModule"===i&&function(r,t){var n,a=r.id,i=r.args;e[a]&&"function"===typeof e[a].value||t(new Error("Worker module "+a+": not found or its 'init' did not return a function"));try{var o=(n=e[a]).value.apply(n,i);o&&"function"===typeof o.then?o.then(s,(function(e){return t(e instanceof Error?e:new Error(""+e))})):s(o)}catch(u){t(u)}function s(r){try{var n=e[a].getTransferables&&e[a].getTransferables(r);n&&Array.isArray(n)&&n.length||(n=void 0),t(r,n)}catch(u){console.error(u),t(u)}}}(o,(function(e,r){e instanceof Error?postMessage({messageId:a,success:!1,error:e.message}):postMessage({messageId:a,success:!0,result:e},r||void 0)}))}catch(s){postMessage({messageId:a,success:!1,error:s.stack})}}))}var i=function(){var e=!1;if("undefined"!==typeof window&&"undefined"!==typeof window.document)try{new Worker(URL.createObjectURL(new Blob([""],{type:"application/javascript"}))).terminate(),e=!0}catch(r){console.log("Troika createWorkerModule: web workers not allowed; falling back to main thread execution. Cause: ["+r.message+"]")}return i=function(){return e},e},o=0,s=0,u=!1,l=Object.create(null),f=Object.create(null);function c(e){if((!e||"function"!==typeof e.init)&&!u)throw new Error("requires `options.init` function");var r=e.dependencies,t=e.init,a=e.getTransferables,s=e.workerId;if(!i())return function(e){var r=function e(){for(var r=[],t=arguments.length;t--;)r[t]=arguments[t];return e._getInitResult().then((function(e){if("function"===typeof e)return e.apply(void 0,r);throw new Error("Worker module function was called but `init` did not return a callable function")}))};return r._getInitResult=function(){var t=e.dependencies,a=e.init;t=Array.isArray(t)?t.map((function(e){return e&&e._getInitResult?e._getInitResult():e})):[];var i=n.all(t).then((function(e){return a.apply(null,e)}));return r._getInitResult=function(){return i},i},r}(e);null==s&&(s="#default");var l="workerModule"+ ++o,f=e.name||l,p=null;function v(){for(var e=[],r=arguments.length;r--;)e[r]=arguments[r];return p||(p=d(s,"registerModule",v.workerModuleData)),p.then((function(r){if(r.isCallable)return d(s,"callModule",{id:l,args:e});throw new Error("Worker module function was called but `init` did not return a callable function")}))}return r=r&&r.map((function(e){return"function"!==typeof e||e.workerModuleData||(u=!0,e=c({workerId:s,name:"<"+f+"> function dependency: "+e.name,init:"function(){return (\n"+h(e)+"\n)}"}),u=!1),e&&e.workerModuleData&&(e=e.workerModuleData),e})),v.workerModuleData={isWorkerModule:!0,id:l,name:f,dependencies:r,init:h(t),getTransferables:a&&h(a)},v}function h(e){var r=e.toString();return!/^function/.test(r)&&/^\w+\s*\(/.test(r)&&(r="function "+r),r}function d(e,r,t){var i=n(),o=++s;return f[o]=function(e){e.success?i.resolve(e.result):i.reject(new Error("Error in worker "+r+" call: "+e.error))},f._count++,f.count>1e3&&console.warn("Large number of open WorkerModule requests, some may not be returning"),function(e){var r=l[e];if(!r){var t=h(a);(r=l[e]=new Worker(URL.createObjectURL(new Blob(["/** Worker Module Bootstrap: "+e.replace(/\*/g,"")+" **/\n\n;("+t+")()"],{type:"application/javascript"})))).onmessage=function(e){var r=e.data,t=r.messageId,n=f[t];if(!n)throw new Error("WorkerModule response with empty or unknown messageId");delete f[t],f.count--,n(r)}}return r}(e).postMessage({messageId:o,action:r,data:t}),i}f._count=0;var p=c({name:"Thenable",dependencies:[n],init:function(e){return e}});e.Thenable=n,e.ThenableWorkerModule=p,e.defineWorkerModule=c,e.stringifyFunction=h,Object.defineProperty(e,"__esModule",{value:!0})}(r)},127:function(e,r,t){!function(e,r){"use strict";var t=/\bvoid\s+main\s*\(\s*\)\s*{/g;function n(e){return e.replace(/^[ \t]*#include +<([\w\d./]+)>/gm,(function(e,t){var a=r.ShaderChunk[t];return a?n(a):e}))}var a=Object.assign||function(){for(var e=arguments,r=arguments[0],t=1,n=arguments.length;t<n;t++){var a=e[t];if(a)for(var i in a)a.hasOwnProperty(i)&&(r[i]=a[i])}return r},i=Date.now(),o=new WeakMap;function s(e,t){var h=function(e){return JSON.stringify(e,l)}(t),d=o.get(e);if(d||(d=Object.create(null),o.set(e,d)),d[h])return d[h].clone();var p,v,g=function(e){var r=c.get(e);return null==r&&c.set(e,r=++f),r}(h),m="_derivedShaders"+g,y="_onBeforeCompile"+g;function b(r){e.onBeforeCompile.call(this,r);var o=this[m]||(this[m]={vertex:{},fragment:{}}),s=o.vertex,l=o.fragment;if(s.source!==r.vertexShader||l.source!==r.fragmentShader){var f=function(e,r,t){var a=e.vertexShader,i=e.fragmentShader,o=r.vertexDefs,s=r.vertexMainIntro,l=r.vertexMainOutro,f=r.vertexTransform,c=r.fragmentDefs,h=r.fragmentMainIntro,d=r.fragmentMainOutro,p=r.fragmentColorTransform,v=r.customRewriter,g=r.timeUniform;if(o=o||"",s=s||"",l=l||"",c=c||"",h=h||"",d=d||"",(f||v)&&(a=n(a)),(p||v)&&(i=n(i=i.replace(/^[ \t]*#include <((?:tonemapping|encodings|fog|premultiplied_alpha|dithering)_fragment)>/gm,"\n//!BEGIN_POST_CHUNK $1\n$&\n//!END_POST_CHUNK\n"))),v){var m=v({vertexShader:a,fragmentShader:i});a=m.vertexShader,i=m.fragmentShader}if(p){var y=[];i=i.replace(/^\/\/!BEGIN_POST_CHUNK[^]+?^\/\/!END_POST_CHUNK/gm,(function(e){return y.push(e),""})),d=p+"\n"+y.join("\n")+"\n"+d}if(g){var b="\nuniform float "+g+";\n";o=b+o,c=b+c}return f&&(o=o+"\nvec3 troika_position_"+t+";\nvec3 troika_normal_"+t+";\nvec2 troika_uv_"+t+";\nvoid troikaVertexTransform"+t+"(inout vec3 position, inout vec3 normal, inout vec2 uv) {\n  "+f+"\n}\n",s="\ntroika_position_"+t+" = vec3(position);\ntroika_normal_"+t+" = vec3(normal);\ntroika_uv_"+t+" = vec2(uv);\ntroikaVertexTransform"+t+"(troika_position_"+t+", troika_normal_"+t+", troika_uv_"+t+");\n"+s+"\n",a=a.replace(/\b(position|normal|uv)\b/g,(function(e,r,n,a){return/\battribute\s+vec[23]\s+$/.test(a.substr(0,n))?r:"troika_"+r+"_"+t}))),a=u(a,t,o,s,l),i=u(i,t,c,h,d),{vertexShader:a,fragmentShader:i}}(r,t,g);s.source=r.vertexShader,s.result=f.vertexShader,l.source=r.fragmentShader,l.result=f.fragmentShader}r.vertexShader=s.result,r.fragmentShader=l.result,a(r.uniforms,this.uniforms),t.timeUniform&&(r.uniforms[t.timeUniform]={get value(){return Date.now()-i}}),this[y]&&this[y](r)}function x(){e.constructor.apply(this,arguments),this._listeners=void 0}x.prototype=Object.create(e,{constructor:{value:x},isDerivedMaterial:{value:!0},baseMaterial:{value:e},onBeforeCompile:{get:function(){return b},set:function(e){this[y]=e}},copy:{value:function(t){return e.copy.call(this,t),e.isShaderMaterial||e.isDerivedMaterial||(this.extensions=a({},t.extensions),this.defines=a({},t.defines),this.uniforms=r.UniformsUtils.clone(t.uniforms)),this}},getDepthMaterial:{value:function(){var n=this._depthMaterial;return n||(v||((v=s(e.isDerivedMaterial?e.getDepthMaterial():new r.MeshDepthMaterial({depthPacking:r.RGBADepthPacking}),t)).defines.IS_DEPTH_MATERIAL=""),(n=this._depthMaterial=v.clone()).uniforms=this.uniforms),n}},getDistanceMaterial:{value:function(){var n=this._distanceMaterial;return n||(p||((p=s(e.isDerivedMaterial?e.getDistanceMaterial():new r.MeshDistanceMaterial,t)).defines.IS_DISTANCE_MATERIAL=""),(n=this._distanceMaterial=p.clone()).uniforms=this.uniforms),n}},dispose:{value:function(){var r=this._depthMaterial,t=this._distanceMaterial;r&&r.dispose(),t&&t.dispose(),e.dispose.call(this)}}});var S=new x;return S.copy(e),S.uniforms=a(r.UniformsUtils.clone(e.uniforms||{}),t.uniforms),S.defines=a({},e.defines,t.defines),S.defines["TROIKA_DERIVED_MATERIAL_"+g]="",S.extensions=a({},e.extensions,t.extensions),d[h]=S,S.clone()}function u(e,r,n,a,i){return(a||i||n)&&(e=e.replace(t,"\n"+n+"\nvoid troikaOrigMain"+r+"() {"),e+="\nvoid main() {\n  "+a+"\n  troikaOrigMain"+r+"();\n  "+i+"\n}"),e}function l(e,r){return"uniforms"===e?void 0:"function"===typeof r?r.toString():r}var f=0,c=new Map,h={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"phong",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},d=function(e){this.name=e,this.textureUniform="dataTex_"+e,this.textureSizeUniform="dataTexSize_"+e,this.multiplierUniform="dataMultiplier_"+e,this.dataSizeUniform="dataSize_"+e,this.readFunction="readData_"+e,this._raw=new Float32Array(0),this._texture=new r.DataTexture(new Uint8Array(0),0,1),this._length=0,this._multiplier=1},p={length:{configurable:!0}};function v(e,r,t){var n=255*e,a=n%1*255,i=a%1*255,o=i%1*255;return n&=255,a&=255,i&=255,o=255&Math.round(o),r[t]=n,r[t+1]=a,r[t+2]=i,r[t+3]=o,r}p.length.set=function(e){if(e!==this._length){var r=Math.pow(2,Math.ceil(Math.log2(e))),t=this._raw;r<t.length?this._raw=t.subarray(0,r):r>t.length&&(this._raw=new Float32Array(r),this._raw.set(t)),this._length=e}},p.length.get=function(){return this._length},d.prototype.push=function(e){return this.set(this.length++,e)},d.prototype.setArray=function(e){this.length=e.length,this._raw.set(e),this._needsRepack=!0},d.prototype.get=function(e){return this._raw[e]},d.prototype.set=function(e,r){e+1>this._length&&(this.length=e+1),r!==this._raw[e]&&(this._raw[e]=r,v(r/this._multiplier,this._texture.image.data,4*e),this._needsMultCheck=!0)},d.prototype.clone=function(){var e=new d(this.name);return e.setArray(this._raw),e},d.prototype.getShaderUniforms=function(){var e,r=this;return(e={})[this.textureUniform]={get value(){return r._sync(),r._texture}},e[this.textureSizeUniform]={get value(){return r._sync(),r._texture.image.width}},e[this.dataSizeUniform]={get value(){return r._sync(),r.length}},e[this.multiplierUniform]={get value(){return r._sync(),r._multiplier}},e},d.prototype.getShaderHeaderCode=function(){var e=this.textureUniform,r=this.textureSizeUniform,t=this.dataSizeUniform,n=this.multiplierUniform;return"\nuniform sampler2D "+e+";\nuniform float "+r+";\nuniform float "+t+";\nuniform float "+n+";\n\nfloat "+this.readFunction+"(float index) {\n  vec2 texUV = vec2((index + 0.5) / "+r+", 0.5);\n  vec4 pixel = texture2D("+e+", texUV);\n  return dot(pixel, 1.0 / vec4(1.0, 255.0, 65025.0, 16581375.0)) * "+n+";\n}\n"},d.prototype._sync=function(){var e=this._texture,r=this._raw,t=this._needsRepack;if(r.length!==e.image.width&&(e.image={data:new Uint8Array(4*r.length),width:r.length,height:1},t=!0),t||this._needsMultCheck){var n=this._raw.reduce((function(e,r){return Math.max(e,r)}),0),a=Math.pow(2,Math.ceil(Math.log2(n)));a!==this._multiplier&&(this._multiplier=a,t=!0),e.needsUpdate=!0,this._needsMultCheck=!1}if(t){for(var i=0,o=r.length,s=this._multiplier;i<o;i++)v(r[i]/s,e.image.data,4*i);this._needsRepack=!1}},Object.defineProperties(d.prototype,p);var g=null,m=new r.MeshStandardMaterial({color:16777215,side:r.DoubleSide}),y=function(e){function t(){e.call(this,t.getGeometry(),m),this.pointA=new r.Vector3,this.controlA=new r.Vector3,this.controlB=new r.Vector3,this.pointB=new r.Vector3,this.radius=.01,this.dashArray=new r.Vector2,this.dashOffset=0,this.frustumCulled=!1}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={material:{configurable:!0},customDepthMaterial:{configurable:!0},customDistanceMaterial:{configurable:!0}};return t.getGeometry=function(){return g||(g=new r.CylinderBufferGeometry(1,1,1,6,64).translate(0,.5,0))},n.material.get=function(){var e=this._derivedMaterial,t=this._baseMaterial||m;return e&&e.baseMaterial===t||(e=this._derivedMaterial=function(e){return s(e,{uniforms:{pointA:{value:new r.Vector3},controlA:{value:new r.Vector3},controlB:{value:new r.Vector3},pointB:{value:new r.Vector3},radius:{value:.01},dashing:{value:new r.Vector3}},vertexDefs:"\nuniform vec3 pointA;\nuniform vec3 controlA;\nuniform vec3 controlB;\nuniform vec3 pointB;\nuniform float radius;\nvarying float bezierT;\n\nvec3 cubicBezier(vec3 p1, vec3 c1, vec3 c2, vec3 p2, float t) {\n  float t2 = 1.0 - t;\n  float b0 = t2 * t2 * t2;\n  float b1 = 3.0 * t * t2 * t2;\n  float b2 = 3.0 * t * t * t2;\n  float b3 = t * t * t;\n  return b0 * p1 + b1 * c1 + b2 * c2 + b3 * p2;\n}\n\nvec3 cubicBezierDerivative(vec3 p1, vec3 c1, vec3 c2, vec3 p2, float t) {\n  float t2 = 1.0 - t;\n  return -3.0 * p1 * t2 * t2 +\n    c1 * (3.0 * t2 * t2 - 6.0 * t2 * t) +\n    c2 * (6.0 * t2 * t - 3.0 * t * t) +\n    3.0 * p2 * t * t;\n}\n",vertexTransform:'\nfloat t = position.y;\nbezierT = t;\nvec3 bezierCenterPos = cubicBezier(pointA, controlA, controlB, pointB, t);\nvec3 bezierDir = normalize(cubicBezierDerivative(pointA, controlA, controlB, pointB, t));\n\n// Make "sideways" always perpendicular to the camera ray; this ensures that any twists\n// in the cylinder occur where you won\'t see them: \nvec3 viewDirection = normalMatrix * vec3(0.0, 0.0, 1.0);\nif (bezierDir == viewDirection) {\n  bezierDir = normalize(cubicBezierDerivative(pointA, controlA, controlB, pointB, t == 1.0 ? t - 0.0001 : t + 0.0001));\n}\nvec3 sideways = normalize(cross(bezierDir, viewDirection));\nvec3 upish = normalize(cross(sideways, bezierDir));\n\n// Build a matrix for transforming this disc in the cylinder:\nmat4 discTx;\ndiscTx[0].xyz = sideways * radius;\ndiscTx[1].xyz = bezierDir * radius;\ndiscTx[2].xyz = upish * radius;\ndiscTx[3].xyz = bezierCenterPos;\ndiscTx[3][3] = 1.0;\n\n// Apply transform, ignoring original y\nposition = (discTx * vec4(position.x, 0.0, position.z, 1.0)).xyz;\nnormal = normalize(mat3(discTx) * normal);\n',fragmentDefs:"\nuniform vec3 dashing;\nvarying float bezierT;\n",fragmentMainIntro:"\nif (dashing.x + dashing.y > 0.0) {\n  float dashFrac = mod(bezierT - dashing.z, dashing.x + dashing.y);\n  if (dashFrac > dashing.x) {\n    discard;\n  }\n}\n"})}(t),t.addEventListener("dispose",(function r(){t.removeEventListener("dispose",r),e.dispose()}))),e},n.material.set=function(e){this._baseMaterial=e},n.customDepthMaterial.get=function(){return this.material.getDepthMaterial()},n.customDistanceMaterial.get=function(){return this.material.getDistanceMaterial()},t.prototype.onBeforeRender=function(e){var r=this.material.uniforms,t=this.pointA,n=this.controlA,a=this.controlB,i=this.pointB,o=this.radius,s=this.dashArray,u=this.dashOffset;r.pointA.value.copy(t),r.controlA.value.copy(n),r.controlB.value.copy(a),r.pointB.value.copy(i),r.radius.value=o,r.dashing.value.set(s.x,s.y,u||0)},t.prototype.raycast=function(e,r){},Object.defineProperties(t.prototype,n),t}(r.Mesh);e.BezierMesh=y,e.ShaderFloatArray=d,e.createDerivedMaterial=s,e.expandShaderIncludes=n,e.getShaderUniformTypes=function(e){for(var r,t=/\buniform\s+(int|float|vec[234])\s+([A-Za-z_][\w]*)/g,n=Object.create(null);null!==(r=t.exec(e));)n[r[2]]=r[1];return n},e.getShadersForMaterial=function(e){var t=h[e.type];return t?r.ShaderLib[t]:e},e.voidMainRegExp=t,Object.defineProperty(e,"__esModule",{value:!0})}(r,t(72))},149:function(e,r,t){"use strict";t.d(r,"a",(function(){return C})),t.d(r,"b",(function(){return _})),t.d(r,"c",(function(){return w}));t(17);var n=t(5),a=t(16),i=t(14),o=t(8),s=t(9),u=(t(42),t(12)),l=t(3);function f(){return(f=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e}).apply(this,arguments)}function c(e,r){if(null==e)return{};var t,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)t=i[n],r.indexOf(t)>=0||(a[t]=e[t]);return a}var h=t(0),d=t.n(h),p=t(74),v=(t(106),t(72)),g=(t(83),t(79),t(88),t(125),t(128),t(129),t(99)),m=t(90),y=(t(130),t(131),t(132),t(133),t(134),t(135),t(142)),b=t(39),x=t.n(b);t(136),t(137),t(138),t(139),t(140);function S(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}t(141),t(100);function U(e){var r=e+"BufferGeometry";return Object(h.forwardRef)((function(e,t){var n=e.args,a=e.children,i=c(e,["args","children"]);return d.a.createElement("mesh",f({ref:t},i),d.a.createElement(r,{attach:"geometry",args:n}),a)}))}U("box"),U("circle"),U("cone"),U("cylinder"),U("sphere"),U("plane"),U("tube"),U("torus"),U("torusKnot"),U("tetrahedron"),U("ring"),U("polyhedron"),U("icosahedron"),U("octahedron"),U("dodecahedron"),U("extrude"),U("lathe"),U("parametric");var _=Object(h.forwardRef)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{enableDamping:!0},r=arguments.length>1?arguments[1]:void 0,t=Object(p.i)(),n=t.camera,a=t.gl,i=t.invalidate,o=Object(h.useMemo)((function(){return new g.a(n,a.domElement)}),[n,a]);return Object(p.g)((function(){return o.update()})),Object(h.useEffect)((function(){return null==o||null==o.addEventListener||o.addEventListener("change",i),function(){return null==o||null==o.removeEventListener?void 0:o.removeEventListener("change",i)}}),[o,i]),d.a.createElement("primitive",f({dispose:null,object:o,ref:r,enableDamping:!0},e))})),w=Object(h.forwardRef)((function(e,r){var t=Object(p.i)(),n=t.camera,a=t.gl,i=t.invalidate,o=Object(h.useMemo)((function(){return new m.a(n,a.domElement)}),[n,a]);return Object(p.g)((function(){return o.update()})),Object(h.useEffect)((function(){return null==o||null==o.addEventListener||o.addEventListener("change",i),function(){return null==o||null==o.removeEventListener?void 0:o.removeEventListener("change",i)}}),[o,i]),d.a.createElement("primitive",f({dispose:null,object:o,ref:r},e))}));Object(y.a)((function(e){return v.DefaultLoadingManager.onStart=function(r,t,n){return e({active:!0,item:r,loaded:t,total:n,progress:t/n*100})},v.DefaultLoadingManager.onLoad=function(){return e({active:!1})},v.DefaultLoadingManager.onError=function(r){return e((function(e){return{errors:[].concat(Object(u.a)(e.errors),[r])}}))},v.DefaultLoadingManager.onProgress=function(r,t,n){return e({item:r,loaded:t,total:n,progress:t/n*100})},{errors:[],active:!1,progress:0,item:"",loaded:0,total:0}}));var M=new v.Vector3,F=new v.Vector3,T=new v.Vector3;function k(e,r,t){var n=M.setFromMatrixPosition(e.matrixWorld);n.project(r);var a=t.width/2,i=t.height/2;return[n.x*a+a,-n.y*i+i]}var C=d.a.forwardRef((function(e,r){var t,n=e.children,a=e.eps,i=void 0===a?.001:a,o=e.style,s=e.className,u=e.prepend,g=e.center,m=e.fullscreen,y=e.portal,b=e.scaleFactor,S=e.zIndexRange,U=void 0===S?[16777271,0]:S,_=c(e,["children","eps","style","className","prepend","center","fullscreen","portal","scaleFactor","zIndexRange"]),w=Object(p.i)(),C=w.gl,D=w.scene,O=w.camera,P=w.size,I=Object(h.useState)((function(){return document.createElement("div")})),A=Object(l.a)(I,1)[0],B=Object(h.useRef)(null),G=Object(h.useRef)([0,0]),L=null!=(t=null==y?void 0:y.current)?t:C.domElement.parentNode;Object(h.useEffect)((function(){if(B.current){D.updateMatrixWorld();var e=k(B.current,O,P);return A.style.cssText="position:absolute;top:0;left:0;transform:translate3d("+e[0]+"px,"+e[1]+"px,0);transform-origin:0 0;",L&&(u?L.prepend(A):L.appendChild(A)),function(){L&&L.removeChild(A),x.a.unmountComponentAtNode(A)}}}),[L]);var R=Object(h.useMemo)((function(){return f({position:"absolute",transform:g?"translate3d(-50%,-50%,0)":"none"},m&&{top:-P.height/2,left:-P.width/2,width:P.width,height:P.height},o)}),[o,g,m,P]);return Object(h.useEffect)((function(){x.a.render(d.a.createElement("div",{ref:r,style:R,className:s,children:n}),A)})),Object(p.g)((function(){if(B.current){var e=k(B.current,O,P);if(Math.abs(G.current[0]-e[0])>i||Math.abs(G.current[1]-e[1])>i){A.style.display=function(e,r){var t=M.setFromMatrixPosition(e.matrixWorld),n=F.setFromMatrixPosition(r.matrixWorld),a=t.sub(n),i=r.getWorldDirection(T);return a.angleTo(i)>Math.PI/2}(B.current,O)?"none":"block";var r=void 0===b?1:function(e,r){if(r instanceof v.PerspectiveCamera){var t=M.setFromMatrixPosition(e.matrixWorld),n=F.setFromMatrixPosition(r.matrixWorld),a=r.fov*Math.PI/180,i=t.distanceTo(n);return 1/(2*Math.tan(a/2)*i)}return r instanceof v.OrthographicCamera?r.zoom:1}(B.current,O)*b;A.style.transform="translate3d("+e[0]+"px,"+e[1]+"px,0) scale("+r+")",A.style.zIndex=""+function(e,r,t){if(r instanceof v.PerspectiveCamera||r instanceof v.OrthographicCamera){var n=M.setFromMatrixPosition(e.matrixWorld),a=F.setFromMatrixPosition(r.matrixWorld),i=n.distanceTo(a),o=(t[1]-t[0])/(r.far-r.near),s=t[1]-o*r.far;return Math.round(o*i+s)}}(B.current,O,U)}G.current=e}})),d.a.createElement("group",f({},_,{ref:B}))}));new v.Matrix4,new v.Ray,new v.Sphere,new v.Vector3;v.MeshPhysicalMaterial,v.MeshStandardMaterial;v.ShaderMaterial}}]);
//# sourceMappingURL=24.8b4fcb03.chunk.js.map
{"version":3,"sources":["exp/comp/Canvas.js","data/caaSpain.js","exp/Exp19.js"],"names":["width","height","draw","border","canvasRef","useRef","useEffect","canvas","current","ctx","getContext","ratio","window","devicePixelRatio","style","scale","ref","cas","id","abv","sim","name","x","y","pop","linksId","source","target","Map","setSelected","setIsOpen","data","refSvg","radiusScale","scaleSqrt","domain","range","nodes","map","area","deaths","length","svg","select","simulation","forceSimulation","force","forceLink","d","distance","strength","iterations","forceX","forceY","k","i","n","a","j","b","vx","vy","lx","Math","abs","ly","r","tick","on","rect","selectAll","enter","append","attr","text","total","overflow","viewBox","stroke","fill","points","opacity","strokeDasharray","Tip","selected","dates","colors","isOpen","dark","useMeasure","polyfill","ResizeObserver","bounds","language","useContext","LanguageContext","isEnglish","tipAnimation","useSpring","pointerEvents","maxYScale","max","maxIndex","indexOf","maxDate","maxNumber","div","className","position","top","left","transform","zIndex","background","maxWidth","boxShadow","display","justifyContent","alignItems","borderBottom","margin","padding","onClick","cursor","marginLeft","xmlns","aria-hidden","strokeWidth","Date","toLocaleString","split","replace","textAlign","fontSize","upd","TooltipCanvas","foreground","xScale","scaleTime","yScaleLinear","scaleLinear","TipCanvasCell","this","center","row","column","cellSize","cell","code","eu","first","areaGen","y0","curve","curveBasis","context","lineGen","line","beginPath","translate","fillStyle","bg","point","closePath","strokeStyle","main","lineWidth","xAxis","yAxis","legendLines","tickCount","ticks","tickFormat","forEach","moveTo","lineTo","textBaseline","font","fillText","setLineDash","save","rotate","PI","restore","quarantine","Canvas","update","useState","setData","setDates","isLoaded","setIsLoaded","closeTip","ThemeContext","fetch","then","res","ok","Promise","reject","status","csvParse","format","reduce","acc","arr","ca","cod","key","Object","keys","values","flexDirection"],"mappings":"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,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,OAAQ,MACRC,OAAQ,OAEV,CACED,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","file":"static/js/38.be1b6d76.chunk.js","sourcesContent":["import React, { useRef, useEffect } from \"react\";\n\nexport default ({ width, height, draw, border }) => {\n  let canvasRef = useRef();\n\n  const scale = (canvas, ctx) => {\n    const ratio = window.devicePixelRatio || 1;\n\n    canvas.width = width * ratio;\n    canvas.height = height * ratio;\n\n    canvas.style.width = `${width}px`;\n    canvas.style.height = `${height}px`;\n\n    ctx.scale(ratio, ratio);\n  };\n\n  useEffect(() => {\n    const canvas = canvasRef.current;\n    const ctx = canvas.getContext(\"2d\");\n    scale(canvas, ctx);\n    draw(canvas, ctx);\n  });\n\n  return (\n    <canvas\n      style={{ border: border ? \"1px solid white\" : \"\" }}\n      ref={canvasRef}\n      width={width}\n      height={height}\n    />\n  );\n};\n","export const cas = [\n  {\n    id: \"c01\",\n    abv: \"And.\",\n    sim: \"AN\",\n    name: \"Andalucía\",\n    x: 321,\n    y: 571,\n    pop: 8414240,\n  },\n  {\n    id: \"c02\",\n    abv: \"Ar.\",\n    sim: \"AR\",\n    name: \"Aragón\",\n    x: 575,\n    y: 231,\n    pop: 1319291,\n  },\n  {\n    id: \"c03\",\n    abv: \"Ast.\",\n    sim: \"AS\",\n    name: \"Asturias\",\n    x: 253,\n    y: 71,\n    pop: 1022800,\n  },\n  {\n    id: \"c04\",\n    abv: \"Bal.\",\n    sim: \"IB\",\n    name: \"Illes Balears\",\n    x: 801,\n    y: 400,\n    pop: 1149460,\n  },\n  {\n    id: \"c05\",\n    abv: \"Can.\",\n    sim: \"CN\",\n    name: \"Canarias\",\n    x: 76,\n    y: 816,\n    pop: 2153389,\n  },\n  {\n    id: \"c06\",\n    abv: \"Cantb.\",\n    sim: \"CB\",\n    name: \"Cantabria\",\n    x: 367,\n    y: 71,\n    pop: 581078,\n  },\n  {\n    id: \"c07\",\n    abv: \"C. y L.\",\n    sim: \"CL\",\n    name: \"Castilla y León\",\n    x: 309,\n    y: 211,\n    pop: 2399548,\n  },\n  {\n    id: \"c08\",\n    abv: \"C-L. M.\",\n    sim: \"CM\",\n    name: \"Castilla - La Mancha\",\n    x: 432,\n    y: 400,\n    pop: 2032863,\n  },\n  {\n    id: \"c09\",\n    abv: \"Cat.\",\n    sim: \"CT\",\n    name: \"Cataluña\",\n    x: 727,\n    y: 196,\n    pop: 7675217,\n  },\n  {\n    id: \"c10\",\n    abv: \"Com. V\",\n    sim: \"VC\",\n    name: \"Comunitat Valenciana\",\n    x: 575,\n    y: 400,\n    pop: 5003769,\n  },\n  {\n    id: \"c11\",\n    abv: \"Ext.\",\n    sim: \"EX\",\n    name: \"Extremadura\",\n    x: 225,\n    y: 400,\n    pop: 1067710,\n  },\n  {\n    id: \"c12\",\n    abv: \"Gal.\",\n    sim: \"GA\",\n    name: \"Galicia\",\n    x: 121,\n    y: 119,\n    pop: 2699499,\n  },\n  {\n    id: \"c13\",\n    abv: \"Mad.\",\n    sim: \"MD\",\n    name: \"Madrid\",\n    x: 384,\n    y: 312,\n    pop: 6663394,\n  },\n  {\n    id: \"c14\",\n    abv: \"Mur.\",\n    sim: \"MC\",\n    name: \"Murcia\",\n    x: 536,\n    y: 531,\n    pop: 1493898,\n  },\n  {\n    id: \"c15\",\n    abv: \"Nav.\",\n    sim: \"NC\",\n    name: \"Navarra\",\n    x: 526,\n    y: 126,\n    pop: 654214,\n  },\n  {\n    id: \"c16\",\n    abv: \"P. V.\",\n    sim: \"PV\",\n    name: \"País Vasco\",\n    x: 459,\n    y: 71,\n    pop: 2207776,\n  },\n  {\n    id: \"c17\",\n    abv: \"L.R.\",\n    sim: \"RI\",\n    name: \"La Rioja\",\n    x: 459,\n    y: 167,\n    pop: 316798,\n  },\n  {\n    id: \"c18\",\n    abv: \"Ceu.\",\n    sim: \"CE\",\n    name: \"Ceuta\",\n    x: 266,\n    y: 703,\n    pop: 84777,\n  },\n  {\n    id: \"c19\",\n    abv: \"Mel.\",\n    sim: \"ME\",\n    name: \"Melilla\",\n    x: 438,\n    y: 741,\n    pop: 86487,\n  },\n];\n\nexport const linksId = [\n  {\n    source: \"c01\",\n    target: \"c11\",\n  },\n  {\n    source: \"c01\",\n    target: \"c08\",\n  },\n  {\n    source: \"c01\",\n    target: \"c14\",\n  },\n  {\n    source: \"c02\",\n    target: \"c15\",\n  },\n  {\n    source: \"c02\",\n    target: \"c09\",\n  },\n  {\n    source: \"c02\",\n    target: \"c10\",\n  },\n  {\n    source: \"c02\",\n    target: \"c08\",\n  },\n  {\n    source: \"c02\",\n    target: \"c07\",\n  },\n  {\n    source: \"c02\",\n    target: \"c17\",\n  },\n  {\n    source: \"c03\",\n    target: \"c12\",\n  },\n  {\n    source: \"c03\",\n    target: \"c07\",\n  },\n  {\n    source: \"c03\",\n    target: \"c06\",\n  },\n  {\n    source: \"c06\",\n    target: \"c03\",\n  },\n  {\n    source: \"c06\",\n    target: \"c16\",\n  },\n  {\n    source: \"c06\",\n    target: \"c07\",\n  },\n  {\n    source: \"c07\",\n    target: \"c12\",\n  },\n  {\n    source: \"c07\",\n    target: \"c03\",\n  },\n  {\n    source: \"c07\",\n    target: \"c06\",\n  },\n  {\n    source: \"c07\",\n    target: \"c16\",\n  },\n  {\n    source: \"c07\",\n    target: \"c17\",\n  },\n  {\n    source: \"c07\",\n    target: \"c02\",\n  },\n  {\n    source: \"c07\",\n    target: \"c08\",\n  },\n  {\n    source: \"c07\",\n    target: \"c13\",\n  },\n  {\n    source: \"c07\",\n    target: \"c11\",\n  },\n  {\n    source: \"c08\",\n    target: \"c13\",\n  },\n  {\n    source: \"c08\",\n    target: \"c07\",\n  },\n  {\n    source: \"c08\",\n    target: \"c02\",\n  },\n  {\n    source: \"c08\",\n    target: \"c10\",\n  },\n  {\n    source: \"c08\",\n    target: \"c14\",\n  },\n  {\n    source: \"c08\",\n    target: \"c01\",\n  },\n  {\n    source: \"c08\",\n    target: \"c11\",\n  },\n  {\n    source: \"c09\",\n    target: \"c02\",\n  },\n  {\n    source: \"c09\",\n    target: \"c11\",\n  },\n  {\n    source: \"c10\",\n    target: \"c14\",\n  },\n  {\n    source: \"c10\",\n    target: \"c08\",\n  },\n  {\n    source: \"c10\",\n    target: \"c02\",\n  },\n  {\n    source: \"c10\",\n    target: \"c09\",\n  },\n  {\n    source: \"c11\",\n    target: \"c01\",\n  },\n  {\n    source: \"c11\",\n    target: \"c07\",\n  },\n  {\n    source: \"c11\",\n    target: \"c08\",\n  },\n  {\n    source: \"c11\",\n    target: \"c14\",\n  },\n  {\n    source: \"c12\",\n    target: \"c03\",\n  },\n  {\n    source: \"c12\",\n    target: \"c07\",\n  },\n  {\n    source: \"c13\",\n    target: \"c07\",\n  },\n  {\n    source: \"c13\",\n    target: \"c08\",\n  },\n  {\n    source: \"c13\",\n    target: \"c11\",\n  },\n  {\n    source: \"c14\",\n    target: \"c10\",\n  },\n  {\n    source: \"c14\",\n    target: \"c08\",\n  },\n  {\n    source: \"c14\",\n    target: \"c01\",\n  },\n  {\n    source: \"c15\",\n    target: \"c16\",\n  },\n  {\n    source: \"c15\",\n    target: \"c17\",\n  },\n  {\n    source: \"c15\",\n    target: \"c02\",\n  },\n  {\n    source: \"c16\",\n    target: \"c06\",\n  },\n  {\n    source: \"c16\",\n    target: \"c07\",\n  },\n  {\n    source: \"c16\",\n    target: \"c17\",\n  },\n  {\n    source: \"c16\",\n    target: \"c15\",\n  },\n  {\n    source: \"c17\",\n    target: \"c07\",\n  },\n  {\n    source: \"c17\",\n    target: \"c16\",\n  },\n  {\n    source: \"c17\",\n    target: \"c15\",\n  },\n  {\n    source: \"c17\",\n    target: \"c02\",\n  },\n];\n\n// export const popTotal = 47026208;\n// https://www.ine.es/jaxiT3/Datos.htm?t=2915#!tabs-tabla\n","import React, { useEffect, useState, useRef, useContext } from \"react\";\n// Data\nimport { cas, linksId } from \"../data/caaSpain\";\n// D3\nimport { select } from \"d3-selection\";\nimport { forceX, forceY, forceSimulation, forceLink } from \"d3-force\";\nimport { scaleSqrt, scaleLinear, scaleTime } from \"d3-scale\";\nimport { area, line, curveBasis } from \"d3-shape\";\nimport { csvParse } from \"d3-dsv\";\n// Etc\nimport useMeasure from \"react-use-measure\";\nimport { ResizeObserver } from \"@juggle/resize-observer\";\nimport { animated, useSpring } from \"react-spring\";\nimport ThemeContext from \"../context/ThemeContext\";\nimport LanguageContext from \"../context/LanguageContext\";\n// Comp\nimport Canvas from \"./comp/Canvas\";\n\n// MAP\nconst Map = ({\n  // ignore-prettier\n  width = 900,\n  height = 900,\n  setSelected,\n  setIsOpen,\n  data,\n}) => {\n  const refSvg = useRef();\n\n  const radiusScale = scaleSqrt().domain([0, 10000]).range([5, 310]);\n\n  const nodes = cas.map((x) => {\n    return {\n      ...x,\n      area: radiusScale(data[x.id].deaths[data[x.id].deaths.length - 1]),\n    };\n  });\n\n  useEffect(() => {\n    const svg = select(refSvg.current);\n\n    const collision = () => {\n      const padding = 10;\n      for (let k = 0, iterations = 4, strength = 0.5; k < iterations; ++k) {\n        for (let i = 0, n = nodes.length; i < n; ++i) {\n          for (let a = nodes[i], j = i + 1; j < n; ++j) {\n            let b = nodes[j],\n              x = a.x + a.vx - b.x - b.vx,\n              y = a.y + a.vy - b.y - b.vy,\n              lx = Math.abs(x),\n              ly = Math.abs(y),\n              r = a.area / 2 + b.area / 2 + padding;\n            if (lx < r && ly < r) {\n              if (lx > ly) {\n                lx = (lx - r) * (x < 0 ? -strength : strength);\n                a[\"vx\"] -= lx;\n                b[\"vx\"] += lx;\n              } else {\n                ly = (ly - r) * (y < 0 ? -strength : strength);\n                a[\"vy\"] -= ly;\n                b[\"vy\"] += ly;\n              }\n            }\n          }\n        }\n      }\n    };\n\n    const simulation = forceSimulation(nodes)\n      .force(\n        \"link\",\n        forceLink(linksId)\n          .id((d) => d.id)\n          .distance(0)\n          .strength(0.0025)\n          .iterations(6)\n      )\n      .force(\"x\", forceX((d) => d.x).strength(0.1))\n      .force(\"y\", forceY((d) => d.y).strength(0.1))\n      .force(\"collide\", collision);\n\n    for (let i = 0; i < 120; ++i) {\n      simulation.tick();\n    }\n\n    simulation.on(\"tick\", () => {\n      const rect = svg\n        .selectAll(\"g\")\n        .data(nodes)\n        .enter()\n        .append(\"g\")\n        .attr(\"transform\", (d) => `translate(${d.x}, ${d.y})`);\n\n      // Rect\n      rect\n        .append(\"rect\")\n        .attr(\"width\", (d) => d.area)\n        .attr(\"height\", (d) => d.area)\n        .attr(\"x\", (d) => -d.area / 2)\n        .attr(\"y\", (d) => -d.area / 2)\n        .attr(\"fill\", \"var(--foreground-color)\")\n        // .attr(\"stroke\", \"var(--background-color)\")\n        .style(\"cursor\", \"pointer\");\n\n      rect.on(\"click\", (d) => {\n        setSelected({ ...d, ...data[d.id] });\n        setIsOpen(true);\n      });\n\n      // Text\n      rect\n        .append(\"text\")\n        .style(\"font-size\", `22px`)\n        .style(\"fill\", \"var(--background-color)\")\n        .style(\"pointer-events\", \"none\")\n        .attr(\"text-anchor\", \"middle\")\n        .attr(\"dominant-baseline\", \"middle\")\n        .attr(\"dy\", (d) => {\n          return d.area > 90 ? -15 : \"\";\n        })\n        .text((d) => (d.area > 30 ? d.sim : \"\"));\n\n      rect\n        .append(\"text\")\n        .style(\"font-weight\", `700`)\n        .style(\"font-size\", `26px`)\n        .style(\"pointer-events\", \"none\")\n        .style(\"fill\", \"var(--background-color)\")\n        .style(\"opacity\", \"0.5\")\n        .attr(\"text-anchor\", \"middle\")\n        .attr(\"dy\", 15)\n        .attr(\"dominant-baseline\", \"middle\")\n        .text((d) => {\n          return d.area > 90 ? data[d.id].total : \"\";\n        });\n    });\n  }, [data, nodes, setIsOpen, setSelected]);\n\n  return (\n    <>\n      <svg\n        ref={refSvg}\n        style={{\n          width: \"100%\",\n          overflow: \"visible\",\n        }}\n        viewBox={`0 0 ${width} ${height}`}\n      >\n        {/* Canarias */}\n        <polyline\n          stroke=\"var(--foreground-color)\"\n          fill=\"none\"\n          points=\"0,745 175,745 175,900\"\n          style={{ opacity: \"0.5\", strokeDasharray: \"4 2\" }}\n        />\n      </svg>\n    </>\n  );\n};\n\nconst Tip = ({ selected, dates, colors, isOpen, setIsOpen, dark }) => {\n  const size = 50;\n\n  const [ref, bounds] = useMeasure({ polyfill: ResizeObserver });\n\n  const { language } = useContext(LanguageContext);\n  const isEnglish = language.isEnglish;\n\n  const tipAnimation = useSpring({\n    opacity: isOpen ? 1 : 0,\n    pointerEvents: isOpen ? \"auto\" : \"none\",\n  });\n\n  // Data\n  const maxYScale = Math.max(...selected.deaths);\n  const maxIndex = selected.deaths.indexOf(maxYScale);\n  const maxDate = dates[maxIndex];\n  const maxNumber = selected.deaths[maxIndex];\n\n  return (\n    <animated.div\n      className=\"tooltip\"\n      style={{\n        ...tipAnimation,\n        position: \"absolute\",\n        top: \"50%\",\n        left: \"50%\",\n        transform: \"translate(-50%, -50%)\",\n        overflow: \"visible\",\n        zIndex: 2,\n        background: \"var(--background-color)\",\n        border: \"1px solid var(--foreground-color)\",\n        width: \"calc(100% - 60px)\",\n        maxWidth: \"800px\",\n        height: \"390px\",\n        boxShadow: dark\n          ? \"5px -5px 3px -3px rgba(0,0,0,0.2)\"\n          : \"5px -5px 3px -3px rgba(255,255,255,0.2)\",\n      }}\n      width={`${size}px`}\n      height={`${size}px`}\n      viewBox={`0 0 ${size} ${size}`}\n    >\n      {/* Header */}\n      <div\n        style={{\n          display: \"flex\",\n          justifyContent: \"center\",\n          alignItems: \"center\",\n          height: \"50px\",\n          borderBottom: \"1px solid var(--foreground-color)\",\n        }}\n      >\n        <p style={{ margin: 0, padding: \"1em\" }} className=\"h4\">\n          {selected?.name}\n        </p>\n        <div\n          onClick={() => setIsOpen(!isOpen)}\n          style={{\n            cursor: \"pointer\",\n            height: \"100%\",\n            marginLeft: \"auto\",\n            width: \"50px\",\n            height: \"50px\",\n            background: \"var(--foreground-color)\",\n            display: \"flex\",\n            justifyContent: \"center\",\n            alignItems: \"center\",\n          }}\n        >\n          <svg\n            xmlns=\"http://www.w3.org/2000/svg\"\n            width={32}\n            height={32}\n            aria-hidden=\"true\"\n          >\n            <path\n              fill=\"var(--background-color)\"\n              strokeWidth=\"1\"\n              stroke=\"var(--background-color)\"\n              d=\"M24 9.4L22.6 8 16 14.6 9.4 8 8 9.4l6.6 6.6L8 22.6 9.4 24l6.6-6.6 6.6 6.6 1.4-1.4-6.6-6.6L24 9.4z\"\n            />\n          </svg>\n        </div>\n      </div>\n      {/* Canvas */}\n      <div\n        ref={ref}\n        className=\"tooltipGraph\"\n        style={{ margin: \"1em\", height: \"230px\" }}\n      >\n        <div\n          className=\"keyCanvas\"\n          style={{\n            display: \"flex\",\n            justifyContent: \"space-between\",\n            alignItems: \"center\",\n          }}\n        >\n          <p style={{ margin: 0, padding: 0 }}>\n            {isEnglish ? \"Quarantine\" : \"Cuarentena\"}\n            <br />\n            {new Date(new Date(\"2020-03-15\"))\n              .toLocaleString(language.id)\n              .split(\" \")[0]\n              .replace(\",\", \"\")}\n          </p>\n\n          <p style={{ textAlign: \"right\" }}>\n            {isEnglish ? \"Deaths:\" : \"Muertes:\"}\n            <br />\n            <strong>{selected.total}</strong>\n          </p>\n        </div>\n\n        <TooltipCanvas\n          dates={dates}\n          width={bounds.width}\n          height={bounds.height}\n          selected={selected}\n          colors={colors}\n          isEnglish={isEnglish}\n          dark={dark}\n          maxYScale={maxYScale}\n          maxIndex={maxIndex}\n          maxDate={maxDate}\n          maxNumber={maxNumber}\n        />\n      </div>\n\n      {/* Notes */}\n      <div className=\"notes\" style={{ margin: \"3em 1em 0 1em\" }}>\n        <p style={{ opacity: \"0.5\", fontSize: \"90%\" }}>\n          {isEnglish ? \"Updated\" : \"Actualizado\"}{\" \"}\n          {new Date(dates.upd)\n            .toLocaleString(language.id)\n            .split(\" \")[0]\n            .replace(\",\", \"\")}\n          .\n        </p>\n      </div>\n    </animated.div>\n  );\n};\n\nconst TooltipCanvas = ({\n  selected,\n  width,\n  height,\n  colors,\n  dark,\n  maxYScale,\n  dates,\n}) => {\n  // color\n  const foreground = dark\n    ? \"RGBA(255, 255, 255, 0.8)\"\n    : \"RGBA(26, 27, 30, 0.6)\";\n\n  // d3\n  const margin = { top: 50, right: 0, left: 50, bottom: 40 };\n\n  const xScale = scaleTime()\n    .domain([dates.dates[0], dates.upd])\n    .range([0, width - margin.right - margin.left]);\n\n  const yScaleLinear = scaleLinear()\n    .domain([0, maxYScale])\n    .range([height - margin.top - margin.bottom, 0]);\n\n  class TipCanvasCell {\n    constructor({ selected }) {\n      this.id = selected.id;\n      this.position = selected.position;\n      this.center = selected.center;\n      this.row = selected.row;\n      this.column = selected.column;\n      this.cellSize = selected.cellSize;\n      this.cell = selected.cell;\n      this.name = selected.name;\n      this.code = selected.code;\n      this.eu = selected.eu;\n      this.first = dates.dates[0];\n      this.deaths = selected.deaths;\n    }\n\n    draw(ctx) {\n      const areaGen = area()\n        .y0(height - margin.top - margin.bottom)\n        .curve(curveBasis)\n        .context(ctx);\n\n      const lineGen = line().context(ctx);\n\n      ctx.beginPath();\n\n      ctx.translate(margin.left, margin.top);\n\n      ctx.fillStyle = colors.bg;\n\n      areaGen(\n        this.deaths.map((point, i) => {\n          return [xScale(dates.dates[i]), yScaleLinear(point)];\n        })\n      );\n\n      ctx.closePath();\n      ctx.fill();\n\n      ctx.strokeStyle = colors.main;\n      ctx.lineWidth = 3;\n      ctx.beginPath();\n\n      lineGen(\n        this.deaths.map((point, i) => {\n          return [xScale(dates.dates[i]), yScaleLinear(point)];\n        })\n      );\n\n      ctx.stroke();\n\n      ctx.lineWidth = 0.5;\n      xAxis(ctx);\n      yAxis(ctx);\n      legendLines(ctx);\n    }\n\n    update(ctx) {\n      this.draw(ctx);\n    }\n\n    animate(ctx) {\n      this.draw(ctx);\n    }\n  }\n\n  const draw = (canvas, ctx) => {\n    new TipCanvasCell({\n      selected,\n    }).update(ctx);\n  };\n\n  const xAxis = (ctx) => {\n    let tickCount = width / 150;\n    let tickSize = 6;\n    let ticks = xScale.ticks(tickCount);\n    let tickFormat = xScale.tickFormat();\n    let tickPadding = 7;\n\n    ctx.beginPath();\n    ticks.forEach(function (d) {\n      ctx.moveTo(xScale(d), height - margin.top - margin.bottom);\n      ctx.lineTo(xScale(d), height - margin.top - margin.bottom + tickSize);\n    });\n    ctx.strokeStyle = \"gray\";\n    ctx.fillStyle = \"gray\";\n    ctx.stroke();\n\n    ctx.textAlign = \"center\";\n    ctx.textBaseline = \"top\";\n    ctx.font = \"12px Inter\";\n\n    ticks.forEach(function (d) {\n      ctx.fillText(\n        tickFormat(d),\n        xScale(d),\n        height - margin.top - margin.bottom + tickSize + tickPadding\n      );\n    });\n  };\n\n  const yAxis = (ctx) => {\n    let tickCount = 3;\n    let ticks = yScaleLinear.ticks(tickCount);\n    let tickFormat = yScaleLinear.tickFormat(tickCount);\n\n    ctx.beginPath();\n    ticks.forEach(function (d) {\n      ctx.moveTo(-margin.left, yScaleLinear(d));\n      ctx.lineTo(width - margin.left - margin.right, yScaleLinear(d));\n    });\n\n    ctx.fillStyle = \"gray\";\n    ctx.strokeStyle = foreground;\n    ctx.setLineDash([2, 1]);\n\n    ctx.stroke();\n    ctx.setLineDash([]);\n\n    ctx.textAlign = \"left\";\n    ctx.textBaseline = \"left\";\n    ctx.font = \"12px Inter\";\n    ticks.forEach(function (d) {\n      ctx.fillText(tickFormat(d), -margin.left, yScaleLinear(d) - 20);\n    });\n\n    ctx.save();\n    ctx.rotate(-Math.PI / 2);\n    ctx.textAlign = \"right\";\n    ctx.textBaseline = \"top\";\n    ctx.restore();\n  };\n\n  const legendLines = (ctx) => {\n    const legendTop = 10;\n\n    ctx.strokeStyle = foreground;\n\n    let quarantine = new Date(\"2020-03-15\");\n\n    ctx.beginPath();\n    ctx.moveTo(-margin.left, -margin.top + legendTop);\n    ctx.lineTo(xScale(quarantine), -margin.top + legendTop);\n    ctx.lineTo(xScale(quarantine), height - margin.top - margin.bottom);\n    ctx.stroke();\n  };\n\n  return (\n    <Canvas\n      style={{\n        overflow: \"visible\",\n      }}\n      draw={(canvas, ctx) => {\n        draw(canvas, ctx);\n      }}\n      width={width}\n      height={height}\n    />\n  );\n};\n\n// MAIN\nexport default () => {\n  const [data, setData] = useState(null);\n  const [dates, setDates] = useState(null);\n  const [isLoaded, setIsLoaded] = useState(false);\n  const [selected, setSelected] = useState(null);\n  const [isOpen, setIsOpen] = useState(false);\n\n  const closeTip = () => {\n    setSelected(null);\n    isOpen(false);\n  };\n\n  const { dark } = useContext(ThemeContext);\n  const { language } = useContext(LanguageContext);\n\n  // DATA\n  // Force\n\n  useEffect(() => {\n    const fetchData = () => {\n      const uri =\n        \"https://raw.githubusercontent.com/datadista/datasets/master/COVID%2019/old_series/ccaa_covid19_fallecidos.csv\";\n      fetch(uri)\n        .then((res) => (res.ok ? res.text() : Promise.reject(res.status)))\n        .then((text) => csvParse(text))\n        .then((data) => {\n          const format = data.reduce((acc, x, i, arr) => {\n            const ca = x[\"CCAA\"];\n            const cod = x[\"cod_ine\"];\n            const key = `c${cod}`;\n            // delete\n            delete x[\"CCAA\"];\n            delete x[\"cod_ine\"];\n            // save dates\n            if (i === 0) {\n              const dates = [...Object.keys(x)].map((x) => new Date(x));\n              setDates({ dates, upd: dates[dates.length - 1] });\n            }\n            // array\n            const deaths = [...Object.values(x)].map((x) => +x);\n\n            acc[key] = {\n              key,\n              cod,\n              ca,\n              deaths,\n              total: deaths[deaths.length - 1],\n            };\n            return acc;\n          }, {});\n          // save data\n          setData(format);\n          setIsLoaded(true);\n        });\n    };\n\n    fetchData();\n  }, []);\n\n  // Colors\n  const colors = {\n    bg: dark ? \"RGBA(234, 234, 234, 0.20)\" : \"RGBA(26, 27, 30, 0.10)\",\n    main: dark ? \"RGBA(234, 234, 234, 1.00)\" : \"RGBA(26, 27, 30, 1.00)\",\n  };\n\n  return (\n    <div\n      style={{\n        width: \"100%\",\n        maxWidth: \"600px\",\n        margin: \"0 auto\",\n        height: \"100vh\",\n        display: \"flex\",\n        justifyContent: \"center\",\n        alignItems: \"center\",\n        flexDirection: \"column\",\n      }}\n    >\n      {isLoaded && data && dates && (\n        <Map\n          data={data}\n          closeTip={closeTip}\n          setSelected={setSelected}\n          setIsOpen={setIsOpen}\n          language={language}\n        />\n      )}\n\n      {isLoaded && selected && dates && (\n        <Tip\n          dates={dates}\n          selected={selected}\n          closeTip={closeTip}\n          colors={colors}\n          isOpen={isOpen}\n          setIsOpen={setIsOpen}\n          dark={dark}\n        />\n      )}\n    </div>\n  );\n};\n"],"sourceRoot":""}
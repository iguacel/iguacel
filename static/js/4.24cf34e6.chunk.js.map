{"version":3,"sources":["../node_modules/three/examples/jsm/controls/DeviceOrientationControls.js","../node_modules/three/examples/jsm/controls/FlyControls.js","../node_modules/three/examples/jsm/controls/TransformControls.js","../node_modules/lodash.pick/index.js","../node_modules/lodash.omit/index.js","../node_modules/three/examples/jsm/controls/PointerLockControls.js","../node_modules/three/examples/jsm/loaders/DRACOLoader.js","../node_modules/three/examples/jsm/loaders/GLTFLoader.js","../node_modules/three/examples/jsm/objects/Reflector.js","../node_modules/three/examples/js/libs/stats.min.js","../node_modules/three/examples/jsm/modifiers/SimplifyModifier.js","../node_modules/three/examples/jsm/modifiers/SubdivisionModifier.js","../node_modules/three/examples/jsm/modifiers/TessellateModifier.js","../node_modules/three/examples/jsm/objects/Sky.js","../node_modules/zustand/index.js","../node_modules/three/examples/jsm/lines/LineMaterial.js","../node_modules/three/examples/jsm/lines/LineGeometry.js","../node_modules/three/examples/jsm/lines/LineSegments2.js","../node_modules/three/examples/jsm/lines/Line2.js","../node_modules/three/examples/jsm/controls/TrackballControls.js","../node_modules/three/examples/jsm/lines/LineSegmentsGeometry.js","../node_modules/three/examples/jsm/controls/OrbitControls.js"],"names":["DeviceOrientationControls","object","scope","this","rotation","reorder","enabled","deviceOrientation","screenOrientation","alphaOffset","onDeviceOrientationChangeEvent","event","onScreenOrientationChangeEvent","window","orientation","setObjectQuaternion","zee","Vector3","euler","Euler","q0","Quaternion","q1","Math","sqrt","quaternion","alpha","beta","gamma","orient","set","setFromEuler","multiply","setFromAxisAngle","connect","undefined","DeviceOrientationEvent","requestPermission","then","response","addEventListener","catch","error","console","disconnect","removeEventListener","update","device","MathUtils","degToRad","dispose","FlyControls","domElement","bind","fn","apply","arguments","contextmenu","preventDefault","warn","document","setAttribute","movementSpeed","rollSpeed","dragToLook","autoForward","tmpQuaternion","mouseStatus","moveState","up","down","left","right","forward","back","pitchUp","pitchDown","yawLeft","yawRight","rollLeft","rollRight","moveVector","rotationVector","keydown","altKey","keyCode","movementSpeedMultiplier","updateMovementVector","updateRotationVector","keyup","mousedown","focus","stopPropagation","button","mousemove","container","getContainerDimensions","halfWidth","size","halfHeight","pageX","offset","pageY","mouseup","delta","moveMult","rotMult","translateX","x","translateY","y","translateZ","z","normalize","setFromQuaternion","order","offsetWidth","offsetHeight","offsetLeft","offsetTop","innerWidth","innerHeight","_mousedown","_mousemove","_mouseup","_keydown","_keyup","TransformControls","camera","Object3D","call","visible","_gizmo","TransformControlsGizmo","add","_plane","TransformControlsPlane","defineProperty","changeEvent","type","mouseDownEvent","mouseUpEvent","mode","objectChangeEvent","raycaster","Raycaster","intersectObjectWithRay","includeInvisible","allIntersections","intersectObject","i","length","_tempVector","_tempVector2","_tempQuaternion","_unit","X","Y","Z","pointStart","pointEnd","rotationAxis","startNorm","endNorm","rotationAngle","cameraPosition","cameraQuaternion","cameraScale","parentPosition","parentQuaternion","parentQuaternionInv","parentScale","worldPositionStart","worldQuaternionStart","worldScaleStart","worldPosition","worldQuaternion","worldQuaternionInv","worldScale","eye","positionStart","quaternionStart","scaleStart","propName","defaultValue","propValue","Object","get","value","dispatchEvent","getPointer","pointerLockElement","pointer","changedTouches","rect","getBoundingClientRect","clientX","width","clientY","top","height","onPointerHover","pointerHover","onPointerDown","onPointerMove","pointerDown","pointerMove","onPointerUp","pointerUp","traverse","child","geometry","material","attach","detach","axis","updateMatrixWorld","parent","matrixWorld","decompose","copy","inverse","sub","prototype","dragging","setFromCamera","intersect","picker","name","planeIntersect","space","snap","rotationSnap","round","position","scale","point","applyQuaternion","indexOf","divide","translationSnap","search","setFromMatrixPosition","d","dot","scaleSnap","ROTATION_SPEED","distanceTo","angleTo","cross","getMode","setMode","setTranslationSnap","setRotationSnap","setScaleSnap","setSize","setSpace","assign","create","constructor","isTransformControls","gizmoMaterial","MeshBasicMaterial","depthTest","depthWrite","transparent","side","DoubleSide","fog","gizmoLineMaterial","LineBasicMaterial","linewidth","matInvisible","clone","opacity","matHelper","matRed","color","matGreen","matBlue","matWhiteTransparent","matYellowTransparent","matCyanTransparent","matMagentaTransparent","matLineRed","matLineGreen","matLineBlue","matLineCyan","matLineMagenta","matLineYellow","matLineGray","matLineYellowTransparent","arrowGeometry","CylinderBufferGeometry","scaleHandleGeometry","BoxBufferGeometry","lineGeometry","BufferGeometry","Float32BufferAttribute","CircleGeometry","radius","arc","vertices","push","cos","PI","sin","gizmoTranslate","Mesh","Line","XYZ","OctahedronBufferGeometry","XY","PlaneBufferGeometry","YZ","XZ","pickerTranslate","helperTranslate","START","END","DELTA","TranslateHelperGeometry","gizmoRotate","E","XYZE","helperRotate","AXIS","pickerRotate","TorusBufferGeometry","SphereBufferGeometry","gizmoScale","XYZX","XYZY","XYZZ","pickerScale","helperScale","setupGizmo","gizmoMap","gizmo","tag","updateMatrix","tempGeometry","applyMatrix4","matrix","renderOrder","Infinity","tempVector","tempEuler","alignVector","zeroVector","lookAtMatrix","Matrix4","tempQuaternion","tempQuaternion2","identityQuaternion","unitX","unitY","unitZ","helper","handles","concat","children","factor","handle","isOrthographicCamera","bottom","zoom","min","tan","fov","multiplyScalar","abs","setFromRotationMatrix","lookAt","atan2","multiplyQuaternions","showX","showY","showZ","_opacity","_color","split","some","a","lerp","Color","isTransformControlsGizmo","wireframe","dirVector","tempMatrix","isTransformControlsPlane","freeGlobal","global","freeSelf","self","root","Function","func","thisArg","args","arrayPush","array","values","index","objectProto","hasOwnProperty","objectToString","toString","Symbol","propertyIsEnumerable","spreadableSymbol","isConcatSpreadable","nativeMax","max","isFlattenable","isArray","isObjectLike","isLength","isObject","isFunction","isArrayLike","isArrayLikeObject","isArguments","toKey","isSymbol","result","Array","start","pick","props","predicate","key","basePickBy","basePick","iteratee","arrayMap","baseFlatten","depth","isStrict","otherArgs","module","exports","reIsHostCtor","reIsUint","arrayIncludes","fromIndex","fromRight","baseFindIndex","baseIsNaN","baseIndexOf","arrayIncludesWith","comparator","cacheHas","cache","has","overArg","transform","arg","arrayProto","funcProto","coreJsData","maskSrcKey","uid","exec","keys","IE_PROTO","funcToString","reIsNative","RegExp","replace","getPrototype","getPrototypeOf","splice","nativeGetSymbols","getOwnPropertySymbols","Map","getNative","nativeCreate","Hash","entries","clear","entry","ListCache","MapCache","SetCache","__data__","arrayLikeKeys","inherited","n","baseTimes","String","skipIndexes","isIndex","assocIndexOf","other","baseIsNative","e","isHostObject","test","toSource","baseKeysIn","nativeKeysIn","isProto","Ctor","proto","isPrototype","getAllKeysIn","keysFunc","symbolsFunc","baseGetAllKeys","keysIn","getSymbolsIn","getMapData","map","data","isKeyable","getValue","pop","getSymbols","stubArray","omit","includes","isCommon","valuesLength","outer","computed","valuesIndex","baseDifference","PointerLockControls","body","isLocked","lockEvent","unlockEvent","PI_2","vec","onMouseMove","movementX","mozMovementX","webkitMovementX","movementY","mozMovementY","webkitMovementY","onPointerlockChange","onPointerlockError","getObject","getDirection","direction","v","moveForward","distance","setFromMatrixColumn","crossVectors","addScaledVector","moveRight","lock","requestPointerLock","unlock","exitPointerLock","EventDispatcher","DRACOLoader","manager","Loader","decoderPath","decoderConfig","decoderBinary","decoderPending","workerLimit","workerPool","workerNextTaskID","workerSourceURL","defaultAttributeIDs","normal","uv","defaultAttributeTypes","setDecoderPath","path","setDecoderConfig","config","setWorkerLimit","setVerbosity","setDrawMode","setSkipDequantization","load","url","onLoad","onProgress","onError","loader","FileLoader","setPath","setResponseType","crossOrigin","setWithCredentials","buffer","taskConfig","attributeIDs","attributeTypes","useUniqueIDs","decodeGeometry","decodeDracoFile","callback","attribute","BYTES_PER_ELEMENT","worker","taskKey","JSON","stringify","taskCache","cachedTask","promise","byteLength","Error","taskID","taskCost","geometryPending","_getWorker","_worker","Promise","resolve","reject","_callbacks","postMessage","id","message","_createGeometry","_releaseTask","geometryData","setIndex","BufferAttribute","attributes","itemSize","_loadLibrary","responseType","preload","_initDecoder","useJS","WebAssembly","librariesPending","all","libraries","jsContent","wasmBinary","DRACOWorker","substring","lastIndexOf","join","URL","createObjectURL","Blob","Worker","_taskCosts","_taskLoad","onmessage","sort","b","debug","log","terminate","decodeAttribute","draco","decoder","dracoGeometry","attributeName","attributeType","dracoArray","numComponents","num_components","numValues","num_points","Float32Array","DracoFloat32Array","GetAttributeFloatForAllPoints","Int8Array","DracoInt8Array","GetAttributeInt8ForAllPoints","Int16Array","DracoInt16Array","GetAttributeInt16ForAllPoints","Int32Array","DracoInt32Array","GetAttributeInt32ForAllPoints","Uint8Array","DracoUInt8Array","GetAttributeUInt8ForAllPoints","Uint16Array","DracoUInt16Array","GetAttributeUInt16ForAllPoints","Uint32Array","DracoUInt32Array","GetAttributeUInt32ForAllPoints","GetValue","destroy","onModuleLoaded","DracoDecoderModule","Decoder","decoderBuffer","DecoderBuffer","Init","decodingStatus","geometryType","GetEncodedGeometryType","TRIANGULAR_MESH","DecodeBufferToMesh","POINT_CLOUD","PointCloud","DecodeBufferToPointCloud","ok","ptr","error_msg","attributeID","GetAttributeByUniqueId","GetAttributeId","GetAttribute","numFaces","num_faces","indexArray","GetFaceFromMesh","j","buffers","attr","WeakMap","releaseDecoderModule","getDecoderModule","GLTFLoader","dracoLoader","ddsLoader","GLTFRegistry","objects","remove","removeAll","resourcePath","LoaderUtils","extractUrlBase","itemStart","_onError","itemError","itemEnd","setRequestHeader","requestHeader","parse","gltf","setDRACOLoader","setDDSLoader","content","extensions","decodeText","BINARY_EXTENSION_HEADER_MAGIC","EXTENSIONS","KHR_BINARY_GLTF","GLTFBinaryExtension","json","asset","version","extensionsUsed","extensionName","extensionsRequired","KHR_LIGHTS_PUNCTUAL","GLTFLightsExtension","KHR_MATERIALS_CLEARCOAT","GLTFMaterialsClearcoatExtension","KHR_MATERIALS_UNLIT","GLTFMaterialsUnlitExtension","KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS","GLTFMaterialsPbrSpecularGlossinessExtension","KHR_DRACO_MESH_COMPRESSION","GLTFDracoMeshCompressionExtension","MSFT_TEXTURE_DDS","GLTFTextureDDSExtension","KHR_TEXTURE_TRANSFORM","GLTFTextureTransformExtension","KHR_MESH_QUANTIZATION","GLTFMeshQuantizationExtension","parser","GLTFParser","fileLoader","extension","lightDefs","lights","loadLight","lightIndex","lightNode","lightDef","fromArray","range","DirectionalLight","target","PointLight","SpotLight","spot","innerConeAngle","outerConeAngle","angle","penumbra","decay","intensity","getMaterialType","extendParams","materialParams","materialDef","pending","metallicRoughness","pbrMetallicRoughness","baseColorFactor","baseColorTexture","assignTexture","MeshPhysicalMaterial","clearcoatFactor","clearcoat","clearcoatTexture","clearcoatRoughnessFactor","clearcoatRoughness","clearcoatRoughnessTexture","clearcoatNormalTexture","clearcoatNormalScale","Vector2","BINARY_EXTENSION_CHUNK_TYPES","headerView","DataView","header","magic","slice","getUint32","chunkView","chunkIndex","chunkLength","chunkType","contentArray","byteOffset","GLTFMeshStandardSGMaterial","params","MeshStandardMaterial","isGLTFSpecularGlossinessMaterial","specularMapParsFragmentChunk","glossinessMapParsFragmentChunk","specularMapFragmentChunk","glossinessMapFragmentChunk","lightPhysicalFragmentChunk","uniforms","specular","setHex","glossiness","specularMap","glossinessMap","_extraUniforms","onBeforeCompile","shader","uniformName","fragmentShader","defineProperties","defines","USE_GLOSSINESSMAP","USE_ROUGHNESSMAP","metalness","roughness","metalnessMap","roughnessMap","setValues","specularGlossinessParams","pbrSpecularGlossiness","diffuseFactor","diffuseTexture","emissive","glossinessFactor","specularFactor","specularGlossinessTexture","specGlossMapDef","createMaterial","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalMapType","TangentSpaceNormalMap","normalScale","displacementMap","displacementScale","displacementBias","alphaMap","envMap","envMapIntensity","refractionRatio","GLTFCubicSplineInterpolant","parameterPositions","sampleValues","sampleSize","resultBuffer","Interpolant","decodePrimitive","primitive","bufferViewIndex","bufferView","gltfAttributeMap","threeAttributeMap","attributeNormalizedMap","attributeTypeMap","threeAttributeName","ATTRIBUTES","toLowerCase","accessorDef","accessors","componentType","WEBGL_COMPONENT_TYPES","normalized","getDependency","extendTexture","texture","repeat","texCoord","needsUpdate","source","copySampleValue_","valueSize","beforeStart_","afterEnd_","interpolate_","i1","t0","t","t1","stride","stride2","stride3","td","p","pp","ppp","offset1","offset0","s2","s3","s0","s1","p0","m0","p1","m1","WEBGL_CONSTANTS","5120","5121","5122","5123","5125","5126","WEBGL_FILTERS","9728","NearestFilter","9729","LinearFilter","9984","NearestMipmapNearestFilter","9985","LinearMipmapNearestFilter","9986","NearestMipmapLinearFilter","9987","LinearMipmapLinearFilter","WEBGL_WRAPPINGS","33071","ClampToEdgeWrapping","33648","MirroredRepeatWrapping","10497","RepeatWrapping","WEBGL_TYPE_SIZES","POSITION","NORMAL","TANGENT","TEXCOORD_0","TEXCOORD_1","COLOR_0","WEIGHTS_0","JOINTS_0","PATH_PROPERTIES","translation","weights","INTERPOLATION","CUBICSPLINE","LINEAR","InterpolateLinear","STEP","InterpolateDiscrete","ALPHA_MODES","MIME_TYPE_FORMATS","RGBAFormat","RGBFormat","resolveURL","addUnknownExtensionsToUserData","knownExtensions","objectDef","userData","gltfExtensions","assignExtrasToUserData","gltfDef","extras","updateMorphTargets","mesh","meshDef","il","morphTargetInfluences","targetNames","morphTargetDictionary","createPrimitiveKey","primitiveDef","dracoExtension","indices","createAttributesKey","attributesKey","options","associations","primitiveCache","textureLoader","TextureLoader","setCrossOrigin","addPrimitiveAttributes","assignAttributeAccessor","accessorIndex","accessor","gltfAttributeName","box","Box3","targets","maxDisplacement","vector","setX","setY","setZ","expandByVector","boundingBox","sphere","Sphere","getCenter","center","boundingSphere","computeBounds","hasMorphPosition","hasMorphNormal","pendingPositionAccessors","pendingNormalAccessors","pendingAccessor","morphPositions","morphNormals","morphAttributes","morphTargetsRelative","addMorphTargets","toTrianglesDrawMode","drawMode","getIndex","getAttribute","count","numberOfTriangles","newIndices","TriangleFanDrawMode","getX","newGeometry","markDefs","getDependencies","dependencies","scene","scenes","animations","cameras","nodeDefs","nodes","skinDefs","skins","meshDefs","meshes","meshReferences","meshUses","skinIndex","skinLength","joints","isBone","nodeIndex","nodeLength","nodeDef","skin","isSkinnedMesh","cacheKey","dependency","loadScene","loadNode","loadMesh","loadAccessor","loadBufferView","loadBuffer","loadMaterial","loadTexture","loadSkin","loadAnimation","loadCamera","defs","def","bufferIndex","bufferDef","uri","bufferViewDef","bufferViews","sparse","pendingBufferViews","bufferAttribute","TypedArray","elementBytes","itemBytes","byteStride","ibSlice","floor","ibCacheKey","ib","InterleavedBuffer","InterleavedBufferAttribute","itemSizeIndices","SCALAR","TypedArrayIndices","byteOffsetIndices","byteOffsetValues","sparseIndices","sparseValues","setW","textureIndex","webkitURL","textureDef","textures","textureExtensions","sourceURI","images","isObjectURL","blob","mimeType","getHandler","revokeObjectURL","flipY","format","sampler","samplers","magFilter","minFilter","wrapS","wrapT","mapName","mapDef","isCompressedTexture","gltfReference","assignFinalMaterial","useVertexTangents","tangent","useVertexColors","useFlatShading","useSkinning","useMorphTargets","useMorphNormals","isPoints","uuid","pointsMaterial","PointsMaterial","Material","sizeAttenuation","isLine","lineMaterial","cachedMaterial","skinning","vertexTangents","vertexColors","flatShading","morphTargets","uv2","materialIndex","materialType","materials","materialExtensions","sgExtension","kmuExtension","metallicFactor","roughnessFactor","metallicRoughnessTexture","doubleSided","alphaMode","alphaTest","alphaCutoff","normalTexture","occlusionTexture","strength","emissiveFactor","emissiveTexture","clearcoatExtension","encoding","sRGBEncoding","loadGeometries","primitives","createDracoPrimitive","geometryPromise","cached","meshIndex","FrontSide","results","geometries","SkinnedMesh","skinWeight","normalizeSkinWeights","TriangleStripDrawMode","LineSegments","LineLoop","Points","group","Group","cameraIndex","cameraDef","PerspectiveCamera","radToDeg","yfov","aspectRatio","znear","zfar","OrthographicCamera","xmag","ymag","skinDef","skinEntry","inverseBindMatrices","animationIndex","animationDef","pendingNodes","pendingInputAccessors","pendingOutputAccessors","pendingSamplers","pendingTargets","channels","channel","node","input","parameters","output","inputAccessors","outputAccessors","tracks","inputAccessor","outputAccessor","TypedKeyframeTrack","matrixAutoUpdate","NumberKeyframeTrack","QuaternionKeyframeTrack","VectorKeyframeTrack","targetName","interpolation","isMesh","outputArray","scaled","jl","track","createInterpolant","times","getValueSize","isInterpolantFactoryMethodGLTFCubicSpline","AnimationClip","instanceNum","o","light","Bone","PropertyBinding","sanitizeNodeName","buildNodeHierachy","nodeId","parentObject","pendingJoints","jointNodes","bones","boneInverses","jointNode","mat","Skeleton","sceneIndex","sceneDef","nodeIds","Reflector","textureWidth","textureHeight","clipBias","ReflectorShader","LinearEncoding","reflectorPlane","Plane","reflectorWorldPosition","cameraWorldPosition","rotationMatrix","lookAtPosition","clipPlane","Vector4","view","q","textureMatrix","virtualCamera","stencilBuffer","renderTarget","WebGLRenderTarget","isPowerOfTwo","generateMipmaps","ShaderMaterial","UniformsUtils","vertexShader","onBeforeRender","renderer","extractRotation","subVectors","reflect","negate","far","projectionMatrix","matrixWorldInverse","setFromNormalAndCoplanarPoint","constant","sign","elements","w","currentRenderTarget","getRenderTarget","currentXrEnabled","xr","currentShadowAutoUpdate","shadowMap","autoUpdate","setRenderTarget","state","setMask","autoClear","render","viewport","Stats","h","c","appendChild","dom","k","style","display","l","createElement","cssText","g","performance","Date","now","r","Panel","f","memory","REVISION","addPanel","showPanel","begin","end","usedJSHeapSize","jsHeapSizeLimit","devicePixelRatio","u","m","getContext","font","textBaseline","fillStyle","fillRect","fillText","globalAlpha","drawImage","SimplifyModifier","cb","ab","removeFromArray","computeEdgeCollapseCost","face","sideFace","edgelength","curvature","sideFaces","faces","hasVertex","minCurvature","dotProd","computeEdgeCostAtVertex","neighbors","collapseNeighbor","collapseCost","minCost","totalCost","costCount","removeVertex","assert","removeFace","v1","v2","v3","vs","removeIfNonNeighbor","collapse","tmpVertices","replaceVertex","minimumCostEdge","least","Triangle","computeNormal","addUniqueNeighbor","Vertex","vA","vB","vC","oldv","newv","vertex","modify","isBufferGeometry","Geometry","fromBufferGeometry","mergeVertices","nextVertex","oldVertices","oldFaces","triangle","simplifiedGeometry","SubdivisionModifier","subdivisions","repeats","smooth","computeFaceNormals","computeVertexNormals","ABC","getEdge","processEdge","metaVertices","edge","vertexIndexA","vertexIndexB","newEdge","edges","newFace","newFaces","Face3","midpoint","newUv","newUvs","oldUvs","newVertices","sourceEdges","newEdgeVertices","newSourceVertices","tmp","newUVs","currentEdge","edgeVertexWeight","adjacentVertexWeight","connectedFaces","sourceVertexWeight","connectingVertexWeight","connectingEdge","connectingEdges","oldVertex","newSourceVertex","hasUvs","faceVertexUvs","generateLookups","addVectors","edge1","edge2","edge3","x0","x1","x2","sl","x3","x4","x5","TessellateModifier","maxEdgeLength","maxEdgeLengthSquared","va","vb","vc","dab","distanceToSquared","dbc","dac","triA","triB","vm","vertexNormals","vnm","vcm","uvs","uvA","uvB","uvC","uvM","uvsTriA","uvsTriB","Sky","SkyShader","BackSide","createState","listeners","Set","setState","partial","nextState","forEach","listener","getState","api","subscribe","selector","equalityFn","is","currentSlice","listenerToAdd","newStateSlice","delete","subscribeWithSelector","useIsoLayoutEffect","useEffect","useLayoutEffect","create$1","useStore","useReducer","forceUpdate","stateRef","useRef","selectorRef","equalityFnRef","erroredRef","currentSliceRef","current","hasNewStateSlice","stateBeforeSubscriptionRef","nextStateSlice","unsubscribe","iterator","UniformsLib","line","resolution","dashScale","dashSize","gapSize","ShaderLib","merge","common","LineMaterial","clipping","dashed","enumerable","diffuse","isLineMaterial","LineGeometry","LineSegmentsGeometry","isLineGeometry","setPositions","points","setColors","colors","fromLine","isGeometry","LineSegments2","random","isLineSegments2","computeLineDistances","instanceStart","instanceEnd","lineDistances","fromBufferAttribute","instanceDistanceBuffer","InstancedInterleavedBuffer","raycast","ssOrigin","ssOrigin3","mvMatrix","Line3","closestPoint","intersects","ray","lineWidth","at","multiplyMatrices","isBehindCameraNear","isPastCameraFar","param","closestPointToPointParameter","zPos","isInClipSpace","isInside","pointOnLine","distanceSqToSegment","origin","faceIndex","Line2","isLine2","TrackballControls","_this","STATE","screen","rotateSpeed","zoomSpeed","panSpeed","noRotate","noZoom","noPan","staticMoving","dynamicDampingFactor","minDistance","maxDistance","mouseButtons","LEFT","MOUSE","ROTATE","MIDDLE","ZOOM","RIGHT","PAN","lastPosition","lastZoom","_state","_keyState","_eye","_movePrev","_moveCurr","_lastAxis","_lastAngle","_zoomStart","_zoomEnd","_touchZoomDistanceStart","_touchZoomDistanceEnd","_panStart","_panEnd","target0","position0","up0","zoom0","startEvent","endEvent","handleResize","ownerDocument","documentElement","pageXOffset","clientLeft","pageYOffset","clientTop","getMouseOnScreen","getMouseOnCircle","mousewheel","deltaMode","deltaY","touchstart","touches","dx","dy","touchmove","touchend","rotateCamera","eyeDirection","objectUpDirection","objectSidewaysDirection","moveDirection","setLength","zoomCamera","isPerspectiveCamera","updateProjectionMatrix","panCamera","mouseChange","objectUp","pan","lengthSq","scale_x","clientWidth","scale_y","checkDistances","reset","InstancedBufferGeometry","isLineSegmentsGeometry","computeBoundingBox","computeBoundingSphere","lineSegments","instanceBuffer","instanceColorBuffer","fromWireframeGeometry","fromEdgesGeometry","fromMesh","WireframeGeometry","fromLineSegments","setFromBufferAttribute","union","maxRadiusSq","isNaN","toJSON","applyMatrix","OrbitControls","minZoom","maxZoom","minPolarAngle","maxPolarAngle","minAzimuthAngle","maxAzimuthAngle","enableDamping","dampingFactor","enableZoom","enableRotate","enablePan","screenSpacePanning","keyPanSpeed","autoRotate","autoRotateSpeed","enableKeys","UP","BOTTOM","DOLLY","ONE","TOUCH","TWO","DOLLY_PAN","getPolarAngle","spherical","phi","getAzimuthalAngle","theta","saveState","NONE","quat","setFromUnitVectors","quatInverse","lastQuaternion","setFromVector3","rotateLeft","sphericalDelta","makeSafe","panOffset","setFromSpherical","zoomChanged","EPS","onContextMenu","onMouseDown","onMouseWheel","onTouchStart","onTouchEnd","onTouchMove","onMouseUp","onKeyDown","TOUCH_ROTATE","TOUCH_PAN","TOUCH_DOLLY_PAN","TOUCH_DOLLY_ROTATE","Spherical","rotateStart","rotateEnd","rotateDelta","panStart","panEnd","panDelta","dollyStart","dollyEnd","dollyDelta","getZoomScale","pow","rotateUp","panLeft","objectMatrix","panUp","deltaX","element","targetDistance","clientHeight","dollyOut","dollyScale","dollyIn","handleMouseDownRotate","handleMouseDownPan","handleTouchStartRotate","handleTouchStartPan","handleTouchStartDolly","handleTouchMoveRotate","handleTouchMovePan","handleTouchMoveDolly","mouseAction","handleMouseDownDolly","ctrlKey","metaKey","shiftKey","handleMouseMoveRotate","handleMouseMoveDolly","handleMouseMovePan","handleMouseWheel","handleKeyDown","handleTouchStartDollyPan","DOLLY_ROTATE","handleTouchStartDollyRotate","handleTouchMoveDollyPan","handleTouchMoveDollyRotate","tabIndex","MapControls"],"mappings":"oIAAA,8CAcIA,EAA4B,SAAWC,GAE1C,IAAIC,EAAQC,KAEZA,KAAKF,OAASA,EACdE,KAAKF,OAAOG,SAASC,QAAS,OAE9BF,KAAKG,SAAU,EAEfH,KAAKI,kBAAoB,GACzBJ,KAAKK,kBAAoB,EAEzBL,KAAKM,YAAc,EAEnB,IAAIC,EAAiC,SAAWC,GAE/CT,EAAMK,kBAAoBI,GAIvBC,EAAiC,WAEpCV,EAAMM,kBAAoBK,OAAOC,aAAe,GAM7CC,EAAsB,WAEzB,IAAIC,EAAM,IAAIC,UAAS,EAAG,EAAG,GAEzBC,EAAQ,IAAIC,QAEZC,EAAK,IAAIC,aAETC,EAAK,IAAID,cAAcE,KAAKC,KAAM,IAAO,EAAG,EAAGD,KAAKC,KAAM,KAE9D,OAAO,SAAWC,EAAYC,EAAOC,EAAMC,EAAOC,GAEjDX,EAAMY,IAAKH,EAAMD,GAASE,EAAO,OAEjCH,EAAWM,aAAcb,GAEzBO,EAAWO,SAAUV,GAErBG,EAAWO,SAAUZ,EAAGa,iBAAkBjB,GAAOa,KAlBzB,GAwB1B1B,KAAK+B,QAAU,WAEdtB,SAIuCuB,IAAlCtB,OAAOuB,wBAAmG,oBAApDvB,OAAOuB,uBAAuBC,kBAExFxB,OAAOuB,uBAAuBC,oBAAoBC,MAAM,SAAWC,GAEjD,WAAZA,IAEJ1B,OAAO2B,iBAAkB,oBAAqB5B,GAAgC,GAC9EC,OAAO2B,iBAAkB,oBAAqB9B,GAAgC,OAI5E+B,OAAO,SAAWC,GAErBC,QAAQD,MAAO,wEAAyEA,OAMzF7B,OAAO2B,iBAAkB,oBAAqB5B,GAAgC,GAC9EC,OAAO2B,iBAAkB,oBAAqB9B,GAAgC,IAI/ER,EAAMI,SAAU,GAIjBH,KAAKyC,WAAa,WAEjB/B,OAAOgC,oBAAqB,oBAAqBjC,GAAgC,GACjFC,OAAOgC,oBAAqB,oBAAqBnC,GAAgC,GAEjFR,EAAMI,SAAU,GAIjBH,KAAK2C,OAAS,WAEb,IAAuB,IAAlB5C,EAAMI,QAAX,CAEA,IAAIyC,EAAS7C,EAAMK,kBAEnB,GAAKwC,EAAS,CAEb,IAAIrB,EAAQqB,EAAOrB,MAAQsB,YAAUC,SAAUF,EAAOrB,OAAUxB,EAAMO,YAAc,EAEhFkB,EAAOoB,EAAOpB,KAAOqB,YAAUC,SAAUF,EAAOpB,MAAS,EAEzDC,EAAQmB,EAAOnB,MAAQoB,YAAUC,SAAUF,EAAOnB,OAAU,EAE5DC,EAAS3B,EAAMM,kBAAoBwC,YAAUC,SAAU/C,EAAMM,mBAAsB,EAEvFO,EAAqBb,EAAMD,OAAOwB,WAAYC,EAAOC,EAAMC,EAAOC,MAOpE1B,KAAK+C,QAAU,WAEdhD,EAAM0C,cAIPzC,KAAK+B,Y,iCC1IN,8CASIiB,EAAc,SAAWlD,EAAQmD,GA+OpC,SAASC,EAAMnD,EAAOoD,GAErB,OAAO,WAENA,EAAGC,MAAOrD,EAAOsD,YAMnB,SAASC,EAAa9C,GAErBA,EAAM+C,sBAzPavB,IAAfiB,IAEJT,QAAQgB,KAAM,0EACdP,EAAaQ,UAIdzD,KAAKF,OAASA,EACdE,KAAKiD,WAAaA,EAEbA,GAAajD,KAAKiD,WAAWS,aAAc,YAAc,GAI9D1D,KAAK2D,cAAgB,EACrB3D,KAAK4D,UAAY,KAEjB5D,KAAK6D,YAAa,EAClB7D,KAAK8D,aAAc,EAMnB9D,KAAK+D,cAAgB,IAAI7C,aAEzBlB,KAAKgE,YAAc,EAEnBhE,KAAKiE,UAAY,CAAEC,GAAI,EAAGC,KAAM,EAAGC,KAAM,EAAGC,MAAO,EAAGC,QAAS,EAAGC,KAAM,EAAGC,QAAS,EAAGC,UAAW,EAAGC,QAAS,EAAGC,SAAU,EAAGC,SAAU,EAAGC,UAAW,GACtJ7E,KAAK8E,WAAa,IAAIhE,UAAS,EAAG,EAAG,GACrCd,KAAK+E,eAAiB,IAAIjE,UAAS,EAAG,EAAG,GAEzCd,KAAKgF,QAAU,SAAWxE,GAEzB,IAAKA,EAAMyE,OAAX,CAQA,OAASzE,EAAM0E,SAEd,KAAK,GAAgBlF,KAAKmF,wBAA0B,GAAI,MAExD,KAAK,GAAUnF,KAAKiE,UAAUK,QAAU,EAAG,MAC3C,KAAK,GAAUtE,KAAKiE,UAAUM,KAAO,EAAG,MAExC,KAAK,GAAUvE,KAAKiE,UAAUG,KAAO,EAAG,MACxC,KAAK,GAAUpE,KAAKiE,UAAUI,MAAQ,EAAG,MAEzC,KAAK,GAAUrE,KAAKiE,UAAUC,GAAK,EAAG,MACtC,KAAK,GAAUlE,KAAKiE,UAAUE,KAAO,EAAG,MAExC,KAAK,GAAWnE,KAAKiE,UAAUO,QAAU,EAAG,MAC5C,KAAK,GAAaxE,KAAKiE,UAAUQ,UAAY,EAAG,MAEhD,KAAK,GAAazE,KAAKiE,UAAUS,QAAU,EAAG,MAC9C,KAAK,GAAc1E,KAAKiE,UAAUU,SAAW,EAAG,MAEhD,KAAK,GAAU3E,KAAKiE,UAAUW,SAAW,EAAG,MAC5C,KAAK,GAAU5E,KAAKiE,UAAUY,UAAY,EAI3C7E,KAAKoF,uBACLpF,KAAKqF,yBAINrF,KAAKsF,MAAQ,SAAW9E,GAEvB,OAASA,EAAM0E,SAEd,KAAK,GAAgBlF,KAAKmF,wBAA0B,EAAG,MAEvD,KAAK,GAAUnF,KAAKiE,UAAUK,QAAU,EAAG,MAC3C,KAAK,GAAUtE,KAAKiE,UAAUM,KAAO,EAAG,MAExC,KAAK,GAAUvE,KAAKiE,UAAUG,KAAO,EAAG,MACxC,KAAK,GAAUpE,KAAKiE,UAAUI,MAAQ,EAAG,MAEzC,KAAK,GAAUrE,KAAKiE,UAAUC,GAAK,EAAG,MACtC,KAAK,GAAUlE,KAAKiE,UAAUE,KAAO,EAAG,MAExC,KAAK,GAAWnE,KAAKiE,UAAUO,QAAU,EAAG,MAC5C,KAAK,GAAaxE,KAAKiE,UAAUQ,UAAY,EAAG,MAEhD,KAAK,GAAazE,KAAKiE,UAAUS,QAAU,EAAG,MAC9C,KAAK,GAAc1E,KAAKiE,UAAUU,SAAW,EAAG,MAEhD,KAAK,GAAU3E,KAAKiE,UAAUW,SAAW,EAAG,MAC5C,KAAK,GAAU5E,KAAKiE,UAAUY,UAAY,EAI3C7E,KAAKoF,uBACLpF,KAAKqF,wBAINrF,KAAKuF,UAAY,SAAW/E,GAW3B,GATKR,KAAKiD,aAAeQ,UAExBzD,KAAKiD,WAAWuC,QAIjBhF,EAAM+C,iBACN/C,EAAMiF,kBAEDzF,KAAK6D,WAET7D,KAAKgE,kBAEC,CAEN,OAASxD,EAAMkF,QAEd,KAAK,EAAG1F,KAAKiE,UAAUK,QAAU,EAAG,MACpC,KAAK,EAAGtE,KAAKiE,UAAUM,KAAO,EAI/BvE,KAAKoF,yBAMPpF,KAAK2F,UAAY,SAAWnF,GAE3B,IAAOR,KAAK6D,YAAc7D,KAAKgE,YAAc,EAAI,CAEhD,IAAI4B,EAAY5F,KAAK6F,yBACjBC,EAAYF,EAAUG,KAAM,GAAM,EAClCC,EAAaJ,EAAUG,KAAM,GAAM,EAEvC/F,KAAKiE,UAAUS,UAAgBlE,EAAMyF,MAAQL,EAAUM,OAAQ,GAAQJ,GAAcA,EACrF9F,KAAKiE,UAAUQ,WAAgBjE,EAAM2F,MAAQP,EAAUM,OAAQ,GAAQF,GAAeA,EAEtFhG,KAAKqF,yBAMPrF,KAAKoG,QAAU,SAAW5F,GAKzB,GAHAA,EAAM+C,iBACN/C,EAAMiF,kBAEDzF,KAAK6D,WAET7D,KAAKgE,cAELhE,KAAKiE,UAAUS,QAAU1E,KAAKiE,UAAUQ,UAAY,MAE9C,CAEN,OAASjE,EAAMkF,QAEd,KAAK,EAAG1F,KAAKiE,UAAUK,QAAU,EAAG,MACpC,KAAK,EAAGtE,KAAKiE,UAAUM,KAAO,EAI/BvE,KAAKoF,uBAINpF,KAAKqF,wBAINrF,KAAK2C,OAAS,SAAW0D,GAExB,IAAIC,EAAWD,EAAQrG,KAAK2D,cACxB4C,EAAUF,EAAQrG,KAAK4D,UAE3B5D,KAAKF,OAAO0G,WAAYxG,KAAK8E,WAAW2B,EAAIH,GAC5CtG,KAAKF,OAAO4G,WAAY1G,KAAK8E,WAAW6B,EAAIL,GAC5CtG,KAAKF,OAAO8G,WAAY5G,KAAK8E,WAAW+B,EAAIP,GAE5CtG,KAAK+D,cAAcpC,IAAK3B,KAAK+E,eAAe0B,EAAIF,EAASvG,KAAK+E,eAAe4B,EAAIJ,EAASvG,KAAK+E,eAAe8B,EAAIN,EAAS,GAAIO,YAC/H9G,KAAKF,OAAOwB,WAAWO,SAAU7B,KAAK+D,eAGtC/D,KAAKF,OAAOG,SAAS8G,kBAAmB/G,KAAKF,OAAOwB,WAAYtB,KAAKF,OAAOG,SAAS+G,QAKtFhH,KAAKoF,qBAAuB,WAE3B,IAAId,EAAYtE,KAAKiE,UAAUK,SAAatE,KAAK8D,cAAiB9D,KAAKiE,UAAUM,KAAW,EAAI,EAEhGvE,KAAK8E,WAAW2B,GAAQzG,KAAKiE,UAAUG,KAAOpE,KAAKiE,UAAUI,MAC7DrE,KAAK8E,WAAW6B,GAAQ3G,KAAKiE,UAAUE,KAAOnE,KAAKiE,UAAUC,GAC7DlE,KAAK8E,WAAW+B,GAAQvC,EAAUtE,KAAKiE,UAAUM,MAMlDvE,KAAKqF,qBAAuB,WAE3BrF,KAAK+E,eAAe0B,GAAQzG,KAAKiE,UAAUQ,UAAYzE,KAAKiE,UAAUO,QACtExE,KAAK+E,eAAe4B,GAAQ3G,KAAKiE,UAAUU,SAAW3E,KAAKiE,UAAUS,QACrE1E,KAAK+E,eAAe8B,GAAQ7G,KAAKiE,UAAUY,UAAY7E,KAAKiE,UAAUW,UAMvE5E,KAAK6F,uBAAyB,WAE7B,OAAK7F,KAAKiD,YAAcQ,SAEhB,CACNsC,KAAM,CAAE/F,KAAKiD,WAAWgE,YAAajH,KAAKiD,WAAWiE,cACrDhB,OAAQ,CAAElG,KAAKiD,WAAWkE,WAAYnH,KAAKiD,WAAWmE,YAKhD,CACNrB,KAAM,CAAErF,OAAO2G,WAAY3G,OAAO4G,aAClCpB,OAAQ,CAAE,EAAG,KAuBhBlG,KAAK+C,QAAU,WAEd/C,KAAKiD,WAAWP,oBAAqB,cAAeY,GAAa,GACjEtD,KAAKiD,WAAWP,oBAAqB,YAAa6E,GAAY,GAC9DvH,KAAKiD,WAAWP,oBAAqB,YAAa8E,GAAY,GAC9DxH,KAAKiD,WAAWP,oBAAqB,UAAW+E,GAAU,GAE1D/G,OAAOgC,oBAAqB,UAAWgF,GAAU,GACjDhH,OAAOgC,oBAAqB,QAASiF,GAAQ,IAI9C,IAAIH,EAAatE,EAAMlD,KAAMA,KAAK2F,WAC9B4B,EAAarE,EAAMlD,KAAMA,KAAKuF,WAC9BkC,EAAWvE,EAAMlD,KAAMA,KAAKoG,SAC5BsB,EAAWxE,EAAMlD,KAAMA,KAAKgF,SAC5B2C,EAASzE,EAAMlD,KAAMA,KAAKsF,OAE9BtF,KAAKiD,WAAWZ,iBAAkB,cAAeiB,GAAa,GAE9DtD,KAAKiD,WAAWZ,iBAAkB,YAAamF,GAAY,GAC3DxH,KAAKiD,WAAWZ,iBAAkB,YAAakF,GAAY,GAC3DvH,KAAKiD,WAAWZ,iBAAkB,UAAWoF,GAAU,GAEvD/G,OAAO2B,iBAAkB,UAAWqF,GAAU,GAC9ChH,OAAO2B,iBAAkB,QAASsF,GAAQ,GAE1C3H,KAAKoF,uBACLpF,KAAKqF,yB,iCCpSN,8CA2BIuC,EAAoB,SAAWC,EAAQ5E,QAEtBjB,IAAfiB,IAEJT,QAAQgB,KAAM,gFACdP,EAAaQ,UAIdqE,WAASC,KAAM/H,MAEfA,KAAKgI,SAAU,EACfhI,KAAKiD,WAAaA,EAElB,IAAIgF,EAAS,IAAIC,EACjBlI,KAAKmI,IAAKF,GAEV,IAAIG,EAAS,IAAIC,EACjBrI,KAAKmI,IAAKC,GAEV,IAAIrI,EAAQC,KAMZsI,EAAgB,SAAUT,GAC1BS,EAAgB,cAAUtG,GAC1BsG,EAAgB,WAAW,GAC3BA,EAAgB,OAAQ,MACxBA,EAAgB,OAAQ,aACxBA,EAAgB,kBAAmB,MACnCA,EAAgB,eAAgB,MAChCA,EAAgB,YAAa,MAC7BA,EAAgB,QAAS,SACzBA,EAAgB,OAAQ,GACxBA,EAAgB,YAAY,GAC5BA,EAAgB,SAAS,GACzBA,EAAgB,SAAS,GACzBA,EAAgB,SAAS,GAEzB,IAAIC,EAAc,CAAEC,KAAM,UACtBC,EAAiB,CAAED,KAAM,aACzBE,EAAe,CAAEF,KAAM,UAAWG,KAAM5I,EAAM4I,MAC9CC,EAAoB,CAAEJ,KAAM,gBAI5BK,EAAY,IAAIC,YAEpB,SAASC,EAAwBjJ,EAAQ+I,EAAWG,GAInD,IAFA,IAAIC,EAAmBJ,EAAUK,gBAAiBpJ,GAAQ,GAEhDqJ,EAAI,EAAGA,EAAIF,EAAiBG,OAAQD,IAE7C,GAAKF,EAAkBE,GAAIrJ,OAAOkI,SAAWgB,EAE5C,OAAOC,EAAkBE,GAM3B,OAAO,EAIR,IAAIE,EAAc,IAAIvI,UAClBwI,EAAe,IAAIxI,UACnByI,EAAkB,IAAIrI,aACtBsI,EAAQ,CACXC,EAAG,IAAI3I,UAAS,EAAG,EAAG,GACtB4I,EAAG,IAAI5I,UAAS,EAAG,EAAG,GACtB6I,EAAG,IAAI7I,UAAS,EAAG,EAAG,IAGnB8I,EAAa,IAAI9I,UACjB+I,EAAW,IAAI/I,UACfoF,EAAS,IAAIpF,UACbgJ,EAAe,IAAIhJ,UACnBiJ,EAAY,IAAIjJ,UAChBkJ,EAAU,IAAIlJ,UACdmJ,EAAgB,EAEhBC,EAAiB,IAAIpJ,UACrBqJ,EAAmB,IAAIjJ,aACvBkJ,EAAc,IAAItJ,UAElBuJ,EAAiB,IAAIvJ,UACrBwJ,EAAmB,IAAIpJ,aACvBqJ,EAAsB,IAAIrJ,aAC1BsJ,EAAc,IAAI1J,UAElB2J,EAAqB,IAAI3J,UACzB4J,EAAuB,IAAIxJ,aAC3ByJ,EAAkB,IAAI7J,UAEtB8J,EAAgB,IAAI9J,UACpB+J,EAAkB,IAAI3J,aACtB4J,EAAqB,IAAI5J,aACzB6J,EAAa,IAAIjK,UAEjBkK,EAAM,IAAIlK,UAEVmK,EAAgB,IAAInK,UACpBoK,EAAkB,IAAIhK,aACtBiK,EAAa,IAAIrK,UA0ErB,SAASwH,EAAgB8C,EAAUC,GAElC,IAAIC,EAAYD,EAEhBE,OAAOjD,eAAgBvI,EAAOqL,EAAU,CAEvCI,IAAK,WAEJ,YAAqBxJ,IAAdsJ,EAA0BA,EAAYD,GAI9C1J,IAAK,SAAW8J,GAEVH,IAAcG,IAElBH,EAAYG,EACZrD,EAAQgD,GAAaK,EACrBxD,EAAQmD,GAAaK,EAErB1L,EAAM2L,cAAe,CAAElD,KAAM4C,EAAW,WAAYK,MAAOA,IAC3D1L,EAAM2L,cAAenD,OAQxBxI,EAAOqL,GAAaC,EACpBjD,EAAQgD,GAAaC,EACrBpD,EAAQmD,GAAaC,EA8XtB,SAASM,EAAYnL,GAEpB,GAAKiD,SAASmI,mBAEb,MAAO,CACNnF,EAAG,EACHE,EAAG,EACHjB,OAAQlF,EAAMkF,QAKf,IAAImG,EAAUrL,EAAMsL,eAAiBtL,EAAMsL,eAAgB,GAAMtL,EAE7DuL,EAAO9I,EAAW+I,wBAEtB,MAAO,CACNvF,GAAKoF,EAAQI,QAAUF,EAAK3H,MAAS2H,EAAKG,MAAQ,EAAI,EACtDvF,IAAOkF,EAAQM,QAAUJ,EAAKK,KAAQL,EAAKM,OAAS,EAAI,EACxD3G,OAAQlF,EAAMkF,QASjB,SAAS4G,EAAgB9L,GAEjBT,EAAMI,SAEbJ,EAAMwM,aAAcZ,EAAYnL,IAIjC,SAASgM,EAAehM,GAEhBT,EAAMI,UAEbsD,SAASpB,iBAAkB,YAAaoK,GAAe,GAEvD1M,EAAMwM,aAAcZ,EAAYnL,IAChCT,EAAM2M,YAAaf,EAAYnL,KAIhC,SAASiM,EAAejM,GAEhBT,EAAMI,SAEbJ,EAAM4M,YAAahB,EAAYnL,IAIhC,SAASoM,EAAapM,GAEdT,EAAMI,UAEbsD,SAASf,oBAAqB,YAAa+J,GAAe,GAE1D1M,EAAM8M,UAAWlB,EAAYnL,KAhiB9B8H,EAAgB,gBAAiBsC,GACjCtC,EAAgB,qBAAsBmC,GACtCnC,EAAgB,kBAAmBuC,GACnCvC,EAAgB,uBAAwBoC,GACxCpC,EAAgB,iBAAkB4B,GAClC5B,EAAgB,mBAAoB6B,GACpC7B,EAAgB,aAAcsB,GAC9BtB,EAAgB,WAAYuB,GAC5BvB,EAAgB,eAAgBwB,GAChCxB,EAAgB,gBAAiB2B,GACjC3B,EAAgB,MAAO0C,GAItB/H,EAAWZ,iBAAkB,YAAamK,GAAe,GACzDvJ,EAAWZ,iBAAkB,aAAcmK,GAAe,GAC1DvJ,EAAWZ,iBAAkB,YAAaiK,GAAgB,GAC1DrJ,EAAWZ,iBAAkB,YAAaiK,GAAgB,GAC1DrJ,EAAWZ,iBAAkB,YAAaoK,GAAe,GACzDhJ,SAASpB,iBAAkB,UAAWuK,GAAa,GACnD3J,EAAWZ,iBAAkB,WAAYuK,GAAa,GACtD3J,EAAWZ,iBAAkB,cAAeuK,GAAa,GACzD3J,EAAWZ,iBAAkB,aAAcuK,GAAa,GAIzD5M,KAAK+C,QAAU,WAEdE,EAAWP,oBAAqB,YAAa8J,GAC7CvJ,EAAWP,oBAAqB,aAAc8J,GAC9CvJ,EAAWP,oBAAqB,YAAa4J,GAC7C7I,SAASf,oBAAqB,YAAa+J,GAC3CxJ,EAAWP,oBAAqB,YAAa4J,GAC7CrJ,EAAWP,oBAAqB,YAAa+J,GAC7ChJ,SAASf,oBAAqB,UAAWkK,GACzC3J,EAAWP,oBAAqB,WAAYkK,GAC5C3J,EAAWP,oBAAqB,cAAekK,GAC/C3J,EAAWP,oBAAqB,aAAckK,GAE9C5M,KAAK8M,UAAU,SAAWC,GAEpBA,EAAMC,UAAWD,EAAMC,SAASjK,UAChCgK,EAAME,UAAWF,EAAME,SAASlK,cAOvC/C,KAAKkN,OAAS,SAAWpN,GAKxB,OAHAE,KAAKF,OAASA,EACdE,KAAKgI,SAAU,EAERhI,MAKRA,KAAKmN,OAAS,WAMb,OAJAnN,KAAKF,YAASkC,EACdhC,KAAKgI,SAAU,EACfhI,KAAKoN,KAAO,KAELpN,MAyCRA,KAAKqN,kBAAoB,gBAEHrL,IAAhBhC,KAAKF,SAETE,KAAKF,OAAOuN,oBAEgB,OAAvBrN,KAAKF,OAAOwN,OAEhB9K,QAAQD,MAAO,gFAIfvC,KAAKF,OAAOwN,OAAOC,YAAYC,UAAWnD,EAAgBC,EAAkBE,GAI7ExK,KAAKF,OAAOyN,YAAYC,UAAW5C,EAAeC,EAAiBE,GAEnER,EAAoBkD,KAAMnD,GAAmBoD,UAC7C5C,EAAmB2C,KAAM5C,GAAkB6C,WAI5C1N,KAAK6H,OAAOwF,oBACZrN,KAAK6H,OAAO0F,YAAYC,UAAWtD,EAAgBC,EAAkBC,GAErEY,EAAIyC,KAAMvD,GAAiByD,IAAK/C,GAAgB9D,YAEhDgB,WAAS8F,UAAUP,kBAAkBtF,KAAM/H,OAI5CA,KAAKuM,aAAe,SAAWV,GAE9B,QAAqB7J,IAAhBhC,KAAKF,SAA0C,IAAlBE,KAAK6N,gBAA0C7L,IAAnB6J,EAAQnG,QAA2C,IAAnBmG,EAAQnG,QAAtG,CAEAmD,EAAUiF,cAAejC,EAAS7L,KAAK6H,QAEvC,IAAIkG,EAAYhF,EAAwBd,EAAO+F,OAAQhO,KAAK2I,MAAQE,GAInE7I,KAAKoN,KAFDW,EAEQA,EAAUjO,OAAOmO,KAIjB,OAMdjO,KAAK0M,YAAc,SAAWb,GAE7B,QAAqB7J,IAAhBhC,KAAKF,SAA0C,IAAlBE,KAAK6N,gBAA0C7L,IAAnB6J,EAAQnG,QAA2C,IAAnBmG,EAAQnG,UAE5E,IAAnBmG,EAAQnG,aAAmC1D,IAAnB6J,EAAQnG,SAAwC,OAAd1F,KAAKoN,KAAgB,CAErFvE,EAAUiF,cAAejC,EAAS7L,KAAK6H,QAEvC,IAAIqG,EAAiBnF,EAAwBX,EAAQS,GAAW,GAEhE,GAAKqF,EAAiB,CAErB,IAAIC,EAAQnO,KAAKmO,MAYjB,GAVmB,UAAdnO,KAAK2I,KAETwF,EAAQ,QAEiB,MAAdnO,KAAKoN,MAA8B,SAAdpN,KAAKoN,MAAiC,QAAdpN,KAAKoN,OAE7De,EAAQ,SAIM,UAAVA,GAAmC,WAAdnO,KAAK2I,KAAoB,CAElD,IAAIyF,EAAOpO,KAAKqO,aAEG,MAAdrO,KAAKoN,MAAgBgB,IAAOpO,KAAKF,OAAOG,SAASwG,EAAIrF,KAAKkN,MAAOtO,KAAKF,OAAOG,SAASwG,EAAI2H,GAASA,GACrF,MAAdpO,KAAKoN,MAAgBgB,IAAOpO,KAAKF,OAAOG,SAAS0G,EAAIvF,KAAKkN,MAAOtO,KAAKF,OAAOG,SAAS0G,EAAIyH,GAASA,GACrF,MAAdpO,KAAKoN,MAAgBgB,IAAOpO,KAAKF,OAAOG,SAAS4G,EAAIzF,KAAKkN,MAAOtO,KAAKF,OAAOG,SAAS4G,EAAIuH,GAASA,GAIzGpO,KAAKF,OAAOuN,oBACZrN,KAAKF,OAAOwN,OAAOD,oBAEnBpC,EAAcwC,KAAMzN,KAAKF,OAAOyO,UAChCrD,EAAgBuC,KAAMzN,KAAKF,OAAOwB,YAClC6J,EAAWsC,KAAMzN,KAAKF,OAAO0O,OAE7BxO,KAAKF,OAAOyN,YAAYC,UAAW/C,EAAoBC,EAAsBC,GAE7Ef,EAAW6D,KAAMS,EAAeO,OAAQd,IAAKlD,GAI9CzK,KAAK6N,UAAW,EAChBpF,EAAeE,KAAO3I,KAAK2I,KAC3B3I,KAAK0L,cAAejD,KAMtBzI,KAAK2M,YAAc,SAAWd,GAE7B,IAAIuB,EAAOpN,KAAKoN,KACZzE,EAAO3I,KAAK2I,KACZ7I,EAASE,KAAKF,OACdqO,EAAQnO,KAAKmO,MAYjB,GAVc,UAATxF,EAEJwF,EAAQ,QAEY,MAATf,GAAyB,SAATA,GAA4B,QAATA,IAE9Ce,EAAQ,cAIOnM,IAAXlC,GAAiC,OAATsN,IAAmC,IAAlBpN,KAAK6N,gBAA2C7L,IAAnB6J,EAAQnG,QAA2C,IAAnBmG,EAAQnG,QAAnH,CAEAmD,EAAUiF,cAAejC,EAAS7L,KAAK6H,QAEvC,IAAIqG,EAAiBnF,EAAwBX,EAAQS,GAAW,GAEhE,GAAOqF,EAAP,CAIA,GAFArE,EAAS4D,KAAMS,EAAeO,OAAQd,IAAKlD,GAE7B,cAAT9B,EAIJzC,EAAOuH,KAAM5D,GAAW8D,IAAK/D,GAEd,UAAVuE,GAA8B,QAATf,GAEzBlH,EAAOwI,gBAAiB5D,IAIM,IAA1BsC,EAAKuB,QAAS,OAAgBzI,EAAOO,EAAI,IACf,IAA1B2G,EAAKuB,QAAS,OAAgBzI,EAAOS,EAAI,IACf,IAA1ByG,EAAKuB,QAAS,OAAgBzI,EAAOW,EAAI,GAE/B,UAAVsH,GAA8B,QAATf,EAEzBlH,EAAOwI,gBAAiBxD,GAAkB0D,OAAQpE,GAIlDtE,EAAOwI,gBAAiBnE,GAAsBqE,OAAQpE,GAIvD1K,EAAOyO,SAASd,KAAMvH,GAASiC,IAAK8C,GAI/BjL,KAAK6O,kBAEM,UAAVV,IAEJrO,EAAOyO,SAASG,gBAAiBnF,EAAgBkE,KAAMvC,GAAkBwC,YAE3C,IAAzBN,EAAK0B,OAAQ,OAEjBhP,EAAOyO,SAAS9H,EAAIrF,KAAKkN,MAAOxO,EAAOyO,SAAS9H,EAAIzG,KAAK6O,iBAAoB7O,KAAK6O,kBAIrD,IAAzBzB,EAAK0B,OAAQ,OAEjBhP,EAAOyO,SAAS5H,EAAIvF,KAAKkN,MAAOxO,EAAOyO,SAAS5H,EAAI3G,KAAK6O,iBAAoB7O,KAAK6O,kBAIrD,IAAzBzB,EAAK0B,OAAQ,OAEjBhP,EAAOyO,SAAS1H,EAAIzF,KAAKkN,MAAOxO,EAAOyO,SAAS1H,EAAI7G,KAAK6O,iBAAoB7O,KAAK6O,iBAInF/O,EAAOyO,SAASG,gBAAiBxD,IAInB,UAAViD,IAECrO,EAAOwN,QAEXxN,EAAOyO,SAASpG,IAAKkB,EAAY0F,sBAAuBjP,EAAOwN,OAAOC,eAIzC,IAAzBH,EAAK0B,OAAQ,OAEjBhP,EAAOyO,SAAS9H,EAAIrF,KAAKkN,MAAOxO,EAAOyO,SAAS9H,EAAIzG,KAAK6O,iBAAoB7O,KAAK6O,kBAIrD,IAAzBzB,EAAK0B,OAAQ,OAEjBhP,EAAOyO,SAAS5H,EAAIvF,KAAKkN,MAAOxO,EAAOyO,SAAS5H,EAAI3G,KAAK6O,iBAAoB7O,KAAK6O,kBAIrD,IAAzBzB,EAAK0B,OAAQ,OAEjBhP,EAAOyO,SAAS1H,EAAIzF,KAAKkN,MAAOxO,EAAOyO,SAAS1H,EAAI7G,KAAK6O,iBAAoB7O,KAAK6O,iBAI9E/O,EAAOwN,QAEXxN,EAAOyO,SAASZ,IAAKtE,EAAY0F,sBAAuBjP,EAAOwN,OAAOC,qBAQnE,GAAc,UAAT5E,EAAmB,CAE9B,IAAgC,IAA3ByE,EAAK0B,OAAQ,OAAkB,CAEnC,IAAIE,EAAInF,EAAST,SAAWQ,EAAWR,SAElCS,EAASoF,IAAKrF,GAAe,IAAIoF,IAAO,GAE7C1F,EAAa3H,IAAKqN,EAAGA,EAAGA,QAIxB3F,EAAYoE,KAAM7D,GAClBN,EAAamE,KAAM5D,GAEnBR,EAAYqF,gBAAiB5D,GAC7BxB,EAAaoF,gBAAiB5D,GAE9BxB,EAAasF,OAAQvF,IAES,IAAzB+D,EAAK0B,OAAQ,OAEjBxF,EAAa7C,EAAI,IAIY,IAAzB2G,EAAK0B,OAAQ,OAEjBxF,EAAa3C,EAAI,IAIY,IAAzByG,EAAK0B,OAAQ,OAEjBxF,EAAazC,EAAI,GAQnB/G,EAAO0O,MAAMf,KAAMtC,GAAatJ,SAAUyH,GAErCtJ,KAAKkP,aAEqB,IAAzB9B,EAAK0B,OAAQ,OAEjBhP,EAAO0O,MAAM/H,EAAIrF,KAAKkN,MAAOxO,EAAO0O,MAAM/H,EAAIzG,KAAKkP,WAAclP,KAAKkP,WAAalP,KAAKkP,YAI3D,IAAzB9B,EAAK0B,OAAQ,OAEjBhP,EAAO0O,MAAM7H,EAAIvF,KAAKkN,MAAOxO,EAAO0O,MAAM7H,EAAI3G,KAAKkP,WAAclP,KAAKkP,WAAalP,KAAKkP,YAI3D,IAAzB9B,EAAK0B,OAAQ,OAEjBhP,EAAO0O,MAAM3H,EAAIzF,KAAKkN,MAAOxO,EAAO0O,MAAM3H,EAAI7G,KAAKkP,WAAclP,KAAKkP,WAAalP,KAAKkP,iBAMpF,GAAc,WAATvG,EAAoB,CAE/BzC,EAAOuH,KAAM5D,GAAW8D,IAAK/D,GAE7B,IAAIuF,EAAiB,GAAKvE,EAAcwE,WAAY/F,EAAY0F,sBAAuB/O,KAAK6H,OAAO0F,cAErF,MAATH,GAEJtD,EAAa2D,KAAMzC,GACnBf,EAAgBJ,EAASwF,QAASzF,GAElCG,EAAU0D,KAAM7D,GAAa9C,YAC7BkD,EAAQyD,KAAM5D,GAAW/C,YAEzBmD,GAAmBD,EAAQsF,MAAOvF,GAAYkF,IAAKjE,GAAQ,EAAI,GAAM,GAEjD,SAAToC,GAEXtD,EAAa2D,KAAMvH,GAASoJ,MAAOtE,GAAMlE,YACzCmD,EAAgB/D,EAAO+I,IAAK5F,EAAYoE,KAAM3D,GAAewF,MAAOtP,KAAKgL,MAAUmE,GAE/D,MAAT/B,GAAyB,MAATA,GAAyB,MAATA,IAE3CtD,EAAa2D,KAAMjE,EAAO4D,IAE1B/D,EAAYoE,KAAMjE,EAAO4D,IAEV,UAAVe,GAEJ9E,EAAYqF,gBAAiB7D,GAI9BZ,EAAgB/D,EAAO+I,IAAK5F,EAAYiG,MAAOtE,GAAMlE,aAAgBqI,GAMjEnP,KAAKqO,eAAepE,EAAgB7I,KAAKkN,MAAOrE,EAAgBjK,KAAKqO,cAAiBrO,KAAKqO,cAEhGrO,KAAKiK,cAAgBA,EAGN,UAAVkE,GAA8B,MAATf,GAAyB,SAATA,GAEzCtN,EAAOwB,WAAWmM,KAAMvC,GACxBpL,EAAOwB,WAAWO,SAAU0H,EAAgBzH,iBAAkBgI,EAAcG,IAAkBnD,cAI9FgD,EAAa4E,gBAAiBnE,GAC9BzK,EAAOwB,WAAWmM,KAAMlE,EAAgBzH,iBAAkBgI,EAAcG,IACxEnK,EAAOwB,WAAWO,SAAUqJ,GAAkBpE,aAMhD9G,KAAK0L,cAAenD,GACpBvI,KAAK0L,cAAe9C,MAIrB5I,KAAK6M,UAAY,SAAWhB,QAEH7J,IAAnB6J,EAAQnG,QAA2C,IAAnBmG,EAAQnG,SAExC1F,KAAK6N,UAA4B,OAAd7N,KAAKoN,OAE5B1E,EAAaC,KAAO3I,KAAK2I,KACzB3I,KAAK0L,cAAehD,IAIrB1I,KAAK6N,UAAW,OAEQ7L,IAAnB6J,EAAQnG,SAAuB1F,KAAKoN,KAAO,QAyEjDpN,KAAKuP,QAAU,WAEd,OAAOxP,EAAM4I,MAId3I,KAAKwP,QAAU,SAAW7G,GAEzB5I,EAAM4I,KAAOA,GAId3I,KAAKyP,mBAAqB,SAAWZ,GAEpC9O,EAAM8O,gBAAkBA,GAIzB7O,KAAK0P,gBAAkB,SAAWrB,GAEjCtO,EAAMsO,aAAeA,GAItBrO,KAAK2P,aAAe,SAAWT,GAE9BnP,EAAMmP,UAAYA,GAInBlP,KAAK4P,QAAU,SAAW7J,GAEzBhG,EAAMgG,KAAOA,GAId/F,KAAK6P,SAAW,SAAW1B,GAE1BpO,EAAMoO,MAAQA,GAIfnO,KAAK2C,OAAS,WAEbH,QAAQgB,KAAM,2GAMhBoE,EAAkBgG,UAAYrC,OAAOuE,OAAQvE,OAAOwE,OAAQjI,WAAS8F,WAAa,CAEjFoC,YAAapI,EAEbqI,qBAAqB,IAKtB,IAAI/H,EAAyB,WAI5BJ,WAASC,KAAM/H,MAEfA,KAAKwI,KAAO,yBAIZ,IAAI0H,EAAgB,IAAIC,oBAAmB,CAC1CC,WAAW,EACXC,YAAY,EACZC,aAAa,EACbC,KAAMC,aACNC,KAAK,IAGFC,EAAoB,IAAIC,oBAAmB,CAC9CP,WAAW,EACXC,YAAY,EACZC,aAAa,EACbM,UAAW,EACXH,KAAK,IAKFI,EAAeX,EAAcY,QACjCD,EAAaE,QAAU,IAEvB,IAAIC,EAAYd,EAAcY,QAC9BE,EAAUD,QAAU,IAEpB,IAAIE,EAASf,EAAcY,QAC3BG,EAAOC,MAAMvP,IAAK,UAElB,IAAIwP,EAAWjB,EAAcY,QAC7BK,EAASD,MAAMvP,IAAK,OAEpB,IAAIyP,EAAUlB,EAAcY,QAC5BM,EAAQF,MAAMvP,IAAK,KAEnB,IAAI0P,EAAsBnB,EAAcY,QACxCO,EAAoBN,QAAU,IAE9B,IAAIO,EAAuBD,EAAoBP,QAC/CQ,EAAqBJ,MAAMvP,IAAK,UAEhC,IAAI4P,EAAqBF,EAAoBP,QAC7CS,EAAmBL,MAAMvP,IAAK,OAE9B,IAAI6P,EAAwBH,EAAoBP,QAChDU,EAAsBN,MAAMvP,IAAK,UAEjBuO,EAAcY,QACpBI,MAAMvP,IAAK,UAErB,IAAI8P,EAAaf,EAAkBI,QACnCW,EAAWP,MAAMvP,IAAK,UAEtB,IAAI+P,EAAehB,EAAkBI,QACrCY,EAAaR,MAAMvP,IAAK,OAExB,IAAIgQ,EAAcjB,EAAkBI,QACpCa,EAAYT,MAAMvP,IAAK,KAEvB,IAAIiQ,EAAclB,EAAkBI,QACpCc,EAAYV,MAAMvP,IAAK,OAEvB,IAAIkQ,EAAiBnB,EAAkBI,QACvCe,EAAeX,MAAMvP,IAAK,UAE1B,IAAImQ,EAAgBpB,EAAkBI,QACtCgB,EAAcZ,MAAMvP,IAAK,UAEzB,IAAIoQ,EAAcrB,EAAkBI,QACpCiB,EAAYb,MAAMvP,IAAK,SAEvB,IAAIqQ,EAA2BF,EAAchB,QAC7CkB,EAAyBjB,QAAU,IAInC,IAAIkB,EAAgB,IAAIC,yBAAwB,EAAG,IAAM,GAAK,GAAI,GAAG,GAEjEC,EAAsB,IAAIC,oBAAmB,KAAO,KAAO,MAE3DC,EAAe,IAAIC,iBACvBD,EAAa3O,aAAc,WAAY,IAAI6O,yBAAwB,CAAE,EAAG,EAAG,EAAG,EAAG,EAAG,GAAK,IAEzF,IAAIC,EAAiB,SAAWC,EAAQC,GAKvC,IAHA,IAAI1F,EAAW,IAAIsF,iBACfK,EAAW,GAELxJ,EAAI,EAAGA,GAAK,GAAKuJ,IAAQvJ,EAElCwJ,EAASC,KAAM,EAAGxR,KAAKyR,IAAK1J,EAAI,GAAK/H,KAAK0R,IAAOL,EAAQrR,KAAK2R,IAAK5J,EAAI,GAAK/H,KAAK0R,IAAOL,GAMzF,OAFAzF,EAAStJ,aAAc,WAAY,IAAI6O,yBAAwBI,EAAU,IAElE3F,GAkBJgG,EAAiB,CACpBvJ,EAAG,CACF,CAAE,IAAIwJ,OAAMhB,EAAehB,GAAU,CAAE,EAAG,EAAG,GAAK,CAAE,EAAG,GAAK7P,KAAK0R,GAAK,GAAK,KAAM,OACjF,CAAE,IAAIG,OAAMhB,EAAehB,GAAU,CAAE,EAAG,EAAG,GAAK,CAAE,EAAG,EAAG7P,KAAK0R,GAAK,GAAK,KAAM,OAC/E,CAAE,IAAII,OAAMb,EAAcZ,KAE3B/H,EAAG,CACF,CAAE,IAAIuJ,OAAMhB,EAAed,GAAY,CAAE,EAAG,EAAG,GAAK,KAAM,KAAM,OAChE,CAAE,IAAI8B,OAAMhB,EAAed,GAAY,CAAE,EAAG,EAAG,GAAK,CAAE/P,KAAK0R,GAAI,EAAG,GAAK,KAAM,OAC7E,CAAE,IAAII,OAAMb,EAAcX,GAAgB,KAAM,CAAE,EAAG,EAAGtQ,KAAK0R,GAAK,KAEnEnJ,EAAG,CACF,CAAE,IAAIsJ,OAAMhB,EAAeb,GAAW,CAAE,EAAG,EAAG,GAAK,CAAEhQ,KAAK0R,GAAK,EAAG,EAAG,GAAK,KAAM,OAChF,CAAE,IAAIG,OAAMhB,EAAeb,GAAW,CAAE,EAAG,EAAG,GAAK,EAAIhQ,KAAK0R,GAAK,EAAG,EAAG,GAAK,KAAM,OAClF,CAAE,IAAII,OAAMb,EAAcV,GAAe,KAAM,CAAE,GAAKvQ,KAAK0R,GAAK,EAAG,KAEpEK,IAAK,CACJ,CAAE,IAAIF,OAAM,IAAIG,2BAA0B,GAAK,GAAK/B,EAAoBP,SAAW,CAAE,EAAG,EAAG,GAAK,CAAE,EAAG,EAAG,KAEzGuC,GAAI,CACH,CAAE,IAAIJ,OAAM,IAAIK,sBAAqB,KAAO,MAAShC,EAAqBR,SAAW,CAAE,IAAM,IAAM,IACnG,CAAE,IAAIoC,OAAMb,EAAcP,GAAiB,CAAE,IAAM,GAAK,GAAK,KAAM,CAAE,KAAO,EAAG,IAC/E,CAAE,IAAIoB,OAAMb,EAAcP,GAAiB,CAAE,GAAK,IAAM,GAAK,CAAE,EAAG,EAAG1Q,KAAK0R,GAAK,GAAK,CAAE,KAAO,EAAG,KAEjGS,GAAI,CACH,CAAE,IAAIN,OAAM,IAAIK,sBAAqB,KAAO,MAAS/B,EAAmBT,SAAW,CAAE,EAAG,IAAM,KAAQ,CAAE,EAAG1P,KAAK0R,GAAK,EAAG,IACxH,CAAE,IAAII,OAAMb,EAAcT,GAAe,CAAE,EAAG,IAAM,IAAO,CAAE,EAAG,EAAGxQ,KAAK0R,GAAK,GAAK,CAAE,KAAO,EAAG,IAC9F,CAAE,IAAII,OAAMb,EAAcT,GAAe,CAAE,EAAG,GAAK,KAAQ,CAAE,GAAKxQ,KAAK0R,GAAK,EAAG,GAAK,CAAE,KAAO,EAAG,KAEjGU,GAAI,CACH,CAAE,IAAIP,OAAM,IAAIK,sBAAqB,KAAO,MAAS9B,EAAsBV,SAAW,CAAE,IAAM,EAAG,KAAQ,EAAI1P,KAAK0R,GAAK,EAAG,EAAG,IAC7H,CAAE,IAAII,OAAMb,EAAcR,GAAkB,CAAE,IAAM,EAAG,IAAO,KAAM,CAAE,KAAO,EAAG,IAChF,CAAE,IAAIqB,OAAMb,EAAcR,GAAkB,CAAE,GAAK,EAAG,KAAQ,CAAE,GAAKzQ,KAAK0R,GAAK,EAAG,GAAK,CAAE,KAAO,EAAG,MAIjGW,EAAkB,CACrBhK,EAAG,CACF,CAAE,IAAIwJ,OAAM,IAAIf,yBAAwB,GAAK,EAAG,EAAG,EAAG,GAAG,GAASrB,GAAgB,CAAE,GAAK,EAAG,GAAK,CAAE,EAAG,GAAKzP,KAAK0R,GAAK,KAEtHpJ,EAAG,CACF,CAAE,IAAIuJ,OAAM,IAAIf,yBAAwB,GAAK,EAAG,EAAG,EAAG,GAAG,GAASrB,GAAgB,CAAE,EAAG,GAAK,KAE7FlH,EAAG,CACF,CAAE,IAAIsJ,OAAM,IAAIf,yBAAwB,GAAK,EAAG,EAAG,EAAG,GAAG,GAASrB,GAAgB,CAAE,EAAG,EAAG,IAAO,CAAEzP,KAAK0R,GAAK,EAAG,EAAG,KAEpHK,IAAK,CACJ,CAAE,IAAIF,OAAM,IAAIG,2BAA0B,GAAK,GAAKvC,KAErDwC,GAAI,CACH,CAAE,IAAIJ,OAAM,IAAIK,sBAAqB,GAAK,IAAOzC,GAAgB,CAAE,GAAK,GAAK,KAE9E0C,GAAI,CACH,CAAE,IAAIN,OAAM,IAAIK,sBAAqB,GAAK,IAAOzC,GAAgB,CAAE,EAAG,GAAK,IAAO,CAAE,EAAGzP,KAAK0R,GAAK,EAAG,KAErGU,GAAI,CACH,CAAE,IAAIP,OAAM,IAAIK,sBAAqB,GAAK,IAAOzC,GAAgB,CAAE,GAAK,EAAG,IAAO,EAAIzP,KAAK0R,GAAK,EAAG,EAAG,MAIpGY,EAAkB,CACrBC,MAAO,CACN,CAAE,IAAIV,OAAM,IAAIG,2BAA0B,IAAM,GAAKpC,GAAa,KAAM,KAAM,KAAM,WAErF4C,IAAK,CACJ,CAAE,IAAIX,OAAM,IAAIG,2BAA0B,IAAM,GAAKpC,GAAa,KAAM,KAAM,KAAM,WAErF6C,MAAO,CACN,CAAE,IAAIX,OAhFsB,WAE7B,IAAIlG,EAAW,IAAIsF,iBAInB,OAFAtF,EAAStJ,aAAc,WAAY,IAAI6O,yBAAwB,CAAE,EAAG,EAAG,EAAG,EAAG,EAAG,GAAK,IAE9EvF,EA0EM8G,GAA2B9C,GAAa,KAAM,KAAM,KAAM,WAEvEvH,EAAG,CACF,CAAE,IAAIyJ,OAAMb,EAAcrB,EAAUF,SAAW,EAAI,IAAK,EAAG,GAAK,KAAM,CAAE,IAAK,EAAG,GAAK,WAEtFpH,EAAG,CACF,CAAE,IAAIwJ,OAAMb,EAAcrB,EAAUF,SAAW,CAAE,GAAK,IAAK,GAAK,CAAE,EAAG,EAAG1P,KAAK0R,GAAK,GAAK,CAAE,IAAK,EAAG,GAAK,WAEvGnJ,EAAG,CACF,CAAE,IAAIuJ,OAAMb,EAAcrB,EAAUF,SAAW,CAAE,EAAG,GAAK,KAAO,CAAE,GAAK1P,KAAK0R,GAAK,EAAG,GAAK,CAAE,IAAK,EAAG,GAAK,YAItGiB,EAAc,CACjBtK,EAAG,CACF,CAAE,IAAIyJ,OAAMV,EAAgB,EAAG,IAAOf,IACtC,CAAE,IAAIwB,OAAM,IAAIG,2BAA0B,IAAM,GAAKnC,GAAU,CAAE,EAAG,EAAG,KAAQ,KAAM,CAAE,EAAG,EAAG,KAE9FvH,EAAG,CACF,CAAE,IAAIwJ,OAAMV,EAAgB,EAAG,IAAOd,GAAgB,KAAM,CAAE,EAAG,GAAKtQ,KAAK0R,GAAK,IAChF,CAAE,IAAIG,OAAM,IAAIG,2BAA0B,IAAM,GAAKjC,GAAY,CAAE,EAAG,EAAG,KAAQ,KAAM,CAAE,EAAG,EAAG,KAEhGxH,EAAG,CACF,CAAE,IAAIuJ,OAAMV,EAAgB,EAAG,IAAOb,GAAe,KAAM,CAAE,EAAGvQ,KAAK0R,GAAK,EAAG,IAC7E,CAAE,IAAIG,OAAM,IAAIG,2BAA0B,IAAM,GAAKhC,GAAW,CAAE,IAAM,EAAG,GAAK,KAAM,CAAE,EAAG,EAAG,KAE/F4C,EAAG,CACF,CAAE,IAAId,OAAMV,EAAgB,KAAM,GAAKR,GAA4B,KAAM,CAAE,EAAG5Q,KAAK0R,GAAK,EAAG,IAC3F,CAAE,IAAIG,OAAM,IAAIf,yBAAwB,IAAM,EAAG,IAAM,EAAG,GAAG,GAASF,GAA4B,CAAE,KAAM,EAAG,GAAK,CAAE,EAAG,GAAK5Q,KAAK0R,GAAK,GAAK,CAAE,EAAG,EAAG,OACnJ,CAAE,IAAIG,OAAM,IAAIf,yBAAwB,IAAM,EAAG,IAAM,EAAG,GAAG,GAASF,GAA4B,EAAI,KAAM,EAAG,GAAK,CAAE,EAAG,EAAG5Q,KAAK0R,GAAK,GAAK,CAAE,EAAG,EAAG,OACnJ,CAAE,IAAIG,OAAM,IAAIf,yBAAwB,IAAM,EAAG,IAAM,EAAG,GAAG,GAASF,GAA4B,CAAE,GAAK,KAAM,GAAK,CAAE5Q,KAAK0R,GAAI,EAAG,GAAK,CAAE,EAAG,EAAG,OAC/I,CAAE,IAAIG,OAAM,IAAIf,yBAAwB,IAAM,EAAG,IAAM,EAAG,GAAG,GAASF,GAA4B,CAAE,EAAG,KAAM,GAAK,CAAE,EAAG,EAAG,GAAK,CAAE,EAAG,EAAG,QAExIiC,KAAM,CACL,CAAE,IAAIf,OAAMV,EAAgB,EAAG,GAAKT,GAAe,KAAM,CAAE,EAAG3Q,KAAK0R,GAAK,EAAG,MAIzEoB,EAAe,CAClBC,KAAM,CACL,CAAE,IAAIjB,OAAMb,EAAcrB,EAAUF,SAAW,EAAI,IAAK,EAAG,GAAK,KAAM,CAAE,IAAK,EAAG,GAAK,YAInFsD,EAAe,CAClB3K,EAAG,CACF,CAAE,IAAIwJ,OAAM,IAAIoB,sBAAqB,EAAG,GAAK,EAAG,IAAMxD,GAAgB,CAAE,EAAG,EAAG,GAAK,CAAE,GAAKzP,KAAK0R,GAAK,GAAK1R,KAAK0R,GAAK,KAEpHpJ,EAAG,CACF,CAAE,IAAIuJ,OAAM,IAAIoB,sBAAqB,EAAG,GAAK,EAAG,IAAMxD,GAAgB,CAAE,EAAG,EAAG,GAAK,CAAEzP,KAAK0R,GAAK,EAAG,EAAG,KAEtGnJ,EAAG,CACF,CAAE,IAAIsJ,OAAM,IAAIoB,sBAAqB,EAAG,GAAK,EAAG,IAAMxD,GAAgB,CAAE,EAAG,EAAG,GAAK,CAAE,EAAG,GAAKzP,KAAK0R,GAAK,KAExGkB,EAAG,CACF,CAAE,IAAIf,OAAM,IAAIoB,sBAAqB,KAAM,GAAK,EAAG,IAAMxD,KAE1DoD,KAAM,CACL,CAAE,IAAIhB,OAAM,IAAIqB,uBAAsB,GAAK,GAAI,GAAKzD,MAIlD0D,EAAa,CAChB9K,EAAG,CACF,CAAE,IAAIwJ,OAAMd,EAAqBlB,GAAU,CAAE,GAAK,EAAG,GAAK,CAAE,EAAG,GAAK7P,KAAK0R,GAAK,IAC9E,CAAE,IAAII,OAAMb,EAAcZ,GAAc,KAAM,KAAM,CAAE,GAAK,EAAG,KAE/D/H,EAAG,CACF,CAAE,IAAIuJ,OAAMd,EAAqBhB,GAAY,CAAE,EAAG,GAAK,IACvD,CAAE,IAAI+B,OAAMb,EAAcX,GAAgB,KAAM,CAAE,EAAG,EAAGtQ,KAAK0R,GAAK,GAAK,CAAE,GAAK,EAAG,KAElFnJ,EAAG,CACF,CAAE,IAAIsJ,OAAMd,EAAqBf,GAAW,CAAE,EAAG,EAAG,IAAO,CAAEhQ,KAAK0R,GAAK,EAAG,EAAG,IAC7E,CAAE,IAAII,OAAMb,EAAcV,GAAe,KAAM,CAAE,GAAKvQ,KAAK0R,GAAK,EAAG,GAAK,CAAE,GAAK,EAAG,KAEnFO,GAAI,CACH,CAAE,IAAIJ,OAAMd,EAAqBb,GAAwB,CAAE,IAAM,IAAM,GAAK,KAAM,CAAE,EAAG,EAAG,KAC1F,CAAE,IAAI4B,OAAMb,EAAcP,GAAiB,CAAE,KAAO,IAAM,GAAK,KAAM,CAAE,KAAO,EAAG,IACjF,CAAE,IAAIoB,OAAMb,EAAcP,GAAiB,CAAE,IAAM,KAAO,GAAK,CAAE,EAAG,EAAG1Q,KAAK0R,GAAK,GAAK,CAAE,KAAO,EAAG,KAEnGS,GAAI,CACH,CAAE,IAAIN,OAAMd,EAAqBZ,GAAsB,CAAE,EAAG,IAAM,KAAQ,KAAM,CAAE,GAAK,EAAG,IAC1F,CAAE,IAAI2B,OAAMb,EAAcT,GAAe,CAAE,EAAG,KAAO,KAAQ,CAAE,EAAG,EAAGxQ,KAAK0R,GAAK,GAAK,CAAE,KAAO,EAAG,IAChG,CAAE,IAAII,OAAMb,EAAcT,GAAe,CAAE,EAAG,IAAM,MAAS,CAAE,GAAKxQ,KAAK0R,GAAK,EAAG,GAAK,CAAE,KAAO,EAAG,KAEnGU,GAAI,CACH,CAAE,IAAIP,OAAMd,EAAqBX,GAAyB,CAAE,IAAM,EAAG,KAAQ,KAAM,CAAE,EAAG,GAAK,IAC7F,CAAE,IAAI0B,OAAMb,EAAcR,GAAkB,CAAE,KAAO,EAAG,KAAQ,KAAM,CAAE,KAAO,EAAG,IAClF,CAAE,IAAIqB,OAAMb,EAAcR,GAAkB,CAAE,IAAM,EAAG,MAAS,CAAE,GAAKzQ,KAAK0R,GAAK,EAAG,GAAK,CAAE,KAAO,EAAG,KAEtG0B,KAAM,CACL,CAAE,IAAIvB,OAAM,IAAIb,oBAAmB,KAAO,KAAO,MAASf,EAAoBP,SAAW,CAAE,IAAK,EAAG,KAEpG2D,KAAM,CACL,CAAE,IAAIxB,OAAM,IAAIb,oBAAmB,KAAO,KAAO,MAASf,EAAoBP,SAAW,CAAE,EAAG,IAAK,KAEpG4D,KAAM,CACL,CAAE,IAAIzB,OAAM,IAAIb,oBAAmB,KAAO,KAAO,MAASf,EAAoBP,SAAW,CAAE,EAAG,EAAG,QAI/F6D,EAAc,CACjBlL,EAAG,CACF,CAAE,IAAIwJ,OAAM,IAAIf,yBAAwB,GAAK,EAAG,GAAK,EAAG,GAAG,GAASrB,GAAgB,CAAE,GAAK,EAAG,GAAK,CAAE,EAAG,GAAKzP,KAAK0R,GAAK,KAExHpJ,EAAG,CACF,CAAE,IAAIuJ,OAAM,IAAIf,yBAAwB,GAAK,EAAG,GAAK,EAAG,GAAG,GAASrB,GAAgB,CAAE,EAAG,GAAK,KAE/FlH,EAAG,CACF,CAAE,IAAIsJ,OAAM,IAAIf,yBAAwB,GAAK,EAAG,GAAK,EAAG,GAAG,GAASrB,GAAgB,CAAE,EAAG,EAAG,IAAO,CAAEzP,KAAK0R,GAAK,EAAG,EAAG,KAEtHO,GAAI,CACH,CAAE,IAAIJ,OAAMd,EAAqBtB,GAAgB,CAAE,IAAM,IAAM,GAAK,KAAM,CAAE,EAAG,EAAG,MAEnF0C,GAAI,CACH,CAAE,IAAIN,OAAMd,EAAqBtB,GAAgB,CAAE,EAAG,IAAM,KAAQ,KAAM,CAAE,GAAK,EAAG,KAErF2C,GAAI,CACH,CAAE,IAAIP,OAAMd,EAAqBtB,GAAgB,CAAE,IAAM,EAAG,KAAQ,KAAM,CAAE,EAAG,GAAK,KAErF2D,KAAM,CACL,CAAE,IAAIvB,OAAM,IAAIb,oBAAmB,GAAK,GAAK,IAAOvB,GAAgB,CAAE,IAAK,EAAG,KAE/E4D,KAAM,CACL,CAAE,IAAIxB,OAAM,IAAIb,oBAAmB,GAAK,GAAK,IAAOvB,GAAgB,CAAE,EAAG,IAAK,KAE/E6D,KAAM,CACL,CAAE,IAAIzB,OAAM,IAAIb,oBAAmB,GAAK,GAAK,IAAOvB,GAAgB,CAAE,EAAG,EAAG,QAI1E+D,EAAc,CACjBnL,EAAG,CACF,CAAE,IAAIyJ,OAAMb,EAAcrB,EAAUF,SAAW,EAAI,IAAK,EAAG,GAAK,KAAM,CAAE,IAAK,EAAG,GAAK,WAEtFpH,EAAG,CACF,CAAE,IAAIwJ,OAAMb,EAAcrB,EAAUF,SAAW,CAAE,GAAK,IAAK,GAAK,CAAE,EAAG,EAAG1P,KAAK0R,GAAK,GAAK,CAAE,IAAK,EAAG,GAAK,WAEvGnJ,EAAG,CACF,CAAE,IAAIuJ,OAAMb,EAAcrB,EAAUF,SAAW,CAAE,EAAG,GAAK,KAAO,CAAE,GAAK1P,KAAK0R,GAAK,EAAG,GAAK,CAAE,IAAK,EAAG,GAAK,YAMtG+B,EAAa,SAAWC,GAE3B,IAAIC,EAAQ,IAAIjN,WAEhB,IAAM,IAAImG,KAAQ6G,EAEjB,IAAM,IAAI3L,EAAI2L,EAAU7G,GAAO7E,OAAQD,KAAQ,CAE9C,IAAIrJ,EAASgV,EAAU7G,GAAQ9E,GAAK,GAAI2H,QACpCvC,EAAWuG,EAAU7G,GAAQ9E,GAAK,GAClClJ,EAAW6U,EAAU7G,GAAQ9E,GAAK,GAClCqF,EAAQsG,EAAU7G,GAAQ9E,GAAK,GAC/B6L,EAAMF,EAAU7G,GAAQ9E,GAAK,GAGjCrJ,EAAOmO,KAAOA,EACdnO,EAAOkV,IAAMA,EAERzG,GAEJzO,EAAOyO,SAAS5M,IAAK4M,EAAU,GAAKA,EAAU,GAAKA,EAAU,IAIzDtO,GAEJH,EAAOG,SAAS0B,IAAK1B,EAAU,GAAKA,EAAU,GAAKA,EAAU,IAIzDuO,GAEJ1O,EAAO0O,MAAM7M,IAAK6M,EAAO,GAAKA,EAAO,GAAKA,EAAO,IAIlD1O,EAAOmV,eAEP,IAAIC,EAAepV,EAAOkN,SAAS8D,QACnCoE,EAAaC,aAAcrV,EAAOsV,QAClCtV,EAAOkN,SAAWkI,EAClBpV,EAAOuV,YAAcC,IAErBxV,EAAOyO,SAAS5M,IAAK,EAAG,EAAG,GAC3B7B,EAAOG,SAAS0B,IAAK,EAAG,EAAG,GAC3B7B,EAAO0O,MAAM7M,IAAK,EAAG,EAAG,GAExBoT,EAAM5M,IAAKrI,GAMb,OAAOiV,GAMJQ,EAAa,IAAIzU,UAAS,EAAG,EAAG,GAChC0U,EAAY,IAAIxU,QAChByU,EAAc,IAAI3U,UAAS,EAAG,EAAG,GACjC4U,EAAa,IAAI5U,UAAS,EAAG,EAAG,GAChC6U,EAAe,IAAIC,UACnBC,EAAiB,IAAI3U,aACrB4U,EAAkB,IAAI5U,aACtB6U,EAAqB,IAAI7U,aAEzB8U,EAAQ,IAAIlV,UAAS,EAAG,EAAG,GAC3BmV,EAAQ,IAAInV,UAAS,EAAG,EAAG,GAC3BoV,EAAQ,IAAIpV,UAAS,EAAG,EAAG,GAI/Bd,KAAK+U,MAAQ,GACb/U,KAAKgO,OAAS,GACdhO,KAAKmW,OAAS,GAEdnW,KAAKmI,IAAKnI,KAAK+U,MAAL,UAA4BF,EAAY7B,IAClDhT,KAAKmI,IAAKnI,KAAK+U,MAAL,OAAyBF,EAAYd,IAC/C/T,KAAKmI,IAAKnI,KAAK+U,MAAL,MAAwBF,EAAYN,IAC9CvU,KAAKmI,IAAKnI,KAAKgO,OAAL,UAA6B6G,EAAYpB,IACnDzT,KAAKmI,IAAKnI,KAAKgO,OAAL,OAA0B6G,EAAYT,IAChDpU,KAAKmI,IAAKnI,KAAKgO,OAAL,MAAyB6G,EAAYF,IAC/C3U,KAAKmI,IAAKnI,KAAKmW,OAAL,UAA6BtB,EAAYnB,IACnD1T,KAAKmI,IAAKnI,KAAKmW,OAAL,OAA0BtB,EAAYX,IAChDlU,KAAKmI,IAAKnI,KAAKmW,OAAL,MAAyBtB,EAAYD,IAI/C5U,KAAKgO,OAAL,UAA2BhG,SAAU,EACrChI,KAAKgO,OAAL,OAAwBhG,SAAU,EAClChI,KAAKgO,OAAL,MAAuBhG,SAAU,EAIjChI,KAAKqN,kBAAoB,WAExB,IAAIc,EAAQnO,KAAKmO,MAEE,UAAdnO,KAAK2I,OAAmBwF,EAAQ,SAErC,IAAI7M,EAAuB,UAAV6M,EAAoBnO,KAAK6K,gBAAkBkL,EAI5D/V,KAAK+U,MAAL,UAA0B/M,QAAwB,cAAdhI,KAAK2I,KACzC3I,KAAK+U,MAAL,OAAuB/M,QAAwB,WAAdhI,KAAK2I,KACtC3I,KAAK+U,MAAL,MAAsB/M,QAAwB,UAAdhI,KAAK2I,KAErC3I,KAAKmW,OAAL,UAA2BnO,QAAwB,cAAdhI,KAAK2I,KAC1C3I,KAAKmW,OAAL,OAAwBnO,QAAwB,WAAdhI,KAAK2I,KACvC3I,KAAKmW,OAAL,MAAuBnO,QAAwB,UAAdhI,KAAK2I,KAGtC,IAAIyN,EAAU,GAGdA,GADAA,GADAA,EAAUA,EAAQC,OAAQrW,KAAKgO,OAAQhO,KAAK2I,MAAO2N,WACjCD,OAAQrW,KAAK+U,MAAO/U,KAAK2I,MAAO2N,WAChCD,OAAQrW,KAAKmW,OAAQnW,KAAK2I,MAAO2N,UAEnD,IAAM,IAAInN,EAAI,EAAGA,EAAIiN,EAAQhN,OAAQD,IAAO,CAE3C,IAQIoN,EARAC,EAASJ,EAASjN,GAwBtB,GApBAqN,EAAOxO,SAAU,EACjBwO,EAAOvW,SAAS0B,IAAK,EAAG,EAAG,GAC3B6U,EAAOjI,SAASd,KAAMzN,KAAK4K,eAM1B2L,EAFIvW,KAAK6H,OAAO4O,sBAELzW,KAAK6H,OAAOuE,IAAMpM,KAAK6H,OAAO6O,QAAW1W,KAAK6H,OAAO8O,KAIvD3W,KAAK4K,cAAcwE,WAAYpP,KAAKkK,gBAAmB9I,KAAKwV,IAAK,IAAMxV,KAAKyV,IAAKzV,KAAK0R,GAAK9S,KAAK6H,OAAOiP,IAAM,KAAQ9W,KAAK6H,OAAO8O,KAAM,GAIjJH,EAAOhI,MAAM7M,IAAK,EAAG,EAAG,GAAIoV,eAAgBR,EAASvW,KAAK+F,KAAO,GAI7C,WAAfyQ,EAAOxB,IAAZ,CAmHA,GAFAwB,EAAOlV,WAAWmM,KAAMnM,GAEL,cAAdtB,KAAK2I,MAAsC,UAAd3I,KAAK2I,KAAmB,CASpC,MAAhB6N,EAAOvI,MAAgC,SAAhBuI,EAAOvI,MAE7B7M,KAAK4V,IAAKvB,EAAYhI,KAAMuI,GAAQtH,gBAAiBpN,GAAa2N,IAAKjP,KAAKgL,MAPzD,MASvBwL,EAAOhI,MAAM7M,IAAK,MAAO,MAAO,OAChC6U,EAAOxO,SAAU,GAME,MAAhBwO,EAAOvI,MAAgC,SAAhBuI,EAAOvI,MAE7B7M,KAAK4V,IAAKvB,EAAYhI,KAAMwI,GAAQvH,gBAAiBpN,GAAa2N,IAAKjP,KAAKgL,MAlBzD,MAoBvBwL,EAAOhI,MAAM7M,IAAK,MAAO,MAAO,OAChC6U,EAAOxO,SAAU,GAME,MAAhBwO,EAAOvI,MAAgC,SAAhBuI,EAAOvI,MAE7B7M,KAAK4V,IAAKvB,EAAYhI,KAAMyI,GAAQxH,gBAAiBpN,GAAa2N,IAAKjP,KAAKgL,MA7BzD,MA+BvBwL,EAAOhI,MAAM7M,IAAK,MAAO,MAAO,OAChC6U,EAAOxO,SAAU,GAME,OAAhBwO,EAAOvI,MAEN7M,KAAK4V,IAAKvB,EAAYhI,KAAMyI,GAAQxH,gBAAiBpN,GAAa2N,IAAKjP,KAAKgL,MAvCxD,KAyCxBwL,EAAOhI,MAAM7M,IAAK,MAAO,MAAO,OAChC6U,EAAOxO,SAAU,GAME,OAAhBwO,EAAOvI,MAEN7M,KAAK4V,IAAKvB,EAAYhI,KAAMuI,GAAQtH,gBAAiBpN,GAAa2N,IAAKjP,KAAKgL,MAlDxD,KAoDxBwL,EAAOhI,MAAM7M,IAAK,MAAO,MAAO,OAChC6U,EAAOxO,SAAU,GAME,OAAhBwO,EAAOvI,MAEN7M,KAAK4V,IAAKvB,EAAYhI,KAAMwI,GAAQvH,gBAAiBpN,GAAa2N,IAAKjP,KAAKgL,MA7DxD,KA+DxBwL,EAAOhI,MAAM7M,IAAK,MAAO,MAAO,OAChC6U,EAAOxO,SAAU,IAQkB,IAAhCwO,EAAOvI,KAAKa,OAAQ,OAEnB2G,EAAYhI,KAAMuI,GAAQtH,gBAAiBpN,GAAa2N,IAAKjP,KAAKgL,KAzE/C,EA2EH,QAAfwL,EAAOxB,IAEXwB,EAAOxO,SAAU,EAIjBwO,EAAOhI,MAAM/H,IAAO,EAIK,QAAf+P,EAAOxB,MAElBwB,EAAOxO,SAAU,KAMkB,IAAhCwO,EAAOvI,KAAKa,OAAQ,OAEnB2G,EAAYhI,KAAMwI,GAAQvH,gBAAiBpN,GAAa2N,IAAKjP,KAAKgL,KA/F/C,EAiGH,QAAfwL,EAAOxB,IAEXwB,EAAOxO,SAAU,EAIjBwO,EAAOhI,MAAM7H,IAAO,EAIK,QAAf6P,EAAOxB,MAElBwB,EAAOxO,SAAU,KAMkB,IAAhCwO,EAAOvI,KAAKa,OAAQ,OAEnB2G,EAAYhI,KAAMyI,GAAQxH,gBAAiBpN,GAAa2N,IAAKjP,KAAKgL,KArH/C,EAuHH,QAAfwL,EAAOxB,IAEXwB,EAAOxO,SAAU,EAIjBwO,EAAOhI,MAAM3H,IAAO,EAIK,QAAf2P,EAAOxB,MAElBwB,EAAOxO,SAAU,QAMM,WAAdhI,KAAK2I,OAIhBmN,EAAgBrI,KAAMnM,GACtBmU,EAAYhI,KAAMzN,KAAKgL,KAAM0D,gBAAiBmH,EAAepI,KAAMnM,GAAaoM,YAE3C,IAAhC8I,EAAOvI,KAAKa,OAAQ,MAExB0H,EAAOlV,WAAW2V,sBAAuBtB,EAAauB,OAAQlX,KAAKgL,IAAK0K,EAAYO,IAIhE,MAAhBO,EAAOvI,OAEX4H,EAAe/T,iBAAkBkU,EAAO5U,KAAK+V,OAAS1B,EAAY9O,EAAG8O,EAAY5O,IACjFgP,EAAeuB,oBAAqBtB,EAAiBD,GACrDW,EAAOlV,WAAWmM,KAAMoI,IAIJ,MAAhBW,EAAOvI,OAEX4H,EAAe/T,iBAAkBmU,EAAO7U,KAAK+V,MAAO1B,EAAYhP,EAAGgP,EAAY5O,IAC/EgP,EAAeuB,oBAAqBtB,EAAiBD,GACrDW,EAAOlV,WAAWmM,KAAMoI,IAIJ,MAAhBW,EAAOvI,OAEX4H,EAAe/T,iBAAkBoU,EAAO9U,KAAK+V,MAAO1B,EAAY9O,EAAG8O,EAAYhP,IAC/EoP,EAAeuB,oBAAqBtB,EAAiBD,GACrDW,EAAOlV,WAAWmM,KAAMoI,KAO1BW,EAAOxO,QAAUwO,EAAOxO,WAA8C,IAAjCwO,EAAOvI,KAAKU,QAAS,MAAiB3O,KAAKqX,OAChFb,EAAOxO,QAAUwO,EAAOxO,WAA8C,IAAjCwO,EAAOvI,KAAKU,QAAS,MAAiB3O,KAAKsX,OAChFd,EAAOxO,QAAUwO,EAAOxO,WAA8C,IAAjCwO,EAAOvI,KAAKU,QAAS,MAAiB3O,KAAKuX,OAChFf,EAAOxO,QAAUwO,EAAOxO,WAA8C,IAAjCwO,EAAOvI,KAAKU,QAAS,MAAmB3O,KAAKqX,OAASrX,KAAKsX,OAAStX,KAAKuX,OAI9Gf,EAAOvJ,SAASuK,SAAWhB,EAAOvJ,SAASuK,UAAYhB,EAAOvJ,SAAS8D,QACvEyF,EAAOvJ,SAASwK,OAASjB,EAAOvJ,SAASwK,QAAUjB,EAAOvJ,SAASiE,MAAMJ,QAEzE0F,EAAOvJ,SAASiE,MAAMzD,KAAM+I,EAAOvJ,SAASwK,QAC5CjB,EAAOvJ,SAAS8D,QAAUyF,EAAOvJ,SAASuK,SAEnCxX,KAAKG,QAKAH,KAAKoN,OAEXoJ,EAAOvI,OAASjO,KAAKoN,MAKdpN,KAAKoN,KAAKsK,MAAO,IAAKC,MAAM,SAAWC,GAElD,OAAOpB,EAAOvI,OAAS2J,MALvBpB,EAAOvJ,SAAS8D,QAAU,EAC1ByF,EAAOvJ,SAASiE,MAAM2G,KAAM,IAAIC,QAAO,EAAG,EAAG,GAAK,MAalDtB,EAAOvJ,SAAS8D,SAAW,IAC3ByF,EAAOvJ,SAASiE,MAAM2G,KAAM,IAAIC,QAAO,EAAG,EAAG,GAAK,OAtBnDtB,EAAOvJ,SAAS8D,SAAW,GAC3ByF,EAAOvJ,SAASiE,MAAM2G,KAAM,IAAIC,QAAO,EAAG,EAAG,GAAK,UAxTlDtB,EAAOxO,SAAU,EAEI,SAAhBwO,EAAOvI,MAEXuI,EAAOjI,SAASd,KAAMzN,KAAKyK,oBAC3B+L,EAAOxO,UAAahI,KAAKoN,KAEN,MAAdpN,KAAKoN,OAETyI,EAAejU,aAAc4T,EAAU7T,IAAK,EAAG,EAAG,IAClD6U,EAAOlV,WAAWmM,KAAMnM,GAAaO,SAAUgU,GAE1CzU,KAAK4V,IAAKvB,EAAYhI,KAAMuI,GAAQtH,gBAAiBpN,GAAa2N,IAAKjP,KAAKgL,MAAU,KAE1FwL,EAAOxO,SAAU,IAMA,MAAdhI,KAAKoN,OAETyI,EAAejU,aAAc4T,EAAU7T,IAAK,EAAG,EAAGP,KAAK0R,GAAK,IAC5D0D,EAAOlV,WAAWmM,KAAMnM,GAAaO,SAAUgU,GAE1CzU,KAAK4V,IAAKvB,EAAYhI,KAAMwI,GAAQvH,gBAAiBpN,GAAa2N,IAAKjP,KAAKgL,MAAU,KAE1FwL,EAAOxO,SAAU,IAMA,MAAdhI,KAAKoN,OAETyI,EAAejU,aAAc4T,EAAU7T,IAAK,EAAGP,KAAK0R,GAAK,EAAG,IAC5D0D,EAAOlV,WAAWmM,KAAMnM,GAAaO,SAAUgU,GAE1CzU,KAAK4V,IAAKvB,EAAYhI,KAAMyI,GAAQxH,gBAAiBpN,GAAa2N,IAAKjP,KAAKgL,MAAU,KAE1FwL,EAAOxO,SAAU,IAMA,SAAdhI,KAAKoN,OAETyI,EAAejU,aAAc4T,EAAU7T,IAAK,EAAGP,KAAK0R,GAAK,EAAG,IAC5D2C,EAAYhI,KAAMzN,KAAK8J,cACvB0M,EAAOlV,WAAW2V,sBAAuBtB,EAAauB,OAAQxB,EAAYD,EAAaQ,IACvFO,EAAOlV,WAAWO,SAAUgU,GAC5BW,EAAOxO,QAAUhI,KAAK6N,UAIJ,MAAd7N,KAAKoN,OAEToJ,EAAOxO,SAAU,IAKS,UAAhBwO,EAAOvI,MAElBuI,EAAOjI,SAASd,KAAMzN,KAAKyK,oBAC3B+L,EAAOxO,QAAUhI,KAAK6N,UAEK,QAAhB2I,EAAOvI,MAElBuI,EAAOjI,SAASd,KAAMzN,KAAK4K,eAC3B4L,EAAOxO,QAAUhI,KAAK6N,UAEK,UAAhB2I,EAAOvI,MAElBuI,EAAOjI,SAASd,KAAMzN,KAAKyK,oBAC3B+L,EAAOlV,WAAWmM,KAAMzN,KAAK0K,sBAC7B6K,EAAW5T,IAAK,MAAO,MAAO,OAAQwG,IAAKnI,KAAKyK,oBAAqBkD,IAAK3N,KAAK4K,eAAgBmM,gBAAkB,GACjHxB,EAAW7G,gBAAiB1O,KAAK0K,qBAAqBoG,QAAQpD,WAC9D8I,EAAOhI,MAAMf,KAAM8H,GACnBiB,EAAOxO,QAAUhI,KAAK6N,WAItB2I,EAAOlV,WAAWmM,KAAMnM,GAEnBtB,KAAK6N,SAET2I,EAAOjI,SAASd,KAAMzN,KAAKyK,oBAI3B+L,EAAOjI,SAASd,KAAMzN,KAAK4K,eAIvB5K,KAAKoN,OAEToJ,EAAOxO,SAAgD,IAAtChI,KAAKoN,KAAK0B,OAAQ0H,EAAOvI,QAmP9CnG,WAAS8F,UAAUP,kBAAkBtF,KAAM/H,QAM7CkI,EAAuB0F,UAAYrC,OAAOuE,OAAQvE,OAAOwE,OAAQjI,WAAS8F,WAAa,CAEtFoC,YAAa9H,EAEb6P,0BAA0B,IAK3B,IAAI1P,EAAyB,WAI5B4K,OAAKlL,KAAM/H,KACV,IAAIsT,sBAAqB,IAAQ,IAAQ,EAAG,GAC5C,IAAInD,oBAAmB,CAAEnI,SAAS,EAAOgQ,WAAW,EAAMzH,KAAMC,aAAYF,aAAa,EAAMS,QAAS,MAGzG/Q,KAAKwI,KAAO,yBAEZ,IAAIwN,EAAQ,IAAIlV,UAAS,EAAG,EAAG,GAC3BmV,EAAQ,IAAInV,UAAS,EAAG,EAAG,GAC3BoV,EAAQ,IAAIpV,UAAS,EAAG,EAAG,GAE3ByU,EAAa,IAAIzU,UACjBmX,EAAY,IAAInX,UAChB2U,EAAc,IAAI3U,UAClBoX,EAAa,IAAItC,UACjBG,EAAqB,IAAI7U,aAE7BlB,KAAKqN,kBAAoB,WAExB,IAAIc,EAAQnO,KAAKmO,MAcjB,OAZAnO,KAAKuO,SAASd,KAAMzN,KAAK4K,eAEN,UAAd5K,KAAK2I,OAAmBwF,EAAQ,SAErC6H,EAAMrU,IAAK,EAAG,EAAG,GAAI+M,gBAA2B,UAAVP,EAAoBnO,KAAK6K,gBAAkBkL,GACjFE,EAAMtU,IAAK,EAAG,EAAG,GAAI+M,gBAA2B,UAAVP,EAAoBnO,KAAK6K,gBAAkBkL,GACjFG,EAAMvU,IAAK,EAAG,EAAG,GAAI+M,gBAA2B,UAAVP,EAAoBnO,KAAK6K,gBAAkBkL,GAIjFN,EAAYhI,KAAMwI,GAETjW,KAAK2I,MAEb,IAAK,YACL,IAAK,QACJ,OAAS3I,KAAKoN,MAEb,IAAK,IACJqI,EAAYhI,KAAMzN,KAAKgL,KAAMsE,MAAO0G,GACpCiC,EAAUxK,KAAMuI,GAAQ1G,MAAOmG,GAC/B,MACD,IAAK,IACJA,EAAYhI,KAAMzN,KAAKgL,KAAMsE,MAAO2G,GACpCgC,EAAUxK,KAAMwI,GAAQ3G,MAAOmG,GAC/B,MACD,IAAK,IACJA,EAAYhI,KAAMzN,KAAKgL,KAAMsE,MAAO4G,GACpC+B,EAAUxK,KAAMyI,GAAQ5G,MAAOmG,GAC/B,MACD,IAAK,KACJwC,EAAUxK,KAAMyI,GAChB,MACD,IAAK,KACJ+B,EAAUxK,KAAMuI,GAChB,MACD,IAAK,KACJP,EAAYhI,KAAMyI,GAClB+B,EAAUxK,KAAMwI,GAChB,MACD,IAAK,MACL,IAAK,IACJgC,EAAUtW,IAAK,EAAG,EAAG,GAKvB,MACD,IAAK,SACL,QAECsW,EAAUtW,IAAK,EAAG,EAAG,GAIK,IAAvBsW,EAAU7O,SAGdpJ,KAAKsB,WAAWmM,KAAMzN,KAAKmK,mBAI3B+N,EAAWhB,OAAQ3B,EAAW5T,IAAK,EAAG,EAAG,GAAKsW,EAAWxC,GAEzDzV,KAAKsB,WAAW2V,sBAAuBiB,IAIxCpQ,WAAS8F,UAAUP,kBAAkBtF,KAAM/H,QAM7CqI,EAAuBuF,UAAYrC,OAAOuE,OAAQvE,OAAOwE,OAAQkD,OAAKrF,WAAa,CAElFoC,YAAa3H,EAEb8P,0BAA0B,K,qBCzpD3B,YAUA,IAUIC,EAA8B,iBAAVC,GAAsBA,GAAUA,EAAO9M,SAAWA,QAAU8M,EAGhFC,EAA0B,iBAARC,MAAoBA,MAAQA,KAAKhN,SAAWA,QAAUgN,KAGxEC,EAAOJ,GAAcE,GAAYG,SAAS,cAATA,GAYrC,SAASrV,EAAMsV,EAAMC,EAASC,GAC5B,OAAQA,EAAKxP,QACX,KAAK,EAAG,OAAOsP,EAAK3Q,KAAK4Q,GACzB,KAAK,EAAG,OAAOD,EAAK3Q,KAAK4Q,EAASC,EAAK,IACvC,KAAK,EAAG,OAAOF,EAAK3Q,KAAK4Q,EAASC,EAAK,GAAIA,EAAK,IAChD,KAAK,EAAG,OAAOF,EAAK3Q,KAAK4Q,EAASC,EAAK,GAAIA,EAAK,GAAIA,EAAK,IAE3D,OAAOF,EAAKtV,MAAMuV,EAASC,GA+B7B,SAASC,EAAUC,EAAOC,GAKxB,IAJA,IAAIC,GAAS,EACT5P,EAAS2P,EAAO3P,OAChBlD,EAAS4S,EAAM1P,SAEV4P,EAAQ5P,GACf0P,EAAM5S,EAAS8S,GAASD,EAAOC,GAEjC,OAAOF,EAIT,IAAIG,EAAc1N,OAAOqC,UAGrBsL,EAAiBD,EAAYC,eAO7BC,EAAiBF,EAAYG,SAG7BC,EAASb,EAAKa,OACdC,EAAuBL,EAAYK,qBACnCC,EAAmBF,EAASA,EAAOG,wBAAqBxX,EAGxDyX,EAAYrY,KAAKsY,IAiHrB,SAASC,EAAclO,GACrB,OAAOmO,EAAQnO,IAqCjB,SAAqBA,GAEnB,OAmFF,SAA2BA,GACzB,OAAOoO,EAAapO,IA9BtB,SAAqBA,GACnB,OAAgB,MAATA,GAkFT,SAAkBA,GAChB,MAAuB,iBAATA,GACZA,GAAS,GAAKA,EAAQ,GAAK,GAAKA,GAnYb,iBA+SGqO,CAASrO,EAAMrC,UAiDzC,SAAoBqC,GAGlB,IAAIuJ,EA4DN,SAAkBvJ,GAChB,IAAIjD,SAAciD,EAClB,QAASA,IAAkB,UAARjD,GAA4B,YAARA,GA9D7BuR,CAAStO,GAAS0N,EAAepR,KAAK0D,GAAS,GACzD,MAhWY,qBAgWLuJ,GA/VI,8BA+VcA,EArD0BgF,CAAWvO,GA6BhCwO,CAAYxO,GApFnCyO,CAAkBzO,IAAUyN,EAAenR,KAAK0D,EAAO,aAC1D6N,EAAqBvR,KAAK0D,EAAO,WAtPzB,sBAsPsC0N,EAAepR,KAAK0D,IAxC7C0O,CAAY1O,OAChC8N,GAAoB9N,GAASA,EAAM8N,IAU1C,SAASa,EAAM3O,GACb,GAAoB,iBAATA,GAoPb,SAAkBA,GAChB,MAAuB,iBAATA,GACXoO,EAAapO,IA7cF,mBA6cY0N,EAAepR,KAAK0D,GAtPd4O,CAAS5O,GACvC,OAAOA,EAET,IAAI6O,EAAU7O,EAAQ,GACtB,MAAkB,KAAV6O,GAAkB,EAAI7O,IAlOjB,IAkOwC,KAAO6O,EAkD9D,IAAIV,EAAUW,MAAMX,QAyKpB,SAASC,EAAapO,GACpB,QAASA,GAAyB,iBAATA,EA0C3B,IAnTkBiN,EAAM8B,EAmTpBC,GAnTc/B,EAmTE,SAAS5Y,EAAQ4a,GACnC,OAAiB,MAAV5a,EAAiB,GA5V1B,SAAkBA,EAAQ4a,GAExB,OAcF,SAAoB5a,EAAQ4a,EAAOC,GAKjC,IAJA,IAAI3B,GAAS,EACT5P,EAASsR,EAAMtR,OACfkR,EAAS,KAEJtB,EAAQ5P,GAAQ,CACvB,IAAIwR,EAAMF,EAAM1B,GACZvN,EAAQ3L,EAAO8a,GAEfD,EAAUlP,EAAOmP,KACnBN,EAAOM,GAAOnP,GAGlB,OAAO6O,EA3BAO,CADP/a,EAASyL,OAAOzL,GACU4a,GAAO,SAASjP,EAAOmP,GAC/C,OAAOA,KAAO9a,KAyVagb,CAAShb,EA1bxC,SAAkBgZ,EAAOiC,GAKvB,IAJA,IAAI/B,GAAS,EACT5P,EAAS0P,EAAQA,EAAM1P,OAAS,EAChCkR,EAASC,MAAMnR,KAEV4P,EAAQ5P,GACfkR,EAAOtB,GAAS+B,EAASjC,EAAME,GAAQA,EAAOF,GAEhD,OAAOwB,EAkbuCU,CA5XhD,SAASC,EAAYnC,EAAOoC,EAAOP,EAAWQ,EAAUb,GACtD,IAAItB,GAAS,EACT5P,EAAS0P,EAAM1P,OAKnB,IAHAuR,IAAcA,EAAYhB,GAC1BW,IAAWA,EAAS,MAEXtB,EAAQ5P,GAAQ,CACvB,IAAIqC,EAAQqN,EAAME,GACdkC,EAAQ,GAAKP,EAAUlP,GACrByP,EAAQ,EAEVD,EAAYxP,EAAOyP,EAAQ,EAAGP,EAAWQ,EAAUb,GAEnDzB,EAAUyB,EAAQ7O,GAEV0P,IACVb,EAAOA,EAAOlR,QAAUqC,GAG5B,OAAO6O,EAwWgDW,CAAYP,EAAO,GAAIN,KAnT9EI,EAAQf,OAAoBzX,IAAVwY,EAAuB9B,EAAKtP,OAAS,EAAKoR,EAAO,GAC5D,WAML,IALA,IAAI5B,EAAOvV,UACP2V,GAAS,EACT5P,EAASqQ,EAAUb,EAAKxP,OAASoR,EAAO,GACxC1B,EAAQyB,MAAMnR,KAET4P,EAAQ5P,GACf0P,EAAME,GAASJ,EAAK4B,EAAQxB,GAE9BA,GAAS,EAET,IADA,IAAIoC,EAAYb,MAAMC,EAAQ,KACrBxB,EAAQwB,GACfY,EAAUpC,GAASJ,EAAKI,GAG1B,OADAoC,EAAUZ,GAAS1B,EACZ1V,EAAMsV,EAAM1Y,KAAMob,KAsS7BC,EAAOC,QAAUb,I,uCCtfjB,YAUA,IAsBIc,EAAe,8BAGfC,EAAW,mBAGXpD,EAA8B,iBAAVC,GAAsBA,GAAUA,EAAO9M,SAAWA,QAAU8M,EAGhFC,EAA0B,iBAARC,MAAoBA,MAAQA,KAAKhN,SAAWA,QAAUgN,KAGxEC,EAAOJ,GAAcE,GAAYG,SAAS,cAATA,GAYrC,SAASrV,EAAMsV,EAAMC,EAASC,GAC5B,OAAQA,EAAKxP,QACX,KAAK,EAAG,OAAOsP,EAAK3Q,KAAK4Q,GACzB,KAAK,EAAG,OAAOD,EAAK3Q,KAAK4Q,EAASC,EAAK,IACvC,KAAK,EAAG,OAAOF,EAAK3Q,KAAK4Q,EAASC,EAAK,GAAIA,EAAK,IAChD,KAAK,EAAG,OAAOF,EAAK3Q,KAAK4Q,EAASC,EAAK,GAAIA,EAAK,GAAIA,EAAK,IAE3D,OAAOF,EAAKtV,MAAMuV,EAASC,GAY7B,SAAS6C,EAAc3C,EAAOrN,GAE5B,SADaqN,EAAQA,EAAM1P,OAAS,IAgGtC,SAAqB0P,EAAOrN,EAAOiQ,GACjC,GAAIjQ,IAAUA,EACZ,OAvBJ,SAAuBqN,EAAO6B,EAAWe,EAAWC,GAClD,IAAIvS,EAAS0P,EAAM1P,OACf4P,EAAQ0C,GAAaC,EAAY,GAAK,GAE1C,KAAQA,EAAY3C,MAAYA,EAAQ5P,GACtC,GAAIuR,EAAU7B,EAAME,GAAQA,EAAOF,GACjC,OAAOE,EAGX,OAAQ,EAcC4C,CAAc9C,EAAO+C,EAAWH,GAEzC,IAAI1C,EAAQ0C,EAAY,EACpBtS,EAAS0P,EAAM1P,OAEnB,OAAS4P,EAAQ5P,GACf,GAAI0P,EAAME,KAAWvN,EACnB,OAAOuN,EAGX,OAAQ,EA3GW8C,CAAYhD,EAAOrN,EAAO,IAAM,EAYrD,SAASsQ,EAAkBjD,EAAOrN,EAAOuQ,GAIvC,IAHA,IAAIhD,GAAS,EACT5P,EAAS0P,EAAQA,EAAM1P,OAAS,IAE3B4P,EAAQ5P,GACf,GAAI4S,EAAWvQ,EAAOqN,EAAME,IAC1B,OAAO,EAGX,OAAO,EAYT,SAASgC,EAASlC,EAAOiC,GAKvB,IAJA,IAAI/B,GAAS,EACT5P,EAAS0P,EAAQA,EAAM1P,OAAS,EAChCkR,EAASC,MAAMnR,KAEV4P,EAAQ5P,GACfkR,EAAOtB,GAAS+B,EAASjC,EAAME,GAAQA,EAAOF,GAEhD,OAAOwB,EAWT,SAASzB,EAAUC,EAAOC,GAKxB,IAJA,IAAIC,GAAS,EACT5P,EAAS2P,EAAO3P,OAChBlD,EAAS4S,EAAM1P,SAEV4P,EAAQ5P,GACf0P,EAAM5S,EAAS8S,GAASD,EAAOC,GAEjC,OAAOF,EAyDT,SAAS+C,EAAUpQ,GACjB,OAAOA,IAAUA,EA2CnB,SAASwQ,EAASC,EAAOtB,GACvB,OAAOsB,EAAMC,IAAIvB,GA0CnB,SAASwB,EAAQ1D,EAAM2D,GACrB,OAAO,SAASC,GACd,OAAO5D,EAAK2D,EAAUC,KAK1B,IAAIC,EAAahC,MAAM3M,UACnB4O,EAAY/D,SAAS7K,UACrBqL,EAAc1N,OAAOqC,UAGrB6O,EAAajE,EAAK,sBAGlBkE,EAAc,WAChB,IAAIC,EAAM,SAASC,KAAKH,GAAcA,EAAWI,MAAQJ,EAAWI,KAAKC,UAAY,IACrF,OAAOH,EAAO,iBAAmBA,EAAO,GAFxB,GAMdI,EAAeP,EAAUpD,SAGzBF,EAAiBD,EAAYC,eAO7BC,EAAiBF,EAAYG,SAG7B4D,EAAaC,OAAO,IACtBF,EAAahV,KAAKmR,GAAgBgE,QA/RjB,sBA+RuC,QACvDA,QAAQ,yDAA0D,SAAW,KAI5E7D,EAASb,EAAKa,OACd8D,EAAef,EAAQ7Q,OAAO6R,eAAgB7R,QAC9C+N,EAAuBL,EAAYK,qBACnC+D,EAASd,EAAWc,OACpB9D,EAAmBF,EAASA,EAAOG,wBAAqBxX,EAGxDsb,EAAmB/R,OAAOgS,sBAC1B9D,EAAYrY,KAAKsY,IAGjB8D,EAAMC,EAAUjF,EAAM,OACtBkF,EAAeD,EAAUlS,OAAQ,UASrC,SAASoS,EAAKC,GACZ,IAAI5E,GAAS,EACT5P,EAASwU,EAAUA,EAAQxU,OAAS,EAGxC,IADApJ,KAAK6d,UACI7E,EAAQ5P,GAAQ,CACvB,IAAI0U,EAAQF,EAAQ5E,GACpBhZ,KAAK2B,IAAImc,EAAM,GAAIA,EAAM,KA2F7B,SAASC,EAAUH,GACjB,IAAI5E,GAAS,EACT5P,EAASwU,EAAUA,EAAQxU,OAAS,EAGxC,IADApJ,KAAK6d,UACI7E,EAAQ5P,GAAQ,CACvB,IAAI0U,EAAQF,EAAQ5E,GACpBhZ,KAAK2B,IAAImc,EAAM,GAAIA,EAAM,KAyG7B,SAASE,EAASJ,GAChB,IAAI5E,GAAS,EACT5P,EAASwU,EAAUA,EAAQxU,OAAS,EAGxC,IADApJ,KAAK6d,UACI7E,EAAQ5P,GAAQ,CACvB,IAAI0U,EAAQF,EAAQ5E,GACpBhZ,KAAK2B,IAAImc,EAAM,GAAIA,EAAM,KAwF7B,SAASG,EAASlF,GAChB,IAAIC,GAAS,EACT5P,EAAS2P,EAASA,EAAO3P,OAAS,EAGtC,IADApJ,KAAKke,SAAW,IAAIF,IACXhF,EAAQ5P,GACfpJ,KAAKmI,IAAI4Q,EAAOC,IA4CpB,SAASmF,EAAc1S,EAAO2S,GAG5B,IAAI9D,EAAUV,EAAQnO,IAAU0O,EAAY1O,GA7e9C,SAAmB4S,EAAGtD,GAIpB,IAHA,IAAI/B,GAAS,EACTsB,EAASC,MAAM8D,KAEVrF,EAAQqF,GACf/D,EAAOtB,GAAS+B,EAAS/B,GAE3B,OAAOsB,EAueHgE,CAAU7S,EAAMrC,OAAQmV,QACxB,GAEAnV,EAASkR,EAAOlR,OAChBoV,IAAgBpV,EAEpB,IAAK,IAAIwR,KAAOnP,GACT2S,IAAalF,EAAenR,KAAK0D,EAAOmP,IACvC4D,IAAuB,UAAP5D,GAAmB6D,EAAQ7D,EAAKxR,KACpDkR,EAAO1H,KAAKgI,GAGhB,OAAON,EAWT,SAASoE,EAAa5F,EAAO8B,GAE3B,IADA,IAwbUnP,EAAOkT,EAxbbvV,EAAS0P,EAAM1P,OACZA,KACL,IAsbQqC,EAtbDqN,EAAM1P,GAAQ,OAsbNuV,EAtbU/D,IAubAnP,IAAUA,GAASkT,IAAUA,EAtbpD,OAAOvV,EAGX,OAAQ,EAqHV,SAASwV,EAAanT,GACpB,SAAKsO,EAAStO,KAqNEiN,EArNiBjN,EAsNxBiR,GAAeA,KAAchE,MAnNvBsB,EAAWvO,IA/kB5B,SAAsBA,GAGpB,IAAI6O,GAAS,EACb,GAAa,MAAT7O,GAA0C,mBAAlBA,EAAM2N,SAChC,IACEkB,KAAY7O,EAAQ,IACpB,MAAOoT,IAEX,OAAOvE,EAskB6BwE,CAAarT,GAAUuR,EAAazB,GACzDwD,KA4QjB,SAAkBrG,GAChB,GAAY,MAARA,EAAc,CAChB,IACE,OAAOqE,EAAahV,KAAK2Q,GACzB,MAAOmG,IACT,IACE,OAAQnG,EAAO,GACf,MAAOmG,KAEX,MAAO,GArRaG,CAASvT,IAiN/B,IAAkBiN,EAvMlB,SAASuG,EAAWnf,GAClB,IAAKia,EAASja,GACZ,OAgOJ,SAAsBA,GACpB,IAAIwa,EAAS,GACb,GAAc,MAAVxa,EACF,IAAK,IAAI8a,KAAOrP,OAAOzL,GACrBwa,EAAO1H,KAAKgI,GAGhB,OAAON,EAvOE4E,CAAapf,GAEtB,IAAIqf,EA8MN,SAAqB1T,GACnB,IAAI2T,EAAO3T,GAASA,EAAMuE,YACtBqP,EAAwB,mBAARD,GAAsBA,EAAKxR,WAAcqL,EAE7D,OAAOxN,IAAU4T,EAlNHC,CAAYxf,GACtBwa,EAAS,GAEb,IAAK,IAAIM,KAAO9a,GACD,eAAP8a,IAAyBuE,GAAYjG,EAAenR,KAAKjI,EAAQ8a,KACrEN,EAAO1H,KAAKgI,GAGhB,OAAON,EAiFT,SAASiF,EAAazf,GACpB,OA1HF,SAAwBA,EAAQ0f,EAAUC,GACxC,IAAInF,EAASkF,EAAS1f,GACtB,OAAO8Z,EAAQ9Z,GAAUwa,EAASzB,EAAUyB,EAAQmF,EAAY3f,IAwHzD4f,CAAe5f,EAAQ6f,GAAQC,GAWxC,SAASC,EAAWC,EAAKlF,GACvB,IAAImF,EAAOD,EAAI5B,SACf,OA8EF,SAAmBzS,GACjB,IAAIjD,SAAciD,EAClB,MAAgB,UAARjD,GAA4B,UAARA,GAA4B,UAARA,GAA4B,WAARA,EACrD,cAAViD,EACU,OAAVA,EAlFEuU,CAAUpF,GACbmF,EAAmB,iBAAPnF,EAAkB,SAAW,QACzCmF,EAAKD,IAWX,SAASrC,EAAU3d,EAAQ8a,GACzB,IAAInP,EA9tBN,SAAkB3L,EAAQ8a,GACxB,OAAiB,MAAV9a,OAAiBkC,EAAYlC,EAAO8a,GA6tB/BqF,CAASngB,EAAQ8a,GAC7B,OAAOgE,EAAanT,GAASA,OAAQzJ,EA9iBvC2b,EAAK/P,UAAUiQ,MAnEf,WACE7d,KAAKke,SAAWR,EAAeA,EAAa,MAAQ,IAmEtDC,EAAK/P,UAAL,OAtDA,SAAoBgN,GAClB,OAAO5a,KAAKmc,IAAIvB,WAAe5a,KAAKke,SAAStD,IAsD/C+C,EAAK/P,UAAUpC,IA1Cf,SAAiBoP,GACf,IAAImF,EAAO/f,KAAKke,SAChB,GAAIR,EAAc,CAChB,IAAIpD,EAASyF,EAAKnF,GAClB,MA1XiB,8BA0XVN,OAA4BtY,EAAYsY,EAEjD,OAAOpB,EAAenR,KAAKgY,EAAMnF,GAAOmF,EAAKnF,QAAO5Y,GAqCtD2b,EAAK/P,UAAUuO,IAzBf,SAAiBvB,GACf,IAAImF,EAAO/f,KAAKke,SAChB,OAAOR,OAA6B1b,IAAd+d,EAAKnF,GAAqB1B,EAAenR,KAAKgY,EAAMnF,IAwB5E+C,EAAK/P,UAAUjM,IAXf,SAAiBiZ,EAAKnP,GAGpB,OAFWzL,KAAKke,SACXtD,GAAQ8C,QAA0B1b,IAAVyJ,EAzZV,4BAyZkDA,EAC9DzL,MAoHT+d,EAAUnQ,UAAUiQ,MAjFpB,WACE7d,KAAKke,SAAW,IAiFlBH,EAAUnQ,UAAV,OArEA,SAAyBgN,GACvB,IAAImF,EAAO/f,KAAKke,SACZlF,EAAQ0F,EAAaqB,EAAMnF,GAE/B,QAAI5B,EAAQ,KAIRA,GADY+G,EAAK3W,OAAS,EAE5B2W,EAAKG,MAEL7C,EAAOtV,KAAKgY,EAAM/G,EAAO,IAEpB,IAyDT+E,EAAUnQ,UAAUpC,IA7CpB,SAAsBoP,GACpB,IAAImF,EAAO/f,KAAKke,SACZlF,EAAQ0F,EAAaqB,EAAMnF,GAE/B,OAAO5B,EAAQ,OAAIhX,EAAY+d,EAAK/G,GAAO,IA0C7C+E,EAAUnQ,UAAUuO,IA9BpB,SAAsBvB,GACpB,OAAO8D,EAAa1e,KAAKke,SAAUtD,IAAQ,GA8B7CmD,EAAUnQ,UAAUjM,IAjBpB,SAAsBiZ,EAAKnP,GACzB,IAAIsU,EAAO/f,KAAKke,SACZlF,EAAQ0F,EAAaqB,EAAMnF,GAO/B,OALI5B,EAAQ,EACV+G,EAAKnN,KAAK,CAACgI,EAAKnP,IAEhBsU,EAAK/G,GAAO,GAAKvN,EAEZzL,MAkGTge,EAASpQ,UAAUiQ,MA/DnB,WACE7d,KAAKke,SAAW,CACd,KAAQ,IAAIP,EACZ,IAAO,IAAKH,GAAOO,GACnB,OAAU,IAAIJ,IA4DlBK,EAASpQ,UAAT,OA/CA,SAAwBgN,GACtB,OAAOiF,EAAW7f,KAAM4a,GAAjB,OAAgCA,IA+CzCoD,EAASpQ,UAAUpC,IAnCnB,SAAqBoP,GACnB,OAAOiF,EAAW7f,KAAM4a,GAAKpP,IAAIoP,IAmCnCoD,EAASpQ,UAAUuO,IAvBnB,SAAqBvB,GACnB,OAAOiF,EAAW7f,KAAM4a,GAAKuB,IAAIvB,IAuBnCoD,EAASpQ,UAAUjM,IAVnB,SAAqBiZ,EAAKnP,GAExB,OADAoU,EAAW7f,KAAM4a,GAAKjZ,IAAIiZ,EAAKnP,GACxBzL,MAyDTie,EAASrQ,UAAUzF,IAAM8V,EAASrQ,UAAUgF,KAnB5C,SAAqBnH,GAEnB,OADAzL,KAAKke,SAASvc,IAAI8J,EA/oBC,6BAgpBZzL,MAkBTie,EAASrQ,UAAUuO,IANnB,SAAqB1Q,GACnB,OAAOzL,KAAKke,SAAS/B,IAAI1Q,IAyT3B,IAAI0U,EAAa7C,EAAmBlB,EAAQkB,EAAkB/R,QAAU6U,GAUpER,EAAgBtC,EAA+B,SAASxd,GAE1D,IADA,IAAIwa,EAAS,GACNxa,GACL+Y,EAAUyB,EAAQ6F,EAAWrgB,IAC7BA,EAASqd,EAAard,GAExB,OAAOwa,GAN8B8F,GAgBvC,SAASzG,EAAclO,GACrB,OAAOmO,EAAQnO,IAAU0O,EAAY1O,OAChC8N,GAAoB9N,GAASA,EAAM8N,IAW1C,SAASkF,EAAQhT,EAAOrC,GAEtB,SADAA,EAAmB,MAAVA,EA1/BY,iBA0/BwBA,KAE1B,iBAATqC,GAAqB+P,EAASuD,KAAKtT,KAC1CA,GAAS,GAAKA,EAAQ,GAAK,GAAKA,EAAQrC,EAoE7C,SAASgR,EAAM3O,GACb,GAAoB,iBAATA,GA2Sb,SAAkBA,GAChB,MAAuB,iBAATA,GACXoO,GAAapO,IAz2CF,mBAy2CY0N,EAAepR,KAAK0D,GA7Sd4O,CAAS5O,GACvC,OAAOA,EAET,IAAI6O,EAAU7O,EAAQ,GACtB,MAAkB,KAAV6O,GAAkB,EAAI7O,IAvkCjB,IAukCwC,KAAO6O,EA4E9D,SAASH,EAAY1O,GAEnB,OAmFF,SAA2BA,GACzB,OAAOoO,GAAapO,IAAUwO,EAAYxO,GApFnCyO,CAAkBzO,IAAUyN,EAAenR,KAAK0D,EAAO,aAC1D6N,EAAqBvR,KAAK0D,EAAO,WAlpCzB,sBAkpCsC0N,EAAepR,KAAK0D,IA0BxE,IAAImO,EAAUW,MAAMX,QA2BpB,SAASK,EAAYxO,GACnB,OAAgB,MAATA,GAkFT,SAAkBA,GAChB,MAAuB,iBAATA,GACZA,GAAS,GAAKA,EAAQ,GAAK,GAAKA,GA/xCb,iBA2sCGqO,CAASrO,EAAMrC,UAAY4Q,EAAWvO,GAiDhE,SAASuO,EAAWvO,GAGlB,IAAIuJ,EAAM+E,EAAStO,GAAS0N,EAAepR,KAAK0D,GAAS,GACzD,MA5vCY,qBA4vCLuJ,GA3vCI,8BA2vCcA,EA2D3B,SAAS+E,EAAStO,GAChB,IAAIjD,SAAciD,EAClB,QAASA,IAAkB,UAARjD,GAA4B,YAARA,GA2BzC,SAASqR,GAAapO,GACpB,QAASA,GAAyB,iBAATA,EAgD3B,SAASkU,GAAO7f,GACd,OAAOma,EAAYna,GAAUqe,EAAcre,GAAQ,GAAQmf,EAAWnf,GAsBxE,IAlhBkB4Y,GAAM8B,GAkhBpB6F,IAlhBc3H,GAkhBE,SAAS5Y,EAAQ4a,GACnC,OAAc,MAAV5a,EACK,IAET4a,EAAQM,EAppBV,SAASC,EAAYnC,EAAOoC,EAAOP,EAAWQ,EAAUb,GACtD,IAAItB,GAAS,EACT5P,EAAS0P,EAAM1P,OAKnB,IAHAuR,IAAcA,EAAYhB,GAC1BW,IAAWA,EAAS,MAEXtB,EAAQ5P,GAAQ,CACvB,IAAIqC,EAAQqN,EAAME,GACdkC,EAAQ,GAAKP,EAAUlP,GACrByP,EAAQ,EAEVD,EAAYxP,EAAOyP,EAAQ,EAAGP,EAAWQ,EAAUb,GAEnDzB,EAAUyB,EAAQ7O,GAEV0P,IACVb,EAAOA,EAAOlR,QAAUqC,GAG5B,OAAO6O,EAgoBUW,CAAYP,EAAO,GAAIN,GA9jB1C,SAAkBta,EAAQ4a,GAExB,OAcF,SAAoB5a,EAAQ4a,EAAOC,GAKjC,IAJA,IAAI3B,GAAS,EACT5P,EAASsR,EAAMtR,OACfkR,EAAS,KAEJtB,EAAQ5P,GAAQ,CACvB,IAAIwR,EAAMF,EAAM1B,GACZvN,EAAQ3L,EAAO8a,GAEfD,EAAUlP,EAAOmP,KACnBN,EAAOM,GAAOnP,GAGlB,OAAO6O,EA3BAO,CADP/a,EAASyL,OAAOzL,GACU4a,GAAO,SAASjP,EAAOmP,GAC/C,OAAOA,KAAO9a,KA4jBTgb,CAAShb,EA7sBlB,SAAwBgZ,EAAOC,EAAQgC,EAAUiB,GAC/C,IA1gBiBtD,EA0gBbM,GAAS,EACTsH,EAAW7E,EACX8E,GAAW,EACXnX,EAAS0P,EAAM1P,OACfkR,EAAS,GACTkG,EAAezH,EAAO3P,OAE1B,IAAKA,EACH,OAAOkR,EAELS,IACFhC,EAASiC,EAASjC,GArhBHL,EAqhBqBqC,EAphB/B,SAAStP,GACd,OAAOiN,EAAKjN,OAqhBVuQ,GACFsE,EAAWvE,EACXwE,GAAW,GAEJxH,EAAO3P,QAjvBK,MAkvBnBkX,EAAWrE,EACXsE,GAAW,EACXxH,EAAS,IAAIkF,EAASlF,IAExB0H,EACA,OAASzH,EAAQ5P,GAAQ,CACvB,IAAIqC,EAAQqN,EAAME,GACd0H,EAAW3F,EAAWA,EAAStP,GAASA,EAG5C,GADAA,EAASuQ,GAAwB,IAAVvQ,EAAeA,EAAQ,EAC1C8U,GAAYG,IAAaA,EAAU,CAErC,IADA,IAAIC,EAAcH,EACXG,KACL,GAAI5H,EAAO4H,KAAiBD,EAC1B,SAASD,EAGbnG,EAAO1H,KAAKnH,QAEJ6U,EAASvH,EAAQ2H,EAAU1E,IACnC1B,EAAO1H,KAAKnH,GAGhB,OAAO6O,EAmqBiBsG,CAAerB,EAAazf,GAAS4a,MAthB7DF,GAAQf,OAAoBzX,IAAVwY,GAAuB9B,GAAKtP,OAAS,EAAKoR,GAAO,GAC5D,WAML,IALA,IAAI5B,EAAOvV,UACP2V,GAAS,EACT5P,EAASqQ,EAAUb,EAAKxP,OAASoR,GAAO,GACxC1B,EAAQyB,MAAMnR,KAET4P,EAAQ5P,GACf0P,EAAME,GAASJ,EAAK4B,GAAQxB,GAE9BA,GAAS,EAET,IADA,IAAIoC,EAAYb,MAAMC,GAAQ,KACrBxB,EAAQwB,IACfY,EAAUpC,GAASJ,EAAKI,GAG1B,OADAoC,EAAUZ,IAAS1B,EACZ1V,EAAMsV,GAAM1Y,KAAMob,KA2hB7B,SAASgF,KACP,MAAO,GAGT/E,EAAOC,QAAU+E,K,mDC/8CjB,8CAWIQ,EAAsB,SAAWhZ,EAAQ5E,QAExBjB,IAAfiB,IAEJT,QAAQgB,KAAM,kFACdP,EAAaQ,SAASqd,MAIvB9gB,KAAKiD,WAAaA,EAClBjD,KAAK+gB,UAAW,EAMhB,IAAIhhB,EAAQC,KAERuI,EAAc,CAAEC,KAAM,UACtBwY,EAAY,CAAExY,KAAM,QACpByY,EAAc,CAAEzY,KAAM,UAEtBzH,EAAQ,IAAIC,QAAO,EAAG,EAAG,EAAG,OAE5BkgB,EAAO9f,KAAK0R,GAAK,EAEjBqO,EAAM,IAAIrgB,UAEd,SAASsgB,EAAa5gB,GAErB,IAAwB,IAAnBT,EAAMghB,SAAX,CAEA,IAAIM,EAAY7gB,EAAM6gB,WAAa7gB,EAAM8gB,cAAgB9gB,EAAM+gB,iBAAmB,EAC9EC,EAAYhhB,EAAMghB,WAAahhB,EAAMihB,cAAgBjhB,EAAMkhB,iBAAmB,EAElF3gB,EAAMgG,kBAAmBc,EAAOvG,YAEhCP,EAAM4F,GAAiB,KAAZ0a,EACXtgB,EAAM0F,GAAiB,KAAZ+a,EAEXzgB,EAAM0F,EAAIrF,KAAKsY,KAAOwH,EAAM9f,KAAKwV,IAAKsK,EAAMngB,EAAM0F,IAElDoB,EAAOvG,WAAWM,aAAcb,GAEhChB,EAAM2L,cAAenD,IAItB,SAASoZ,IAEHle,SAASmI,qBAAuB7L,EAAMkD,YAE1ClD,EAAM2L,cAAesV,GAErBjhB,EAAMghB,UAAW,IAIjBhhB,EAAM2L,cAAeuV,GAErBlhB,EAAMghB,UAAW,GAMnB,SAASa,IAERpf,QAAQD,MAAO,6DAIhBvC,KAAK+B,QAAU,WAEd0B,SAASpB,iBAAkB,YAAa+e,GAAa,GACrD3d,SAASpB,iBAAkB,oBAAqBsf,GAAqB,GACrEle,SAASpB,iBAAkB,mBAAoBuf,GAAoB,IAIpE5hB,KAAKyC,WAAa,WAEjBgB,SAASf,oBAAqB,YAAa0e,GAAa,GACxD3d,SAASf,oBAAqB,oBAAqBif,GAAqB,GACxEle,SAASf,oBAAqB,mBAAoBkf,GAAoB,IAIvE5hB,KAAK+C,QAAU,WAEd/C,KAAKyC,cAINzC,KAAK6hB,UAAY,WAEhB,OAAOha,GAIR7H,KAAK8hB,aAAe,WAEnB,IAAIC,EAAY,IAAIjhB,UAAS,EAAG,GAAK,GAErC,OAAO,SAAWkhB,GAEjB,OAAOA,EAAEvU,KAAMsU,GAAYrT,gBAAiB7G,EAAOvG,aANjC,GAYpBtB,KAAKiiB,YAAc,SAAWC,GAK7Bf,EAAIgB,oBAAqBta,EAAOuN,OAAQ,GAExC+L,EAAIiB,aAAcva,EAAO3D,GAAIid,GAE7BtZ,EAAO0G,SAAS8T,gBAAiBlB,EAAKe,IAIvCliB,KAAKsiB,UAAY,SAAWJ,GAE3Bf,EAAIgB,oBAAqBta,EAAOuN,OAAQ,GAExCvN,EAAO0G,SAAS8T,gBAAiBlB,EAAKe,IAIvCliB,KAAKuiB,KAAO,WAEXviB,KAAKiD,WAAWuf,sBAIjBxiB,KAAKyiB,OAAS,WAEbhf,SAASif,mBAIV1iB,KAAK+B,WAIN8e,EAAoBjT,UAAYrC,OAAOwE,OAAQ4S,kBAAgB/U,WAC/DiT,EAAoBjT,UAAUoC,YAAc6Q,G,iCCjK5C,8CAWI+B,EAAc,SAAWC,GAE5BC,SAAO/a,KAAM/H,KAAM6iB,GAEnB7iB,KAAK+iB,YAAc,GACnB/iB,KAAKgjB,cAAgB,GACrBhjB,KAAKijB,cAAgB,KACrBjjB,KAAKkjB,eAAiB,KAEtBljB,KAAKmjB,YAAc,EACnBnjB,KAAKojB,WAAa,GAClBpjB,KAAKqjB,iBAAmB,EACxBrjB,KAAKsjB,gBAAkB,GAEvBtjB,KAAKujB,oBAAsB,CAC1BhV,SAAU,WACViV,OAAQ,SACRtS,MAAO,QACPuS,GAAI,aAELzjB,KAAK0jB,sBAAwB,CAC5BnV,SAAU,eACViV,OAAQ,eACRtS,MAAO,eACPuS,GAAI,iBAKNb,EAAYhV,UAAYrC,OAAOuE,OAAQvE,OAAOwE,OAAQ+S,SAAOlV,WAAa,CAEzEoC,YAAa4S,EAEbe,eAAgB,SAAWC,GAI1B,OAFA5jB,KAAK+iB,YAAca,EAEZ5jB,MAIR6jB,iBAAkB,SAAWC,GAI5B,OAFA9jB,KAAKgjB,cAAgBc,EAEd9jB,MAIR+jB,eAAgB,SAAWZ,GAI1B,OAFAnjB,KAAKmjB,YAAcA,EAEZnjB,MAKRgkB,aAAc,WAEbxhB,QAAQgB,KAAM,oEAKfygB,YAAa,WAEZzhB,QAAQgB,KAAM,mEAKf0gB,sBAAuB,WAEtB1hB,QAAQgB,KAAM,6EAIf2gB,KAAM,SAAWC,EAAKC,EAAQC,EAAYC,GAAU,WAE/CC,EAAS,IAAIC,aAAYzkB,KAAK6iB,SAElC2B,EAAOE,QAAS1kB,KAAK4jB,MACrBY,EAAOG,gBAAiB,eAEE,oBAArB3kB,KAAK4kB,aAETJ,EAAOK,oBAAoB,GAI5BL,EAAOL,KAAMC,GAAK,SAAEU,GAEnB,IAAIC,EAAa,CAChBC,aAAc,EAAKzB,oBACnB0B,eAAgB,EAAKvB,sBACrBwB,cAAc,GAGf,EAAKC,eAAgBL,EAAQC,GAC3B5iB,KAAMkiB,GACN/hB,MAAOiiB,KAEPD,EAAYC,IAKhBa,gBAAiB,SAAWN,EAAQO,EAAUL,EAAcC,GAE3D,IAAIF,EAAa,CAChBC,aAAcA,GAAgBhlB,KAAKujB,oBACnC0B,eAAgBA,GAAkBjlB,KAAK0jB,sBACvCwB,eAAiBF,GAGlBhlB,KAAKmlB,eAAgBL,EAAQC,GAAa5iB,KAAMkjB,IAIjDF,eAAgB,SAAWL,EAAQC,GAAa,WAK/C,IAAM,IAAIO,KAAaP,EAAWE,eAAiB,CAElD,IAAIzc,EAAOuc,EAAWE,eAAgBK,QAENtjB,IAA3BwG,EAAK+c,oBAETR,EAAWE,eAAgBK,GAAc9c,EAAKyF,MAQhD,IA+BIuX,EA/BAC,EAAUC,KAAKC,UAAWZ,GAI9B,GAAKnC,EAAYgD,UAAUzJ,IAAK2I,GAAW,CAE1C,IAAIe,EAAajD,EAAYgD,UAAUpa,IAAKsZ,GAE5C,GAAKe,EAAWjL,MAAQ6K,EAEvB,OAAOI,EAAWC,QAEZ,GAA2B,IAAtBhB,EAAOiB,WAMlB,MAAM,IAAIC,MAET,iHAYH,IAAIC,EAASjmB,KAAKqjB,mBACd6C,EAAWpB,EAAOiB,WAIlBI,EAAkBnmB,KAAKomB,WAAYH,EAAQC,GAC7C/jB,MAAM,SAAEkkB,GAIR,OAFAb,EAASa,EAEF,IAAIC,SAAS,SAAEC,EAASC,GAE9BhB,EAAOiB,WAAYR,GAAW,CAAEM,UAASC,UAEzChB,EAAOkB,YAAa,CAAEle,KAAM,SAAUme,GAAIV,EAAQlB,aAAYD,UAAU,CAAEA,UAO3E3iB,MAAM,SAAEykB,GAAF,OAAe,EAAKC,gBAAiBD,EAAQ5Z,aA0BrD,OAtBAmZ,EACE7jB,OAAO,kBAAM,KACbH,MAAM,WAEDqjB,GAAUS,GAEd,EAAKa,aAActB,EAAQS,MAS9BrD,EAAYgD,UAAUjkB,IAAKmjB,EAAQ,CAElClK,IAAK6K,EACLK,QAASK,IAIHA,GAIRU,gBAAiB,SAAWE,GAE3B,IAAI/Z,EAAW,IAAIsF,iBAEdyU,EAAa/N,OAEjBhM,EAASga,SAAU,IAAIC,kBAAiBF,EAAa/N,MAAMF,MAAO,IAInE,IAAM,IAAI3P,EAAI,EAAGA,EAAI4d,EAAaG,WAAW9d,OAAQD,IAAO,CAE3D,IAAImc,EAAYyB,EAAaG,WAAY/d,GACrC8E,EAAOqX,EAAUrX,KACjB6K,EAAQwM,EAAUxM,MAClBqO,EAAW7B,EAAU6B,SAEzBna,EAAStJ,aAAcuK,EAAM,IAAIgZ,kBAAiBnO,EAAOqO,IAI1D,OAAOna,GAIRoa,aAAc,SAAWhD,EAAKiD,GAE7B,IAAI7C,EAAS,IAAIC,aAAYzkB,KAAK6iB,SAIlC,OAHA2B,EAAOE,QAAS1kB,KAAK+iB,aACrByB,EAAOG,gBAAiB0C,GAEjB,IAAIf,SAAS,SAAEC,EAASC,GAE9BhC,EAAOL,KAAMC,EAAKmC,OAASvkB,EAAWwkB,OAMxCc,QAAS,WAIR,OAFAtnB,KAAKunB,eAEEvnB,MAIRunB,aAAc,WAAY,WAEzB,GAAKvnB,KAAKkjB,eAAiB,OAAOljB,KAAKkjB,eAEvC,IAAIsE,EAA+B,kBAAhBC,aAAwD,OAA5BznB,KAAKgjB,cAAcxa,KAC9Dkf,EAAmB,GAsCvB,OApCKF,EAEJE,EAAiB9U,KAAM5S,KAAKonB,aAAc,mBAAoB,UAI9DM,EAAiB9U,KAAM5S,KAAKonB,aAAc,wBAAyB,SACnEM,EAAiB9U,KAAM5S,KAAKonB,aAAc,qBAAsB,iBAIjEpnB,KAAKkjB,eAAiBoD,QAAQqB,IAAKD,GACjCvlB,MAAM,SAAEylB,GAER,IAAIC,EAAYD,EAAW,GAEpBJ,IAEN,EAAKxE,cAAc8E,WAAaF,EAAW,IAI5C,IAAIzkB,EAAKyf,EAAYmF,YAAY3O,WAE7B0H,EAAO,CACV,sBACA+G,EACA,GACA,eACA1kB,EAAG6kB,UAAW7kB,EAAGwL,QAAS,KAAQ,EAAGxL,EAAG8kB,YAAa,OACpDC,KAAM,MAER,EAAK5E,gBAAkB6E,IAAIC,gBAAiB,IAAIC,KAAM,CAAEvH,QAInD9gB,KAAKkjB,gBAIbkD,WAAY,SAAWH,EAAQC,GAAW,WAEzC,OAAOlmB,KAAKunB,eAAeplB,MAAM,WAI/B,IAyCGqjB,EA3CC,EAAKpC,WAAWha,OAAS,EAAK+Z,cAE9BqC,EAAS,IAAI8C,OAAQ,EAAKhF,kBAEvBmD,WAAa,GACpBjB,EAAO+C,WAAa,GACpB/C,EAAOgD,UAAY,EAEnBhD,EAAOkB,YAAa,CAAEle,KAAM,OAAQwa,cAAe,EAAKA,gBAExDwC,EAAOiD,UAAY,SAAW5J,GAE7B,IAAI+H,EAAU/H,EAAEkB,KAEhB,OAAS6G,EAAQpe,MAEhB,IAAK,SACJgd,EAAOiB,WAAYG,EAAQD,IAAKJ,QAASK,GACzC,MAED,IAAK,QACJpB,EAAOiB,WAAYG,EAAQD,IAAKH,OAAQI,GACxC,MAED,QACCpkB,QAAQD,MAAO,2CAA6CqkB,EAAQpe,KAAO,OAM9E,EAAK4a,WAAWxQ,KAAM4S,IAItB,EAAKpC,WAAWsF,MAAM,SAAW9Q,EAAG+Q,GAEnC,OAAO/Q,EAAE4Q,UAAYG,EAAEH,WAAc,EAAI,KAS3C,OAHIhD,EAAS,EAAKpC,WAAY,EAAKA,WAAWha,OAAS,IAChDmf,WAAYtC,GAAWC,EAC9BV,EAAOgD,WAAatC,EACbV,MAMTsB,aAAc,SAAWtB,EAAQS,GAEhCT,EAAOgD,WAAahD,EAAO+C,WAAYtC,UAChCT,EAAOiB,WAAYR,UACnBT,EAAO+C,WAAYtC,IAI3B2C,MAAO,WAENpmB,QAAQqmB,IAAK,cAAe7oB,KAAKojB,WAAWtD,KAAK,SAAE0F,GAAF,OAAcA,EAAOgD,eAIvEzlB,QAAS,WAER,IAAM,IAAIoG,EAAI,EAAGA,EAAInJ,KAAKojB,WAAWha,SAAWD,EAE/CnJ,KAAKojB,WAAYja,GAAI2f,YAMtB,OAFA9oB,KAAKojB,WAAWha,OAAS,EAElBpJ,QAQT4iB,EAAYmF,YAAc,WAEzB,IAAI/E,EACAE,EAkKJ,SAAS6F,EAAiBC,EAAOC,EAASC,EAAeC,EAAeC,EAAe9D,GAEtF,IAGI+D,EAEAvQ,EALAwQ,EAAgBhE,EAAUiE,iBAE1BC,EADYN,EAAcO,aACFH,EAK5B,OAASF,GAER,KAAKM,aACJL,EAAa,IAAIL,EAAMW,kBACvBV,EAAQW,8BAA+BV,EAAe5D,EAAW+D,GACjEvQ,EAAQ,IAAI4Q,aAAcF,GAC1B,MAED,KAAKK,UACJR,EAAa,IAAIL,EAAMc,eACvBb,EAAQc,6BAA8Bb,EAAe5D,EAAW+D,GAChEvQ,EAAQ,IAAI+Q,UAAWL,GACvB,MAED,KAAKQ,WACJX,EAAa,IAAIL,EAAMiB,gBACvBhB,EAAQiB,8BAA+BhB,EAAe5D,EAAW+D,GACjEvQ,EAAQ,IAAIkR,WAAYR,GACxB,MAED,KAAKW,WACJd,EAAa,IAAIL,EAAMoB,gBACvBnB,EAAQoB,8BAA+BnB,EAAe5D,EAAW+D,GACjEvQ,EAAQ,IAAIqR,WAAYX,GACxB,MAED,KAAKc,WACJjB,EAAa,IAAIL,EAAMuB,gBACvBtB,EAAQuB,8BAA+BtB,EAAe5D,EAAW+D,GACjEvQ,EAAQ,IAAIwR,WAAYd,GACxB,MAED,KAAKiB,YACJpB,EAAa,IAAIL,EAAM0B,iBACvBzB,EAAQ0B,+BAAgCzB,EAAe5D,EAAW+D,GAClEvQ,EAAQ,IAAI2R,YAAajB,GACzB,MAED,KAAKoB,YACJvB,EAAa,IAAIL,EAAM6B,iBACvB5B,EAAQ6B,+BAAgC5B,EAAe5D,EAAW+D,GAClEvQ,EAAQ,IAAI8R,YAAapB,GACzB,MAED,QACC,MAAM,IAAIxD,MAAO,iDAInB,IAAM,IAAI7c,EAAI,EAAGA,EAAIqgB,EAAWrgB,IAE/B2P,EAAO3P,GAAMkgB,EAAW0B,SAAU5hB,GAMnC,OAFA6f,EAAMgC,QAAS3B,GAER,CACNpb,KAAMkb,EACNrQ,MAAOA,EACPqO,SAAUmC,GArOZb,UAAY,SAAW5J,GAEtB,IAAI+H,EAAU/H,EAAEkB,KAEhB,OAAS6G,EAAQpe,MAEhB,IAAK,OACJwa,EAAgB4D,EAAQ5D,cACxBE,EAAiB,IAAIoD,SAAS,SAAWC,GAExCvD,EAAciI,eAAiB,SAAWjC,GAGzCzC,EAAS,CAAEyC,MAAOA,KAInBkC,mBAAoBlI,MAGrB,MAED,IAAK,SACJ,IAAI8B,EAAS8B,EAAQ9B,OACjBC,EAAa6B,EAAQ7B,WACzB7B,EAAe/gB,MAAM,SAAEkZ,GAEtB,IAAI2N,EAAQ3N,EAAO2N,MACfC,EAAU,IAAID,EAAMmC,QACpBC,EAAgB,IAAIpC,EAAMqC,cAC9BD,EAAcE,KAAM,IAAIzB,UAAW/E,GAAUA,EAAOiB,YAEpD,IAEC,IAAI/Y,EA4BT,SAAyBgc,EAAOC,EAASmC,EAAerG,GAEvD,IAGImE,EACAqC,EAJAvG,EAAeD,EAAWC,aAC1BC,EAAiBF,EAAWE,eAK5BuG,EAAevC,EAAQwC,uBAAwBL,GAEnD,GAAKI,IAAiBxC,EAAM0C,gBAE3BxC,EAAgB,IAAIF,EAAM/V,KAC1BsY,EAAiBtC,EAAQ0C,mBAAoBP,EAAelC,OAEtD,IAAKsC,IAAiBxC,EAAM4C,YAOlC,MAAM,IAAI5F,MAAO,gDALjBkD,EAAgB,IAAIF,EAAM6C,WAC1BN,EAAiBtC,EAAQ6C,yBAA0BV,EAAelC,GAQnE,IAAOqC,EAAeQ,MAA8B,IAAtB7C,EAAc8C,IAE3C,MAAM,IAAIhG,MAAO,uCAAyCuF,EAAeU,aAI1E,IAAIjf,EAAW,CAAEgM,MAAO,KAAMkO,WAAY,IAG1C,IAAM,IAAIiC,KAAiBnE,EAAe,CAEzC,IAEIM,EACA4G,EAHA9C,EAAgB7Q,KAAM0M,EAAgBkE,IAS1C,GAAKpE,EAAWG,aAEfgH,EAAclH,EAAcmE,GAC5B7D,EAAY2D,EAAQkD,uBAAwBjD,EAAegD,OAErD,CAIN,IAAuB,KAFvBA,EAAcjD,EAAQmD,eAAgBlD,EAAeF,EAAOhE,EAAcmE,MAE/C,SAE3B7D,EAAY2D,EAAQoD,aAAcnD,EAAegD,GAIlDlf,EAASka,WAAWtU,KAAMmW,EAAiBC,EAAOC,EAASC,EAAeC,EAAeC,EAAe9D,IAKzG,GAAKkG,IAAiBxC,EAAM0C,gBAAkB,CAQ7C,IALA,IAAIY,EAAWpD,EAAcqD,YAEzBvT,EAAQ,IAAI4R,YADY,EAAX0B,GAEbE,EAAa,IAAIxD,EAAMoB,gBAEjBjhB,EAAI,EAAGA,EAAImjB,IAAanjB,EAAI,CAErC8f,EAAQwD,gBAAiBvD,EAAe/f,EAAGqjB,GAE3C,IAAM,IAAIE,EAAI,EAAGA,EAAI,IAAMA,EAE1B1T,EAAW,EAAJ7P,EAAQujB,GAAMF,EAAWzB,SAAU2B,GAM5C1f,EAASgM,MAAQ,CAAEF,MAAOE,EAAOmO,SAAU,GAE3C6B,EAAMgC,QAASwB,GAMhB,OAFAxD,EAAMgC,QAAS9B,GAERlc,EA1HYmY,CAAgB6D,EAAOC,EAASmC,EAAerG,GAE1D4H,EAAU3f,EAASka,WAAWpH,KAAK,SAAE8M,GAAF,OAAYA,EAAK9T,MAAMgM,UAEzD9X,EAASgM,OAAQ2T,EAAQ/Z,KAAM5F,EAASgM,MAAMF,MAAMgM,QAEzDvM,KAAKmO,YAAa,CAAEle,KAAM,SAAUme,GAAIC,EAAQD,GAAI3Z,YAAY2f,GAE/D,MAAQpqB,GAETC,QAAQD,MAAOA,GAEfgW,KAAKmO,YAAa,CAAEle,KAAM,QAASme,GAAIC,EAAQD,GAAIpkB,MAAOA,EAAMqkB,UAdjE,QAkBCoC,EAAMgC,QAASI,GACfpC,EAAMgC,QAAS/B,UAyLrBrG,EAAYgD,UAAY,IAAIiH,QAK5BjK,EAAYe,eAAiB,WAE5BnhB,QAAQgB,KAAM,4FAKfof,EAAYiB,iBAAmB,WAE9BrhB,QAAQgB,KAAM,8FAKfof,EAAYkK,qBAAuB,WAElCtqB,QAAQgB,KAAM,kGAKfof,EAAYmK,iBAAmB,WAE9BvqB,QAAQgB,KAAM,+F,iCC5qBf,8CAwEIwpB,EAAe,WAElB,SAASA,EAAYnK,GAEpBC,SAAO/a,KAAM/H,KAAM6iB,GAEnB7iB,KAAKitB,YAAc,KACnBjtB,KAAKktB,UAAY,KAuNlB,SAASC,IAER,IAAIC,EAAU,GAEd,MAAO,CAEN5hB,IAAK,SAAWoP,GAEf,OAAOwS,EAASxS,IAIjBzS,IAAK,SAAWyS,EAAK9a,GAEpBstB,EAASxS,GAAQ9a,GAIlButB,OAAQ,SAAWzS,UAEXwS,EAASxS,IAIjB0S,UAAW,WAEVF,EAAU,KA7ObJ,EAAWpf,UAAYrC,OAAOuE,OAAQvE,OAAOwE,OAAQ+S,SAAOlV,WAAa,CAExEoC,YAAagd,EAEb7I,KAAM,SAAWC,EAAKC,EAAQC,EAAYC,GAEzC,IAEIgJ,EAFAxtB,EAAQC,KAMXutB,EAF0B,KAAtBvtB,KAAKutB,aAEMvtB,KAAKutB,aAEK,KAAdvtB,KAAK4jB,KAED5jB,KAAK4jB,KAIL4J,cAAYC,eAAgBrJ,GAO5CrkB,EAAM8iB,QAAQ6K,UAAWtJ,GAEzB,IAAIuJ,EAAW,SAAW9O,GAEpB0F,EAEJA,EAAS1F,GAITrc,QAAQD,MAAOsc,GAIhB9e,EAAM8iB,QAAQ+K,UAAWxJ,GACzBrkB,EAAM8iB,QAAQgL,QAASzJ,IAIpBI,EAAS,IAAIC,aAAY1kB,EAAM8iB,SAEnC2B,EAAOE,QAAS1kB,KAAK4jB,MACrBY,EAAOG,gBAAiB,eACxBH,EAAOsJ,iBAAkB9tB,KAAK+tB,eAEH,oBAAtBhuB,EAAM6kB,aAEVJ,EAAOK,oBAAoB,GAI5BL,EAAOL,KAAMC,GAAK,SAAWrE,GAE5B,IAEChgB,EAAMiuB,MAAOjO,EAAMwN,GAAc,SAAWU,GAE3C5J,EAAQ4J,GAERluB,EAAM8iB,QAAQgL,QAASzJ,KAErBuJ,GAEF,MAAQ9O,GAET8O,EAAU9O,MAITyF,EAAYqJ,IAIhBO,eAAgB,SAAWjB,GAG1B,OADAjtB,KAAKitB,YAAcA,EACZjtB,MAIRmuB,aAAc,SAAWjB,GAGxB,OADAltB,KAAKktB,UAAYA,EACVltB,MAIRguB,MAAO,SAAWjO,EAAM6D,EAAMS,EAAQE,GAErC,IAAI6J,EACAC,EAAa,GAEjB,GAAqB,kBAATtO,EAEXqO,EAAUrO,OAMV,GAFYyN,cAAYc,WAAY,IAAIhE,WAAYvK,EAAM,EAAG,MAE9CwO,EAAgC,CAE9C,IAECF,EAAYG,EAAWC,iBAAoB,IAAIC,EAAqB3O,GAEnE,MAAQxd,GAGT,YADKgiB,GAAUA,EAAShiB,IAKzB6rB,EAAUC,EAAYG,EAAWC,iBAAkBL,aAInDA,EAAUZ,cAAYc,WAAY,IAAIhE,WAAYvK,IAMpD,IAAI4O,EAAOjJ,KAAKsI,MAAOI,GAEvB,QAAoBpsB,IAAf2sB,EAAKC,OAAuBD,EAAKC,MAAMC,QAAS,GAAM,EAErDtK,GAAUA,EAAS,IAAIyB,MAAO,gFAFpC,CAOA,GAAK2I,EAAKG,eAET,IAAM,IAAI3lB,EAAI,EAAGA,EAAIwlB,EAAKG,eAAe1lB,SAAWD,EAAI,CAEvD,IAAI4lB,EAAgBJ,EAAKG,eAAgB3lB,GACrC6lB,EAAqBL,EAAKK,oBAAsB,GAEpD,OAASD,GAER,KAAKP,EAAWS,oBACfZ,EAAYU,GAAkB,IAAIG,EAAqBP,GACvD,MAED,KAAKH,EAAWW,wBACfd,EAAYU,GAAkB,IAAIK,EAClC,MAED,KAAKZ,EAAWa,oBACfhB,EAAYU,GAAkB,IAAIO,EAClC,MAED,KAAKd,EAAWe,sCACflB,EAAYU,GAAkB,IAAIS,EAClC,MAED,KAAKhB,EAAWiB,2BACfpB,EAAYU,GAAkB,IAAIW,EAAmCf,EAAM3uB,KAAKitB,aAChF,MAED,KAAKuB,EAAWmB,iBACftB,EAAYU,GAAkB,IAAIa,EAAyB5vB,KAAKktB,WAChE,MAED,KAAKsB,EAAWqB,sBACfxB,EAAYU,GAAkB,IAAIe,EAClC,MAED,KAAKtB,EAAWuB,sBACf1B,EAAYU,GAAkB,IAAIiB,EAClC,MAED,QAEMhB,EAAmBrgB,QAASogB,IAAmB,GAEnDvsB,QAAQgB,KAAM,wCAA0CurB,EAAgB,OAU7E,IAAIkB,EAAS,IAAIC,EAAYvB,EAAMN,EAAY,CAE9CzK,KAAMA,GAAQ5jB,KAAKutB,cAAgB,GACnC3I,YAAa5kB,KAAK4kB,YAClB/B,QAAS7iB,KAAK6iB,UAIfoN,EAAOE,WAAWrC,iBAAkB9tB,KAAK+tB,eACzCkC,EAAOjC,MAAO3J,EAAQE,OA8CxB,IAAIiK,EAAa,CAChBC,gBAAiB,kBACjBgB,2BAA4B,6BAC5BR,oBAAqB,sBACrBE,wBAAyB,0BACzBI,sCAAuC,sCACvCF,oBAAqB,sBACrBQ,sBAAuB,wBACvBE,sBAAuB,wBACvBJ,iBAAkB,oBASnB,SAASC,EAAyB1C,GAEjC,IAAOA,EAEN,MAAM,IAAIlH,MAAO,iFAIlBhmB,KAAKiO,KAAOugB,EAAWmB,iBACvB3vB,KAAKktB,UAAYA,EASlB,SAASgC,EAAqBP,GAE7B3uB,KAAKiO,KAAOugB,EAAWS,oBAEvB,IAAImB,EAAczB,EAAKN,YAAcM,EAAKN,WAAYG,EAAWS,sBAA2B,GAC5FjvB,KAAKqwB,UAAYD,EAAUE,QAAU,GAgEtC,SAAShB,IAERtvB,KAAKiO,KAAOugB,EAAWa,oBA+CxB,SAASD,IAERpvB,KAAKiO,KAAOugB,EAAWW,wBA/GxBD,EAAoBthB,UAAU2iB,UAAY,SAAWC,GAEpD,IACIC,EADAC,EAAW1wB,KAAKqwB,UAAWG,GAG3Btf,EAAQ,IAAI4G,QAAO,eACC9V,IAAnB0uB,EAASxf,OAAsBA,EAAMyf,UAAWD,EAASxf,OAE9D,IAAI0f,OAA2B5uB,IAAnB0uB,EAASE,MAAsBF,EAASE,MAAQ,EAE5D,OAASF,EAASloB,MAEjB,IAAK,eACJioB,EAAY,IAAII,mBAAkB3f,IACxB4f,OAAOviB,SAAS5M,IAAK,EAAG,GAAK,GACvC8uB,EAAUtoB,IAAKsoB,EAAUK,QACzB,MAED,IAAK,SACJL,EAAY,IAAIM,aAAY7f,IAClBgR,SAAW0O,EACrB,MAED,IAAK,QACJH,EAAY,IAAIO,YAAW9f,IACjBgR,SAAW0O,EAErBF,EAASO,KAAOP,EAASO,MAAQ,GACjCP,EAASO,KAAKC,oBAAkDlvB,IAAjC0uB,EAASO,KAAKC,eAA+BR,EAASO,KAAKC,eAAiB,EAC3GR,EAASO,KAAKE,oBAAkDnvB,IAAjC0uB,EAASO,KAAKE,eAA+BT,EAASO,KAAKE,eAAiB/vB,KAAK0R,GAAK,EACrH2d,EAAUW,MAAQV,EAASO,KAAKE,eAChCV,EAAUY,SAAW,EAAMX,EAASO,KAAKC,eAAiBR,EAASO,KAAKE,eACxEV,EAAUK,OAAOviB,SAAS5M,IAAK,EAAG,GAAK,GACvC8uB,EAAUtoB,IAAKsoB,EAAUK,QACzB,MAED,QACC,MAAM,IAAI9K,MAAO,6CAA+C0K,EAASloB,KAAO,MAclF,OARAioB,EAAUliB,SAAS5M,IAAK,EAAG,EAAG,GAE9B8uB,EAAUa,MAAQ,OAEUtvB,IAAvB0uB,EAASa,YAA0Bd,EAAUc,UAAYb,EAASa,WAEvEd,EAAUxiB,KAAOyiB,EAASziB,MAAU,SAAWuiB,EAExClK,QAAQC,QAASkK,IAezBnB,EAA4B1hB,UAAU4jB,gBAAkB,WAEvD,OAAOrhB,qBAIRmf,EAA4B1hB,UAAU6jB,aAAe,SAAWC,EAAgBC,EAAa1B,GAE5F,IAAI2B,EAAU,GAEdF,EAAexgB,MAAQ,IAAI4G,QAAO,EAAK,EAAK,GAC5C4Z,EAAe3gB,QAAU,EAEzB,IAAI8gB,EAAoBF,EAAYG,qBAEpC,GAAKD,EAAoB,CAExB,GAAKtX,MAAMX,QAASiY,EAAkBE,iBAAoB,CAEzD,IAAIjZ,EAAQ+Y,EAAkBE,gBAE9BL,EAAexgB,MAAMyf,UAAW7X,GAChC4Y,EAAe3gB,QAAU+H,EAAO,QAIW9W,IAAvC6vB,EAAkBG,kBAEtBJ,EAAQhf,KAAMqd,EAAOgC,cAAeP,EAAgB,MAAOG,EAAkBG,mBAM/E,OAAO1L,QAAQqB,IAAKiK,IAerBxC,EAAgCxhB,UAAU4jB,gBAAkB,WAE3D,OAAOU,wBAIR9C,EAAgCxhB,UAAU6jB,aAAe,SAAWC,EAAgBC,EAAa1B,GAEhG,IAAI2B,EAAU,GAEVxB,EAAYuB,EAAYtD,WAAYruB,KAAKiO,MA0B7C,QAxBmCjM,IAA9BouB,EAAU+B,kBAEdT,EAAeU,UAAYhC,EAAU+B,sBAIFnwB,IAA/BouB,EAAUiC,kBAEdT,EAAQhf,KAAMqd,EAAOgC,cAAeP,EAAgB,eAAgBtB,EAAUiC,wBAInCrwB,IAAvCouB,EAAUkC,2BAEdZ,EAAea,mBAAqBnC,EAAUkC,+BAIFtwB,IAAxCouB,EAAUoC,2BAEdZ,EAAQhf,KAAMqd,EAAOgC,cAAeP,EAAgB,wBAAyBtB,EAAUoC,iCAI9CxwB,IAArCouB,EAAUqC,yBAEdb,EAAQhf,KAAMqd,EAAOgC,cAAeP,EAAgB,qBAAsBtB,EAAUqC,8BAEpCzwB,IAA3CouB,EAAUqC,uBAAuBjkB,OAAsB,CAE3D,IAAIA,EAAQ4hB,EAAUqC,uBAAuBjkB,MAE7CkjB,EAAegB,qBAAuB,IAAIC,UAASnkB,EAAOA,GAM5D,OAAO8X,QAAQqB,IAAKiK,IAKrB,IAAIrD,EAAgC,OAEhCqE,EAAuC,WAAvCA,EAAwD,QAE5D,SAASlE,EAAqB3O,GAE7B/f,KAAKiO,KAAOugB,EAAWC,gBACvBzuB,KAAKouB,QAAU,KACfpuB,KAAK8gB,KAAO,KAEZ,IAAI+R,EAAa,IAAIC,SAAU/S,EAAM,EATD,IAiBpC,GANA/f,KAAK+yB,OAAS,CACbC,MAAOxF,cAAYc,WAAY,IAAIhE,WAAYvK,EAAKkT,MAAO,EAAG,KAC9DpE,QAASgE,EAAWK,UAAW,GAAG,GAClC9pB,OAAQypB,EAAWK,UAAW,GAAG,IAG7BlzB,KAAK+yB,OAAOC,QAAUzE,EAE1B,MAAM,IAAIvI,MAAO,qDAEX,GAAKhmB,KAAK+yB,OAAOlE,QAAU,EAEjC,MAAM,IAAI7I,MAAO,kDAOlB,IAHA,IAAImN,EAAY,IAAIL,SAAU/S,EA3BM,IA4BhCqT,EAAa,EAETA,EAAaD,EAAUpN,YAAa,CAE3C,IAAIsN,EAAcF,EAAUD,UAAWE,GAAY,GACnDA,GAAc,EAEd,IAAIE,EAAYH,EAAUD,UAAWE,GAAY,GAGjD,GAFAA,GAAc,EAETE,IAAcV,EAAoC,CAEtD,IAAIW,EAAe,IAAIjJ,WAAYvK,EAxCD,GAwCwCqT,EAAYC,GACtFrzB,KAAKouB,QAAUZ,cAAYc,WAAYiF,QAEjC,GAAKD,IAAcV,EAAmC,CAE5D,IAAIY,EA7C8B,GA6CgBJ,EAClDpzB,KAAK8gB,KAAOf,EAAKkT,MAAOO,EAAYA,EAAaH,GAMlDD,GAAcC,EAIf,GAAsB,OAAjBrzB,KAAKouB,QAET,MAAM,IAAIpI,MAAO,6CAWnB,SAAS0J,EAAmCf,EAAM1B,GAEjD,IAAOA,EAEN,MAAM,IAAIjH,MAAO,uDAIlBhmB,KAAKiO,KAAOugB,EAAWiB,2BACvBzvB,KAAK2uB,KAAOA,EACZ3uB,KAAKitB,YAAcA,EACnBjtB,KAAKitB,YAAY3F,UAoElB,SAASwI,IAER9vB,KAAKiO,KAAOugB,EAAWqB,sBAkDxB,SAAS4D,EAA4BC,GAEpCC,uBAAqB5rB,KAAM/H,MAE3BA,KAAK4zB,kCAAmC,EAGxC,IAAIC,EAA+B,CAClC,yBACA,mCACA,UACC3L,KAAM,MAEJ4L,EAAiC,CACpC,2BACA,qCACA,UACC5L,KAAM,MAEJ6L,EAA2B,CAC9B,kCACA,yBACA,wDACA,mDACA,oFACA,yCACA,UACC7L,KAAM,MAEJ8L,EAA6B,CAChC,uCACA,2BACA,4DACA,kFACA,2CACA,UACC9L,KAAM,MAEJ+L,EAA6B,CAChC,6BACA,4CACA,kFACA,+DACA,6HACA,mDACA,uEACA,gDACC/L,KAAM,MAEJgM,EAAW,CACdC,SAAU,CAAE1oB,OAAO,IAAIqM,SAAQsc,OAAQ,WACvCC,WAAY,CAAE5oB,MAAO,GACrB6oB,YAAa,CAAE7oB,MAAO,MACtB8oB,cAAe,CAAE9oB,MAAO,OAGzBzL,KAAKw0B,eAAiBN,EAGtBl0B,KAAKy0B,gBAAkB,SAAWC,GAEjC,IAAM,IAAIC,KAAeT,EAExBQ,EAAOR,SAAUS,GAAgBT,EAAUS,GAI5CD,EAAOE,eAAiBF,EAAOE,eAAe1X,QAAS,2BAA4B,0BACnFwX,EAAOE,eAAiBF,EAAOE,eAAe1X,QAAS,2BAA4B,6BACnFwX,EAAOE,eAAiBF,EAAOE,eAAe1X,QAAS,wCAAyC2W,GAChGa,EAAOE,eAAiBF,EAAOE,eAAe1X,QAAS,wCAAyC4W,GAChGY,EAAOE,eAAiBF,EAAOE,eAAe1X,QAAS,mCAAoC6W,GAC3FW,EAAOE,eAAiBF,EAAOE,eAAe1X,QAAS,mCAAoC8W,GAC3FU,EAAOE,eAAiBF,EAAOE,eAAe1X,QAAS,sCAAuC+W,IAK/F1oB,OAAOspB,iBACN70B,KACA,CACCm0B,SAAU,CACT3oB,IAAK,WAAc,OAAO0oB,EAASC,SAAS1oB,OAC5C9J,IAAK,SAAWqgB,GAAMkS,EAASC,SAAS1oB,MAAQuW,IAEjDsS,YAAa,CACZ9oB,IAAK,WAAc,OAAO0oB,EAASI,YAAY7oB,OAC/C9J,IAAK,SAAWqgB,GAAMkS,EAASI,YAAY7oB,MAAQuW,IAEpDqS,WAAY,CACX7oB,IAAK,WAAc,OAAO0oB,EAASG,WAAW5oB,OAC9C9J,IAAK,SAAWqgB,GAAMkS,EAASG,WAAW5oB,MAAQuW,IAEnDuS,cAAe,CACd/oB,IAAK,WAAc,OAAO0oB,EAASK,cAAc9oB,OACjD9J,IAAK,SAAWqgB,GAEfkS,EAASK,cAAc9oB,MAAQuW,EAE1BA,GAEJhiB,KAAK80B,QAAQC,kBAAoB,GAEjC/0B,KAAK80B,QAAQE,iBAAmB,YAIzBh1B,KAAK80B,QAAQE,wBACbh1B,KAAK80B,QAAQC,8BAUlB/0B,KAAKi1B,iBACLj1B,KAAKk1B,iBACLl1B,KAAKm1B,oBACLn1B,KAAKo1B,aAEZp1B,KAAKq1B,UAAW3B,GAsBjB,SAASlE,IAER,MAAO,CAENvhB,KAAMugB,EAAWe,sCAEjB+F,yBAA0B,CACzB,QACA,MACA,WACA,oBACA,QACA,iBACA,WACA,oBACA,cACA,UACA,YACA,YACA,gBACA,kBACA,oBACA,mBACA,cACA,WACA,gBACA,aACA,WACA,SACA,kBACA,mBAGD9D,gBAAiB,WAEhB,OAAOiC,GAIRhC,aAAc,SAAWC,EAAgBC,EAAa1B,GAErD,IAAIsF,EAAwB5D,EAAYtD,WAAYruB,KAAKiO,MAEzDyjB,EAAexgB,MAAQ,IAAI4G,QAAO,EAAK,EAAK,GAC5C4Z,EAAe3gB,QAAU,EAEzB,IAAI6gB,EAAU,GAEd,GAAKrX,MAAMX,QAAS2b,EAAsBC,eAAkB,CAE3D,IAAI1c,EAAQyc,EAAsBC,cAElC9D,EAAexgB,MAAMyf,UAAW7X,GAChC4Y,EAAe3gB,QAAU+H,EAAO,GAoBjC,QAhB8C9W,IAAzCuzB,EAAsBE,gBAE1B7D,EAAQhf,KAAMqd,EAAOgC,cAAeP,EAAgB,MAAO6D,EAAsBE,iBAIlF/D,EAAegE,SAAW,IAAI5d,QAAO,EAAK,EAAK,GAC/C4Z,EAAe2C,gBAAwDryB,IAA3CuzB,EAAsBI,iBAAiCJ,EAAsBI,iBAAmB,EAC5HjE,EAAeyC,SAAW,IAAIrc,QAAO,EAAK,EAAK,GAE1CyC,MAAMX,QAAS2b,EAAsBK,iBAEzClE,EAAeyC,SAASxD,UAAW4E,EAAsBK,qBAID5zB,IAApDuzB,EAAsBM,0BAA0C,CAEpE,IAAIC,EAAkBP,EAAsBM,0BAC5CjE,EAAQhf,KAAMqd,EAAOgC,cAAeP,EAAgB,gBAAiBoE,IACrElE,EAAQhf,KAAMqd,EAAOgC,cAAeP,EAAgB,cAAeoE,IAIpE,OAAOxP,QAAQqB,IAAKiK,IAIrBmE,eAAgB,SAAWrE,GAE1B,IAAIzkB,EAAW,IAAIwmB,EAA4B/B,GA0C/C,OAzCAzkB,EAASwD,KAAM,EAEfxD,EAASiE,MAAQwgB,EAAexgB,MAEhCjE,EAAS6S,SAA6B9d,IAAvB0vB,EAAe5R,IAAoB,KAAO4R,EAAe5R,IAExE7S,EAAS+oB,SAAW,KACpB/oB,EAASgpB,kBAAoB,EAE7BhpB,EAASipB,WAAiCl0B,IAAzB0vB,EAAewE,MAAsB,KAAOxE,EAAewE,MAC5EjpB,EAASkpB,eAAiB,EAE1BlpB,EAASyoB,SAAWhE,EAAegE,SACnCzoB,EAASmpB,kBAAoB,EAC7BnpB,EAASopB,iBAA6Cr0B,IAA/B0vB,EAAe2E,YAA4B,KAAO3E,EAAe2E,YAExFppB,EAASqpB,aAAqCt0B,IAA3B0vB,EAAe4E,QAAwB,KAAO5E,EAAe4E,QAChFrpB,EAASspB,UAAY,EAErBtpB,EAASupB,eAAyCx0B,IAA7B0vB,EAAe8E,UAA0B,KAAO9E,EAAe8E,UACpFvpB,EAASwpB,cAAgBC,wBAEpBhF,EAAeiF,cAAc1pB,EAAS0pB,YAAcjF,EAAeiF,aAExE1pB,EAAS2pB,gBAAkB,KAC3B3pB,EAAS4pB,kBAAoB,EAC7B5pB,EAAS6pB,iBAAmB,EAE5B7pB,EAASqnB,iBAA6CtyB,IAA/B0vB,EAAe4C,YAA4B,KAAO5C,EAAe4C,YACxFrnB,EAASknB,SAAWzC,EAAeyC,SAEnClnB,EAASsnB,mBAAiDvyB,IAAjC0vB,EAAe6C,cAA8B,KAAO7C,EAAe6C,cAC5FtnB,EAASonB,WAAa3C,EAAe2C,WAErCpnB,EAAS8pB,SAAW,KAEpB9pB,EAAS+pB,YAAmCh1B,IAA1B0vB,EAAesF,OAAuB,KAAOtF,EAAesF,OAC9E/pB,EAASgqB,gBAAkB,EAE3BhqB,EAASiqB,gBAAkB,IAEpBjqB,IAaV,SAAS+iB,IAERhwB,KAAKiO,KAAOugB,EAAWuB,sBAUxB,SAASoH,EAA4BC,EAAoBC,EAAcC,EAAYC,GAElFC,cAAYzvB,KAAM/H,KAAMo3B,EAAoBC,EAAcC,EAAYC,GAjavE7H,EAAkC9hB,UAAU6pB,gBAAkB,SAAWC,EAAWzH,GAEnF,IAAItB,EAAO3uB,KAAK2uB,KACZ1B,EAAcjtB,KAAKitB,YACnB0K,EAAkBD,EAAUrJ,WAAYruB,KAAKiO,MAAO2pB,WACpDC,EAAmBH,EAAUrJ,WAAYruB,KAAKiO,MAAOiZ,WACrD4Q,EAAoB,GACpBC,EAAyB,GACzBC,EAAmB,GAEvB,IAAM,IAAI7O,KAAiB0O,EAAmB,CAE7C,IAAII,EAAqBC,EAAY/O,IAAmBA,EAAcgP,cAEtEL,EAAmBG,GAAuBJ,EAAkB1O,GAI7D,IAAMA,KAAiBuO,EAAUxQ,WAAa,CAEzC+Q,EAAqBC,EAAY/O,IAAmBA,EAAcgP,cAEtE,QAA2Cn2B,IAAtC61B,EAAkB1O,GAAgC,CAEtD,IAAIiP,EAAczJ,EAAK0J,UAAWX,EAAUxQ,WAAYiC,IACpDmP,EAAgBC,EAAuBH,EAAYE,eAEvDN,EAAkBC,GAAuBK,EACzCP,EAAwBE,IAAkD,IAA3BG,EAAYI,YAM7D,OAAOvI,EAAOwI,cAAe,aAAcd,GAAkBx1B,MAAM,SAAWy1B,GAE7E,OAAO,IAAItR,SAAS,SAAWC,GAE9B0G,EAAY7H,gBAAiBwS,GAAY,SAAW5qB,GAEnD,IAAM,IAAImc,KAAiBnc,EAASka,WAAa,CAEhD,IAAI5B,EAAYtY,EAASka,WAAYiC,GACjCqP,EAAaT,EAAwB5O,QAErBnnB,IAAfw2B,IAA2BlT,EAAUkT,WAAaA,GAIxDjS,EAASvZ,KAEP8qB,EAAmBE,UAmBzBlI,EAA8BliB,UAAU8qB,cAAgB,SAAWC,EAAStc,GA8B3E,OA5BAsc,EAAUA,EAAQ7nB,aAEQ9O,IAArBqa,EAAUnW,QAEdyyB,EAAQzyB,OAAOyqB,UAAWtU,EAAUnW,aAITlE,IAAvBqa,EAAUpc,WAEd04B,EAAQ14B,SAAWoc,EAAUpc,eAIL+B,IAApBqa,EAAU7N,OAEdmqB,EAAQC,OAAOjI,UAAWtU,EAAU7N,YAITxM,IAAvBqa,EAAUwc,UAEdr2B,QAAQgB,KAAM,wCAA0CxD,KAAKiO,KAAO,kCAIrE0qB,EAAQG,aAAc,EAEfH,GA+IRlF,EAA2B7lB,UAAYrC,OAAOwE,OAAQ4jB,uBAAqB/lB,WAC3E6lB,EAA2B7lB,UAAUoC,YAAcyjB,EAEnDA,EAA2B7lB,UAAUH,KAAO,SAAWsrB,GAWtD,OATApF,uBAAqB/lB,UAAUH,KAAK1F,KAAM/H,KAAM+4B,GAChD/4B,KAAKs0B,YAAcyE,EAAOzE,YAC1Bt0B,KAAKm0B,SAAS1mB,KAAMsrB,EAAO5E,UAC3Bn0B,KAAKu0B,cAAgBwE,EAAOxE,cAC5Bv0B,KAAKq0B,WAAa0E,EAAO1E,kBAClBr0B,KAAKi1B,iBACLj1B,KAAKk1B,iBACLl1B,KAAKm1B,oBACLn1B,KAAKo1B,aACLp1B,MAoKRm3B,EAA2BvpB,UAAYrC,OAAOwE,OAAQynB,cAAY5pB,WAClEupB,EAA2BvpB,UAAUoC,YAAcmnB,EAEnDA,EAA2BvpB,UAAUorB,iBAAmB,SAAWhgB,GAUlE,IALA,IAAIsB,EAASta,KAAKu3B,aACjBxe,EAAS/Y,KAAKq3B,aACd4B,EAAYj5B,KAAKi5B,UACjB/yB,EAAS8S,EAAQigB,EAAY,EAAIA,EAExB9vB,EAAI,EAAGA,IAAM8vB,EAAW9vB,IAEjCmR,EAAQnR,GAAM4P,EAAQ7S,EAASiD,GAIhC,OAAOmR,GAIR6c,EAA2BvpB,UAAUsrB,aAAe/B,EAA2BvpB,UAAUorB,iBAEzF7B,EAA2BvpB,UAAUurB,UAAYhC,EAA2BvpB,UAAUorB,iBAEtF7B,EAA2BvpB,UAAUwrB,aAAe,SAAWC,EAAIC,EAAIC,EAAGC,GAyBzE,IAvBA,IAAIlf,EAASta,KAAKu3B,aACdxe,EAAS/Y,KAAKq3B,aACdoC,EAASz5B,KAAKi5B,UAEdS,EAAmB,EAATD,EACVE,EAAmB,EAATF,EAEVG,EAAKJ,EAAKF,EAEVO,GAAMN,EAAID,GAAOM,EACjBE,EAAKD,EAAIA,EACTE,EAAMD,EAAKD,EAEXG,EAAUX,EAAKM,EACfM,EAAUD,EAAUL,EAEpBO,GAAO,EAAIH,EAAM,EAAID,EACrBK,EAAKJ,EAAMD,EACXM,EAAK,EAAIF,EACTG,EAAKF,EAAKL,EAAKD,EAIT1wB,EAAI,EAAGA,IAAMswB,EAAQtwB,IAAO,CAErC,IAAImxB,EAAKvhB,EAAQkhB,EAAU9wB,EAAIswB,GAC3Bc,EAAKxhB,EAAQkhB,EAAU9wB,EAAIuwB,GAAYE,EACvCY,EAAKzhB,EAAQihB,EAAU7wB,EAAIswB,GAC3BgB,EAAK1hB,EAAQihB,EAAU7wB,GAAMywB,EAEjCtf,EAAQnR,GAAMixB,EAAKE,EAAKD,EAAKE,EAAKL,EAAKM,EAAKL,EAAKM,EAIlD,OAAOngB,GAUR,IAAIogB,EAWK,EAXLA,EAYI,EAZJA,EAaQ,EAbRA,EAcS,EAdTA,EAeQ,EAfRA,EAgBa,EAhBbA,EAiBW,EAKXnC,EAAwB,CAC3BoC,KAAM9Q,UACN+Q,KAAMtQ,WACNuQ,KAAM7Q,WACN8Q,KAAMrQ,YACNsQ,KAAMnQ,YACNoQ,KAAMtR,cAGHuR,EAAgB,CACnBC,KAAMC,gBACNC,KAAMC,eACNC,KAAMC,6BACNC,KAAMC,4BACNC,KAAMC,4BACNC,KAAMC,4BAGHC,EAAkB,CACrBC,MAAOC,sBACPC,MAAOC,yBACPC,MAAOC,kBAGJC,EAAmB,CACtB,OAAU,EACV,KAAQ,EACR,KAAQ,EACR,KAAQ,EACR,KAAQ,EACR,KAAQ,EACR,KAAQ,IAGLnE,EAAa,CAChBoE,SAAU,WACVC,OAAQ,SACRC,QAAS,UACTC,WAAY,KACZC,WAAY,MACZC,QAAS,QACTC,UAAW,aACXC,SAAU,aAGPC,EAAkB,CACrBtuB,MAAO,QACPuuB,YAAa,WACb98B,SAAU,aACV+8B,QAAS,yBAGNC,EAAgB,CACnBC,iBAAal7B,EAEbm7B,OAAQC,oBACRC,KAAMC,uBAGHC,EACK,SADLA,EAEG,OAFHA,EAGI,QAGJC,EAAoB,CACvB,YAAaC,aACb,aAAcC,aAKf,SAASC,EAAYvZ,EAAKR,GAGzB,MAAoB,kBAARQ,GAA4B,KAARA,EAAoB,IAG/C,gBAAgBrF,KAAM6E,IAAU,MAAM7E,KAAMqF,KAEhDR,EAAOA,EAAK1G,QAAS,0BAA2B,OAK5C,mBAAmB6B,KAAMqF,IAGzB,gBAAgBrF,KAAMqF,IAGtB,aAAarF,KAAMqF,GANqBA,EAStCR,EAAOQ,GA2Bf,SAASwZ,EAAgCC,EAAiB/9B,EAAQg+B,GAIjE,IAAM,IAAI7vB,KAAQ6vB,EAAUzP,gBAEMrsB,IAA5B67B,EAAiB5vB,KAErBnO,EAAOi+B,SAASC,eAAiBl+B,EAAOi+B,SAASC,gBAAkB,GACnEl+B,EAAOi+B,SAASC,eAAgB/vB,GAAS6vB,EAAUzP,WAAYpgB,IAYlE,SAASgwB,EAAwBn+B,EAAQo+B,QAEhBl8B,IAAnBk8B,EAAQC,SAEmB,kBAAnBD,EAAQC,OAEnB5yB,OAAOuE,OAAQhQ,EAAOi+B,SAAUG,EAAQC,QAIxC37B,QAAQgB,KAAM,sDAAwD06B,EAAQC,SAqFjF,SAASC,EAAoBC,EAAMC,GAIlC,GAFAD,EAAKD,0BAEoBp8B,IAApBs8B,EAAQtB,QAEZ,IAAM,IAAI7zB,EAAI,EAAGo1B,EAAKD,EAAQtB,QAAQ5zB,OAAQD,EAAIo1B,EAAIp1B,IAErDk1B,EAAKG,sBAAuBr1B,GAAMm1B,EAAQtB,QAAS7zB,GAOrD,GAAKm1B,EAAQH,QAAU5jB,MAAMX,QAAS0kB,EAAQH,OAAOM,aAAgB,CAEpE,IAAIA,EAAcH,EAAQH,OAAOM,YAEjC,GAAKJ,EAAKG,sBAAsBp1B,SAAWq1B,EAAYr1B,OAAS,CAE/Di1B,EAAKK,sBAAwB,GAE7B,IAAUv1B,EAAI,EAAGo1B,EAAKE,EAAYr1B,OAAQD,EAAIo1B,EAAIp1B,IAEjDk1B,EAAKK,sBAAuBD,EAAat1B,IAAQA,OAMlD3G,QAAQgB,KAAM,yEAQjB,SAASm7B,EAAoBC,GAE5B,IAAIC,EAAiBD,EAAavQ,YAAcuQ,EAAavQ,WAAYG,EAAWiB,4BAepF,OAZKoP,EAEU,SAAWA,EAAejH,WACrC,IAAMiH,EAAeC,QACrB,IAAMC,EAAqBF,EAAe3X,YAI/B0X,EAAaE,QAAU,IAAMC,EAAqBH,EAAa1X,YAAe,IAAM0X,EAAaj2B,KAQjH,SAASo2B,EAAqB7X,GAM7B,IAJA,IAAI8X,EAAgB,GAEhBniB,EAAOtR,OAAOsR,KAAMqK,GAAawB,OAE3Bvf,EAAI,EAAGo1B,EAAK1hB,EAAKzT,OAAQD,EAAIo1B,EAAIp1B,IAE1C61B,GAAiBniB,EAAM1T,GAAM,IAAM+d,EAAYrK,EAAM1T,IAAQ,IAI9D,OAAO61B,EAMR,SAAS9O,EAAYvB,EAAMN,EAAY4Q,GAEtCj/B,KAAK2uB,KAAOA,GAAQ,GACpB3uB,KAAKquB,WAAaA,GAAc,GAChCruB,KAAKi/B,QAAUA,GAAW,GAG1Bj/B,KAAKkc,MAAQ,IAAIiR,EAGjBntB,KAAKk/B,aAAe,IAAI1hB,IAGxBxd,KAAKm/B,eAAiB,GAEtBn/B,KAAKo/B,cAAgB,IAAIC,gBAAer/B,KAAKi/B,QAAQpc,SACrD7iB,KAAKo/B,cAAcE,eAAgBt/B,KAAKi/B,QAAQra,aAEhD5kB,KAAKmwB,WAAa,IAAI1L,aAAYzkB,KAAKi/B,QAAQpc,SAC/C7iB,KAAKmwB,WAAWxL,gBAAiB,eAEC,oBAA7B3kB,KAAKi/B,QAAQra,aAEjB5kB,KAAKmwB,WAAWtL,oBAAoB,GAq8BtC,SAAS0a,EAAwBvyB,EAAU4xB,EAAc3O,GAExD,IAAI/I,EAAa0X,EAAa1X,WAE1B0K,EAAU,GAEd,SAAS4N,EAAyBC,EAAetW,GAEhD,OAAO8G,EAAOwI,cAAe,WAAYgH,GACvCt9B,MAAM,SAAWu9B,GAEjB1yB,EAAStJ,aAAcylB,EAAeuW,MAMzC,IAAM,IAAIC,KAAqBzY,EAAa,CAE3C,IAAI+Q,EAAqBC,EAAYyH,IAAuBA,EAAkBxH,cAGzEF,KAAsBjrB,EAASka,YAEpC0K,EAAQhf,KAAM4sB,EAAyBtY,EAAYyY,GAAqB1H,IAIzE,QAA8Bj2B,IAAzB48B,EAAaE,UAA2B9xB,EAASgM,MAAQ,CAE7D,IAAI0mB,EAAWzP,EAAOwI,cAAe,WAAYmG,EAAaE,SAAU38B,MAAM,SAAWu9B,GAExF1yB,EAASga,SAAU0Y,MAIpB9N,EAAQhf,KAAM8sB,GAQf,OAJAzB,EAAwBjxB,EAAU4xB,GA3InC,SAAwB5xB,EAAU4xB,EAAc3O,GAE/C,IAAI/I,EAAa0X,EAAa1X,WAE1B0Y,EAAM,IAAIC,OAEd,QAA6B79B,IAAxBklB,EAAWoV,SAAhB,CAEC,IAEI1lB,GAFA8oB,EAAWzP,EAAOtB,KAAK0J,UAAWnR,EAAWoV,WAE9B1lB,IACf8C,EAAMgmB,EAAShmB,IAInB,QAAa1X,IAAR4U,QAA6B5U,IAAR0X,EAA1B,CAECkmB,EAAIj+B,IACH,IAAIb,UAAS8V,EAAK,GAAKA,EAAK,GAAKA,EAAK,IACtC,IAAI9V,UAAS4Y,EAAK,GAAKA,EAAK,GAAKA,EAAK,KAgBzC,IAAIomB,EAAUlB,EAAakB,QAE3B,QAAiB99B,IAAZ89B,EAAwB,CAK5B,IAHA,IAAIC,EAAkB,IAAIj/B,UACtBk/B,EAAS,IAAIl/B,UAEPqI,EAAI,EAAGo1B,EAAKuB,EAAQ12B,OAAQD,EAAIo1B,EAAIp1B,IAAO,CAEpD,IAAI2nB,EAASgP,EAAS32B,GAEtB,QAAyBnH,IAApB8uB,EAAOwL,SAAyB,CAEpC,IAAIoD,EACA9oB,GADA8oB,EAAWzP,EAAOtB,KAAK0J,UAAWvH,EAAOwL,WAC1B1lB,IACf8C,EAAMgmB,EAAShmB,SAIN1X,IAAR4U,QAA6B5U,IAAR0X,GAGzBsmB,EAAOC,KAAM7+B,KAAKsY,IAAKtY,KAAK4V,IAAKJ,EAAK,IAAOxV,KAAK4V,IAAK0C,EAAK,MAC5DsmB,EAAOE,KAAM9+B,KAAKsY,IAAKtY,KAAK4V,IAAKJ,EAAK,IAAOxV,KAAK4V,IAAK0C,EAAK,MAC5DsmB,EAAOG,KAAM/+B,KAAKsY,IAAKtY,KAAK4V,IAAKJ,EAAK,IAAOxV,KAAK4V,IAAK0C,EAAK,MAM5DqmB,EAAgBrmB,IAAKsmB,IAIrBx9B,QAAQgB,KAAM,wEASjBo8B,EAAIQ,eAAgBL,GAIrB/yB,EAASqzB,YAAcT,EAEvB,IAAIU,EAAS,IAAIC,SAEjBX,EAAIY,UAAWF,EAAOG,QACtBH,EAAO7tB,OAASmtB,EAAIhpB,IAAIxH,WAAYwwB,EAAIlmB,KAAQ,EAEhD1M,EAAS0zB,eAAiBJ,OAlExB99B,QAAQgB,KAAM,wEAsHhBm9B,CAAe3zB,EAAU4xB,EAAc3O,GAEhC3J,QAAQqB,IAAKiK,GAAUzvB,MAAM,WAEnC,YAAgCH,IAAzB48B,EAAakB,QA7pCtB,SAA0B9yB,EAAU8yB,EAAS7P,GAK5C,IAHA,IAAI2Q,GAAmB,EACnBC,GAAiB,EAEX13B,EAAI,EAAGo1B,EAAKuB,EAAQ12B,OAAQD,EAAIo1B,EAAIp1B,IAAO,CAOpD,QAHyBnH,KAFrB8uB,EAASgP,EAAS32B,IAEVmzB,WAAyBsE,GAAmB,QACjC5+B,IAAlB8uB,EAAOyL,SAAuBsE,GAAiB,GAE/CD,GAAoBC,EAAiB,MAI3C,IAAOD,IAAsBC,EAAiB,OAAOva,QAAQC,QAASvZ,GAEtE,IAAI8zB,EAA2B,GAC3BC,EAAyB,GAE7B,IAAU53B,EAAI,EAAGo1B,EAAKuB,EAAQ12B,OAAQD,EAAIo1B,EAAIp1B,IAAO,CAEpD,IAAI2nB,EAASgP,EAAS32B,GAEtB,GAAKy3B,EAAmB,CAEvB,IAAII,OAAsCh/B,IAApB8uB,EAAOwL,SAC1BrM,EAAOwI,cAAe,WAAY3H,EAAOwL,UACzCtvB,EAASka,WAAW3Y,SAEvBuyB,EAAyBluB,KAAMouB,GAIhC,GAAKH,EAAiB,CAEjBG,OAAoCh/B,IAAlB8uB,EAAOyL,OAC1BtM,EAAOwI,cAAe,WAAY3H,EAAOyL,QACzCvvB,EAASka,WAAW1D,OAEvBud,EAAuBnuB,KAAMouB,IAM/B,OAAO1a,QAAQqB,IAAK,CACnBrB,QAAQqB,IAAKmZ,GACbxa,QAAQqB,IAAKoZ,KACV5+B,MAAM,SAAWk2B,GAEpB,IAAI4I,EAAiB5I,EAAW,GAC5B6I,EAAe7I,EAAW,GAM9B,OAJKuI,IAAmB5zB,EAASm0B,gBAAgB5yB,SAAW0yB,GACvDJ,IAAiB7zB,EAASm0B,gBAAgB3d,OAAS0d,GACxDl0B,EAASo0B,sBAAuB,EAEzBp0B,KAmmCJq0B,CAAiBr0B,EAAU4xB,EAAakB,QAAS7P,GACjDjjB,KAWL,SAASs0B,EAAqBt0B,EAAUu0B,GAEvC,IAAIvoB,EAAQhM,EAASw0B,WAIrB,GAAe,OAAVxoB,EAAiB,CAErB,IAAI8lB,EAAU,GAEVvwB,EAAWvB,EAASy0B,aAAc,YAEtC,QAAkBz/B,IAAbuM,EAcJ,OADA/L,QAAQD,MAAO,kGACRyK,EAZP,IAAM,IAAI7D,EAAI,EAAGA,EAAIoF,EAASmzB,MAAOv4B,IAEpC21B,EAAQlsB,KAAMzJ,GAIf6D,EAASga,SAAU8X,GACnB9lB,EAAQhM,EAASw0B,WAanB,IAAIG,EAAoB3oB,EAAM0oB,MAAQ,EAClCE,EAAa,GAEjB,GAAKL,IAAaM,sBAIjB,IAAU14B,EAAI,EAAGA,GAAKw4B,EAAmBx4B,IAExCy4B,EAAWhvB,KAAMoG,EAAM8oB,KAAM,IAC7BF,EAAWhvB,KAAMoG,EAAM8oB,KAAM34B,IAC7By4B,EAAWhvB,KAAMoG,EAAM8oB,KAAM34B,EAAI,SAQlC,IAAUA,EAAI,EAAGA,EAAIw4B,EAAmBx4B,IAElCA,EAAI,IAAM,GAEdy4B,EAAWhvB,KAAMoG,EAAM8oB,KAAM34B,IAC7By4B,EAAWhvB,KAAMoG,EAAM8oB,KAAM34B,EAAI,IACjCy4B,EAAWhvB,KAAMoG,EAAM8oB,KAAM34B,EAAI,MAKjCy4B,EAAWhvB,KAAMoG,EAAM8oB,KAAM34B,EAAI,IACjCy4B,EAAWhvB,KAAMoG,EAAM8oB,KAAM34B,EAAI,IACjCy4B,EAAWhvB,KAAMoG,EAAM8oB,KAAM34B,KAQzBy4B,EAAWx4B,OAAS,IAAQu4B,GAElCn/B,QAAQD,MAAO,2FAMhB,IAAIw/B,EAAc/0B,EAAS8D,QAG3B,OAFAixB,EAAY/a,SAAU4a,GAEfG,EA2vBR,OA10DA7R,EAAWtiB,UAAUogB,MAAQ,SAAW3J,EAAQE,GAE/C,IAAI0L,EAASjwB,KACT2uB,EAAO3uB,KAAK2uB,KACZN,EAAaruB,KAAKquB,WAGtBruB,KAAKkc,MAAMoR,YAGXttB,KAAKgiC,WAEL1b,QAAQqB,IAAK,CAEZ3nB,KAAKiiC,gBAAiB,SACtBjiC,KAAKiiC,gBAAiB,aACtBjiC,KAAKiiC,gBAAiB,YAEnB9/B,MAAM,SAAW+/B,GAEpB,IAAI5nB,EAAS,CACZ6nB,MAAOD,EAAc,GAAKvT,EAAKwT,OAAS,GACxCC,OAAQF,EAAc,GACtBG,WAAYH,EAAc,GAC1BI,QAASJ,EAAc,GACvBtT,MAAOD,EAAKC,MACZqB,OAAQA,EACR8N,SAAU,IAGXH,EAAgCvP,EAAY/T,EAAQqU,GAEpDsP,EAAwB3jB,EAAQqU,GAEhCtK,EAAQ/J,MAELhY,MAAOiiB,IAOZ2L,EAAWtiB,UAAUo0B,SAAW,WAW/B,IATA,IAAIO,EAAWviC,KAAK2uB,KAAK6T,OAAS,GAC9BC,EAAWziC,KAAK2uB,KAAK+T,OAAS,GAC9BC,EAAW3iC,KAAK2uB,KAAKiU,QAAU,GAE/BC,EAAiB,GACjBC,EAAW,GAILC,EAAY,EAAGC,EAAaP,EAASr5B,OAAQ25B,EAAYC,EAAYD,IAI9E,IAFA,IAAIE,EAASR,EAAUM,GAAYE,OAEzB95B,EAAI,EAAGo1B,EAAK0E,EAAO75B,OAAQD,EAAIo1B,EAAIp1B,IAE5Co5B,EAAUU,EAAQ95B,IAAM+5B,QAAS,EAWnC,IAAM,IAAIC,EAAY,EAAGC,EAAab,EAASn5B,OAAQ+5B,EAAYC,EAAYD,IAAe,CAE7F,IAAIE,EAAUd,EAAUY,QAEFnhC,IAAjBqhC,EAAQhF,YAE4Br8B,IAAnC6gC,EAAgBQ,EAAQhF,QAE5BwE,EAAgBQ,EAAQhF,MAASyE,EAAUO,EAAQhF,MAAS,GAI7DwE,EAAgBQ,EAAQhF,aAKFr8B,IAAjBqhC,EAAQC,OAEZX,EAAUU,EAAQhF,MAAOkF,eAAgB,IAQ5CvjC,KAAK2uB,KAAKkU,eAAiBA,EAC3B7iC,KAAK2uB,KAAKmU,SAAWA,GAUtB5S,EAAWtiB,UAAU6qB,cAAgB,SAAWjwB,EAAMwQ,GAErD,IAAIwqB,EAAWh7B,EAAO,IAAMwQ,EACxByqB,EAAazjC,KAAKkc,MAAM1Q,IAAKg4B,GAEjC,IAAOC,EAAa,CAEnB,OAASj7B,GAER,IAAK,QACJi7B,EAAazjC,KAAK0jC,UAAW1qB,GAC7B,MAED,IAAK,OACJyqB,EAAazjC,KAAK2jC,SAAU3qB,GAC5B,MAED,IAAK,OACJyqB,EAAazjC,KAAK4jC,SAAU5qB,GAC5B,MAED,IAAK,WACJyqB,EAAazjC,KAAK6jC,aAAc7qB,GAChC,MAED,IAAK,aACJyqB,EAAazjC,KAAK8jC,eAAgB9qB,GAClC,MAED,IAAK,SACJyqB,EAAazjC,KAAK+jC,WAAY/qB,GAC9B,MAED,IAAK,WACJyqB,EAAazjC,KAAKgkC,aAAchrB,GAChC,MAED,IAAK,UACJyqB,EAAazjC,KAAKikC,YAAajrB,GAC/B,MAED,IAAK,OACJyqB,EAAazjC,KAAKkkC,SAAUlrB,GAC5B,MAED,IAAK,YACJyqB,EAAazjC,KAAKmkC,cAAenrB,GACjC,MAED,IAAK,SACJyqB,EAAazjC,KAAKokC,WAAYprB,GAC9B,MAED,IAAK,QACJyqB,EAAazjC,KAAKquB,WAAYG,EAAWS,qBAAsBsB,UAAWvX,GAC1E,MAED,QACC,MAAM,IAAIgN,MAAO,iBAAmBxd,GAItCxI,KAAKkc,MAAM/T,IAAKq7B,EAAUC,GAI3B,OAAOA,GASRvT,EAAWtiB,UAAUq0B,gBAAkB,SAAWz5B,GAEjD,IAAI05B,EAAeliC,KAAKkc,MAAM1Q,IAAKhD,GAEnC,IAAO05B,EAAe,CAErB,IAAIjS,EAASjwB,KACTqkC,EAAOrkC,KAAK2uB,KAAMnmB,GAAkB,SAATA,EAAkB,KAAO,OAAW,GAEnE05B,EAAe5b,QAAQqB,IAAK0c,EAAKvkB,KAAK,SAAWwkB,EAAKtrB,GAErD,OAAOiX,EAAOwI,cAAejwB,EAAMwQ,OAIpChZ,KAAKkc,MAAM/T,IAAKK,EAAM05B,GAIvB,OAAOA,GASRhS,EAAWtiB,UAAUm2B,WAAa,SAAWQ,GAE5C,IAAIC,EAAYxkC,KAAK2uB,KAAKhC,QAAS4X,GAC/B/f,EAASxkB,KAAKmwB,WAElB,GAAKqU,EAAUh8B,MAA2B,gBAAnBg8B,EAAUh8B,KAEhC,MAAM,IAAIwd,MAAO,qBAAuBwe,EAAUh8B,KAAO,kCAK1D,QAAuBxG,IAAlBwiC,EAAUC,KAAqC,IAAhBF,EAEnC,OAAOje,QAAQC,QAASvmB,KAAKquB,WAAYG,EAAWC,iBAAkB3N,MAIvE,IAAIme,EAAUj/B,KAAKi/B,QAEnB,OAAO,IAAI3Y,SAAS,SAAWC,EAASC,GAEvChC,EAAOL,KAAMwZ,EAAY6G,EAAUC,IAAKxF,EAAQrb,MAAQ2C,OAASvkB,GAAW,WAE3EwkB,EAAQ,IAAIR,MAAO,4CAA8Cwe,EAAUC,IAAM,cAapFvU,EAAWtiB,UAAUk2B,eAAiB,SAAWnM,GAEhD,IAAI+M,EAAgB1kC,KAAK2uB,KAAKgW,YAAahN,GAE3C,OAAO33B,KAAKy4B,cAAe,SAAUiM,EAAc5f,QAAS3iB,MAAM,SAAW2iB,GAE5E,IAAIiB,EAAa2e,EAAc3e,YAAc,EACzCyN,EAAakR,EAAclR,YAAc,EAC7C,OAAO1O,EAAOmO,MAAOO,EAAYA,EAAazN,OAWhDmK,EAAWtiB,UAAUi2B,aAAe,SAAWpE,GAE9C,IAAIxP,EAASjwB,KACT2uB,EAAO3uB,KAAK2uB,KAEZyJ,EAAcp4B,KAAK2uB,KAAK0J,UAAWoH,GAEvC,QAAgCz9B,IAA3Bo2B,EAAYR,iBAAmD51B,IAAvBo2B,EAAYwM,OAKxD,OAAOte,QAAQC,QAAS,MAIzB,IAAIse,EAAqB,GAmBzB,YAjBgC7iC,IAA3Bo2B,EAAYR,WAEhBiN,EAAmBjyB,KAAM5S,KAAKy4B,cAAe,aAAcL,EAAYR,aAIvEiN,EAAmBjyB,KAAM,WAIE5Q,IAAvBo2B,EAAYwM,SAEhBC,EAAmBjyB,KAAM5S,KAAKy4B,cAAe,aAAcL,EAAYwM,OAAO9F,QAAQlH,aACtFiN,EAAmBjyB,KAAM5S,KAAKy4B,cAAe,aAAcL,EAAYwM,OAAO7rB,OAAO6e,cAI/EtR,QAAQqB,IAAKkd,GAAqB1iC,MAAM,SAAWwiC,GAEzD,IAWI7rB,EAAOgsB,EAXPlN,EAAa+M,EAAa,GAE1Bxd,EAAWkV,EAAkBjE,EAAY5vB,MACzCu8B,EAAaxM,EAAuBH,EAAYE,eAGhD0M,EAAeD,EAAWxf,kBAC1B0f,EAAYD,EAAe7d,EAC3BqM,EAAa4E,EAAY5E,YAAc,EACvC0R,OAAwCljC,IAA3Bo2B,EAAYR,WAA2BjJ,EAAKgW,YAAavM,EAAYR,YAAasN,gBAAaljC,EAC5Gw2B,GAAwC,IAA3BJ,EAAYI,WAI7B,GAAK0M,GAAcA,IAAeD,EAAY,CAI7C,IAAIE,EAAU/jC,KAAKgkC,MAAO5R,EAAa0R,GACnCG,EAAa,qBAAuBjN,EAAYR,WAAa,IAAMQ,EAAYE,cAAgB,IAAM6M,EAAU,IAAM/M,EAAYsJ,MACjI4D,EAAKrV,EAAO/T,MAAM1Q,IAAK65B,GAEpBC,IAENxsB,EAAQ,IAAIisB,EAAYnN,EAAYuN,EAAUD,EAAY9M,EAAYsJ,MAAQwD,EAAaF,GAG3FM,EAAK,IAAIC,oBAAmBzsB,EAAOosB,EAAaF,GAEhD/U,EAAO/T,MAAM/T,IAAKk9B,EAAYC,IAI/BR,EAAkB,IAAIU,6BAA4BF,EAAIne,EAAYqM,EAAa0R,EAAeF,EAAcxM,QAM3G1f,EAFmB,OAAf8e,EAEI,IAAImN,EAAY3M,EAAYsJ,MAAQva,GAIpC,IAAI4d,EAAYnN,EAAYpE,EAAY4E,EAAYsJ,MAAQva,GAIrE2d,EAAkB,IAAI7d,kBAAiBnO,EAAOqO,EAAUqR,GAKzD,QAA4Bx2B,IAAvBo2B,EAAYwM,OAAuB,CAEvC,IAAIa,EAAkBpJ,EAAiBqJ,OACnCC,EAAoBpN,EAAuBH,EAAYwM,OAAO9F,QAAQxG,eAEtEsN,EAAoBxN,EAAYwM,OAAO9F,QAAQtL,YAAc,EAC7DqS,EAAmBzN,EAAYwM,OAAO7rB,OAAOya,YAAc,EAE3DsS,EAAgB,IAAIH,EAAmBhB,EAAa,GAAKiB,EAAmBxN,EAAYwM,OAAOlD,MAAQ+D,GACvGM,EAAe,IAAIhB,EAAYJ,EAAa,GAAKkB,EAAkBzN,EAAYwM,OAAOlD,MAAQva,GAE9E,OAAfyQ,IAGJkN,EAAkB,IAAI7d,kBAAiB6d,EAAgBhsB,MAAMma,QAAS6R,EAAgB3d,SAAU2d,EAAgBtM,aAIjH,IAAM,IAAIrvB,EAAI,EAAGo1B,EAAKuH,EAAc18B,OAAQD,EAAIo1B,EAAIp1B,IAAO,CAE1D,IAAI6P,EAAQ8sB,EAAe38B,GAM3B,GAJA27B,EAAgB7E,KAAMjnB,EAAO+sB,EAAc58B,EAAIge,IAC1CA,GAAY,GAAI2d,EAAgB5E,KAAMlnB,EAAO+sB,EAAc58B,EAAIge,EAAW,IAC1EA,GAAY,GAAI2d,EAAgB3E,KAAMnnB,EAAO+sB,EAAc58B,EAAIge,EAAW,IAC1EA,GAAY,GAAI2d,EAAgBkB,KAAMhtB,EAAO+sB,EAAc58B,EAAIge,EAAW,IAC1EA,GAAY,EAAI,MAAM,IAAInB,MAAO,sEAMxC,OAAO8e,MAWT5U,EAAWtiB,UAAUq2B,YAAc,SAAWgC,GAE7C,IAWIlN,EAXA9I,EAASjwB,KACT2uB,EAAO3uB,KAAK2uB,KACZsQ,EAAUj/B,KAAKi/B,QACfG,EAAgBp/B,KAAKo/B,cAErBjX,EAAM5P,KAAK4P,KAAO5P,KAAK2tB,UAEvBC,EAAaxX,EAAKyX,SAAUH,GAE5BI,EAAoBF,EAAW9X,YAAc,GAc7CiY,GARHvN,EAFIsN,EAAmB7X,EAAWmB,kBAEzBhB,EAAK4X,OAAQF,EAAmB7X,EAAWmB,kBAAmBoJ,QAI9DpK,EAAK4X,OAAQJ,EAAWpN,SAIX0L,IACnB+B,GAAc,EAiBlB,YAf2BxkC,IAAtB+2B,EAAOnB,aAIX0O,EAAYrW,EAAOwI,cAAe,aAAcM,EAAOnB,YAAaz1B,MAAM,SAAWy1B,GAEpF4O,GAAc,EACd,IAAIC,EAAO,IAAIpe,KAAM,CAAEuP,GAAc,CAAEpvB,KAAMuwB,EAAO2N,WAEpD,OADAJ,EAAYne,EAAIC,gBAAiBqe,OAO5BngB,QAAQC,QAAS+f,GAAYnkC,MAAM,SAAWmkC,GAIpD,IAAI9hB,EAASya,EAAQpc,QAAQ8jB,WAAYL,GAUzC,OARO9hB,IAENA,EAAS6hB,EAAmB7X,EAAWmB,kBACpCM,EAAO5B,WAAYG,EAAWmB,kBAAmBzC,UACjDkS,GAIG,IAAI9Y,SAAS,SAAWC,EAASC,GAEvChC,EAAOL,KAAMwZ,EAAY2I,EAAWrH,EAAQrb,MAAQ2C,OAASvkB,EAAWwkB,SAItErkB,MAAM,SAAWw2B,IAIC,IAAhB6N,GAEJre,EAAIye,gBAAiBN,GAItB3N,EAAQkO,OAAQ,EAEXV,EAAWl4B,OAAO0qB,EAAQ1qB,KAAOk4B,EAAWl4B,MAG5C8qB,EAAO2N,YAAYlJ,IAEvB7E,EAAQmO,OAAStJ,EAAmBzE,EAAO2N,WAI5C,IACIK,GADWpY,EAAKqY,UAAY,IACRb,EAAWY,UAAa,GAYhD,OAVApO,EAAQsO,UAAYhM,EAAe8L,EAAQE,YAAe5L,eAC1D1C,EAAQuO,UAAYjM,EAAe8L,EAAQG,YAAerL,2BAC1DlD,EAAQwO,MAAQrL,EAAiBiL,EAAQI,QAAW/K,iBACpDzD,EAAQyO,MAAQtL,EAAiBiL,EAAQK,QAAWhL,iBAEpDnM,EAAOiP,aAAav9B,IAAKg3B,EAAS,CACjCnwB,KAAM,WACNwQ,MAAOitB,IAGDtN,MAaTzI,EAAWtiB,UAAUqkB,cAAgB,SAAWP,EAAgB2V,EAASC,GAExE,IAAIrX,EAASjwB,KAEb,OAAOA,KAAKy4B,cAAe,UAAW6O,EAAOtuB,OAAQ7W,MAAM,SAAWw2B,GAErE,IAAOA,EAAQ4O,oBAEd,OAASF,GAER,IAAK,QACL,IAAK,cACL,IAAK,eACL,IAAK,YACL,IAAK,eACJ1O,EAAQmO,OAASpJ,YAepB,QANyB17B,IAApBslC,EAAOzO,UAA6C,GAAnByO,EAAOzO,UAAiC,UAAZwO,GAA0C,GAAnBC,EAAOzO,UAE/Fr2B,QAAQgB,KAAM,mCAAqC8jC,EAAOzO,SAAW,gBAAkBwO,EAAU,uBAI7FpX,EAAO5B,WAAYG,EAAWqB,uBAA0B,CAE5D,IAAIxT,OAAkCra,IAAtBslC,EAAOjZ,WAA2BiZ,EAAOjZ,WAAYG,EAAWqB,4BAA0B7tB,EAE1G,GAAKqa,EAAY,CAEhB,IAAImrB,EAAgBvX,EAAOiP,aAAa1zB,IAAKmtB,GAC7CA,EAAU1I,EAAO5B,WAAYG,EAAWqB,uBAAwB6I,cAAeC,EAAStc,GACxF4T,EAAOiP,aAAav9B,IAAKg3B,EAAS6O,IAMpC9V,EAAgB2V,GAAY1O,MAc9BzI,EAAWtiB,UAAU65B,oBAAsB,SAAWpJ,GAErD,IAAIrxB,EAAWqxB,EAAKrxB,SAChBC,EAAWoxB,EAAKpxB,SAEhBy6B,OAAoD1lC,IAAhCgL,EAASka,WAAWygB,QACxCC,OAAgD5lC,IAA9BgL,EAASka,WAAWhW,MACtC22B,OAAgD7lC,IAA/BgL,EAASka,WAAW1D,OACrCskB,GAAqC,IAAvBzJ,EAAKkF,cACnBwE,EAAkBx8B,OAAOsR,KAAM7P,EAASm0B,iBAAkB/3B,OAAS,EACnE4+B,EAAkBD,QAAuD/lC,IAApCgL,EAASm0B,gBAAgB3d,OAElE,GAAK6a,EAAK4J,SAAW,CAEpB,IAAIzE,EAAW,kBAAoBv2B,EAASi7B,KAExCC,EAAiBnoC,KAAKkc,MAAM1Q,IAAKg4B,GAE9B2E,IAENA,EAAiB,IAAIC,iBACrBC,WAASz6B,UAAUH,KAAK1F,KAAMogC,EAAgBl7B,GAC9Ck7B,EAAej3B,MAAMzD,KAAMR,EAASiE,OACpCi3B,EAAeroB,IAAM7S,EAAS6S,IAC9BqoB,EAAeG,iBAAkB,EAEjCtoC,KAAKkc,MAAM/T,IAAKq7B,EAAU2E,IAI3Bl7B,EAAWk7B,OAEL,GAAK9J,EAAKkK,OAAS,CAErB/E,EAAW,qBAAuBv2B,EAASi7B,KAA/C,IAEIM,EAAexoC,KAAKkc,MAAM1Q,IAAKg4B,GAE5BgF,IAENA,EAAe,IAAI73B,oBACnB03B,WAASz6B,UAAUH,KAAK1F,KAAMygC,EAAcv7B,GAC5Cu7B,EAAat3B,MAAMzD,KAAMR,EAASiE,OAElClR,KAAKkc,MAAM/T,IAAKq7B,EAAUgF,IAI3Bv7B,EAAWu7B,EAKZ,GAAKd,GAAqBE,GAAmBC,GAAkBC,GAAeC,EAAkB,CAE3FvE,EAAW,kBAAoBv2B,EAASi7B,KAAO,IAE9Cj7B,EAAS2mB,mCAAmC4P,GAAY,wBACxDsE,IAActE,GAAY,aAC1BkE,IAAoBlE,GAAY,oBAChCoE,IAAkBpE,GAAY,kBAC9BqE,IAAiBrE,GAAY,iBAC7BuE,IAAkBvE,GAAY,kBAC9BwE,IAAkBxE,GAAY,kBAEnC,IAAIiF,EAAiBzoC,KAAKkc,MAAM1Q,IAAKg4B,GAE9BiF,IAENA,EAAiBx7B,EAAS6D,QAErBg3B,IAAcW,EAAeC,UAAW,GACxChB,IAAoBe,EAAeE,gBAAiB,GACpDf,IAAkBa,EAAeG,cAAe,GAChDf,IAAiBY,EAAeI,aAAc,GAC9Cd,IAAkBU,EAAeK,cAAe,GAChDd,IAAkBS,EAAevH,cAAe,GAErDlhC,KAAKkc,MAAM/T,IAAKq7B,EAAUiF,GAE1BzoC,KAAKk/B,aAAav9B,IAAK8mC,EAAgBzoC,KAAKk/B,aAAa1zB,IAAKyB,KAI/DA,EAAWw7B,EAMPx7B,EAASipB,YAAqCl0B,IAA5BgL,EAASka,WAAW6hB,UAAgD/mC,IAA3BgL,EAASka,WAAWzD,IAEnFzW,EAAStJ,aAAc,MAAOsJ,EAASka,WAAWzD,IAK9CxW,EAAS0pB,cAAiB+Q,IAE9Bz6B,EAAS0pB,YAAYhwB,GAAMsG,EAAS0pB,YAAYhwB,GAI5CsG,EAASylB,uBAA0BgV,IAEvCz6B,EAASylB,qBAAqB/rB,GAAMsG,EAASylB,qBAAqB/rB,GAInE03B,EAAKpxB,SAAWA,GASjBijB,EAAWtiB,UAAUo2B,aAAe,SAAWgF,GAE9C,IAKIC,EALAhZ,EAASjwB,KACT2uB,EAAO3uB,KAAK2uB,KACZN,EAAaruB,KAAKquB,WAClBsD,EAAchD,EAAKua,UAAWF,GAG9BtX,EAAiB,GACjByX,EAAqBxX,EAAYtD,YAAc,GAE/CuD,EAAU,GAEd,GAAKuX,EAAoB3a,EAAWe,uCAA0C,CAE7E,IAAI6Z,EAAc/a,EAAYG,EAAWe,uCACzC0Z,EAAeG,EAAY5X,kBAC3BI,EAAQhf,KAAMw2B,EAAY3X,aAAcC,EAAgBC,EAAa1B,SAE/D,GAAKkZ,EAAoB3a,EAAWa,qBAAwB,CAElE,IAAIga,EAAehb,EAAYG,EAAWa,qBAC1C4Z,EAAeI,EAAa7X,kBAC5BI,EAAQhf,KAAMy2B,EAAa5X,aAAcC,EAAgBC,EAAa1B,QAEhE,CAKNgZ,EAAetV,uBAEf,IAAI9B,EAAoBF,EAAYG,sBAAwB,GAK5D,GAHAJ,EAAexgB,MAAQ,IAAI4G,QAAO,EAAK,EAAK,GAC5C4Z,EAAe3gB,QAAU,EAEpBwJ,MAAMX,QAASiY,EAAkBE,iBAAoB,CAEzD,IAAIjZ,EAAQ+Y,EAAkBE,gBAE9BL,EAAexgB,MAAMyf,UAAW7X,GAChC4Y,EAAe3gB,QAAU+H,EAAO,QAIW9W,IAAvC6vB,EAAkBG,kBAEtBJ,EAAQhf,KAAMqd,EAAOgC,cAAeP,EAAgB,MAAOG,EAAkBG,mBAI9EN,EAAeuD,eAAiDjzB,IAArC6vB,EAAkByX,eAA+BzX,EAAkByX,eAAiB,EAC/G5X,EAAewD,eAAkDlzB,IAAtC6vB,EAAkB0X,gBAAgC1X,EAAkB0X,gBAAkB,OAE7DvnC,IAA/C6vB,EAAkB2X,2BAEtB5X,EAAQhf,KAAMqd,EAAOgC,cAAeP,EAAgB,eAAgBG,EAAkB2X,2BACtF5X,EAAQhf,KAAMqd,EAAOgC,cAAeP,EAAgB,eAAgBG,EAAkB2X,6BAMvD,IAA5B7X,EAAY8X,cAEhB/X,EAAenhB,KAAOC,cAIvB,IAAIk5B,EAAY/X,EAAY+X,WAAanM,EA2DzC,GAzDKmM,IAAcnM,GAElB7L,EAAephB,aAAc,EAG7BohB,EAAerhB,YAAa,IAI5BqhB,EAAephB,aAAc,EAExBo5B,IAAcnM,IAElB7L,EAAeiY,eAAwC3nC,IAA5B2vB,EAAYiY,YAA4BjY,EAAYiY,YAAc,UAM5D5nC,IAA9B2vB,EAAYkY,eAA+BZ,IAAiB94B,sBAEhEyhB,EAAQhf,KAAMqd,EAAOgC,cAAeP,EAAgB,YAAaC,EAAYkY,gBAE7EnY,EAAeiF,YAAc,IAAIhE,UAAS,EAAG,QAEJ3wB,IAApC2vB,EAAYkY,cAAcr7B,OAE9BkjB,EAAeiF,YAAYh1B,IAAKgwB,EAAYkY,cAAcr7B,MAAOmjB,EAAYkY,cAAcr7B,aAMvDxM,IAAjC2vB,EAAYmY,kBAAkCb,IAAiB94B,sBAEnEyhB,EAAQhf,KAAMqd,EAAOgC,cAAeP,EAAgB,QAASC,EAAYmY,wBAE1B9nC,IAA1C2vB,EAAYmY,iBAAiBC,WAEjCrY,EAAeyE,eAAiBxE,EAAYmY,iBAAiBC,gBAM3B/nC,IAA/B2vB,EAAYqY,gBAAgCf,IAAiB94B,sBAEjEuhB,EAAegE,UAAW,IAAI5d,SAAQ6Y,UAAWgB,EAAYqY,sBAIzBhoC,IAAhC2vB,EAAYsY,iBAAiChB,IAAiB94B,qBAElEyhB,EAAQhf,KAAMqd,EAAOgC,cAAeP,EAAgB,cAAeC,EAAYsY,kBAI3Ed,EAAoB3a,EAAWW,yBAA4B,CAE/D,IAAI+a,EAAqB7b,EAAYG,EAAWW,yBAChD8Z,EAAeiB,EAAmB1Y,kBAClCI,EAAQhf,KAAMs3B,EAAmBzY,aAAcC,EAAgB,CAAErD,WAAY8a,GAAsBlZ,IAIpG,OAAO3J,QAAQqB,IAAKiK,GAAUzvB,MAAM,WAEnC,IAAI8K,EAwBJ,OApBCA,EAFIg8B,IAAiBxV,EAEVpF,EAAYG,EAAWe,uCAAwCwG,eAAgBrE,GAI/E,IAAIuX,EAAcvX,GAIzBC,EAAY1jB,OAAOhB,EAASgB,KAAO0jB,EAAY1jB,MAG/ChB,EAAS6S,MAAM7S,EAAS6S,IAAIqqB,SAAWC,gBACvCn9B,EAASopB,cAAcppB,EAASopB,YAAY8T,SAAWC,gBAE5DnM,EAAwBhxB,EAAU0kB,GAElC1B,EAAOiP,aAAav9B,IAAKsL,EAAU,CAAEzE,KAAM,YAAawQ,MAAOgwB,IAE1DrX,EAAYtD,YAAauP,EAAgCvP,EAAYphB,EAAU0kB,GAE7E1kB,MA0QTijB,EAAWtiB,UAAUy8B,eAAiB,SAAWC,GAEhD,IAAIra,EAASjwB,KACTquB,EAAaruB,KAAKquB,WAClBnS,EAAQlc,KAAKm/B,eAEjB,SAASoL,EAAsB7S,GAE9B,OAAOrJ,EAAYG,EAAWiB,4BAC5BgI,gBAAiBC,EAAWzH,GAC5B9tB,MAAM,SAAW6K,GAEjB,OAAOuyB,EAAwBvyB,EAAU0qB,EAAWzH,MAQvD,IAFA,IAAI2B,EAAU,GAEJzoB,EAAI,EAAGo1B,EAAK+L,EAAWlhC,OAAQD,EAAIo1B,EAAIp1B,IAAO,CAEvD,IAaKqhC,EAbD9S,EAAY4S,EAAYnhC,GACxBq6B,EAAW7E,EAAoBjH,GAG/B+S,EAASvuB,EAAOsnB,GAEpB,GAAKiH,EAGJ7Y,EAAQhf,KAAM63B,EAAO3kB,cASpB0kB,EAHI9S,EAAUrJ,YAAcqJ,EAAUrJ,WAAYG,EAAWiB,4BAG3C8a,EAAsB7S,GAKtB6H,EAAwB,IAAIjtB,iBAAkBolB,EAAWzH,GAK5E/T,EAAOsnB,GAAa,CAAE9L,UAAWA,EAAW5R,QAAS0kB,GAErD5Y,EAAQhf,KAAM43B,GAMhB,OAAOlkB,QAAQqB,IAAKiK,IASrB1B,EAAWtiB,UAAUg2B,SAAW,SAAW8G,GAU1C,IARA,IAn5C+BxuB,EAm5C3B+T,EAASjwB,KAGTs+B,EAFOt+B,KAAK2uB,KAEGiU,OAAQ8H,GACvBJ,EAAahM,EAAQgM,WAErB1Y,EAAU,GAEJzoB,EAAI,EAAGo1B,EAAK+L,EAAWlhC,OAAQD,EAAIo1B,EAAIp1B,IAAO,CAEvD,IAAI8D,OAAwCjL,IAA7BsoC,EAAYnhC,GAAI8D,eA35CIjL,KAFLka,EA85CJlc,KAAKkc,OA55CtB,kBAETA,EAAK,gBAAwB,IAAIyX,uBAAsB,CACtDziB,MAAO,SACPwkB,SAAU,EACVT,UAAW,EACXC,UAAW,EACX5kB,aAAa,EACbF,WAAW,EACXG,KAAMo6B,eAKDzuB,EAAK,iBA+4CRlc,KAAKy4B,cAAe,WAAY6R,EAAYnhC,GAAI8D,UAEnD2kB,EAAQhf,KAAM3F,GAMf,OAFA2kB,EAAQhf,KAAMqd,EAAOoa,eAAgBC,IAE9BhkB,QAAQqB,IAAKiK,GAAUzvB,MAAM,SAAWyoC,GAO9C,IALA,IAAI1B,EAAY0B,EAAQ3X,MAAO,EAAG2X,EAAQxhC,OAAS,GAC/CyhC,EAAaD,EAASA,EAAQxhC,OAAS,GAEvCw5B,EAAS,GAEHz5B,EAAI,EAAGo1B,EAAKsM,EAAWzhC,OAAQD,EAAIo1B,EAAIp1B,IAAO,CAEvD,IAKIk1B,EALArxB,EAAW69B,EAAY1hC,GACvBuuB,EAAY4S,EAAYnhC,GAMxB8D,EAAWi8B,EAAW//B,GAE1B,GAAKuuB,EAAU/uB,OAAS+xB,GACvBhD,EAAU/uB,OAAS+xB,GACnBhD,EAAU/uB,OAAS+xB,QACA14B,IAAnB01B,EAAU/uB,MAOkB,KAJ5B01B,GAAiC,IAA1BC,EAAQiF,cACZ,IAAIuH,cAAa99B,EAAUC,GAC3B,IAAIgG,OAAMjG,EAAUC,IAEbs2B,eAA4BlF,EAAKrxB,SAASka,WAAW6jB,WAAWvS,YAIzE6F,EAAK2M,uBAIDtT,EAAU/uB,OAAS+xB,EAEvB2D,EAAKrxB,SAAWs0B,EAAqBjD,EAAKrxB,SAAUi+B,yBAEzCvT,EAAU/uB,OAAS+xB,IAE9B2D,EAAKrxB,SAAWs0B,EAAqBjD,EAAKrxB,SAAU60B,6BAI/C,GAAKnK,EAAU/uB,OAAS+xB,EAE9B2D,EAAO,IAAI6M,eAAcl+B,EAAUC,QAE7B,GAAKyqB,EAAU/uB,OAAS+xB,EAE9B2D,EAAO,IAAInrB,OAAMlG,EAAUC,QAErB,GAAKyqB,EAAU/uB,OAAS+xB,EAE9B2D,EAAO,IAAI8M,WAAUn+B,EAAUC,OAEzB,IAAKyqB,EAAU/uB,OAAS+xB,EAM9B,MAAM,IAAI1U,MAAO,iDAAmD0R,EAAU/uB,MAJ9E01B,EAAO,IAAI+M,SAAQp+B,EAAUC,GAQzB1B,OAAOsR,KAAMwhB,EAAKrxB,SAASm0B,iBAAkB/3B,OAAS,GAE1Dg1B,EAAoBC,EAAMC,GAI3BD,EAAKpwB,KAAOqwB,EAAQrwB,MAAU,QAAUy8B,EAEnCG,EAAWzhC,OAAS,IAAIi1B,EAAKpwB,MAAQ,IAAM9E,GAEhD80B,EAAwBI,EAAMC,GAE9BrO,EAAOwX,oBAAqBpJ,GAE5BuE,EAAOhwB,KAAMyrB,GAId,GAAuB,IAAlBuE,EAAOx5B,OAEX,OAAOw5B,EAAQ,GAIhB,IAAIyI,EAAQ,IAAIC,QAEhB,IAAUniC,EAAI,EAAGo1B,EAAKqE,EAAOx5B,OAAQD,EAAIo1B,EAAIp1B,IAE5CkiC,EAAMljC,IAAKy6B,EAAQz5B,IAIpB,OAAOkiC,MAWTnb,EAAWtiB,UAAUw2B,WAAa,SAAWmH,GAE5C,IAAI1jC,EACA2jC,EAAYxrC,KAAK2uB,KAAK2T,QAASiJ,GAC/B7X,EAAS8X,EAAWA,EAAUhjC,MAElC,GAAOkrB,EAqBP,MAdwB,gBAAnB8X,EAAUhjC,KAEdX,EAAS,IAAI4jC,oBAAmB5oC,YAAU6oC,SAAUhY,EAAOiY,MAAQjY,EAAOkY,aAAe,EAAGlY,EAAOmY,OAAS,EAAGnY,EAAOoY,MAAQ,KAEhG,iBAAnBN,EAAUhjC,OAErBX,EAAS,IAAIkkC,sBAAsBrY,EAAOsY,KAAMtY,EAAOsY,KAAMtY,EAAOuY,MAAQvY,EAAOuY,KAAMvY,EAAOmY,MAAOnY,EAAOoY,OAI1GN,EAAUv9B,OAAOpG,EAAOoG,KAAOu9B,EAAUv9B,MAE9CgwB,EAAwBp2B,EAAQ2jC,GAEzBllB,QAAQC,QAAS1e,GAnBvBrF,QAAQgB,KAAM,iDA4BhB0sB,EAAWtiB,UAAUs2B,SAAW,SAAWnB,GAE1C,IAAImJ,EAAUlsC,KAAK2uB,KAAK+T,MAAOK,GAE3BoJ,EAAY,CAAElJ,OAAQiJ,EAAQjJ,QAElC,YAAqCjhC,IAAhCkqC,EAAQE,oBAEL9lB,QAAQC,QAAS4lB,GAIlBnsC,KAAKy4B,cAAe,WAAYyT,EAAQE,qBAAsBjqC,MAAM,SAAWu9B,GAIrF,OAFAyM,EAAUC,oBAAsB1M,EAEzByM,MAWTjc,EAAWtiB,UAAUu2B,cAAgB,SAAWkI,GAY/C,IAVA,IAEIC,EAFOtsC,KAAK2uB,KAEQ0T,WAAYgK,GAEhCE,EAAe,GACfC,EAAwB,GACxBC,EAAyB,GACzBC,EAAkB,GAClBC,EAAiB,GAEXxjC,EAAI,EAAGo1B,EAAK+N,EAAaM,SAASxjC,OAAQD,EAAIo1B,EAAIp1B,IAAO,CAElE,IAAI0jC,EAAUP,EAAaM,SAAUzjC,GACjC49B,EAAUuF,EAAatF,SAAU6F,EAAQ9F,SACzCjW,EAAS+b,EAAQ/b,OACjB7iB,OAAuBjM,IAAhB8uB,EAAOgc,KAAqBhc,EAAOgc,KAAOhc,EAAOnK,GACxDomB,OAAoC/qC,IAA5BsqC,EAAaU,WAA2BV,EAAaU,WAAYjG,EAAQgG,OAAUhG,EAAQgG,MACnGE,OAAqCjrC,IAA5BsqC,EAAaU,WAA2BV,EAAaU,WAAYjG,EAAQkG,QAAWlG,EAAQkG,OAEzGV,EAAa35B,KAAM5S,KAAKy4B,cAAe,OAAQxqB,IAC/Cu+B,EAAsB55B,KAAM5S,KAAKy4B,cAAe,WAAYsU,IAC5DN,EAAuB75B,KAAM5S,KAAKy4B,cAAe,WAAYwU,IAC7DP,EAAgB95B,KAAMm0B,GACtB4F,EAAe/5B,KAAMke,GAItB,OAAOxK,QAAQqB,IAAK,CAEnBrB,QAAQqB,IAAK4kB,GACbjmB,QAAQqB,IAAK6kB,GACblmB,QAAQqB,IAAK8kB,GACbnmB,QAAQqB,IAAK+kB,GACbpmB,QAAQqB,IAAKglB,KAEVxqC,MAAM,SAAW+/B,GAUpB,IARA,IAAIM,EAAQN,EAAc,GACtBgL,EAAiBhL,EAAc,GAC/BiL,EAAkBjL,EAAc,GAChC8E,EAAW9E,EAAc,GACzBpC,EAAUoC,EAAc,GAExBkL,EAAS,GAEHjkC,EAAI,EAAGo1B,EAAKiE,EAAMp5B,OAAQD,EAAIo1B,EAAIp1B,IAAO,CAElD,IAAI2jC,EAAOtK,EAAOr5B,GACdkkC,EAAgBH,EAAgB/jC,GAChCmkC,EAAiBH,EAAiBhkC,GAClC49B,EAAUC,EAAU79B,GACpB2nB,EAASgP,EAAS32B,GAEtB,QAAcnH,IAAT8qC,EAAL,CAKA,IAAIS,EAEJ,OALAT,EAAK73B,eACL63B,EAAKU,kBAAmB,EAIf1Q,EAAiBhM,EAAOlN,OAEhC,KAAKkZ,EAAgBE,QAEpBuQ,EAAqBE,sBACrB,MAED,KAAK3Q,EAAgB78B,SAEpBstC,EAAqBG,0BACrB,MAED,KAAK5Q,EAAgBvuB,SACrB,KAAKuuB,EAAgBtuB,MACrB,QAEC++B,EAAqBI,sBAKvB,IAAIC,EAAad,EAAK7+B,KAAO6+B,EAAK7+B,KAAO6+B,EAAK5E,KAE1C2F,OAA0C7rC,IAA1B+kC,EAAQ8G,cAA8B5Q,EAAe8J,EAAQ8G,eAAkBzQ,oBAE/FqB,EAAc,GAEb3B,EAAiBhM,EAAOlN,QAAWkZ,EAAgBE,QAGvD8P,EAAKhgC,UAAU,SAAWhN,IAEF,IAAlBA,EAAOguC,QAAmBhuC,EAAO0+B,uBAErCC,EAAY7rB,KAAM9S,EAAOmO,KAAOnO,EAAOmO,KAAOnO,EAAOooC,SAQvDzJ,EAAY7rB,KAAMg7B,GAInB,IAAIG,EAAcT,EAAex0B,MAEjC,GAAKw0B,EAAe9U,WAAa,CAEhC,IAAIhqB,EAEJ,GAAKu/B,EAAY/9B,cAAgB6Z,UAEhCrb,EAAQ,EAAI,SAEN,GAAKu/B,EAAY/9B,cAAgBsa,WAEvC9b,EAAQ,EAAI,SAEN,GAAKu/B,EAAY/9B,aAAega,WAEtCxb,EAAQ,EAAI,UAEN,IAAKu/B,EAAY/9B,cAAgBya,YAMvC,MAAM,IAAIzE,MAAO,iEAJjBxX,EAAQ,EAAI,MAUb,IAFA,IAAIw/B,EAAS,IAAItkB,aAAcqkB,EAAY3kC,QAEjCsjB,EAAI,EAAGuhB,EAAKF,EAAY3kC,OAAQsjB,EAAIuhB,EAAIvhB,IAEjDshB,EAAQthB,GAAMqhB,EAAarhB,GAAMle,EAIlCu/B,EAAcC,EAIf,IAAUthB,EAAI,EAAGuhB,EAAKxP,EAAYr1B,OAAQsjB,EAAIuhB,EAAIvhB,IAAO,CAExD,IAAIwhB,EAAQ,IAAIX,EACf9O,EAAa/R,GAAM,IAAMoQ,EAAiBhM,EAAOlN,MACjDypB,EAAcv0B,MACdi1B,EACAF,GAI8B,gBAA1B9G,EAAQ8G,gBAEZK,EAAMC,kBAAoB,SAAkD7zB,GAM3E,OAAO,IAAI6c,EAA4Bn3B,KAAKouC,MAAOpuC,KAAK+Y,OAAQ/Y,KAAKquC,eAAiB,EAAG/zB,IAK1F4zB,EAAMC,kBAAkBG,2CAA4C,GAIrElB,EAAOx6B,KAAMs7B,KAMf,IAAIjgC,EAAOq+B,EAAar+B,KAAOq+B,EAAar+B,KAAO,aAAeo+B,EAElE,OAAO,IAAIkC,gBAAetgC,OAAMjM,EAAWorC,OAW7Cld,EAAWtiB,UAAU+1B,SAAW,SAAWR,GAE1C,IAAIxU,EAAO3uB,KAAK2uB,KACZN,EAAaruB,KAAKquB,WAClB4B,EAASjwB,KAET6iC,EAAiBlU,EAAKkU,eACtBC,EAAWnU,EAAKmU,SAEhBO,EAAU1U,EAAK6T,MAAOW,GAE1B,OAAS,WAER,IAAIvR,EAAU,GA0Dd,YAxDsB5vB,IAAjBqhC,EAAQhF,MAEZzM,EAAQhf,KAAMqd,EAAOwI,cAAe,OAAQ4K,EAAQhF,MAAOl8B,MAAM,SAAWk8B,GAE3E,IAAIyO,EAEJ,GAAKjK,EAAgBQ,EAAQhF,MAAS,EAAI,CAEzC,IAAImQ,EAAc1L,EAAUO,EAAQhF,SAEpCyO,EAAOzO,EAAKvtB,SACP7C,MAAQ,aAAeugC,OAI5B1B,EAAOzO,EAqBR,YAhByBr8B,IAApBqhC,EAAQrG,SAEZ8P,EAAKhgC,UAAU,SAAW2hC,GAEzB,GAAOA,EAAEX,OAET,IAAM,IAAI3kC,EAAI,EAAGo1B,EAAK8E,EAAQrG,QAAQ5zB,OAAQD,EAAIo1B,EAAIp1B,IAErDslC,EAAEjQ,sBAAuBr1B,GAAMk6B,EAAQrG,QAAS7zB,MAQ5C2jC,WAMe9qC,IAAnBqhC,EAAQx7B,QAEZ+pB,EAAQhf,KAAMqd,EAAOwI,cAAe,SAAU4K,EAAQx7B,SAIlDw7B,EAAQhV,YACTgV,EAAQhV,WAAYG,EAAWS,2BACgCjtB,IAA/DqhC,EAAQhV,WAAYG,EAAWS,qBAAsByf,OAExD9c,EAAQhf,KAAMqd,EAAOwI,cAAe,QAAS4K,EAAQhV,WAAYG,EAAWS,qBAAsByf,QAI5FpoB,QAAQqB,IAAKiK,GA5DZ,GA8DHzvB,MAAM,SAAWirB,GAEtB,IAAI0f,EAqBJ,IAhBCA,GAFuB,IAAnBzJ,EAAQH,OAEL,IAAIyL,OAEAvhB,EAAQhkB,OAAS,EAErB,IAAIkiC,QAEmB,IAAnBle,EAAQhkB,OAEZgkB,EAAS,GAIT,IAAItlB,cAIEslB,EAAS,GAEtB,IAAM,IAAIjkB,EAAI,EAAGo1B,EAAKnR,EAAQhkB,OAAQD,EAAIo1B,EAAIp1B,IAE7C2jC,EAAK3kC,IAAKilB,EAASjkB,IAiBrB,GAXKk6B,EAAQp1B,OAEZ6+B,EAAK/O,SAAS9vB,KAAOo1B,EAAQp1B,KAC7B6+B,EAAK7+B,KAAO2gC,kBAAgBC,iBAAkBxL,EAAQp1B,OAIvDgwB,EAAwB6O,EAAMzJ,GAEzBA,EAAQhV,YAAauP,EAAgCvP,EAAYye,EAAMzJ,QAEpDrhC,IAAnBqhC,EAAQjuB,OAAuB,CAEnC,IAAIA,EAAS,IAAIQ,UACjBR,EAAOub,UAAW0S,EAAQjuB,QAC1B03B,EAAK33B,aAAcC,aAIUpT,IAAxBqhC,EAAQtG,aAEZ+P,EAAKv+B,SAASoiB,UAAW0S,EAAQtG,kBAIR/6B,IAArBqhC,EAAQpjC,UAEZ6sC,EAAKxrC,WAAWqvB,UAAW0S,EAAQpjC,eAIb+B,IAAlBqhC,EAAQ70B,OAEZs+B,EAAKt+B,MAAMmiB,UAAW0S,EAAQ70B,OAQhC,OAFAyhB,EAAOiP,aAAav9B,IAAKmrC,EAAM,CAAEtkC,KAAM,QAASwQ,MAAOmqB,IAEhD2J,MAWT5c,EAAWtiB,UAAU81B,UAAY,WAIhC,SAASoL,EAAmBC,EAAQC,EAAcrgB,EAAMsB,GAEvD,IAAIoT,EAAU1U,EAAK6T,MAAOuM,GAE1B,OAAO9e,EAAOwI,cAAe,OAAQsW,GAAS5sC,MAAM,SAAW2qC,GAE9D,YAAsB9qC,IAAjBqhC,EAAQC,KAA4BwJ,EAMlC7c,EAAOwI,cAAe,OAAQ4K,EAAQC,MAAOnhC,MAAM,SAAWmhC,GAMpE,IAFA,IAAI2L,EAAgB,GAEV9lC,EAAI,EAAGo1B,GAJjB4N,EAAY7I,GAIoBL,OAAO75B,OAAQD,EAAIo1B,EAAIp1B,IAEtD8lC,EAAcr8B,KAAMqd,EAAOwI,cAAe,OAAQ0T,EAAUlJ,OAAQ95B,KAIrE,OAAOmd,QAAQqB,IAAKsnB,MAEjB9sC,MAAM,SAAW+sC,GAuCpB,OArCApC,EAAKhgC,UAAU,SAAWuxB,GAEzB,GAAOA,EAAKyP,OAAZ,CAKA,IAHA,IAAIqB,EAAQ,GACRC,EAAe,GAET1iB,EAAI,EAAGuhB,EAAKiB,EAAW9lC,OAAQsjB,EAAIuhB,EAAIvhB,IAAO,CAEvD,IAAI2iB,EAAYH,EAAYxiB,GAE5B,GAAK2iB,EAAY,CAEhBF,EAAMv8B,KAAMy8B,GAEZ,IAAIC,EAAM,IAAI15B,eAEyB5T,IAAlCmqC,EAAUC,qBAEdkD,EAAI3e,UAAWwb,EAAUC,oBAAoBtzB,MAAW,GAAJ4T,GAIrD0iB,EAAax8B,KAAM08B,QAInB9sC,QAAQgB,KAAM,mDAAoD2oC,EAAUlJ,OAAQvW,IAMtF2R,EAAKn7B,KAAM,IAAIqsC,WAAUJ,EAAOC,GAAgB/Q,EAAK9wB,iBAI/Cu/B,KAvDR,IAAIX,KA2DDhqC,MAAM,SAAW2qC,GAIpBkC,EAAa7mC,IAAK2kC,GAElB,IAAIlb,EAAU,GAEd,GAAKyR,EAAQ/sB,SAIZ,IAFA,IAAIA,EAAW+sB,EAAQ/sB,SAEbnN,EAAI,EAAGo1B,EAAKjoB,EAASlN,OAAQD,EAAIo1B,EAAIp1B,IAAO,CAErD,IAAI4D,EAAQuJ,EAAUnN,GACtByoB,EAAQhf,KAAMk8B,EAAmB/hC,EAAO+/B,EAAMne,EAAMsB,IAMtD,OAAO3J,QAAQqB,IAAKiK,MAMtB,OAAO,SAAoB4d,GAE1B,IAAI7gB,EAAO3uB,KAAK2uB,KACZN,EAAaruB,KAAKquB,WAClBohB,EAAWzvC,KAAK2uB,KAAKyT,OAAQoN,GAK7BrN,EAAQ,IAAImJ,QACXmE,EAASxhC,OAAOk0B,EAAMl0B,KAAOwhC,EAASxhC,MAE3CgwB,EAAwBkE,EAAOsN,GAE1BA,EAASphB,YAAauP,EAAgCvP,EAAY8T,EAAOsN,GAM9E,IAJA,IAAIC,EAAUD,EAASjN,OAAS,GAE5B5Q,EAAU,GAEJzoB,EAAI,EAAGo1B,EAAKmR,EAAQtmC,OAAQD,EAAIo1B,EAAIp1B,IAE7CyoB,EAAQhf,KAAMk8B,EAAmBY,EAASvmC,GAAKg5B,EAAOxT,EAjB1C3uB,OAqBb,OAAOsmB,QAAQqB,IAAKiK,GAAUzvB,MAAM,WAEnC,OAAOggC,MAhIuB,GAwI1BnV,EAttGW,I,iCCxEnB,8CAqBI2iB,EAAY,SAAZA,EAAuB3iC,EAAUiyB,GAEpChsB,OAAKlL,KAAM/H,KAAMgN,GAEjBhN,KAAKwI,KAAO,YAEZ,IAAIzI,EAAQC,KAIRkR,OAA4BlP,KAFhCi9B,EAAUA,GAAW,IAEC/tB,MAAwB,IAAI4G,QAAOmnB,EAAQ/tB,OAAU,IAAI4G,QAAO,SAClF83B,EAAe3Q,EAAQ2Q,cAAgB,IACvCC,EAAgB5Q,EAAQ4Q,eAAiB,IACzCC,EAAW7Q,EAAQ6Q,UAAY,EAC/Bpb,EAASuK,EAAQvK,QAAUib,EAAUI,gBACrC5F,OAAgCnoC,IAArBi9B,EAAQkL,SAAyBlL,EAAQkL,SAAW6F,iBAI/DC,EAAiB,IAAIC,QACrB1sB,EAAS,IAAI1iB,UACbqvC,EAAyB,IAAIrvC,UAC7BsvC,EAAsB,IAAItvC,UAC1BuvC,EAAiB,IAAIz6B,UACrB06B,EAAiB,IAAIxvC,UAAS,EAAG,GAAK,GACtCyvC,EAAY,IAAIC,UAEhBC,EAAO,IAAI3vC,UACXgwB,EAAS,IAAIhwB,UACb4vC,EAAI,IAAIF,UAERG,EAAgB,IAAI/6B,UACpBg7B,EAAgB,IAAInF,oBAEpBuB,EAAa,CAChB9F,UAAW7L,eACX4L,UAAW5L,eACXyL,OAAQpJ,YACRmT,eAAe,EACf1G,SAAUA,GAGP2G,EAAe,IAAIC,oBAAmBnB,EAAcC,EAAe7C,GAEhEnqC,YAAUmuC,aAAcpB,IAAoB/sC,YAAUmuC,aAAcnB,KAE1EiB,EAAanY,QAAQsY,iBAAkB,GAIxC,IAAIhkC,EAAW,IAAIikC,iBAAgB,CAClChd,SAAUid,gBAAcrgC,MAAO4jB,EAAOR,UACtCU,eAAgBF,EAAOE,eACvBwc,aAAc1c,EAAO0c,eAGtBnkC,EAASinB,SAAT,SAAgCzoB,MAAQqlC,EAAanY,QACrD1rB,EAASinB,SAAT,MAA6BzoB,MAAQyF,EACrCjE,EAASinB,SAAT,cAAqCzoB,MAAQklC,EAE7C3wC,KAAKiN,SAAWA,EAEhBjN,KAAKqxC,eAAiB,SAAWC,EAAUnP,EAAOt6B,GAcjD,GAZAsoC,EAAuBphC,sBAAuBhP,EAAMwN,aACpD6iC,EAAoBrhC,sBAAuBlH,EAAO0F,aAElD8iC,EAAekB,gBAAiBxxC,EAAMwN,aAEtCiW,EAAO7hB,IAAK,EAAG,EAAG,GAClB6hB,EAAOrO,aAAck7B,GAErBI,EAAKe,WAAYrB,EAAwBC,KAIpCK,EAAKxhC,IAAKuU,GAAW,GAA1B,CAEAitB,EAAKgB,QAASjuB,GAASkuB,SACvBjB,EAAKtoC,IAAKgoC,GAEVE,EAAekB,gBAAiB1pC,EAAO0F,aAEvC+iC,EAAe3uC,IAAK,EAAG,GAAK,GAC5B2uC,EAAen7B,aAAck7B,GAC7BC,EAAenoC,IAAKioC,GAEpBtf,EAAO0gB,WAAYrB,EAAwBG,GAC3Cxf,EAAO2gB,QAASjuB,GAASkuB,SACzB5gB,EAAO3oB,IAAKgoC,GAEZS,EAAcriC,SAASd,KAAMgjC,GAC7BG,EAAc1sC,GAAGvC,IAAK,EAAG,EAAG,GAC5BivC,EAAc1sC,GAAGiR,aAAck7B,GAC/BO,EAAc1sC,GAAGutC,QAASjuB,GAC1BotB,EAAc15B,OAAQ4Z,GAEtB8f,EAAce,IAAM9pC,EAAO8pC,IAE3Bf,EAAcvjC,oBACdujC,EAAcgB,iBAAiBnkC,KAAM5F,EAAO+pC,kBAG5CjB,EAAchvC,IACb,GAAK,EAAK,EAAK,GACf,EAAK,GAAK,EAAK,GACf,EAAK,EAAK,GAAK,GACf,EAAK,EAAK,EAAK,GAEhBgvC,EAAc9uC,SAAU+uC,EAAcgB,kBACtCjB,EAAc9uC,SAAU+uC,EAAciB,oBACtClB,EAAc9uC,SAAU9B,EAAMwN,aAI9B0iC,EAAe6B,8BAA+BtuB,EAAQ2sB,GACtDF,EAAe96B,aAAcy7B,EAAciB,oBAE3CtB,EAAU5uC,IAAKsuC,EAAezsB,OAAO/c,EAAGwpC,EAAezsB,OAAO7c,EAAGspC,EAAezsB,OAAO3c,EAAGopC,EAAe8B,UAEzG,IAAIH,EAAmBhB,EAAcgB,iBAErClB,EAAEjqC,GAAMrF,KAAK4wC,KAAMzB,EAAU9pC,GAAMmrC,EAAiBK,SAAU,IAAQL,EAAiBK,SAAU,GACjGvB,EAAE/pC,GAAMvF,KAAK4wC,KAAMzB,EAAU5pC,GAAMirC,EAAiBK,SAAU,IAAQL,EAAiBK,SAAU,GACjGvB,EAAE7pC,GAAM,EACR6pC,EAAEwB,GAAM,EAAMN,EAAiBK,SAAU,KAASL,EAAiBK,SAAU,IAG7E1B,EAAUx5B,eAAgB,EAAMw5B,EAAUthC,IAAKyhC,IAG/CkB,EAAiBK,SAAU,GAAM1B,EAAU9pC,EAC3CmrC,EAAiBK,SAAU,GAAM1B,EAAU5pC,EAC3CirC,EAAiBK,SAAU,IAAO1B,EAAU1pC,EAAI,EAAMipC,EACtD8B,EAAiBK,SAAU,IAAO1B,EAAU2B,EAI5CnyC,EAAMiI,SAAU,EAEhB,IAAImqC,EAAsBb,EAASc,kBAE/BC,EAAmBf,EAASgB,GAAGnyC,QAC/BoyC,EAA0BjB,EAASkB,UAAUC,WAEjDnB,EAASgB,GAAGnyC,SAAU,EACtBmxC,EAASkB,UAAUC,YAAa,EAEhCnB,EAASoB,gBAAiB5B,GAE1BQ,EAASqB,MAAMhmB,QAAQzR,MAAM03B,SAAS,IAEV,IAAvBtB,EAASuB,WAAsBvB,EAASzzB,QAC7CyzB,EAASwB,OAAQ3Q,EAAOyO,GAExBU,EAASgB,GAAGnyC,QAAUkyC,EACtBf,EAASkB,UAAUC,WAAaF,EAEhCjB,EAASoB,gBAAiBP,GAI1B,IAAIY,EAAWlrC,EAAOkrC,cAEJ/wC,IAAb+wC,GAEJzB,EAASqB,MAAMI,SAAUA,GAI1BhzC,EAAMiI,SAAU,IAIjBhI,KAAKoyC,gBAAkB,WAEtB,OAAOtB,IAMTnB,EAAU/hC,UAAYrC,OAAOwE,OAAQkD,OAAKrF,WAC1C+hC,EAAU/hC,UAAUoC,YAAc2/B,EAElCA,EAAUI,gBAAkB,CAE3B7b,SAAU,CAET,MAAS,CACRzoB,MAAO,MAGR,SAAY,CACXA,MAAO,MAGR,cAAiB,CAChBA,MAAO,OAKT2lC,aAAc,CACb,8BACA,oBAEA,gBAEA,iDAEA,8EAEA,KACClpB,KAAM,MAER0M,eAAgB,CACf,sBACA,8BACA,oBAEA,kDAEA,sGAEA,IAEA,+CAEA,sHAEA,IAEA,gBAEA,gDACA,iEAEA,KACC1M,KAAM,Q,oBCnQT,IAAI8qB,EAAM,SAANA,IAAiB,SAASC,EAAEr7B,GAAwB,OAArBs7B,EAAEC,YAAYv7B,EAAEw7B,KAAYx7B,EAAE,SAASy7B,EAAEz7B,GAAG,IAAI,IAAI5I,EAAE,EAAEA,EAAEkkC,EAAE58B,SAASlN,OAAO4F,IAAIkkC,EAAE58B,SAAStH,GAAGskC,MAAMC,QAAQvkC,IAAI4I,EAAE,QAAQ,OAAO47B,EAAE57B,EAAE,IAAI47B,EAAE,EAAEN,EAAEzvC,SAASgwC,cAAc,OAAOP,EAAEI,MAAMI,QAAQ,uEAAuER,EAAE7wC,iBAAiB,SAAQ,SAASuV,GAAGA,EAAErU,iBAAiB8vC,IAAIG,EAAEN,EAAE58B,SAASlN,WAAS,GAAI,IAAIuqC,GAAGC,aAAaC,MAAMC,MAAMj1B,EAAE80B,EAAE/7B,EAAE,EAAEm8B,EAAEd,EAAE,IAAID,EAAMgB,MAAM,MAAM,OAAO,SAASC,EAAEhB,EAAE,IAAID,EAAMgB,MAAM,KAAK,OAAO,SACjf,GAAGz7B,KAAKq7B,aAAar7B,KAAKq7B,YAAYM,OAAO,IAAI3a,EAAE0Z,EAAE,IAAID,EAAMgB,MAAM,KAAK,OAAO,SAAc,OAALX,EAAE,GAAS,CAACc,SAAS,GAAGf,IAAIF,EAAEkB,SAASnB,EAAEoB,UAAUhB,EAAEiB,MAAM,WAAWX,GAAGC,aAAaC,MAAMC,OAAOS,IAAI,WAAW38B,IAAI,IAAIs7B,GAAGU,aAAaC,MAAMC,MAAwB,GAAlBG,EAAEtxC,OAAOuwC,EAAES,EAAE,KAAQT,EAAEr0B,EAAE,MAAMk1B,EAAEpxC,OAAO,IAAIiV,GAAGs7B,EAAEr0B,GAAG,KAAKA,EAAEq0B,EAAEt7B,EAAE,EAAE2hB,GAAG,CAAC,IAAIvqB,EAAE4kC,YAAYM,OAAO3a,EAAE52B,OAAOqM,EAAEwlC,eAAe,QAAQxlC,EAAEylC,gBAAgB,SAAS,OAAOvB,GAAGvwC,OAAO,WAAWgxC,EAAE3zC,KAAKu0C,OAAOtxC,WAAWiwC,EAAE1jC,QAAQ6jC,IAC1cL,EAAMgB,MAAM,SAASf,EAAEI,EAAEG,GAAG,IAAIN,EAAE59B,IAASq+B,EAAE,EAAE90B,EAAEzd,KAAKkN,MAAMsJ,EAAEiH,EAAEne,OAAOg0C,kBAAkB,GAAGX,EAAE,GAAGn8B,EAAEq8B,EAAE,GAAGr8B,EAAE2hB,EAAE,EAAE3hB,EAAE+8B,EAAE,EAAE/8B,EAAE5I,EAAE,EAAE4I,EAAEg9B,EAAE,GAAGh9B,EAAEyG,EAAE,GAAGzG,EAAEiiB,EAAE,GAAGjiB,EAAE84B,EAAEjtC,SAASgwC,cAAc,UAAU/C,EAAExkC,MAAM6nC,EAAErD,EAAErkC,OAAO4nC,EAAEvD,EAAE4C,MAAMI,QAAQ,yBAAyB,IAAI/qB,EAAE+nB,EAAEmE,WAAW,MAAuN,OAAjNlsB,EAAEmsB,KAAK,QAAQ,EAAEl9B,EAAE,gCAAgC+Q,EAAEosB,aAAa,MAAMpsB,EAAEqsB,UAAUxB,EAAE7qB,EAAEssB,SAAS,EAAE,EAAElB,EAAEE,GAAGtrB,EAAEqsB,UAAU3B,EAAE1qB,EAAEusB,SAASjC,EAAE1Z,EAAEob,GAAGhsB,EAAEssB,SAASjmC,EAAE4lC,EAAEv2B,EAAEwb,GAAGlR,EAAEqsB,UAAUxB,EAAE7qB,EAAEwsB,YAAY,GAAGxsB,EAAEssB,SAASjmC,EAAE4lC,EAAEv2B,EAAEwb,GAAS,CAACuZ,IAAI1C,EAAE/tC,OAAO,SAASsxC,EACzfjyB,GAAGkxB,EAAE9xC,KAAKwV,IAAIs8B,EAAEe,GAAGN,EAAEvyC,KAAKsY,IAAIi6B,EAAEM,GAAGtrB,EAAEqsB,UAAUxB,EAAE7qB,EAAEwsB,YAAY,EAAExsB,EAAEssB,SAAS,EAAE,EAAElB,EAAEa,GAAGjsB,EAAEqsB,UAAU3B,EAAE1qB,EAAEusB,SAASr2B,EAAEo1B,GAAG,IAAIhB,EAAE,KAAKp0B,EAAEq0B,GAAG,IAAIr0B,EAAE80B,GAAG,IAAIpa,EAAEob,GAAGhsB,EAAEysB,UAAU1E,EAAE1hC,EAAE4I,EAAEg9B,EAAEv2B,EAAEzG,EAAEiiB,EAAE7qB,EAAE4lC,EAAEv2B,EAAEzG,EAAEiiB,GAAGlR,EAAEssB,SAASjmC,EAAEqP,EAAEzG,EAAEg9B,EAAEh9B,EAAEiiB,GAAGlR,EAAEqsB,UAAUxB,EAAE7qB,EAAEwsB,YAAY,GAAGxsB,EAAEssB,SAASjmC,EAAEqP,EAAEzG,EAAEg9B,EAAEh9B,EAAEiH,GAAG,EAAEo1B,EAAEjyB,GAAG6X,OAAkCxe,EAAOC,QAAQ03B,G,iCCJjU,8CAiBIqC,EAAmB,cAEvB,WAEC,IAAIC,EAAK,IAAIx0C,UAAWy0C,EAAK,IAAIz0C,UAQjC,SAAS00C,EAAiB18B,EAAOhZ,GAEhC,IAAIuzC,EAAIv6B,EAAMnK,QAAS7O,GAClBuzC,GAAM,GAAIv6B,EAAMuE,OAAQg2B,EAAG,GAIjC,SAASoC,EAAyBd,EAAG3yB,GAKpC,IAII7Y,EAAwBusC,EAAMC,EAJ9BC,EAAa5zB,EAAEzT,SAASa,WAAYulC,EAAEpmC,UACtCsnC,EAAY,EAEZC,EAAY,GACTvX,EAAKoW,EAAEoB,MAAM3sC,OAGpB,IAAMD,EAAI,EAAGA,EAAIo1B,EAAIp1B,KAEpBusC,EAAOf,EAAEoB,MAAO5sC,IAEN6sC,UAAWh0B,IAEpB8zB,EAAUljC,KAAM8iC,GAQlB,IAAMvsC,EAAI,EAAGA,EAAIo1B,EAAIp1B,IAAO,CAE3B,IAAI8sC,EAAe,EACnBP,EAAOf,EAAEoB,MAAO5sC,GAEhB,IAAM,IAAIujB,EAAI,EAAGA,EAAIopB,EAAU1sC,OAAQsjB,IAAO,CAE7CipB,EAAWG,EAAWppB,GAEtB,IAAIwpB,EAAUR,EAAKlyB,OAAOvU,IAAK0mC,EAASnyB,QACxCyyB,EAAe70C,KAAKwV,IAAKq/B,GAAgB,MAAQC,GAAY,GAI9DL,EAAYz0C,KAAKsY,IAAKm8B,EAAWI,GAiBlC,OAVKH,EAAU1sC,OAAS,IAIvBysC,EAAY,GAIHD,EAAaC,EATT,EAef,SAASM,EAAyBn0B,GASjC,GAA4B,IAAvBA,EAAEo0B,UAAUhtC,OAMhB,OAHA4Y,EAAEq0B,iBAAmB,UACrBr0B,EAAEs0B,cAAiB,KAMpBt0B,EAAEs0B,aAAe,IACjBt0B,EAAEq0B,iBAAmB,KAGrB,IAAM,IAAIltC,EAAI,EAAGA,EAAI6Y,EAAEo0B,UAAUhtC,OAAQD,IAAO,CAE/C,IAAImtC,EAAeb,EAAyBzzB,EAAGA,EAAEo0B,UAAWjtC,IAErD6Y,EAAEq0B,mBAERr0B,EAAEq0B,iBAAmBr0B,EAAEo0B,UAAWjtC,GAClC6Y,EAAEs0B,aAAeA,EACjBt0B,EAAEu0B,QAAUD,EACZt0B,EAAEw0B,UAAY,EACdx0B,EAAEy0B,UAAY,GAIfz0B,EAAEy0B,YACFz0B,EAAEw0B,WAAaF,EAEVA,EAAet0B,EAAEu0B,UAErBv0B,EAAEq0B,iBAAmBr0B,EAAEo0B,UAAWjtC,GAClC6Y,EAAEu0B,QAAUD,GAOdt0B,EAAEs0B,aAAet0B,EAAEw0B,UAAYx0B,EAAEy0B,UAKlC,SAASC,EAAc10B,EAAGrP,GAIzB,IAFAnQ,QAAQm0C,OAA2B,IAAnB30B,EAAE+zB,MAAM3sC,QAEhB4Y,EAAEo0B,UAAUhtC,QAAS,CAG5BosC,EADQxzB,EAAEo0B,UAAUl2B,MACDk2B,UAAWp0B,GAI/BwzB,EAAiB7iC,EAAUqP,GAI5B,SAAS40B,EAAY3C,EAAG8B,GAEvBP,EAAiBO,EAAO9B,GAEnBA,EAAE4C,IAAKrB,EAAiBvB,EAAE4C,GAAGd,MAAO9B,GACpCA,EAAE6C,IAAKtB,EAAiBvB,EAAE6C,GAAGf,MAAO9B,GACpCA,EAAE8C,IAAKvB,EAAiBvB,EAAE8C,GAAGhB,MAAO9B,GAMzC,IAHA,IACI4C,EAAIC,EADJE,EAAK,CAAE/C,EAAE4C,GAAI5C,EAAE6C,GAAI7C,EAAE8C,IAGf5tC,EAAI,EAAGA,EAAI,EAAGA,IAGvB2tC,EAAKE,GAAM7tC,EAAI,GAAM,IADrB0tC,EAAKG,EAAI7tC,KAGM2tC,IAEfD,EAAGI,oBAAqBH,GACxBA,EAAGG,oBAAqBJ,IAM1B,SAASK,EAAUvkC,EAAUojC,EAAOpB,EAAG3yB,GAItC,GAAOA,EAAP,CAQA,IAAI7Y,EACAguC,EAAc,GAElB,IAAMhuC,EAAI,EAAGA,EAAIwrC,EAAEyB,UAAUhtC,OAAQD,IAEpCguC,EAAYvkC,KAAM+hC,EAAEyB,UAAWjtC,IAMhC,IAAMA,EAAIwrC,EAAEoB,MAAM3sC,OAAS,EAAGD,GAAK,EAAGA,IAEhCwrC,EAAEoB,MAAO5sC,GAAI6sC,UAAWh0B,IAE5B40B,EAAYjC,EAAEoB,MAAO5sC,GAAK4sC,GAO5B,IAAM5sC,EAAIwrC,EAAEoB,MAAM3sC,OAAS,EAAGD,GAAK,EAAGA,IAErCwrC,EAAEoB,MAAO5sC,GAAIiuC,cAAezC,EAAG3yB,GAQhC,IAHA00B,EAAc/B,EAAGhiC,GAGXxJ,EAAI,EAAGA,EAAIguC,EAAY/tC,OAAQD,IAEpCgtC,EAAyBgB,EAAahuC,SAvCtCutC,EAAc/B,EAAGhiC,GA+CnB,SAAS0kC,EAAiB1kC,GAMzB,IAFA,IAAI2kC,EAAQ3kC,EAAU,GAEZxJ,EAAI,EAAGA,EAAIwJ,EAASvJ,OAAQD,IAEhCwJ,EAAUxJ,GAAImtC,aAAegB,EAAMhB,eAEvCgB,EAAQ3kC,EAAUxJ,IAMpB,OAAOmuC,EAMR,SAASC,EAAUV,EAAIC,EAAIC,EAAIn/B,EAAG+Q,EAAGuqB,GAEpClzC,KAAK4X,EAAIA,EACT5X,KAAK2oB,EAAIA,EACT3oB,KAAKkzC,EAAIA,EAETlzC,KAAK62C,GAAKA,EACV72C,KAAK82C,GAAKA,EACV92C,KAAK+2C,GAAKA,EAEV/2C,KAAKwjB,OAAS,IAAI1iB,UAElBd,KAAKw3C,gBAELX,EAAGd,MAAMnjC,KAAM5S,MACf62C,EAAGY,kBAAmBX,GACtBD,EAAGY,kBAAmBV,GAEtBD,EAAGf,MAAMnjC,KAAM5S,MACf82C,EAAGW,kBAAmBZ,GACtBC,EAAGW,kBAAmBV,GAGtBA,EAAGhB,MAAMnjC,KAAM5S,MACf+2C,EAAGU,kBAAmBZ,GACtBE,EAAGU,kBAAmBX,GAwDvB,SAASY,EAAQ11B,EAAG2E,GAEnB3mB,KAAKuO,SAAWyT,EAEhBhiB,KAAK2mB,GAAKA,EAEV3mB,KAAK+1C,MAAQ,GACb/1C,KAAKo2C,UAAY,GAGjBp2C,KAAKs2C,aAAe,EACpBt2C,KAAKq2C,iBAAmB,KA/DzBkB,EAAS3pC,UAAU4pC,cAAgB,WAElC,IAAIG,EAAK33C,KAAK62C,GAAGtoC,SACbqpC,EAAK53C,KAAK82C,GAAGvoC,SACbspC,EAAK73C,KAAK+2C,GAAGxoC,SAEjB+mC,EAAG9D,WAAYqG,EAAID,GACnBrC,EAAG/D,WAAYmG,EAAIC,GACnBtC,EAAGhmC,MAAOimC,GAAKzuC,YAEf9G,KAAKwjB,OAAO/V,KAAM6nC,IAInBiC,EAAS3pC,UAAUooC,UAAY,SAAWh0B,GAEzC,OAAOA,IAAMhiB,KAAK62C,IAAM70B,IAAMhiB,KAAK82C,IAAM90B,IAAMhiB,KAAK+2C,IAIrDQ,EAAS3pC,UAAUwpC,cAAgB,SAAWU,EAAMC,GAE9CD,IAAS93C,KAAK62C,GAAK72C,KAAK62C,GAAKkB,EACxBD,IAAS93C,KAAK82C,GAAK92C,KAAK82C,GAAKiB,EAC7BD,IAAS93C,KAAK+2C,KAAK/2C,KAAK+2C,GAAKgB,GAEvCvC,EAAiBsC,EAAK/B,MAAO/1C,MAC7B+3C,EAAKhC,MAAMnjC,KAAM5S,MAGjB83C,EAAKb,oBAAqBj3C,KAAK62C,IAC/B72C,KAAK62C,GAAGI,oBAAqBa,GAE7BA,EAAKb,oBAAqBj3C,KAAK82C,IAC/B92C,KAAK82C,GAAGG,oBAAqBa,GAE7BA,EAAKb,oBAAqBj3C,KAAK+2C,IAC/B/2C,KAAK+2C,GAAGE,oBAAqBa,GAE7B93C,KAAK62C,GAAGY,kBAAmBz3C,KAAK82C,IAChC92C,KAAK62C,GAAGY,kBAAmBz3C,KAAK+2C,IAEhC/2C,KAAK82C,GAAGW,kBAAmBz3C,KAAK62C,IAChC72C,KAAK82C,GAAGW,kBAAmBz3C,KAAK+2C,IAEhC/2C,KAAK+2C,GAAGU,kBAAmBz3C,KAAK62C,IAChC72C,KAAK+2C,GAAGU,kBAAmBz3C,KAAK82C,IAEhC92C,KAAKw3C,iBAmBNE,EAAO9pC,UAAU6pC,kBAAoB,SAAWO,GAtVhD,IAAuBl/B,EAAOhZ,EAAPgZ,EAwVR9Y,KAAKo2C,UAxVUt2C,EAwVCk4C,GAtVK,IAA9Bl/B,EAAMnK,QAAS7O,IAAmBgZ,EAAMlG,KAAM9S,IA0VpD43C,EAAO9pC,UAAUqpC,oBAAsB,SAAW54B,GAEjD,IAAI+3B,EAAYp2C,KAAKo2C,UACjBL,EAAQ/1C,KAAK+1C,MAEb7vC,EAASkwC,EAAUznC,QAAS0P,GAChC,IAAkB,IAAbnY,EAAL,CACA,IAAM,IAAIiD,EAAI,EAAGA,EAAI4sC,EAAM3sC,OAAQD,IAElC,GAAK4sC,EAAO5sC,GAAI6sC,UAAW33B,GAAM,OAIlC+3B,EAAU/4B,OAAQnX,EAAQ,KAI3BmvC,EAAiBznC,UAAUqqC,OAAS,SAAWjrC,EAAU00B,GAEnD10B,EAASkrC,mBAEblrC,GAAW,IAAImrC,YAAWC,mBAAoBprC,IAI/CA,EAASqrC,gBAET,IAOIlvC,EAAGo1B,EAsCH+Z,EA7CAC,EAAcvrC,EAAS2F,SACvB6lC,EAAWxrC,EAAS+oC,MAGpBpjC,EAAW,GACXojC,EAAQ,GAUZ,IAAM5sC,EAAI,EAAGo1B,EAAKga,EAAYnvC,OAAQD,EAAIo1B,EAAIp1B,IAAO,CAEpD,IAAI6uC,EAAS,IAAIN,EAAQa,EAAapvC,GAAKA,GAC3CwJ,EAASC,KAAMolC,GAMhB,IAAM7uC,EAAI,EAAGo1B,EAAKia,EAASpvC,OAAQD,EAAIo1B,EAAIp1B,IAAO,CAEjD,IAEIyO,GAFA89B,EAAO8C,EAAUrvC,IAERyO,EACT+Q,EAAI+sB,EAAK/sB,EACTuqB,EAAIwC,EAAKxC,EAETuF,EAAW,IAAIlB,EAAU5kC,EAAUiF,GAAKjF,EAAUgW,GAAKhW,EAAUugC,GAAKt7B,EAAG+Q,EAAGuqB,GAChF6C,EAAMnjC,KAAM6lC,GAMb,IAAMtvC,EAAI,EAAGo1B,EAAK5rB,EAASvJ,OAAQD,EAAIo1B,EAAIp1B,IAE1CgtC,EAAyBxjC,EAAUxJ,IAQpC,IAFA,IAAItC,EAAI66B,EAEA76B,KAAO,CAId,KAFAyxC,EAAajB,EAAiB1kC,IAEV,CAEnBnQ,QAAQqmB,IAAK,0CACb,MAIDquB,EAAUvkC,EAAUojC,EAAOuC,EAAYA,EAAWjC,kBAMnD,IAAIqC,EAAqB,IAAIpmC,iBACzB/D,EAAW,GACXyK,EAAQ,GAIZ,IAAM7P,EAAI,EAAGA,EAAIwJ,EAASvJ,OAAQD,IAAO,CAEpC6uC,EAASrlC,EAAUxJ,GAAIoF,SAC3BA,EAASqE,KAAMolC,EAAOvxC,EAAGuxC,EAAOrxC,EAAGqxC,EAAOnxC,GAM3C,IAAMsC,EAAI,EAAGA,EAAI4sC,EAAM3sC,OAAQD,IAAO,CAErC,IAAIusC,EAAOK,EAAO5sC,GAEdyO,EAAIjF,EAAShE,QAAS+mC,EAAKmB,IAC3BluB,EAAIhW,EAAShE,QAAS+mC,EAAKoB,IAC3B5D,EAAIvgC,EAAShE,QAAS+mC,EAAKqB,IAE/B/9B,EAAMpG,KAAMgF,EAAG+Q,EAAGuqB,GASnB,OAHAwF,EAAmBh1C,aAAc,WAAY,IAAI6O,yBAAwBhE,EAAU,IACnFmqC,EAAmB1xB,SAAUhO,GAEtB0/B,GA7dT,I,iCCnBA,8CAuBIC,EAAsB,SAAWC,GAEpC54C,KAAK44C,kBAAkC52C,IAAjB42C,EAA+B,EAAIA,GAK1DD,EAAoB/qC,UAAUqqC,OAAS,SAAWjrC,IAIhDA,EAFIA,EAASkrC,kBAEF,IAAIC,YAAWC,mBAAoBprC,GAInCA,EAAS8D,SAIZunC,gBAIT,IAFA,IAAIQ,EAAU74C,KAAK44C,aAEXC,KAAa,GAEpB74C,KAAK84C,OAAQ9rC,GAOd,OAHAA,EAAS+rC,qBACT/rC,EAASgsC,uBAEFhsC,GAIR,WAGC,IAAIisC,EAAM,CAAE,IAAK,IAAK,KAGtB,SAASC,EAASthC,EAAG+Q,EAAG7I,GAOvB,OAAOA,EALY1e,KAAKwV,IAAKgB,EAAG+Q,GAGP,IAFNvnB,KAAKsY,IAAK9B,EAAG+Q,IASjC,SAASwwB,EAAavhC,EAAG+Q,EAAGhW,EAAUmN,EAAK41B,EAAM0D,GAEhD,IAKIC,EALAC,EAAel4C,KAAKwV,IAAKgB,EAAG+Q,GAC5B4wB,EAAen4C,KAAKsY,IAAK9B,EAAG+Q,GAE5B/N,EAAM0+B,EAAe,IAAMC,EAI1B3+B,KAAOkF,EAEXu5B,EAAOv5B,EAAKlF,IAOZy+B,EAAO,CAENzhC,EALajF,EAAU2mC,GAMvB3wB,EALahW,EAAU4mC,GAMvBC,QAAS,KAGTzD,MAAO,IAIRj2B,EAAKlF,GAAQy+B,GAIdA,EAAKtD,MAAMnjC,KAAM8iC,GAEjB0D,EAAcxhC,GAAI6hC,MAAM7mC,KAAMymC,GAC9BD,EAAczwB,GAAI8wB,MAAM7mC,KAAMymC,GA2B/B,SAASK,EAASC,EAAU/hC,EAAG+Q,EAAGuqB,EAAGlK,GAEpC2Q,EAAS/mC,KAAM,IAAIgnC,QAAOhiC,EAAG+Q,EAAGuqB,OAAGlxC,OAAWA,EAAWgnC,IAI1D,SAAS6Q,EAAUjiC,EAAG+Q,GAErB,OAASvnB,KAAK4V,IAAK2R,EAAI/Q,GAAM,EAAMxW,KAAKwV,IAAKgB,EAAG+Q,GAIjD,SAASmxB,EAAOC,EAAQniC,EAAG+Q,EAAGuqB,GAE7B6G,EAAOnnC,KAAM,CAAEgF,EAAE9G,QAAS6X,EAAE7X,QAASoiC,EAAEpiC,UAOxC6nC,EAAoB/qC,UAAUkrC,OAAS,SAAW9rC,GAEjD,IAEIurC,EAAaC,EAAUwB,EACvBC,EAAaN,EAEbt7B,EAAGlV,EAAGo1B,EAAO8U,EACb+F,EAGAc,EAAaC,EAAiBC,EAT9BC,EAAM,IAAIv5C,UAGaw5C,EAAS,GAQpC/B,EAAcvrC,EAAS2F,SACvB6lC,EAAWxrC,EAAS+oC,MAGpB,IAiCIp3B,EAAO47B,EAAaf,EAAS9D,EAC7B8E,EAAkBC,EAAsBC,EA+DxCl5C,EAAMm5C,EAAoBC,EAC1BC,EAAgBC,EAAiBC,EAAWC,EAlG5CC,OAAyBj5C,KAF7Bg4C,EAAShtC,EAASkuC,eAEG,IAAqBlB,EAAQ,GAAI5wC,OAAS,EAE/D,GAAK6xC,EAEJ,IAAM,IAAIvuB,EAAI,EAAGA,EAAIstB,EAAO5wC,OAAQsjB,IAEnC4tB,EAAO1nC,KAAM,IA8Bf,IAAMzJ,KAhGP,SAA0BwJ,EAAUojC,EAAOqD,EAAcK,GAExD,IAAItwC,EAAGo1B,EAAImX,EAEX,IAAMvsC,EAAI,EAAGo1B,EAAK5rB,EAASvJ,OAAQD,EAAIo1B,EAAIp1B,IAE1CiwC,EAAcjwC,GAAM,CAAEswC,MAAO,IAI9B,IAAMtwC,EAAI,EAAGo1B,EAAKwX,EAAM3sC,OAAQD,EAAIo1B,EAAIp1B,IAIvCgwC,GAFAzD,EAAOK,EAAO5sC,IAEIyO,EAAG89B,EAAK/sB,EAAGhW,EAAU8mC,EAAO/D,EAAM0D,GACpDD,EAAazD,EAAK/sB,EAAG+sB,EAAKxC,EAAGvgC,EAAU8mC,EAAO/D,EAAM0D,GACpDD,EAAazD,EAAKxC,EAAGwC,EAAK99B,EAAGjF,EAAU8mC,EAAO/D,EAAM0D,GAiErD+B,CAAiB5C,EAAaC,EAH9BY,EAAe,IAAI7+B,MAAOg+B,EAAYnvC,QACtC8wC,EAAc,IAadC,EAAkB,GAIPD,EAAc,CA6BxB,IA3BAK,EAAcL,EAAa/wC,GAC3BqwC,EAAU,IAAI14C,UAEd05C,EAAmB,EAAI,EACvBC,EAAuB,EAAI,EAKJ,IAHvBC,EAAiBH,EAAYxE,MAAM3sC,UAMlCoxC,EAAmB,GACnBC,EAAuB,GAUxBjB,EAAQ4B,WAAYb,EAAY3iC,EAAG2iC,EAAY5xB,GAAI5R,eAAgByjC,GAEnEH,EAAI14C,IAAK,EAAG,EAAG,GAET+qB,EAAI,EAAGA,EAAIguB,EAAgBhuB,IAAO,CAIvC,IAFAgpB,EAAO6E,EAAYxE,MAAOrpB,GAEpB2mB,EAAI,EAAGA,EAAI,KAEhB10B,EAAQ45B,EAAa7C,EAAMuD,EAAK5F,QACjBkH,EAAY3iC,GAAK+G,IAAU47B,EAAY5xB,GAHnC0qB,KAOpBgH,EAAIlyC,IAAKwW,GAIV07B,EAAItjC,eAAgB0jC,GACpBjB,EAAQrxC,IAAKkyC,GAEbE,EAAYf,QAAUW,EAAgB/wC,OACtC+wC,EAAgBvnC,KAAM4mC,GAiBvB,IAFAY,EAAoB,GAEdjxC,EAAI,EAAGo1B,EAAKga,EAAYnvC,OAAQD,EAAIo1B,EAAIp1B,IAAO,CAsDpD,IApDA4xC,EAAYxC,EAAapvC,GAMf,IAFVkV,GADAy8B,EAAkB1B,EAAcjwC,GAAIswC,OAChBrwC,QAInB5H,EAAO,EAAI,GAEA6c,EAAI,IAEf7c,EAAO,GAAM,EAAI6c,IAOlBs8B,EAAqB,EAAIt8B,EAAI7c,EAC7Bo5C,EAAyBp5C,EAEpB6c,GAAK,GAKC,GAALA,IAGJs8B,EAAqB,EAAI,EACzBC,EAAyB,EAAI,GAiB/BI,EAAkBD,EAAUjqC,QAAQiG,eAAgB4jC,GAEpDN,EAAI14C,IAAK,EAAG,EAAG,GAET+qB,EAAI,EAAGA,EAAIrO,EAAGqO,IAGnB/N,GADAk8B,EAAiBC,EAAiBpuB,IACX9U,IAAMmjC,EAAYF,EAAejjC,EAAIijC,EAAelyB,EAC3E0xB,EAAIlyC,IAAKwW,GAIV07B,EAAItjC,eAAgB6jC,GACpBI,EAAgB7yC,IAAKkyC,GAErBD,EAAkBxnC,KAAMooC,GAazBf,EAAcG,EAAkB/jC,OAAQ8jC,GACxC,IAAmCkB,EAAOC,EAAOC,EAG7C93B,EAAI+3B,EAAIC,EAAIC,EAHZC,EAAKvB,EAAkBhxC,OAC3BuwC,EAAW,GAGX,IAAIiC,EAAK,IAAIjpB,UACTkpB,EAAK,IAAIlpB,UACTmpB,EAAK,IAAInpB,UAEb,IAAMxpB,EAAI,EAAGo1B,EAAKia,EAASpvC,OAAQD,EAAIo1B,EAAIp1B,IAmB1C,GAPAuwC,EAASC,EANT0B,EAAQnC,GAJRxD,EAAO8C,EAAUrvC,IAIKyO,EAAG89B,EAAK/sB,EAAGuxB,GAAcV,QAAUmC,EACzDL,EAAQpC,EAASxD,EAAK/sB,EAAG+sB,EAAKxC,EAAGgH,GAAcV,QAAUmC,EACzDJ,EAAQrC,EAASxD,EAAKxC,EAAGwC,EAAK99B,EAAGsiC,GAAcV,QAAUmC,EAIjBjG,EAAK1M,eAC7C0Q,EAASC,EAAUjE,EAAK99B,EAAGyjC,EAAOE,EAAO7F,EAAK1M,eAC9C0Q,EAASC,EAAUjE,EAAK/sB,EAAG2yB,EAAOD,EAAO3F,EAAK1M,eAC9C0Q,EAASC,EAAUjE,EAAKxC,EAAGqI,EAAOD,EAAO5F,EAAK1M,eAIzCiS,EAEJ,IAAUvuB,EAAI,EAAGA,EAAIstB,EAAO5wC,OAAQsjB,IAInC8uB,GAFA/3B,EAAKu2B,EAAQttB,GAAKvjB,IAET,GACTsyC,EAAKh4B,EAAI,GACTi4B,EAAKj4B,EAAI,GAETm4B,EAAGj6C,IAAKk4C,EAAU2B,EAAG/0C,EAAGg1C,EAAGh1C,GAAKozC,EAAU2B,EAAG70C,EAAG80C,EAAG90C,IACnDk1C,EAAGl6C,IAAKk4C,EAAU4B,EAAGh1C,EAAGi1C,EAAGj1C,GAAKozC,EAAU4B,EAAG90C,EAAG+0C,EAAG/0C,IACnDm1C,EAAGn6C,IAAKk4C,EAAU2B,EAAG/0C,EAAGi1C,EAAGj1C,GAAKozC,EAAU2B,EAAG70C,EAAG+0C,EAAG/0C,IAEnDmzC,EAAOQ,EAAQ5tB,GAAKkvB,EAAIC,EAAIC,GAC5BhC,EAAOQ,EAAQ5tB,GAAK8uB,EAAII,EAAIE,GAE5BhC,EAAOQ,EAAQ5tB,GAAK+uB,EAAII,EAAID,GAC5B9B,EAAOQ,EAAQ5tB,GAAKgvB,EAAII,EAAID,GAS/B7uC,EAAS2F,SAAWsnC,EACpBjtC,EAAS+oC,MAAQ4D,EACZsB,IAASjuC,EAASkuC,cAAgBZ,IAnWzC,I,iCC3DA,8CAWIyB,EAAqB,SAAWC,GAEnCh8C,KAAKg8C,cAAgBA,GAItBD,EAAmBnuC,UAAUqqC,OAAS,SAAWjrC,GAQhD,IANA,IAAIqsC,EAEAtD,EAAQ,GACRmF,EAAgB,GAChBe,EAAuBj8C,KAAKg8C,cAAgBh8C,KAAKg8C,cAE3C7yC,EAAI,EAAGo1B,EAAKvxB,EAASkuC,cAAc9xC,OAAQD,EAAIo1B,EAAIp1B,IAE5D+xC,EAAe/xC,GAAM,GAItB,IAAUA,EAAI,EAAGo1B,EAAKvxB,EAAS+oC,MAAM3sC,OAAQD,EAAIo1B,EAAIp1B,IAAO,CAE3D,IAAIusC,EAAO1oC,EAAS+oC,MAAO5sC,GAE3B,GAAKusC,aAAgBkE,QAAQ,CAE5B,IAAIhiC,EAAI89B,EAAK99B,EACT+Q,EAAI+sB,EAAK/sB,EACTuqB,EAAIwC,EAAKxC,EAETgJ,EAAKlvC,EAAS2F,SAAUiF,GACxBukC,EAAKnvC,EAAS2F,SAAUgW,GACxByzB,EAAKpvC,EAAS2F,SAAUugC,GAExBmJ,EAAMH,EAAGI,kBAAmBH,GAC5BI,EAAMJ,EAAGG,kBAAmBF,GAC5BI,EAAMN,EAAGI,kBAAmBF,GAEhC,GAAKC,EAAMJ,GAAwBM,EAAMN,GAAwBO,EAAMP,EAAuB,CAE7F,IAAIrH,EAAI5nC,EAAS2F,SAASvJ,OAEtBqzC,EAAO/G,EAAK5kC,QACZ4rC,EAAOhH,EAAK5kC,QAEhB,GAAKurC,GAAOE,GAAOF,GAAOG,EAAM,CAa/B,IAXIG,EAAKT,EAAGprC,SACT+G,KAAMskC,EAAI,IAEbM,EAAK7kC,EAAIA,EACT6kC,EAAK9zB,EAAIisB,EACT6H,EAAKvJ,EAAIA,EAETwJ,EAAK9kC,EAAIg9B,EACT8H,EAAK/zB,EAAIA,EACT+zB,EAAKxJ,EAAIA,EAE0B,IAA9BwC,EAAKkH,cAAcxzC,QAEnByzC,EAAMnH,EAAKkH,cAAe,GAAI9rC,SAC9B+G,KAAM69B,EAAKkH,cAAe,GAAK,IAEnCH,EAAKG,cAAe,GAAInvC,KAAMovC,GAC9BH,EAAKE,cAAe,GAAInvC,KAAMovC,GAI/B,GAAkC,IAA7BnH,EAAK9M,aAAax/B,QAElB0zC,EAAMpH,EAAK9M,aAAc,GAAI93B,SAC7B+G,KAAM69B,EAAK9M,aAAc,GAAK,IAElC6T,EAAK7T,aAAc,GAAIn7B,KAAMqvC,GAC7BJ,EAAK9T,aAAc,GAAIn7B,KAAMqvC,GAI9BzD,EAAO,OAED,GAAKkD,GAAOF,GAAOE,GAAOC,EAAM,CAatC,IAXIG,EAAKR,EAAGrrC,SACT+G,KAAMukC,EAAI,IAEbK,EAAK7kC,EAAIA,EACT6kC,EAAK9zB,EAAIA,EACT8zB,EAAKvJ,EAAI0B,EAET8H,EAAK9kC,EAAIg9B,EACT8H,EAAK/zB,EAAIuqB,EACTwJ,EAAKxJ,EAAIt7B,EAE0B,IAA9B89B,EAAKkH,cAAcxzC,QAEnByzC,EAAMnH,EAAKkH,cAAe,GAAI9rC,SAC9B+G,KAAM69B,EAAKkH,cAAe,GAAK,IAEnCH,EAAKG,cAAe,GAAInvC,KAAMovC,GAE9BH,EAAKE,cAAe,GAAInvC,KAAMovC,GAC9BH,EAAKE,cAAe,GAAInvC,KAAMioC,EAAKkH,cAAe,IAClDF,EAAKE,cAAe,GAAInvC,KAAMioC,EAAKkH,cAAe,IAInD,GAAkC,IAA7BlH,EAAK9M,aAAax/B,QAElB0zC,EAAMpH,EAAK9M,aAAc,GAAI93B,SAC7B+G,KAAM69B,EAAK9M,aAAc,GAAK,IAElC6T,EAAK7T,aAAc,GAAIn7B,KAAMqvC,GAE7BJ,EAAK9T,aAAc,GAAIn7B,KAAMqvC,GAC7BJ,EAAK9T,aAAc,GAAIn7B,KAAMioC,EAAK9M,aAAc,IAChD8T,EAAK9T,aAAc,GAAIn7B,KAAMioC,EAAK9M,aAAc,IAIjDyQ,EAAO,MAED,CAEN,IAAIsD,EAaCE,EAUAC,EAZL,IAXIH,EAAKT,EAAGprC,SACT+G,KAAMukC,EAAI,IAEbK,EAAK7kC,EAAIA,EACT6kC,EAAK9zB,EAAIA,EACT8zB,EAAKvJ,EAAI0B,EAET8H,EAAK9kC,EAAIg9B,EACT8H,EAAK/zB,EAAIA,EACT+zB,EAAKxJ,EAAIA,EAE0B,IAA9BwC,EAAKkH,cAAcxzC,QAEnByzC,EAAMnH,EAAKkH,cAAe,GAAI9rC,SAC9B+G,KAAM69B,EAAKkH,cAAe,GAAK,IAEnCH,EAAKG,cAAe,GAAInvC,KAAMovC,GAC9BH,EAAKE,cAAe,GAAInvC,KAAMovC,GAI/B,GAAkC,IAA7BnH,EAAK9M,aAAax/B,QAElB0zC,EAAMpH,EAAK9M,aAAc,GAAI93B,SAC7B+G,KAAM69B,EAAK9M,aAAc,GAAK,IAElC6T,EAAK7T,aAAc,GAAIn7B,KAAMqvC,GAC7BJ,EAAK9T,aAAc,GAAIn7B,KAAMqvC,GAI9BzD,EAAO,EAIRtD,EAAMnjC,KAAM6pC,EAAMC,GAClB1vC,EAAS2F,SAASC,KAAM+pC,GAExB,IAAM,IAAIjwB,EAAI,EAAGuhB,EAAKjhC,EAASkuC,cAAc9xC,OAAQsjB,EAAIuhB,EAAIvhB,IAE5D,GAAK1f,EAASkuC,cAAexuB,GAAItjB,OAAS,CAEzC,IAAI2zC,EAAM/vC,EAASkuC,cAAexuB,GAAKvjB,GAEnC6zC,EAAMD,EAAK,GACXE,EAAMF,EAAK,GACXG,EAAMH,EAAK,GAIf,GAAc,IAAT1D,EAAa,EAEb8D,EAAMH,EAAIlsC,SACV+G,KAAMolC,EAAK,IAEf,IAAIG,EAAU,CAAEJ,EAAIlsC,QAASqsC,EAAIrsC,QAASosC,EAAIpsC,SAC1CusC,EAAU,CAAEF,EAAIrsC,QAASmsC,EAAInsC,QAASosC,EAAIpsC,cAIxC,GAAc,IAATuoC,EAAa,EAEpB8D,EAAMF,EAAInsC,SACV+G,KAAMqlC,EAAK,IAEXE,EAAU,CAAEJ,EAAIlsC,QAASmsC,EAAInsC,QAASqsC,EAAIrsC,SAC1CusC,EAAU,CAAEF,EAAIrsC,QAASosC,EAAIpsC,QAASksC,EAAIlsC,aAIxC,CAEN,IAAIqsC,KAAMH,EAAIlsC,SACV+G,KAAMqlC,EAAK,IAEXE,EAAU,CAAEJ,EAAIlsC,QAASmsC,EAAInsC,QAASqsC,EAAIrsC,SAC1CusC,EAAU,CAAEF,EAAIrsC,QAASmsC,EAAInsC,QAASosC,EAAIpsC,SAI/CoqC,EAAexuB,GAAI9Z,KAAMwqC,EAASC,QAM9B,CAENtH,EAAMnjC,KAAM8iC,GAEZ,IAAUhpB,EAAI,EAAGuhB,EAAKjhC,EAASkuC,cAAc9xC,OAAQsjB,EAAIuhB,EAAIvhB,IAE5DwuB,EAAexuB,GAAI9Z,KAAM5F,EAASkuC,cAAexuB,GAAKvjB,MAU1D6D,EAAS+oC,MAAQA,EACjB/oC,EAASkuC,cAAgBA,I,iCC7O1B,8CAyBIoC,EAAM,SAANA,IAEH,IAAI5oB,EAAS4oB,EAAIC,UAEbtwC,EAAW,IAAIikC,iBAAgB,CAClCtc,eAAgBF,EAAOE,eACvBwc,aAAc1c,EAAO0c,aACrBld,SAAUid,gBAAcrgC,MAAO4jB,EAAOR,UACtC3jB,KAAMitC,WACNntC,YAAY,IAGb4C,OAAKlL,KAAM/H,KAAM,IAAIoS,oBAAmB,EAAG,EAAG,GAAKnF,IAIpDqwC,EAAI1vC,UAAYrC,OAAOwE,OAAQkD,OAAKrF,WAEpC0vC,EAAIC,UAAY,CAEfrpB,SAAU,CACT,UAAa,CAAEzoB,MAAO,GACtB,UAAa,CAAEA,MAAO,GACtB,SAAY,CAAEA,MAAO,GACrB,eAAkB,CAAEA,MAAO,MAC3B,gBAAmB,CAAEA,MAAO,IAC5B,YAAe,CAAEA,MAAO,IAAI3K,WAC5B,GAAM,CAAE2K,MAAO,IAAI3K,UAAS,EAAG,EAAG,KAGnCswC,aAAc,CACb,4BACA,0BACA,2BACA,gCACA,mBAEA,+BACA,8BACA,0BACA,uBACA,uBACA,uBAGA,2EACA,iEAGA,sDAGA,yGAIA,uBACA,8CAEA,qGAIA,gDACA,+BACA,2BAEA,+CACA,yDACA,uGACA,IAEA,6BACA,oCACA,iCACA,IAEA,gBAEA,8DACA,wCAEA,8EACA,mCAEA,8CAEA,sDAEA,mFAEA,yEAIA,kDAGA,qDAEA,KACClpB,KAAM,MAER0M,eAAgB,CACf,+BACA,8BACA,0BACA,uBACA,uBACA,uBAEA,2BACA,iCACA,mBAEA,gDAGA,iEAEA,0BACA,4BAGA,4CACA,wCAEA,mGAGA,0DAEA,qDAEA,0CACA,kEACA,IAEA,6CACA,8BACA,qEACA,yDACA,IAGA,wBACA,wBACA,wBACA,wBACA,wBACA,wBAEA,+CAEA,qCACA,0FACA,IAGA,gBAEA,8DAIA,kEACA,oHACA,+CACA,0CAGA,sDAGA,sDAEA,0DACA,uCAEA,yDACA,uCAEA,kHACA,6LAGA,iFACA,yFACA,4EACA,iCAGA,oGACA,+CAEA,wEAEA,yFACA,oCAEA,8EAEA,0CAEA,KACC1M,KAAM,Q,oECpOT,SAASnY,EAAO0tC,GACd,IAAI9K,EACE+K,EAAY,IAAIC,IAEhBC,EAAW,SAACC,EAAS3gC,GACzB,IAAM4gC,EAA+B,oBAAZD,EAAyBA,EAAQlL,GAASkL,EAE/DC,IAAcnL,IAChBA,EAAQz1B,EAAU4gC,EAAYvyC,OAAOuE,OAAO,GAAI6iC,EAAOmL,GACvDJ,EAAUK,SAAQ,SAAAC,GAAQ,OAAIA,EAASrL,QAIrCsL,EAAW,kBAAMtL,GAqCjBuL,EAAM,CACVN,WACAK,WACAE,UAfgB,SAACH,EAAUI,EAAUC,GACrC,OAAID,GAAYC,EAxBY,SAACL,GAA0D,IAAhDI,EAAgD,uDAArCH,EAAUI,EAA2B,uDAAd9yC,OAAO+yC,GAC5EC,EAAeH,EAASzL,GAE5B,SAAS6L,IAIP,IACE,IAAMC,EAAgBL,EAASzL,GAE1B0L,EAAWE,EAAcE,IAC5BT,EAASO,EAAeE,GAE1B,MAAOl8C,GACPy7C,EAAS,KAAMz7C,IAMnB,OAFAm7C,EAAUv1C,IAAIq2C,GAEP,kBAAMd,EAAUgB,OAAOF,IAKrBG,CAAsBX,EAAUI,EAAUC,IAGnDX,EAAUv1C,IAAI61C,GAEP,kBAAMN,EAAUgB,OAAOV,MAS9BhzB,QANc,kBAAM0yB,EAAU7/B,UAShC,OADA80B,EAAQ8K,EAAYG,EAAUK,EAAUC,GACjCA,EAGT,IAAMU,EAAuC,qBAAXl+C,OAAyBm+C,YAAYC,kBA+ExDC,IA9Ef,SAAkBtB,GAChB,IAAMS,EAA6B,oBAAhBT,EAA6B1tC,EAAO0tC,GAAeA,EAEhEuB,EAAW,WAAqD,IAahEP,EAbYL,EAAoD,uDAAzCF,EAAID,SAAUI,EAA2B,uDAAd9yC,OAAO+yC,GAAO,EAC5CW,sBAAW,SAAA/L,GAAC,OAAIA,EAAI,IAAG,GADqB,mBAC3DgM,EAD2D,KAE9DvM,EAAQuL,EAAID,WACZkB,EAAWC,iBAAOzM,GAClB0M,EAAcD,iBAAOhB,GACrBkB,EAAgBF,iBAAOf,GACvBkB,EAAaH,kBAAO,GACpBI,EAAkBJ,wBAEQp9C,IAA5Bw9C,EAAgBC,UAClBD,EAAgBC,QAAUrB,EAASzL,IAIrC,IAAI+M,GAAmB,GAInBP,EAASM,UAAY9M,GAAS0M,EAAYI,UAAYrB,GAAYkB,EAAcG,UAAYpB,GAAckB,EAAWE,WAEvHhB,EAAgBL,EAASzL,GACzB+M,GAAoBrB,EAAWmB,EAAgBC,QAAShB,IAI1DG,GAAmB,WACbc,IACFF,EAAgBC,QAAUhB,GAG5BU,EAASM,QAAU9M,EACnB0M,EAAYI,QAAUrB,EACtBkB,EAAcG,QAAUpB,EACxBkB,EAAWE,SAAU,KAEvB,IAAME,EAA6BP,iBAAOzM,GA0B1C,OAzBAkM,qBAAU,WACR,IAAMb,EAAW,WACf,IACE,IAAMF,EAAYI,EAAID,WAChB2B,EAAiBP,EAAYI,QAAQ3B,GAEtCwB,EAAcG,QAAQD,EAAgBC,QAASG,KAClDT,EAASM,QAAU3B,EACnB0B,EAAgBC,QAAUG,EAC1BV,KAEF,MAAO38C,GACPg9C,EAAWE,SAAU,EACrBP,MAIEW,EAAc3B,EAAIC,UAAUH,GAMlC,OAJIE,EAAID,aAAe0B,EAA2BF,SAChDzB,IAGK6B,IACN,IACIH,EAAmBjB,EAAgBe,EAAgBC,SAW5D,OARAl0C,OAAOuE,OAAOkvC,EAAUd,GAExBc,EAAS3lC,OAAOymC,UAAhB,UAA4B,8EAE1B,OADAt9C,QAAQgB,KAAK,sEADa,SAEpBw7C,EAFoB,OAG1B,OAH0B,SAGpBd,EAHoB,0CAMrBc,I,gCC1IT,8CAsBAe,cAAYC,KAAO,CAElBpvC,UAAW,CAAEnF,MAAO,GACpBw0C,WAAY,CAAEx0C,MAAO,IAAIknB,UAAS,EAAG,IACrCutB,UAAW,CAAEz0C,MAAO,GACpB00C,SAAU,CAAE10C,MAAO,GACnB20C,QAAS,CAAE30C,MAAO,GAClBsF,QAAS,CAAEtF,MAAO,IAInB40C,YAAS,KAAa,CAErBnsB,SAAUid,gBAAcmP,MAAO,CAC9BP,cAAYQ,OACZR,cAAYtvC,IACZsvC,cAAYC,OAGb5O,aAAY,qvHAmJZxc,eAAc,2uCA4Df,IAAI4rB,EAAe,SAAWxT,GAE7BkE,iBAAenpC,KAAM/H,KAAM,CAE1BwI,KAAM,eAEN0rB,SAAUid,gBAAcrgC,MAAOuvC,YAAS,KAAWnsB,UAEnDkd,aAAciP,YAAS,KAAWjP,aAClCxc,eAAgByrB,YAAS,KAAWzrB,eAEpC6rB,UAAU,IAIXzgD,KAAK0gD,QAAS,EAEdn1C,OAAOspB,iBAAkB70B,KAAM,CAE9BkR,MAAO,CAENyvC,YAAY,EAEZn1C,IAAK,WAEJ,OAAOxL,KAAKk0B,SAAS0sB,QAAQn1C,OAI9B9J,IAAK,SAAW8J,GAEfzL,KAAKk0B,SAAS0sB,QAAQn1C,MAAQA,IAMhCmF,UAAW,CAEV+vC,YAAY,EAEZn1C,IAAK,WAEJ,OAAOxL,KAAKk0B,SAAStjB,UAAUnF,OAIhC9J,IAAK,SAAW8J,GAEfzL,KAAKk0B,SAAStjB,UAAUnF,MAAQA,IAMlCy0C,UAAW,CAEVS,YAAY,EAEZn1C,IAAK,WAEJ,OAAOxL,KAAKk0B,SAASgsB,UAAUz0C,OAIhC9J,IAAK,SAAW8J,GAEfzL,KAAKk0B,SAASgsB,UAAUz0C,MAAQA,IAMlC00C,SAAU,CAETQ,YAAY,EAEZn1C,IAAK,WAEJ,OAAOxL,KAAKk0B,SAASisB,SAAS10C,OAI/B9J,IAAK,SAAW8J,GAEfzL,KAAKk0B,SAASisB,SAAS10C,MAAQA,IAMjC20C,QAAS,CAERO,YAAY,EAEZn1C,IAAK,WAEJ,OAAOxL,KAAKk0B,SAASksB,QAAQ30C,OAI9B9J,IAAK,SAAW8J,GAEfzL,KAAKk0B,SAASksB,QAAQ30C,MAAQA,IAMhCsF,QAAS,CAER4vC,YAAY,EAEZn1C,IAAK,WAEJ,OAAOxL,KAAKk0B,SAASnjB,QAAQtF,OAI9B9J,IAAK,SAAW8J,GAEfzL,KAAKk0B,SAASnjB,QAAQtF,MAAQA,IAMhCw0C,WAAY,CAEXU,YAAY,EAEZn1C,IAAK,WAEJ,OAAOxL,KAAKk0B,SAAS+rB,WAAWx0C,OAIjC9J,IAAK,SAAW8J,GAEfzL,KAAKk0B,SAAS+rB,WAAWx0C,MAAMgC,KAAMhC,OAQxCzL,KAAKq1B,UAAW2X,IAIjBwT,EAAa5yC,UAAYrC,OAAOwE,OAAQmhC,iBAAetjC,WACvD4yC,EAAa5yC,UAAUoC,YAAcwwC,EAErCA,EAAa5yC,UAAUizC,gBAAiB,G,gCClZxC,8CAQIC,EAAe,WAElBC,IAAqBh5C,KAAM/H,MAE3BA,KAAKwI,KAAO,gBAIbs4C,EAAalzC,UAAYrC,OAAOuE,OAAQvE,OAAOwE,OAAQgxC,IAAqBnzC,WAAa,CAExFoC,YAAa8wC,EAEbE,gBAAgB,EAEhBC,aAAc,SAAWnoC,GAOxB,IAHA,IAAI1P,EAAS0P,EAAM1P,OAAS,EACxB83C,EAAS,IAAIx3B,aAAc,EAAItgB,GAEzBD,EAAI,EAAGA,EAAIC,EAAQD,GAAK,EAEjC+3C,EAAQ,EAAI/3C,GAAM2P,EAAO3P,GACzB+3C,EAAQ,EAAI/3C,EAAI,GAAM2P,EAAO3P,EAAI,GACjC+3C,EAAQ,EAAI/3C,EAAI,GAAM2P,EAAO3P,EAAI,GAEjC+3C,EAAQ,EAAI/3C,EAAI,GAAM2P,EAAO3P,EAAI,GACjC+3C,EAAQ,EAAI/3C,EAAI,GAAM2P,EAAO3P,EAAI,GACjC+3C,EAAQ,EAAI/3C,EAAI,GAAM2P,EAAO3P,EAAI,GAMlC,OAFA43C,IAAqBnzC,UAAUqzC,aAAal5C,KAAM/H,KAAMkhD,GAEjDlhD,MAIRmhD,UAAW,SAAWroC,GAOrB,IAHA,IAAI1P,EAAS0P,EAAM1P,OAAS,EACxBg4C,EAAS,IAAI13B,aAAc,EAAItgB,GAEzBD,EAAI,EAAGA,EAAIC,EAAQD,GAAK,EAEjCi4C,EAAQ,EAAIj4C,GAAM2P,EAAO3P,GACzBi4C,EAAQ,EAAIj4C,EAAI,GAAM2P,EAAO3P,EAAI,GACjCi4C,EAAQ,EAAIj4C,EAAI,GAAM2P,EAAO3P,EAAI,GAEjCi4C,EAAQ,EAAIj4C,EAAI,GAAM2P,EAAO3P,EAAI,GACjCi4C,EAAQ,EAAIj4C,EAAI,GAAM2P,EAAO3P,EAAI,GACjCi4C,EAAQ,EAAIj4C,EAAI,GAAM2P,EAAO3P,EAAI,GAMlC,OAFA43C,IAAqBnzC,UAAUuzC,UAAUp5C,KAAM/H,KAAMohD,GAE9CphD,MAIRqhD,SAAU,SAAWrB,GAEpB,IAAIhzC,EAAWgzC,EAAKhzC,SAcpB,OAZKA,EAASs0C,WAEbthD,KAAKihD,aAAcj0C,EAAS2F,UAEjB3F,EAASkrC,kBAEpBl4C,KAAKihD,aAAcj0C,EAASka,WAAW3Y,SAASuK,OAM1C9Y,MAIRyN,KAAM,WAIL,OAAOzN,S,8FC9ELuhD,EAAgB,SAAWv0C,EAAUC,GAExCgG,OAAKlL,KAAM/H,MAEXA,KAAKwI,KAAO,gBAEZxI,KAAKgN,cAAwBhL,IAAbgL,EAAyBA,EAAW,IAAI+zC,IACxD/gD,KAAKiN,cAAwBjL,IAAbiL,EAAyBA,EAAW,IAAIuzC,IAAc,CAAEtvC,MAAuB,SAAhB9P,KAAKogD,YAIrFD,EAAc3zC,UAAYrC,OAAOuE,OAAQvE,OAAOwE,OAAQkD,OAAKrF,WAAa,CAEzEoC,YAAauxC,EAEbE,iBAAiB,EAEjBC,qBAAwB,WAEvB,IAAIlnC,EAAQ,IAAI1Z,UACZyzC,EAAM,IAAIzzC,UAEd,OAAO,WAQN,IANA,IAAIkM,EAAWhN,KAAKgN,SAEhB20C,EAAgB30C,EAASka,WAAWy6B,cACpCC,EAAc50C,EAASka,WAAW06B,YAClCC,EAAgB,IAAIn4B,aAAc,EAAIi4B,EAAc5hC,KAAK2hB,OAEnDv4B,EAAI,EAAGujB,EAAI,EAAG8mB,EAAImO,EAAc5hC,KAAK2hB,MAAOv4B,EAAIqqC,EAAGrqC,IAAMujB,GAAK,EAEvElS,EAAMsnC,oBAAqBH,EAAex4C,GAC1CorC,EAAIuN,oBAAqBF,EAAaz4C,GAEtC04C,EAAen1B,GAAc,IAANA,EAAY,EAAIm1B,EAAen1B,EAAI,GAC1Dm1B,EAAen1B,EAAI,GAAMm1B,EAAen1B,GAAMlS,EAAMpL,WAAYmlC,GAIjE,IAAIwN,EAAyB,IAAIC,6BAA4BH,EAAe,EAAG,GAK/E,OAHA70C,EAAStJ,aAAc,wBAAyB,IAAI8hC,6BAA4Buc,EAAwB,EAAG,IAC3G/0C,EAAStJ,aAAc,sBAAuB,IAAI8hC,6BAA4Buc,EAAwB,EAAG,IAElG/hD,MA5Be,GAkCxBiiD,QAAW,WAEV,IAAIznC,EAAQ,IAAIg2B,UACZ+D,EAAM,IAAI/D,UAEV0R,EAAW,IAAI1R,UACf2R,EAAY,IAAIrhD,UAChBshD,EAAW,IAAIxsC,UACfoqC,EAAO,IAAIqC,QACXC,EAAe,IAAIxhD,UAEvB,OAAO,SAAkB+H,EAAW05C,GAET,OAArB15C,EAAUhB,QAEdrF,QAAQD,MAAO,gGAIhB,IAAIigD,EAAM35C,EAAU25C,IAChB36C,EAASgB,EAAUhB,OACnB+pC,EAAmB/pC,EAAO+pC,iBAE1B5kC,EAAWhN,KAAKgN,SAChBC,EAAWjN,KAAKiN,SAChBgzC,EAAahzC,EAASgzC,WACtBwC,EAAYx1C,EAAS2D,UAErB+wC,EAAgB30C,EAASka,WAAWy6B,cACpCC,EAAc50C,EAASka,WAAW06B,YAKtCY,EAAIE,GAAI,EAAGR,GAGXA,EAAShQ,EAAI,EACbgQ,EAAS/sC,aAActN,EAAOgqC,oBAC9BqQ,EAAS/sC,aAAcy8B,GACvBsQ,EAASnrC,eAAgB,EAAImrC,EAAShQ,GAGtCgQ,EAASz7C,GAAKw5C,EAAWx5C,EAAI,EAC7By7C,EAASv7C,GAAKs5C,EAAWt5C,EAAI,EAC7Bu7C,EAASr7C,EAAI,EAEbs7C,EAAU10C,KAAMy0C,GAEhB,IAAI30C,EAAcvN,KAAKuN,YACvB60C,EAASO,iBAAkB96C,EAAOgqC,mBAAoBtkC,GAEtD,IAAM,IAAIpE,EAAI,EAAGqqC,EAAImO,EAAcjgB,MAAOv4B,EAAIqqC,EAAGrqC,IAAO,CAEvDqR,EAAMsnC,oBAAqBH,EAAex4C,GAC1CorC,EAAIuN,oBAAqBF,EAAaz4C,GAEtCqR,EAAM03B,EAAI,EACVqC,EAAIrC,EAAI,EAGR13B,EAAMrF,aAAcitC,GACpB7N,EAAIp/B,aAAcitC,GAGlB5nC,EAAMrF,aAAcy8B,GACpB2C,EAAIp/B,aAAcy8B,GAGlBp3B,EAAMzD,eAAgB,EAAIyD,EAAM03B,GAChCqC,EAAIx9B,eAAgB,EAAIw9B,EAAIrC,GAG5B,IAAI0Q,EAAqBpoC,EAAM3T,GAAM,GAAK0tC,EAAI1tC,GAAM,EAChDg8C,EAAkBroC,EAAM3T,EAAI,GAAK0tC,EAAI1tC,EAAI,EAC7C,IAAK+7C,IAAsBC,EAA3B,CAOAroC,EAAM/T,GAAKw5C,EAAWx5C,EAAI,EAC1B+T,EAAM7T,GAAKs5C,EAAWt5C,EAAI,EAE1B4tC,EAAI9tC,GAAKw5C,EAAWx5C,EAAI,EACxB8tC,EAAI5tC,GAAKs5C,EAAWt5C,EAAI,EAGxBq5C,EAAKxlC,MAAM/M,KAAM+M,GACjBwlC,EAAKxlC,MAAM3T,EAAI,EAEfm5C,EAAKzL,IAAI9mC,KAAM8mC,GACfyL,EAAKzL,IAAI1tC,EAAI,EAGb,IAAIi8C,EAAQ9C,EAAK+C,6BAA8BZ,GAAW,GAC1DnC,EAAK0C,GAAII,EAAOR,GAGhB,IAAIU,EAAOngD,YAAUgV,KAAM2C,EAAM3T,EAAG0tC,EAAI1tC,EAAGi8C,GACvCG,EAAgBD,IAAU,GAAKA,GAAQ,EAEvCE,EAAWf,EAAU/yC,WAAYkzC,GAA6B,GAAZG,EAEtD,GAAKQ,GAAiBC,EAAW,CAEhClD,EAAKxlC,MAAMsnC,oBAAqBH,EAAex4C,GAC/C62C,EAAKzL,IAAIuN,oBAAqBF,EAAaz4C,GAE3C62C,EAAKxlC,MAAMrF,aAAc5H,GACzByyC,EAAKzL,IAAIp/B,aAAc5H,GAEvB,IAAI41C,EAAc,IAAIriD,UAClB2N,EAAQ,IAAI3N,UAEhB0hD,EAAIY,oBAAqBpD,EAAKxlC,MAAOwlC,EAAKzL,IAAK9lC,EAAO00C,GAEtDZ,EAAW3vC,KAAM,CAEhBnE,MAAOA,EACP00C,YAAaA,EACbjhC,SAAUsgC,EAAIa,OAAOj0C,WAAYX,GAEjC3O,OAAQE,KACR01C,KAAM,KACN4N,UAAWn6C,EACXsa,GAAI,KACJslB,IAAK,WAhIC,K,YC3DRwa,EAAQ,SAAWv2C,EAAUC,GAEhCs0C,EAAcx5C,KAAM/H,MAEpBA,KAAKwI,KAAO,QAEZxI,KAAKgN,cAAwBhL,IAAbgL,EAAyBA,EAAW,IAAI8zC,IACxD9gD,KAAKiN,cAAwBjL,IAAbiL,EAAyBA,EAAW,IAAIuzC,IAAc,CAAEtvC,MAAuB,SAAhB9P,KAAKogD,YAIrF+B,EAAM31C,UAAYrC,OAAOuE,OAAQvE,OAAOwE,OAAQwxC,EAAc3zC,WAAa,CAE1EoC,YAAauzC,EAEbC,SAAS,K,gCCzBV,8CAeIC,EAAoB,SAAW3jD,EAAQmD,QAEtBjB,IAAfiB,GAA2BT,QAAQgB,KAAM,gFACzCP,IAAeQ,UAAWjB,QAAQD,MAAO,gIAE9C,IAAImhD,EAAQ1jD,KACR2jD,GAAkB,EAAlBA,EAA6B,EAA7BA,EAAsC,EAAtCA,EAA8C,EAA9CA,EAA+D,EAA/DA,EAAkF,EAEtF3jD,KAAKF,OAASA,EACdE,KAAKiD,WAAaA,EAIlBjD,KAAKG,SAAU,EAEfH,KAAK4jD,OAAS,CAAEx/C,KAAM,EAAGgI,IAAK,EAAGF,MAAO,EAAGG,OAAQ,GAEnDrM,KAAK6jD,YAAc,EACnB7jD,KAAK8jD,UAAY,IACjB9jD,KAAK+jD,SAAW,GAEhB/jD,KAAKgkD,UAAW,EAChBhkD,KAAKikD,QAAS,EACdjkD,KAAKkkD,OAAQ,EAEblkD,KAAKmkD,cAAe,EACpBnkD,KAAKokD,qBAAuB,GAE5BpkD,KAAKqkD,YAAc,EACnBrkD,KAAKskD,YAAchvC,IAEnBtV,KAAK6c,KAAO,CAAE,GAAU,GAAU,IAElC7c,KAAKukD,aAAe,CAAEC,KAAMC,QAAMC,OAAQC,OAAQF,QAAMG,KAAMC,MAAOJ,QAAMK,KAI3E9kD,KAAK8wB,OAAS,IAAIhwB,UAElB,IAEIikD,EAAe,IAAIjkD,UACnBkkD,EAAW,EAEXC,EAAStB,EACZuB,EAAYvB,EAEZwB,EAAO,IAAIrkD,UAEXskD,EAAY,IAAIzyB,UAChB0yB,EAAY,IAAI1yB,UAEhB2yB,EAAY,IAAIxkD,UAChBykD,EAAa,EAEbC,EAAa,IAAI7yB,UACjB8yB,EAAW,IAAI9yB,UAEf+yB,EAA0B,EAC1BC,EAAwB,EAExBC,EAAY,IAAIjzB,UAChBkzB,EAAU,IAAIlzB,UAIf3yB,KAAK8lD,QAAU9lD,KAAK8wB,OAAOhgB,QAC3B9Q,KAAK+lD,UAAY/lD,KAAKF,OAAOyO,SAASuC,QACtC9Q,KAAKgmD,IAAMhmD,KAAKF,OAAOoE,GAAG4M,QAC1B9Q,KAAKimD,MAAQjmD,KAAKF,OAAO6W,KAIzB,IAAIpO,EAAc,CAAEC,KAAM,UACtB09C,EAAa,CAAE19C,KAAM,SACrB29C,EAAW,CAAE39C,KAAM,OAKvBxI,KAAKomD,aAAe,WAEnB,IAAIxmB,EAAM5/B,KAAKiD,WAAW+I,wBAEtBgD,EAAIhP,KAAKiD,WAAWojD,cAAcC,gBACtCtmD,KAAK4jD,OAAOx/C,KAAOw7B,EAAIx7B,KAAO1D,OAAO6lD,YAAcv3C,EAAEw3C,WACrDxmD,KAAK4jD,OAAOx3C,IAAMwzB,EAAIxzB,IAAM1L,OAAO+lD,YAAcz3C,EAAE03C,UACnD1mD,KAAK4jD,OAAO13C,MAAQ0zB,EAAI1zB,MACxBlM,KAAK4jD,OAAOv3C,OAASuzB,EAAIvzB,QAI1B,IAAIs6C,EAAqB,WAExB,IAAI3mB,EAAS,IAAIrN,UAEjB,OAAO,SAA2B1sB,EAAOE,GAOxC,OALA65B,EAAOr+B,KACJsE,EAAQy9C,EAAME,OAAOx/C,MAASs/C,EAAME,OAAO13C,OAC3C/F,EAAQu9C,EAAME,OAAOx3C,KAAQs3C,EAAME,OAAOv3C,QAGtC2zB,GAXgB,GAiBrB4mB,EAAqB,WAExB,IAAI5mB,EAAS,IAAIrN,UAEjB,OAAO,SAA2B1sB,EAAOE,GAOxC,OALA65B,EAAOr+B,KACFsE,EAA6B,GAArBy9C,EAAME,OAAO13C,MAAcw3C,EAAME,OAAOx/C,OAAgC,GAArBs/C,EAAME,OAAO13C,QACxEw3C,EAAME,OAAOv3C,OAAS,GAAMq3C,EAAME,OAAOx3C,IAAMjG,IAAYu9C,EAAME,OAAO13C,OAGtE8zB,GAXgB,GA8RzB,SAASh7B,EAASxE,IAEM,IAAlBkjD,EAAMvjD,UAEXO,OAAOgC,oBAAqB,UAAWsC,GAElCkgD,IAAcvB,IAIPnjD,EAAM0E,UAAYw+C,EAAM7mC,KAAM8mC,IAAoBD,EAAMM,SAIxDxjD,EAAM0E,UAAYw+C,EAAM7mC,KAAM8mC,IAAkBD,EAAMO,OAItDzjD,EAAM0E,UAAYw+C,EAAM7mC,KAAM8mC,IAAiBD,EAAMQ,QAEhEgB,EAAYvB,GAJZuB,EAAYvB,EAJZuB,EAAYvB,IAcd,SAASr+C,KAEe,IAAlBo+C,EAAMvjD,UAEX+kD,EAAYvB,EAEZjjD,OAAO2B,iBAAkB,UAAW2C,GAAS,IAI9C,SAASO,EAAW/E,GAEnB,IAAuB,IAAlBkjD,EAAMvjD,QAAX,CAKA,GAHAK,EAAM+C,iBACN/C,EAAMiF,kBAEDw/C,IAAWtB,EAEf,OAASnjD,EAAMkF,QAEd,KAAKg+C,EAAMa,aAAaC,KACvBS,EAAStB,EACT,MAED,KAAKD,EAAMa,aAAaI,OACvBM,EAAStB,EACT,MAED,KAAKD,EAAMa,aAAaM,MACvBI,EAAStB,EACT,MAED,QACCsB,EAAStB,EAMZ,IAAIhR,EAAUuS,IAAcvB,EAAeuB,EAAYD,EAElDtS,IAAUgR,GAAkBD,EAAMM,SAK3BrR,IAAUgR,GAAgBD,EAAMO,OAKhCtR,IAAUgR,GAAeD,EAAMQ,QAE1C0B,EAAUn4C,KAAMk5C,EAAkBnmD,EAAMyF,MAAOzF,EAAM2F,QACrD0/C,EAAQp4C,KAAMm4C,KANdJ,EAAW/3C,KAAMk5C,EAAkBnmD,EAAMyF,MAAOzF,EAAM2F,QACtDs/C,EAASh4C,KAAM+3C,KANfH,EAAU53C,KAAMm5C,EAAkBpmD,EAAMyF,MAAOzF,EAAM2F,QACrDi/C,EAAU33C,KAAM43C,IAcjB5hD,SAASpB,iBAAkB,YAAasD,GAAW,GACnDlC,SAASpB,iBAAkB,UAAW+D,GAAS,GAE/Cs9C,EAAMh4C,cAAew6C,IAItB,SAASvgD,EAAWnF,GAEnB,IAAuB,IAAlBkjD,EAAMvjD,QAAX,CAEAK,EAAM+C,iBACN/C,EAAMiF,kBAEN,IAAIktC,EAAUuS,IAAcvB,EAAeuB,EAAYD,EAElDtS,IAAUgR,GAAkBD,EAAMM,SAK3BrR,IAAUgR,GAAgBD,EAAMO,OAIhCtR,IAAUgR,GAAeD,EAAMQ,OAE1C2B,EAAQp4C,KAAMk5C,EAAkBnmD,EAAMyF,MAAOzF,EAAM2F,QAJnDs/C,EAASh4C,KAAMk5C,EAAkBnmD,EAAMyF,MAAOzF,EAAM2F,SALpDi/C,EAAU33C,KAAM43C,GAChBA,EAAU53C,KAAMm5C,EAAkBpmD,EAAMyF,MAAOzF,EAAM2F,UAcvD,SAASC,EAAS5F,IAEM,IAAlBkjD,EAAMvjD,UAEXK,EAAM+C,iBACN/C,EAAMiF,kBAENw/C,EAAStB,EAETlgD,SAASf,oBAAqB,YAAaiD,GAC3ClC,SAASf,oBAAqB,UAAW0D,GACzCs9C,EAAMh4C,cAAey6C,IAItB,SAASU,EAAYrmD,GAEpB,IAAuB,IAAlBkjD,EAAMvjD,UAEW,IAAjBujD,EAAMO,OAAX,CAKA,OAHAzjD,EAAM+C,iBACN/C,EAAMiF,kBAEGjF,EAAMsmD,WAEd,KAAK,EAEJtB,EAAW7+C,GAAoB,KAAfnG,EAAMumD,OACtB,MAED,KAAK,EAEJvB,EAAW7+C,GAAoB,IAAfnG,EAAMumD,OACtB,MAED,QAECvB,EAAW7+C,GAAoB,MAAfnG,EAAMumD,OAKxBrD,EAAMh4C,cAAew6C,GACrBxC,EAAMh4C,cAAey6C,IAItB,SAASa,EAAYxmD,GAEpB,IAAuB,IAAlBkjD,EAAMvjD,QAAX,CAIA,OAFAK,EAAM+C,iBAEG/C,EAAMymD,QAAQ79C,QAEtB,KAAK,EACJ67C,EAAStB,EACT0B,EAAU53C,KAAMm5C,EAAkBpmD,EAAMymD,QAAS,GAAIhhD,MAAOzF,EAAMymD,QAAS,GAAI9gD,QAC/Ei/C,EAAU33C,KAAM43C,GAChB,MAED,QACCJ,EAAStB,EACT,IAAIuD,EAAK1mD,EAAMymD,QAAS,GAAIhhD,MAAQzF,EAAMymD,QAAS,GAAIhhD,MACnDkhD,EAAK3mD,EAAMymD,QAAS,GAAI9gD,MAAQ3F,EAAMymD,QAAS,GAAI9gD,MACvDw/C,EAAwBD,EAA0BtkD,KAAKC,KAAM6lD,EAAKA,EAAKC,EAAKA,GAE5E,IAAI1gD,GAAMjG,EAAMymD,QAAS,GAAIhhD,MAAQzF,EAAMymD,QAAS,GAAIhhD,OAAU,EAC9DU,GAAMnG,EAAMymD,QAAS,GAAI9gD,MAAQ3F,EAAMymD,QAAS,GAAI9gD,OAAU,EAClEy/C,EAAUn4C,KAAMk5C,EAAkBlgD,EAAGE,IACrCk/C,EAAQp4C,KAAMm4C,GAKhBlC,EAAMh4C,cAAew6C,IAItB,SAASkB,EAAW5mD,GAEnB,IAAuB,IAAlBkjD,EAAMvjD,QAKX,OAHAK,EAAM+C,iBACN/C,EAAMiF,kBAEGjF,EAAMymD,QAAQ79C,QAEtB,KAAK,EACJg8C,EAAU33C,KAAM43C,GAChBA,EAAU53C,KAAMm5C,EAAkBpmD,EAAMymD,QAAS,GAAIhhD,MAAOzF,EAAMymD,QAAS,GAAI9gD,QAC/E,MAED,QACC,IAAI+gD,EAAK1mD,EAAMymD,QAAS,GAAIhhD,MAAQzF,EAAMymD,QAAS,GAAIhhD,MACnDkhD,EAAK3mD,EAAMymD,QAAS,GAAI9gD,MAAQ3F,EAAMymD,QAAS,GAAI9gD,MACvDw/C,EAAwBvkD,KAAKC,KAAM6lD,EAAKA,EAAKC,EAAKA,GAElD,IAAI1gD,GAAMjG,EAAMymD,QAAS,GAAIhhD,MAAQzF,EAAMymD,QAAS,GAAIhhD,OAAU,EAC9DU,GAAMnG,EAAMymD,QAAS,GAAI9gD,MAAQ3F,EAAMymD,QAAS,GAAI9gD,OAAU,EAClE0/C,EAAQp4C,KAAMk5C,EAAkBlgD,EAAGE,KAOtC,SAAS0gD,EAAU7mD,GAElB,IAAuB,IAAlBkjD,EAAMvjD,QAAX,CAEA,OAASK,EAAMymD,QAAQ79C,QAEtB,KAAK,EACJ67C,EAAStB,EACT,MAED,KAAK,EACJsB,EAAStB,EACT0B,EAAU53C,KAAMm5C,EAAkBpmD,EAAMymD,QAAS,GAAIhhD,MAAOzF,EAAMymD,QAAS,GAAI9gD,QAC/Ei/C,EAAU33C,KAAM43C,GAKlB3B,EAAMh4C,cAAey6C,IAItB,SAAS7iD,EAAa9C,IAEE,IAAlBkjD,EAAMvjD,SAEXK,EAAM+C,iBAzgBPvD,KAAKsnD,aAAiB,WAErB,IAMCl2B,EANGhkB,EAAO,IAAItM,UACdQ,EAAa,IAAIJ,aACjBqmD,EAAe,IAAIzmD,UACnB0mD,EAAoB,IAAI1mD,UACxB2mD,EAA0B,IAAI3mD,UAC9B4mD,EAAgB,IAAI5mD,UAGrB,OAAO,WAEN4mD,EAAc/lD,IAAK0jD,EAAU5+C,EAAI2+C,EAAU3+C,EAAG4+C,EAAU1+C,EAAIy+C,EAAUz+C,EAAG,IACzEyqB,EAAQs2B,EAAct+C,WAIrB+7C,EAAK13C,KAAMi2C,EAAM5jD,OAAOyO,UAAWZ,IAAK+1C,EAAM5yB,QAE9Cy2B,EAAa95C,KAAM03C,GAAOr+C,YAC1B0gD,EAAkB/5C,KAAMi2C,EAAM5jD,OAAOoE,IAAK4C,YAC1C2gD,EAAwBrlC,aAAcolC,EAAmBD,GAAezgD,YAExE0gD,EAAkBG,UAAWtC,EAAU1+C,EAAIy+C,EAAUz+C,GACrD8gD,EAAwBE,UAAWtC,EAAU5+C,EAAI2+C,EAAU3+C,GAE3DihD,EAAcj6C,KAAM+5C,EAAkBr/C,IAAKs/C,IAE3Cr6C,EAAKgV,aAAcslC,EAAevC,GAAOr+C,YAEzCsqB,GAASsyB,EAAMG,YACfviD,EAAWQ,iBAAkBsL,EAAMgkB,GAEnC+zB,EAAKz2C,gBAAiBpN,GACtBoiD,EAAM5jD,OAAOoE,GAAGwK,gBAAiBpN,GAEjCgkD,EAAU73C,KAAML,GAChBm4C,EAAan0B,IAEAsyB,EAAMS,cAAgBoB,IAEnCA,GAAcnkD,KAAKC,KAAM,EAAMqiD,EAAMU,sBACrCe,EAAK13C,KAAMi2C,EAAM5jD,OAAOyO,UAAWZ,IAAK+1C,EAAM5yB,QAC9CxvB,EAAWQ,iBAAkBwjD,EAAWC,GACxCJ,EAAKz2C,gBAAiBpN,GACtBoiD,EAAM5jD,OAAOoE,GAAGwK,gBAAiBpN,IAIlC8jD,EAAU33C,KAAM43C,IAjDI,GAwDtBrlD,KAAK4nD,WAAa,WAEjB,IAAIrxC,EAEC0uC,IAAWtB,GAEfptC,EAASmvC,EAA0BC,EACnCD,EAA0BC,EAErBjC,EAAM5jD,OAAO+nD,oBAEjB1C,EAAKpuC,eAAgBR,GAEVmtC,EAAM5jD,OAAO2W,sBAExBitC,EAAM5jD,OAAO6W,MAAQJ,EACrBmtC,EAAM5jD,OAAOgoD,0BAIbtlD,QAAQgB,KAAM,sDAQC,KAFhB+S,EAAS,GAAQkvC,EAAS9+C,EAAI6+C,EAAW7+C,GAAM+8C,EAAMI,YAE9BvtC,EAAS,IAE1BmtC,EAAM5jD,OAAO+nD,oBAEjB1C,EAAKpuC,eAAgBR,GAEVmtC,EAAM5jD,OAAO2W,sBAExBitC,EAAM5jD,OAAO6W,MAAQJ,EACrBmtC,EAAM5jD,OAAOgoD,0BAIbtlD,QAAQgB,KAAM,qDAMXkgD,EAAMS,aAEVqB,EAAW/3C,KAAMg4C,GAIjBD,EAAW7+C,IAAO8+C,EAAS9+C,EAAI6+C,EAAW7+C,GAAM3G,KAAKokD,uBAQxDpkD,KAAK+nD,UAAc,WAElB,IAAIC,EAAc,IAAIr1B,UACrBs1B,EAAW,IAAInnD,UACfonD,EAAM,IAAIpnD,UAEX,OAAO,WAIN,GAFAknD,EAAYv6C,KAAMo4C,GAAUl4C,IAAKi4C,GAE5BoC,EAAYG,WAAa,CAE7B,GAAKzE,EAAM5jD,OAAO2W,qBAAuB,CAExC,IAAI2xC,GAAY1E,EAAM5jD,OAAOuE,MAAQq/C,EAAM5jD,OAAOsE,MAASs/C,EAAM5jD,OAAO6W,KAAO+sC,EAAMzgD,WAAWolD,YAC5FC,GAAY5E,EAAM5jD,OAAOsM,IAAMs3C,EAAM5jD,OAAO4W,QAAWgtC,EAAM5jD,OAAO6W,KAAO+sC,EAAMzgD,WAAWolD,YAEhGL,EAAYvhD,GAAK2hD,EACjBJ,EAAYrhD,GAAK2hD,EAIlBN,EAAYjxC,eAAgBouC,EAAK/7C,SAAWs6C,EAAMK,UAElDmE,EAAIz6C,KAAM03C,GAAO71C,MAAOo0C,EAAM5jD,OAAOoE,IAAKyjD,UAAWK,EAAYvhD,GACjEyhD,EAAI//C,IAAK8/C,EAASx6C,KAAMi2C,EAAM5jD,OAAOoE,IAAKyjD,UAAWK,EAAYrhD,IAEjE+8C,EAAM5jD,OAAOyO,SAASpG,IAAK+/C,GAC3BxE,EAAM5yB,OAAO3oB,IAAK+/C,GAEbxE,EAAMS,aAEVyB,EAAUn4C,KAAMo4C,GAIhBD,EAAUz9C,IAAK6/C,EAAYxW,WAAYqU,EAASD,GAAY7uC,eAAgB2sC,EAAMU,yBApCnE,GA8CnBpkD,KAAKuoD,eAAiB,WAEd7E,EAAMO,QAAYP,EAAMQ,QAEzBiB,EAAKgD,WAAazE,EAAMY,YAAcZ,EAAMY,cAEhDZ,EAAM5jD,OAAOyO,SAAS6sC,WAAYsI,EAAM5yB,OAAQq0B,EAAKwC,UAAWjE,EAAMY,cACtEkB,EAAW/3C,KAAMg4C,IAIbN,EAAKgD,WAAazE,EAAMW,YAAcX,EAAMW,cAEhDX,EAAM5jD,OAAOyO,SAAS6sC,WAAYsI,EAAM5yB,OAAQq0B,EAAKwC,UAAWjE,EAAMW,cACtEmB,EAAW/3C,KAAMg4C,MAQpBzlD,KAAK2C,OAAS,WAEbwiD,EAAK3T,WAAYkS,EAAM5jD,OAAOyO,SAAUm1C,EAAM5yB,QAEvC4yB,EAAMM,UAEZN,EAAM4D,eAIA5D,EAAMO,QAEZP,EAAMkE,aAIAlE,EAAMQ,OAEZR,EAAMqE,YAIPrE,EAAM5jD,OAAOyO,SAAS6sC,WAAYsI,EAAM5yB,OAAQq0B,GAE3CzB,EAAM5jD,OAAO+nD,qBAEjBnE,EAAM6E,iBAEN7E,EAAM5jD,OAAOoX,OAAQwsC,EAAM5yB,QAEtBi0B,EAAazI,kBAAmBoH,EAAM5jD,OAAOyO,UA9S1C,OAgTPm1C,EAAMh4C,cAAenD,GAErBw8C,EAAat3C,KAAMi2C,EAAM5jD,OAAOyO,YAItBm1C,EAAM5jD,OAAO2W,sBAExBitC,EAAM5jD,OAAOoX,OAAQwsC,EAAM5yB,SAEtBi0B,EAAazI,kBAAmBoH,EAAM5jD,OAAOyO,UA1T1C,MA0T8Dy2C,IAAatB,EAAM5jD,OAAO6W,QAE/F+sC,EAAMh4C,cAAenD,GAErBw8C,EAAat3C,KAAMi2C,EAAM5jD,OAAOyO,UAChCy2C,EAAWtB,EAAM5jD,OAAO6W,OAMzBnU,QAAQgB,KAAM,qDAMhBxD,KAAKwoD,MAAQ,WAEZvD,EAAStB,EACTuB,EAAYvB,EAEZD,EAAM5yB,OAAOrjB,KAAMi2C,EAAMoC,SACzBpC,EAAM5jD,OAAOyO,SAASd,KAAMi2C,EAAMqC,WAClCrC,EAAM5jD,OAAOoE,GAAGuJ,KAAMi2C,EAAMsC,KAC5BtC,EAAM5jD,OAAO6W,KAAO+sC,EAAMuC,MAE1BvC,EAAM5jD,OAAOgoD,yBAEb3C,EAAK3T,WAAYkS,EAAM5jD,OAAOyO,SAAUm1C,EAAM5yB,QAE9C4yB,EAAM5jD,OAAOoX,OAAQwsC,EAAM5yB,QAE3B4yB,EAAMh4C,cAAenD,GAErBw8C,EAAat3C,KAAMi2C,EAAM5jD,OAAOyO,UAChCy2C,EAAWtB,EAAM5jD,OAAO6W,MAsQzB3W,KAAK+C,QAAU,WAEd/C,KAAKiD,WAAWP,oBAAqB,cAAeY,GAAa,GACjEtD,KAAKiD,WAAWP,oBAAqB,YAAa6C,GAAW,GAC7DvF,KAAKiD,WAAWP,oBAAqB,QAASmkD,GAAY,GAE1D7mD,KAAKiD,WAAWP,oBAAqB,aAAcskD,GAAY,GAC/DhnD,KAAKiD,WAAWP,oBAAqB,WAAY2kD,GAAU,GAC3DrnD,KAAKiD,WAAWP,oBAAqB,YAAa0kD,GAAW,GAE7D3jD,SAASf,oBAAqB,YAAaiD,GAAW,GACtDlC,SAASf,oBAAqB,UAAW0D,GAAS,GAElD1F,OAAOgC,oBAAqB,UAAWsC,GAAS,GAChDtE,OAAOgC,oBAAqB,QAAS4C,GAAO,IAI7CtF,KAAKiD,WAAWZ,iBAAkB,cAAeiB,GAAa,GAC9DtD,KAAKiD,WAAWZ,iBAAkB,YAAakD,GAAW,GAC1DvF,KAAKiD,WAAWZ,iBAAkB,QAASwkD,GAAY,GAEvD7mD,KAAKiD,WAAWZ,iBAAkB,aAAc2kD,GAAY,GAC5DhnD,KAAKiD,WAAWZ,iBAAkB,WAAYglD,GAAU,GACxDrnD,KAAKiD,WAAWZ,iBAAkB,YAAa+kD,GAAW,GAE1D1mD,OAAO2B,iBAAkB,UAAW2C,GAAS,GAC7CtE,OAAO2B,iBAAkB,QAASiD,GAAO,GAEzCtF,KAAKomD,eAGLpmD,KAAK2C,UAIN8gD,EAAkB71C,UAAYrC,OAAOwE,OAAQ4S,kBAAgB/U,WAC7D61C,EAAkB71C,UAAUoC,YAAcyzC,G,gCC/rB1C,8CAgBI1C,EAAuB,WAE1B0H,0BAAwB1gD,KAAM/H,MAE9BA,KAAKwI,KAAO,uBAMZxI,KAAKgnB,SAFO,CAAE,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,IAGjEhnB,KAAK0D,aAAc,WAAY,IAAI6O,yBALnB,EAAI,EAAG,EAAG,EAAG,EAAG,EAAG,GAAK,EAAG,EAAG,EAAG,EAAG,EAAG,GAAK,EAAG,EAAG,EAAG,EAAG,EAAG,GAAK,GAAK,EAAG,EAAG,GAAK,EAAG,GAK7B,IACtEvS,KAAK0D,aAAc,KAAM,IAAI6O,yBALnB,EAAI,EAAG,EAAG,EAAG,GAAK,EAAG,EAAG,EAAG,GAAK,GAAK,EAAG,GAAK,GAAK,GAAK,EAAG,GAAK,GAKf,KAI3DwuC,EAAqBnzC,UAAYrC,OAAOuE,OAAQvE,OAAOwE,OAAQ04C,0BAAwB76C,WAAa,CAEnGoC,YAAa+wC,EAEb2H,wBAAwB,EAExBvzC,aAAc,SAAWC,GAExB,IAAIoF,EAAQxa,KAAKknB,WAAWy6B,cACxBpN,EAAMv0C,KAAKknB,WAAW06B,YAwB1B,YAtBe5/C,IAAVwY,IAEJA,EAAMrF,aAAcC,GAEpBm/B,EAAIp/B,aAAcC,GAElBoF,EAAMuF,KAAK+Y,aAAc,GAIA,OAArB94B,KAAKqgC,aAETrgC,KAAK2oD,qBAIuB,OAAxB3oD,KAAK0gC,gBAET1gC,KAAK4oD,wBAIC5oD,MAIRihD,aAAc,SAAWnoC,GAExB,IAAI+vC,EAEC/vC,aAAiB4Q,aAErBm/B,EAAe/vC,EAEJyB,MAAMX,QAASd,KAE1B+vC,EAAe,IAAIn/B,aAAc5Q,IAIlC,IAAIgwC,EAAiB,IAAI9G,6BAA4B6G,EAAc,EAAG,GAUtE,OARA7oD,KAAK0D,aAAc,gBAAiB,IAAI8hC,6BAA4BsjB,EAAgB,EAAG,IACvF9oD,KAAK0D,aAAc,cAAe,IAAI8hC,6BAA4BsjB,EAAgB,EAAG,IAIrF9oD,KAAK2oD,qBACL3oD,KAAK4oD,wBAEE5oD,MAIRmhD,UAAW,SAAWroC,GAErB,IAAIsoC,EAECtoC,aAAiB4Q,aAErB03B,EAAStoC,EAEEyB,MAAMX,QAASd,KAE1BsoC,EAAS,IAAI13B,aAAc5Q,IAI5B,IAAIiwC,EAAsB,IAAI/G,6BAA4BZ,EAAQ,EAAG,GAKrE,OAHAphD,KAAK0D,aAAc,qBAAsB,IAAI8hC,6BAA4BujB,EAAqB,EAAG,IACjG/oD,KAAK0D,aAAc,mBAAoB,IAAI8hC,6BAA4BujB,EAAqB,EAAG,IAExF/oD,MAIRgpD,sBAAuB,SAAWh8C,GAIjC,OAFAhN,KAAKihD,aAAcj0C,EAASka,WAAW3Y,SAASuK,OAEzC9Y,MAIRipD,kBAAmB,SAAWj8C,GAI7B,OAFAhN,KAAKihD,aAAcj0C,EAASka,WAAW3Y,SAASuK,OAEzC9Y,MAIRkpD,SAAU,SAAW7qB,GAMpB,OAJAr+B,KAAKgpD,sBAAuB,IAAIG,oBAAmB9qB,EAAKrxB,WAIjDhN,MAIRopD,iBAAkB,SAAWP,GAE5B,IAAI77C,EAAW67C,EAAa77C,SAc5B,OAZKA,EAASs0C,WAEbthD,KAAKihD,aAAcj0C,EAAS2F,UAEjB3F,EAASkrC,kBAEpBl4C,KAAKihD,aAAcj0C,EAASka,WAAW3Y,SAASuK,OAM1C9Y,MAIR2oD,mBAAoB,WAEnB,IAAI/oB,EAAM,IAAIC,OAEd,OAAO,WAEoB,OAArB7/B,KAAKqgC,cAETrgC,KAAKqgC,YAAc,IAAIR,QAIxB,IAAIrlB,EAAQxa,KAAKknB,WAAWy6B,cACxBpN,EAAMv0C,KAAKknB,WAAW06B,iBAEX5/C,IAAVwY,QAA+BxY,IAARuyC,IAE3Bv0C,KAAKqgC,YAAYgpB,uBAAwB7uC,GAEzColB,EAAIypB,uBAAwB9U,GAE5Bv0C,KAAKqgC,YAAYipB,MAAO1pB,KArBP,GA6BpBgpB,sBAAuB,WAEtB,IAAI5oB,EAAS,IAAIl/B,UAEjB,OAAO,WAEuB,OAAxBd,KAAK0gC,iBAET1gC,KAAK0gC,eAAiB,IAAIH,UAID,OAArBvgC,KAAKqgC,aAETrgC,KAAK2oD,qBAIN,IAAInuC,EAAQxa,KAAKknB,WAAWy6B,cACxBpN,EAAMv0C,KAAKknB,WAAW06B,YAE1B,QAAe5/C,IAAVwY,QAA+BxY,IAARuyC,EAAoB,CAE/C,IAAI9T,EAASzgC,KAAK0gC,eAAeD,OAEjCzgC,KAAKqgC,YAAYG,UAAWC,GAI5B,IAFA,IAAI8oB,EAAc,EAERpgD,EAAI,EAAGo1B,EAAK/jB,EAAMknB,MAAOv4B,EAAIo1B,EAAIp1B,IAE1C62B,EAAO8hB,oBAAqBtnC,EAAOrR,GACnCogD,EAAcnoD,KAAKsY,IAAK6vC,EAAa9oB,EAAO6b,kBAAmBtc,IAE/DA,EAAO8hB,oBAAqBvN,EAAKprC,GACjCogD,EAAcnoD,KAAKsY,IAAK6vC,EAAa9oB,EAAO6b,kBAAmBtc,IAIhEhgC,KAAK0gC,eAAejuB,OAASrR,KAAKC,KAAMkoD,GAEnCC,MAAOxpD,KAAK0gC,eAAejuB,SAE/BjQ,QAAQD,MAAO,wIAAyIvC,QA3CrI,GAqDvBypD,OAAQ,aAMRC,YAAa,SAAWt0C,GAIvB,OAFA5S,QAAQgB,KAAM,iFAEPxD,KAAKmV,aAAcC,O,gCClQ5B,gFA0BIu0C,EAAgB,SAAW7pD,EAAQmD,QAElBjB,IAAfiB,GAA2BT,QAAQgB,KAAM,4EACzCP,IAAeQ,UAAWjB,QAAQD,MAAO,4HAE9CvC,KAAKF,OAASA,EACdE,KAAKiD,WAAaA,EAGlBjD,KAAKG,SAAU,EAGfH,KAAK8wB,OAAS,IAAIhwB,UAGlBd,KAAKqkD,YAAc,EACnBrkD,KAAKskD,YAAchvC,IAGnBtV,KAAK4pD,QAAU,EACf5pD,KAAK6pD,QAAUv0C,IAIftV,KAAK8pD,cAAgB,EACrB9pD,KAAK+pD,cAAgB3oD,KAAK0R,GAI1B9S,KAAKgqD,iBAAoB10C,IACzBtV,KAAKiqD,gBAAkB30C,IAIvBtV,KAAKkqD,eAAgB,EACrBlqD,KAAKmqD,cAAgB,IAIrBnqD,KAAKoqD,YAAa,EAClBpqD,KAAK8jD,UAAY,EAGjB9jD,KAAKqqD,cAAe,EACpBrqD,KAAK6jD,YAAc,EAGnB7jD,KAAKsqD,WAAY,EACjBtqD,KAAK+jD,SAAW,EAChB/jD,KAAKuqD,oBAAqB,EAC1BvqD,KAAKwqD,YAAc,EAInBxqD,KAAKyqD,YAAa,EAClBzqD,KAAK0qD,gBAAkB,EAGvB1qD,KAAK2qD,YAAa,EAGlB3qD,KAAK6c,KAAO,CAAE2nC,KAAM,GAAIoG,GAAI,GAAI/F,MAAO,GAAIgG,OAAQ,IAGnD7qD,KAAKukD,aAAe,CAAEC,KAAMC,QAAMC,OAAQC,OAAQF,QAAMqG,MAAOjG,MAAOJ,QAAMK,KAG5E9kD,KAAKinD,QAAU,CAAE8D,IAAKC,QAAMtG,OAAQuG,IAAKD,QAAME,WAG/ClrD,KAAK8lD,QAAU9lD,KAAK8wB,OAAOhgB,QAC3B9Q,KAAK+lD,UAAY/lD,KAAKF,OAAOyO,SAASuC,QACtC9Q,KAAKimD,MAAQjmD,KAAKF,OAAO6W,KAMzB3W,KAAKmrD,cAAgB,WAEpB,OAAOC,EAAUC,KAIlBrrD,KAAKsrD,kBAAoB,WAExB,OAAOF,EAAUG,OAIlBvrD,KAAKwrD,UAAY,WAEhBzrD,EAAM+lD,QAAQr4C,KAAM1N,EAAM+wB,QAC1B/wB,EAAMgmD,UAAUt4C,KAAM1N,EAAMD,OAAOyO,UACnCxO,EAAMkmD,MAAQlmD,EAAMD,OAAO6W,MAI5B3W,KAAKwoD,MAAQ,WAEZzoD,EAAM+wB,OAAOrjB,KAAM1N,EAAM+lD,SACzB/lD,EAAMD,OAAOyO,SAASd,KAAM1N,EAAMgmD,WAClChmD,EAAMD,OAAO6W,KAAO5W,EAAMkmD,MAE1BlmD,EAAMD,OAAOgoD,yBACb/nD,EAAM2L,cAAenD,GAErBxI,EAAM4C,SAENgwC,EAAQgR,EAAM8H,MAKfzrD,KAAK2C,OAAS,WAEb,IAAIuD,EAAS,IAAIpF,UAGb4qD,GAAO,IAAIxqD,cAAayqD,mBAAoB7rD,EAAOoE,GAAI,IAAIpD,UAAS,EAAG,EAAG,IAC1E8qD,EAAcF,EAAK56C,QAAQpD,UAE3Bq3C,EAAe,IAAIjkD,UACnB+qD,EAAiB,IAAI3qD,aAEzB,OAAO,WAEN,IAAIqN,EAAWxO,EAAMD,OAAOyO,SAoF5B,OAlFArI,EAAOuH,KAAMc,GAAWZ,IAAK5N,EAAM+wB,QAGnC5qB,EAAOwI,gBAAiBg9C,GAGxBN,EAAUU,eAAgB5lD,GAErBnG,EAAM0qD,YAAc9X,IAAUgR,EAAM8H,MAExCM,EA8JK,EAAI3qD,KAAK0R,GAAK,GAAK,GAAK/S,EAAM2qD,iBA1J/B3qD,EAAMmqD,eAEVkB,EAAUG,OAASS,EAAeT,MAAQxrD,EAAMoqD,cAChDiB,EAAUC,KAAOW,EAAeX,IAAMtrD,EAAMoqD,gBAI5CiB,EAAUG,OAASS,EAAeT,MAClCH,EAAUC,KAAOW,EAAeX,KAKjCD,EAAUG,MAAQnqD,KAAKsY,IAAK3Z,EAAMiqD,gBAAiB5oD,KAAKwV,IAAK7W,EAAMkqD,gBAAiBmB,EAAUG,QAG9FH,EAAUC,IAAMjqD,KAAKsY,IAAK3Z,EAAM+pD,cAAe1oD,KAAKwV,IAAK7W,EAAMgqD,cAAeqB,EAAUC,MAExFD,EAAUa,WAGVb,EAAU34C,QAAUjE,EAGpB48C,EAAU34C,OAASrR,KAAKsY,IAAK3Z,EAAMskD,YAAajjD,KAAKwV,IAAK7W,EAAMukD,YAAa8G,EAAU34C,UAI1D,IAAxB1S,EAAMmqD,cAEVnqD,EAAM+wB,OAAOzO,gBAAiB6pC,EAAWnsD,EAAMoqD,eAI/CpqD,EAAM+wB,OAAO3oB,IAAK+jD,GAInBhmD,EAAOimD,iBAAkBf,GAGzBllD,EAAOwI,gBAAiBk9C,GAExBr9C,EAASd,KAAM1N,EAAM+wB,QAAS3oB,IAAKjC,GAEnCnG,EAAMD,OAAOoX,OAAQnX,EAAM+wB,SAEE,IAAxB/wB,EAAMmqD,eAEV8B,EAAeT,OAAW,EAAIxrD,EAAMoqD,cACpC6B,EAAeX,KAAS,EAAItrD,EAAMoqD,cAElC+B,EAAUn1C,eAAgB,EAAIhX,EAAMoqD,iBAIpC6B,EAAerqD,IAAK,EAAG,EAAG,GAE1BuqD,EAAUvqD,IAAK,EAAG,EAAG,IAItB6M,EAAQ,KAMH49C,GACJrH,EAAazI,kBAAmBv8C,EAAMD,OAAOyO,UAAa89C,GAC1D,GAAM,EAAIR,EAAe58C,IAAKlP,EAAMD,OAAOwB,aAAiB+qD,KAE5DtsD,EAAM2L,cAAenD,GAErBw8C,EAAat3C,KAAM1N,EAAMD,OAAOyO,UAChCs9C,EAAep+C,KAAM1N,EAAMD,OAAOwB,YAClC8qD,GAAc,GAEP,IA3GI,GAqHdpsD,KAAK+C,QAAU,WAEdhD,EAAMkD,WAAWP,oBAAqB,cAAe4pD,GAAe,GACpEvsD,EAAMkD,WAAWP,oBAAqB,YAAa6pD,GAAa,GAChExsD,EAAMkD,WAAWP,oBAAqB,QAAS8pD,GAAc,GAE7DzsD,EAAMkD,WAAWP,oBAAqB,aAAc+pD,GAAc,GAClE1sD,EAAMkD,WAAWP,oBAAqB,WAAYgqD,GAAY,GAC9D3sD,EAAMkD,WAAWP,oBAAqB,YAAaiqD,GAAa,GAEhElpD,SAASf,oBAAqB,YAAa0e,GAAa,GACxD3d,SAASf,oBAAqB,UAAWkqD,GAAW,GAEpD7sD,EAAMkD,WAAWP,oBAAqB,UAAWmqD,GAAW,IAU7D,IAAI9sD,EAAQC,KAERuI,EAAc,CAAEC,KAAM,UACtB09C,EAAa,CAAE19C,KAAM,SACrB29C,EAAW,CAAE39C,KAAM,OAEnBm7C,EAAQ,CACX8H,MAAQ,EACR/G,OAAQ,EACRoG,MAAO,EACPhG,IAAK,EACLgI,aAAc,EACdC,UAAW,EACXC,gBAAiB,EACjBC,mBAAoB,GAGjBta,EAAQgR,EAAM8H,KAEdY,EAAM,KAGNjB,EAAY,IAAI8B,YAChBlB,EAAiB,IAAIkB,YAErB1+C,EAAQ,EACR09C,EAAY,IAAIprD,UAChBsrD,GAAc,EAEde,EAAc,IAAIx6B,UAClBy6B,EAAY,IAAIz6B,UAChB06B,EAAc,IAAI16B,UAElB26B,EAAW,IAAI36B,UACf46B,EAAS,IAAI56B,UACb66B,EAAW,IAAI76B,UAEf86B,EAAa,IAAI96B,UACjB+6B,EAAW,IAAI/6B,UACfg7B,EAAa,IAAIh7B,UAQrB,SAASi7B,IAER,OAAOxsD,KAAKysD,IAAK,IAAM9tD,EAAM+jD,WAI9B,SAASiI,EAAY36B,GAEpB46B,EAAeT,OAASn6B,EAIzB,SAAS08B,EAAU18B,GAElB46B,EAAeX,KAAOj6B,EAIvB,IAAI28B,EAAU,WAEb,IAAI/rC,EAAI,IAAIlhB,UAEZ,OAAO,SAAkBohB,EAAU8rC,GAElChsC,EAAEG,oBAAqB6rC,EAAc,GACrChsC,EAAEjL,gBAAkBmL,GAEpBgqC,EAAU/jD,IAAK6Z,IATH,GAeVisC,EAAQ,WAEX,IAAIjsC,EAAI,IAAIlhB,UAEZ,OAAO,SAAgBohB,EAAU8rC,IAEE,IAA7BjuD,EAAMwqD,mBAEVvoC,EAAEG,oBAAqB6rC,EAAc,IAIrChsC,EAAEG,oBAAqB6rC,EAAc,GACrChsC,EAAEI,aAAcriB,EAAMD,OAAOoE,GAAI8d,IAIlCA,EAAEjL,eAAgBmL,GAElBgqC,EAAU/jD,IAAK6Z,IAnBL,GA0BRkmC,EAAM,WAET,IAAIhiD,EAAS,IAAIpF,UAEjB,OAAO,SAAcotD,EAAQnH,GAE5B,IAAIoH,EAAUpuD,EAAMkD,WAEpB,GAAKlD,EAAMD,OAAO+nD,oBAAsB,CAGvC,IAAIt5C,EAAWxO,EAAMD,OAAOyO,SAC5BrI,EAAOuH,KAAMc,GAAWZ,IAAK5N,EAAM+wB,QACnC,IAAIs9B,EAAiBloD,EAAOkD,SAG5BglD,GAAkBhtD,KAAKyV,IAAO9W,EAAMD,OAAOgX,IAAM,EAAM1V,KAAK0R,GAAK,KAGjEi7C,EAAS,EAAIG,EAASE,EAAiBD,EAAQE,aAActuD,EAAMD,OAAOsV,QAC1E64C,EAAO,EAAIlH,EAASqH,EAAiBD,EAAQE,aAActuD,EAAMD,OAAOsV,aAE7DrV,EAAMD,OAAO2W,sBAGxBs3C,EAASG,GAAWnuD,EAAMD,OAAOuE,MAAQtE,EAAMD,OAAOsE,MAASrE,EAAMD,OAAO6W,KAAOw3C,EAAQ9F,YAAatoD,EAAMD,OAAOsV,QACrH64C,EAAOlH,GAAWhnD,EAAMD,OAAOsM,IAAMrM,EAAMD,OAAO4W,QAAW3W,EAAMD,OAAO6W,KAAOw3C,EAAQE,aAActuD,EAAMD,OAAOsV,UAKpH5S,QAAQgB,KAAM,gFACdzD,EAAMuqD,WAAY,IAhCX,GAwCV,SAASgE,EAAUC,GAEbxuD,EAAMD,OAAO+nD,oBAEjBr5C,GAAS+/C,EAEExuD,EAAMD,OAAO2W,sBAExB1W,EAAMD,OAAO6W,KAAOvV,KAAKsY,IAAK3Z,EAAM6pD,QAASxoD,KAAKwV,IAAK7W,EAAM8pD,QAAS9pD,EAAMD,OAAO6W,KAAO43C,IAC1FxuD,EAAMD,OAAOgoD,yBACbsE,GAAc,IAId5pD,QAAQgB,KAAM,uFACdzD,EAAMqqD,YAAa,GAMrB,SAASoE,EAASD,GAEZxuD,EAAMD,OAAO+nD,oBAEjBr5C,GAAS+/C,EAEExuD,EAAMD,OAAO2W,sBAExB1W,EAAMD,OAAO6W,KAAOvV,KAAKsY,IAAK3Z,EAAM6pD,QAASxoD,KAAKwV,IAAK7W,EAAM8pD,QAAS9pD,EAAMD,OAAO6W,KAAO43C,IAC1FxuD,EAAMD,OAAOgoD,yBACbsE,GAAc,IAId5pD,QAAQgB,KAAM,uFACdzD,EAAMqqD,YAAa,GAUrB,SAASqE,EAAuBjuD,GAE/B2sD,EAAYxrD,IAAKnB,EAAMyL,QAASzL,EAAM2L,SAUvC,SAASuiD,EAAoBluD,GAE5B8sD,EAAS3rD,IAAKnB,EAAMyL,QAASzL,EAAM2L,SAwHpC,SAASwiD,EAAwBnuD,GAEhC,GAA6B,GAAxBA,EAAMymD,QAAQ79C,OAElB+jD,EAAYxrD,IAAKnB,EAAMymD,QAAS,GAAIhhD,MAAOzF,EAAMymD,QAAS,GAAI9gD,WAExD,CAEN,IAAIM,EAAI,IAAQjG,EAAMymD,QAAS,GAAIhhD,MAAQzF,EAAMymD,QAAS,GAAIhhD,OAC1DU,EAAI,IAAQnG,EAAMymD,QAAS,GAAI9gD,MAAQ3F,EAAMymD,QAAS,GAAI9gD,OAE9DgnD,EAAYxrD,IAAK8E,EAAGE,IAMtB,SAASioD,EAAqBpuD,GAE7B,GAA6B,GAAxBA,EAAMymD,QAAQ79C,OAElBkkD,EAAS3rD,IAAKnB,EAAMymD,QAAS,GAAIhhD,MAAOzF,EAAMymD,QAAS,GAAI9gD,WAErD,CAEN,IAAIM,EAAI,IAAQjG,EAAMymD,QAAS,GAAIhhD,MAAQzF,EAAMymD,QAAS,GAAIhhD,OAC1DU,EAAI,IAAQnG,EAAMymD,QAAS,GAAI9gD,MAAQ3F,EAAMymD,QAAS,GAAI9gD,OAE9DmnD,EAAS3rD,IAAK8E,EAAGE,IAMnB,SAASkoD,EAAuBruD,GAE/B,IAAI0mD,EAAK1mD,EAAMymD,QAAS,GAAIhhD,MAAQzF,EAAMymD,QAAS,GAAIhhD,MACnDkhD,EAAK3mD,EAAMymD,QAAS,GAAI9gD,MAAQ3F,EAAMymD,QAAS,GAAI9gD,MAEnD+b,EAAW9gB,KAAKC,KAAM6lD,EAAKA,EAAKC,EAAKA,GAEzCsG,EAAW9rD,IAAK,EAAGugB,GAoBpB,SAAS4sC,EAAuBtuD,GAE/B,GAA6B,GAAxBA,EAAMymD,QAAQ79C,OAElBgkD,EAAUzrD,IAAKnB,EAAMymD,QAAS,GAAIhhD,MAAOzF,EAAMymD,QAAS,GAAI9gD,WAEtD,CAEN,IAAIM,EAAI,IAAQjG,EAAMymD,QAAS,GAAIhhD,MAAQzF,EAAMymD,QAAS,GAAIhhD,OAC1DU,EAAI,IAAQnG,EAAMymD,QAAS,GAAI9gD,MAAQ3F,EAAMymD,QAAS,GAAI9gD,OAE9DinD,EAAUzrD,IAAK8E,EAAGE,GAInB0mD,EAAY7b,WAAY4b,EAAWD,GAAcp2C,eAAgBhX,EAAM8jD,aAEvE,IAAIsK,EAAUpuD,EAAMkD,WAEpB8oD,EAAY,EAAI3qD,KAAK0R,GAAKu6C,EAAY5mD,EAAI0nD,EAAQE,cAElDP,EAAU,EAAI1sD,KAAK0R,GAAKu6C,EAAY1mD,EAAIwnD,EAAQE,cAEhDlB,EAAY1/C,KAAM2/C,GAInB,SAAS2B,EAAoBvuD,GAE5B,GAA6B,GAAxBA,EAAMymD,QAAQ79C,OAElBmkD,EAAO5rD,IAAKnB,EAAMymD,QAAS,GAAIhhD,MAAOzF,EAAMymD,QAAS,GAAI9gD,WAEnD,CAEN,IAAIM,EAAI,IAAQjG,EAAMymD,QAAS,GAAIhhD,MAAQzF,EAAMymD,QAAS,GAAIhhD,OAC1DU,EAAI,IAAQnG,EAAMymD,QAAS,GAAI9gD,MAAQ3F,EAAMymD,QAAS,GAAI9gD,OAE9DonD,EAAO5rD,IAAK8E,EAAGE,GAIhB6mD,EAAShc,WAAY+b,EAAQD,GAAWv2C,eAAgBhX,EAAMgkD,UAE9DmE,EAAKsF,EAAS/mD,EAAG+mD,EAAS7mD,GAE1B2mD,EAAS7/C,KAAM8/C,GAIhB,SAASyB,EAAsBxuD,GAE9B,IAAI0mD,EAAK1mD,EAAMymD,QAAS,GAAIhhD,MAAQzF,EAAMymD,QAAS,GAAIhhD,MACnDkhD,EAAK3mD,EAAMymD,QAAS,GAAI9gD,MAAQ3F,EAAMymD,QAAS,GAAI9gD,MAEnD+b,EAAW9gB,KAAKC,KAAM6lD,EAAKA,EAAKC,EAAKA,GAEzCuG,EAAS/rD,IAAK,EAAGugB,GAEjByrC,EAAWhsD,IAAK,EAAGP,KAAKysD,IAAKH,EAAS/mD,EAAI8mD,EAAW9mD,EAAG5G,EAAM+jD,YAE9DwK,EAAUX,EAAWhnD,GAErB8mD,EAAWhgD,KAAMigD,GA8BlB,SAASnB,EAAa/rD,GAErB,IAAuB,IAAlBT,EAAMI,QAAX,CAUA,IAAI8uD,EAEJ,OATAzuD,EAAM+C,iBAKNxD,EAAMkD,WAAWuC,MAAQzF,EAAMkD,WAAWuC,QAAU9E,OAAO8E,QAIlDhF,EAAMkF,QAEd,KAAK,EAEJupD,EAAclvD,EAAMwkD,aAAaC,KACjC,MAED,KAAK,EAEJyK,EAAclvD,EAAMwkD,aAAaI,OACjC,MAED,KAAK,EAEJsK,EAAclvD,EAAMwkD,aAAaM,MACjC,MAED,QAECoK,GAAgB,EAIlB,OAASA,GAER,KAAKxK,QAAMqG,MAEV,IAA0B,IAArB/qD,EAAMqqD,WAAuB,QAnUrC,SAA+B5pD,GAE9BitD,EAAW9rD,IAAKnB,EAAMyL,QAASzL,EAAM2L,SAmUnC+iD,CAAsB1uD,GAEtBmyC,EAAQgR,EAAMmH,MAEd,MAED,KAAKrG,QAAMC,OAEV,GAAKlkD,EAAM2uD,SAAW3uD,EAAM4uD,SAAW5uD,EAAM6uD,SAAW,CAEvD,IAAyB,IAApBtvD,EAAMuqD,UAAsB,OAEjCoE,EAAoBluD,GAEpBmyC,EAAQgR,EAAMmB,QAER,CAEN,IAA4B,IAAvB/kD,EAAMsqD,aAAyB,OAEpCoE,EAAuBjuD,GAEvBmyC,EAAQgR,EAAMe,OAIf,MAED,KAAKD,QAAMK,IAEV,GAAKtkD,EAAM2uD,SAAW3uD,EAAM4uD,SAAW5uD,EAAM6uD,SAAW,CAEvD,IAA4B,IAAvBtvD,EAAMsqD,aAAyB,OAEpCoE,EAAuBjuD,GAEvBmyC,EAAQgR,EAAMe,WAER,CAEN,IAAyB,IAApB3kD,EAAMuqD,UAAsB,OAEjCoE,EAAoBluD,GAEpBmyC,EAAQgR,EAAMmB,IAIf,MAED,QAECnS,EAAQgR,EAAM8H,KAIX9Y,IAAUgR,EAAM8H,OAEpBhoD,SAASpB,iBAAkB,YAAa+e,GAAa,GACrD3d,SAASpB,iBAAkB,UAAWuqD,GAAW,GAEjD7sD,EAAM2L,cAAew6C,KAMvB,SAAS9kC,EAAa5gB,GAErB,IAAuB,IAAlBT,EAAMI,QAIX,OAFAK,EAAM+C,iBAEGovC,GAER,KAAKgR,EAAMe,OAEV,IAA4B,IAAvB3kD,EAAMsqD,aAAyB,QAtYvC,SAAgC7pD,GAE/B4sD,EAAUzrD,IAAKnB,EAAMyL,QAASzL,EAAM2L,SAEpCkhD,EAAY7b,WAAY4b,EAAWD,GAAcp2C,eAAgBhX,EAAM8jD,aAEvE,IAAIsK,EAAUpuD,EAAMkD,WAEpB8oD,EAAY,EAAI3qD,KAAK0R,GAAKu6C,EAAY5mD,EAAI0nD,EAAQE,cAElDP,EAAU,EAAI1sD,KAAK0R,GAAKu6C,EAAY1mD,EAAIwnD,EAAQE,cAEhDlB,EAAY1/C,KAAM2/C,GAElBrtD,EAAM4C,SA0XJ2sD,CAAuB9uD,GAEvB,MAED,KAAKmjD,EAAMmH,MAEV,IAA0B,IAArB/qD,EAAMqqD,WAAuB,QA5XrC,SAA+B5pD,GAE9BktD,EAAS/rD,IAAKnB,EAAMyL,QAASzL,EAAM2L,SAEnCwhD,EAAWnc,WAAYkc,EAAUD,GAE5BE,EAAWhnD,EAAI,EAEnB2nD,EAAUV,KAECD,EAAWhnD,EAAI,GAE1B6nD,EAASZ,KAIVH,EAAWhgD,KAAMigD,GAEjB3tD,EAAM4C,SA4WJ4sD,CAAsB/uD,GAEtB,MAED,KAAKmjD,EAAMmB,IAEV,IAAyB,IAApB/kD,EAAMuqD,UAAsB,QA9WpC,SAA6B9pD,GAE5B+sD,EAAO5rD,IAAKnB,EAAMyL,QAASzL,EAAM2L,SAEjCqhD,EAAShc,WAAY+b,EAAQD,GAAWv2C,eAAgBhX,EAAMgkD,UAE9DmE,EAAKsF,EAAS/mD,EAAG+mD,EAAS7mD,GAE1B2mD,EAAS7/C,KAAM8/C,GAEfxtD,EAAM4C,SAsWJ6sD,CAAoBhvD,IAQvB,SAASosD,EAAWpsD,IAEI,IAAlBT,EAAMI,UAIXsD,SAASf,oBAAqB,YAAa0e,GAAa,GACxD3d,SAASf,oBAAqB,UAAWkqD,GAAW,GAEpD7sD,EAAM2L,cAAey6C,GAErBxT,EAAQgR,EAAM8H,MAIf,SAASe,EAAchsD,IAEC,IAAlBT,EAAMI,UAA0C,IAArBJ,EAAMqqD,YAA0BzX,IAAUgR,EAAM8H,MAAQ9Y,IAAUgR,EAAMe,SAExGlkD,EAAM+C,iBACN/C,EAAMiF,kBAEN1F,EAAM2L,cAAew6C,GA1XtB,SAA2B1lD,GAErBA,EAAMumD,OAAS,EAEnByH,EAASZ,KAEEptD,EAAMumD,OAAS,GAE1BuH,EAAUV,KAIX7tD,EAAM4C,SAgXN8sD,CAAkBjvD,GAElBT,EAAM2L,cAAey6C,IAItB,SAAS0G,EAAWrsD,IAEI,IAAlBT,EAAMI,UAA0C,IAArBJ,EAAM4qD,aAA4C,IAApB5qD,EAAMuqD,WApXrE,SAAwB9pD,GAEvB,IAAIs4B,GAAc,EAElB,OAASt4B,EAAM0E,SAEd,KAAKnF,EAAM8c,KAAK+tC,GACf1C,EAAK,EAAGnoD,EAAMyqD,aACd1xB,GAAc,EACd,MAED,KAAK/4B,EAAM8c,KAAKguC,OACf3C,EAAK,GAAKnoD,EAAMyqD,aAChB1xB,GAAc,EACd,MAED,KAAK/4B,EAAM8c,KAAK2nC,KACf0D,EAAKnoD,EAAMyqD,YAAa,GACxB1xB,GAAc,EACd,MAED,KAAK/4B,EAAM8c,KAAKgoC,MACfqD,GAAOnoD,EAAMyqD,YAAa,GAC1B1xB,GAAc,EAKXA,IAGJt4B,EAAM+C,iBAENxD,EAAM4C,UAqVP+sD,CAAelvD,GAIhB,SAASisD,EAAcjsD,GAEtB,IAAuB,IAAlBT,EAAMI,QAAX,CAIA,OAFAK,EAAM+C,iBAEG/C,EAAMymD,QAAQ79C,QAEtB,KAAK,EAEJ,OAASrJ,EAAMknD,QAAQ8D,KAEtB,KAAKC,QAAMtG,OAEV,IAA4B,IAAvB3kD,EAAMsqD,aAAyB,OAEpCsE,EAAwBnuD,GAExBmyC,EAAQgR,EAAMmJ,aAEd,MAED,KAAK9B,QAAMlG,IAEV,IAAyB,IAApB/kD,EAAMuqD,UAAsB,OAEjCsE,EAAqBpuD,GAErBmyC,EAAQgR,EAAMoJ,UAEd,MAED,QAECpa,EAAQgR,EAAM8H,KAIhB,MAED,KAAK,EAEJ,OAAS1rD,EAAMknD,QAAQgE,KAEtB,KAAKD,QAAME,UAEV,IAA0B,IAArBnrD,EAAMqqD,aAA4C,IAApBrqD,EAAMuqD,UAAsB,QAnVpE,SAAmC9pD,GAE7BT,EAAMqqD,YAAayE,EAAuBruD,GAE1CT,EAAMuqD,WAAYsE,EAAqBpuD,GAiVxCmvD,CAA0BnvD,GAE1BmyC,EAAQgR,EAAMqJ,gBAEd,MAED,KAAKhC,QAAM4E,aAEV,IAA0B,IAArB7vD,EAAMqqD,aAA+C,IAAvBrqD,EAAMsqD,aAAyB,QArVvE,SAAsC7pD,GAEhCT,EAAMqqD,YAAayE,EAAuBruD,GAE1CT,EAAMsqD,cAAesE,EAAwBnuD,GAmV9CqvD,CAA6BrvD,GAE7BmyC,EAAQgR,EAAMsJ,mBAEd,MAED,QAECta,EAAQgR,EAAM8H,KAIhB,MAED,QAEC9Y,EAAQgR,EAAM8H,KAIX9Y,IAAUgR,EAAM8H,MAEpB1rD,EAAM2L,cAAew6C,IAMvB,SAASyG,EAAansD,GAErB,IAAuB,IAAlBT,EAAMI,QAKX,OAHAK,EAAM+C,iBACN/C,EAAMiF,kBAEGktC,GAER,KAAKgR,EAAMmJ,aAEV,IAA4B,IAAvB/sD,EAAMsqD,aAAyB,OAEpCyE,EAAuBtuD,GAEvBT,EAAM4C,SAEN,MAED,KAAKghD,EAAMoJ,UAEV,IAAyB,IAApBhtD,EAAMuqD,UAAsB,OAEjCyE,EAAoBvuD,GAEpBT,EAAM4C,SAEN,MAED,KAAKghD,EAAMqJ,gBAEV,IAA0B,IAArBjtD,EAAMqqD,aAA4C,IAApBrqD,EAAMuqD,UAAsB,QAvUlE,SAAkC9pD,GAE5BT,EAAMqqD,YAAa4E,EAAsBxuD,GAEzCT,EAAMuqD,WAAYyE,EAAoBvuD,GAqUzCsvD,CAAyBtvD,GAEzBT,EAAM4C,SAEN,MAED,KAAKghD,EAAMsJ,mBAEV,IAA0B,IAArBltD,EAAMqqD,aAA+C,IAAvBrqD,EAAMsqD,aAAyB,QAzUrE,SAAqC7pD,GAE/BT,EAAMqqD,YAAa4E,EAAsBxuD,GAEzCT,EAAMsqD,cAAeyE,EAAuBtuD,GAuU/CuvD,CAA4BvvD,GAE5BT,EAAM4C,SAEN,MAED,QAECgwC,EAAQgR,EAAM8H,MAMjB,SAASiB,EAAYlsD,IAEG,IAAlBT,EAAMI,UAIXJ,EAAM2L,cAAey6C,GAErBxT,EAAQgR,EAAM8H,MAIf,SAASa,EAAe9rD,IAEA,IAAlBT,EAAMI,SAEXK,EAAM+C,iBAMPxD,EAAMkD,WAAWZ,iBAAkB,cAAeiqD,GAAe,GAEjEvsD,EAAMkD,WAAWZ,iBAAkB,YAAakqD,GAAa,GAC7DxsD,EAAMkD,WAAWZ,iBAAkB,QAASmqD,GAAc,GAE1DzsD,EAAMkD,WAAWZ,iBAAkB,aAAcoqD,GAAc,GAC/D1sD,EAAMkD,WAAWZ,iBAAkB,WAAYqqD,GAAY,GAC3D3sD,EAAMkD,WAAWZ,iBAAkB,YAAasqD,GAAa,GAE7D5sD,EAAMkD,WAAWZ,iBAAkB,UAAWwqD,GAAW,IAIpB,IAAhC9sD,EAAMkD,WAAW+sD,WAErBjwD,EAAMkD,WAAW+sD,SAAW,GAM7BhwD,KAAK2C,UAINgnD,EAAc/7C,UAAYrC,OAAOwE,OAAQ4S,kBAAgB/U,WACzD+7C,EAAc/7C,UAAUoC,YAAc25C,EAWtC,IAAIsG,EAAc,SAAWnwD,EAAQmD,GAEpC0mD,EAAc5hD,KAAM/H,KAAMF,EAAQmD,GAElCjD,KAAKukD,aAAaC,KAAOC,QAAMK,IAC/B9kD,KAAKukD,aAAaM,MAAQJ,QAAMC,OAEhC1kD,KAAKinD,QAAQ8D,IAAMC,QAAMlG,IACzB9kD,KAAKinD,QAAQgE,IAAMD,QAAM4E,cAI1BK,EAAYriD,UAAYrC,OAAOwE,OAAQ4S,kBAAgB/U,WACvDqiD,EAAYriD,UAAUoC,YAAcigD","file":"static/js/4.24cf34e6.chunk.js","sourcesContent":["/**\n * @author richt / http://richt.me\n * @author WestLangley / http://github.com/WestLangley\n *\n * W3C Device Orientation control (http://w3c.github.io/deviceorientation/spec-source-orientation.html)\n */\n\nimport {\n\tEuler,\n\tMathUtils,\n\tQuaternion,\n\tVector3\n} from \"../../../build/three.module.js\";\n\nvar DeviceOrientationControls = function ( object ) {\n\n\tvar scope = this;\n\n\tthis.object = object;\n\tthis.object.rotation.reorder( 'YXZ' );\n\n\tthis.enabled = true;\n\n\tthis.deviceOrientation = {};\n\tthis.screenOrientation = 0;\n\n\tthis.alphaOffset = 0; // radians\n\n\tvar onDeviceOrientationChangeEvent = function ( event ) {\n\n\t\tscope.deviceOrientation = event;\n\n\t};\n\n\tvar onScreenOrientationChangeEvent = function () {\n\n\t\tscope.screenOrientation = window.orientation || 0;\n\n\t};\n\n\t// The angles alpha, beta and gamma form a set of intrinsic Tait-Bryan angles of type Z-X'-Y''\n\n\tvar setObjectQuaternion = function () {\n\n\t\tvar zee = new Vector3( 0, 0, 1 );\n\n\t\tvar euler = new Euler();\n\n\t\tvar q0 = new Quaternion();\n\n\t\tvar q1 = new Quaternion( - Math.sqrt( 0.5 ), 0, 0, Math.sqrt( 0.5 ) ); // - PI/2 around the x-axis\n\n\t\treturn function ( quaternion, alpha, beta, gamma, orient ) {\n\n\t\t\teuler.set( beta, alpha, - gamma, 'YXZ' ); // 'ZXY' for the device, but 'YXZ' for us\n\n\t\t\tquaternion.setFromEuler( euler ); // orient the device\n\n\t\t\tquaternion.multiply( q1 ); // camera looks out the back of the device, not the top\n\n\t\t\tquaternion.multiply( q0.setFromAxisAngle( zee, - orient ) ); // adjust for screen orientation\n\n\t\t};\n\n\t}();\n\n\tthis.connect = function () {\n\n\t\tonScreenOrientationChangeEvent(); // run once on load\n\n\t\t// iOS 13+\n\n\t\tif ( window.DeviceOrientationEvent !== undefined && typeof window.DeviceOrientationEvent.requestPermission === 'function' ) {\n\n\t\t\twindow.DeviceOrientationEvent.requestPermission().then( function ( response ) {\n\n\t\t\t\tif ( response == 'granted' ) {\n\n\t\t\t\t\twindow.addEventListener( 'orientationchange', onScreenOrientationChangeEvent, false );\n\t\t\t\t\twindow.addEventListener( 'deviceorientation', onDeviceOrientationChangeEvent, false );\n\n\t\t\t\t}\n\n\t\t\t} ).catch( function ( error ) {\n\n\t\t\t\tconsole.error( 'THREE.DeviceOrientationControls: Unable to use DeviceOrientation API:', error );\n\n\t\t\t} );\n\n\t\t} else {\n\n\t\t\twindow.addEventListener( 'orientationchange', onScreenOrientationChangeEvent, false );\n\t\t\twindow.addEventListener( 'deviceorientation', onDeviceOrientationChangeEvent, false );\n\n\t\t}\n\n\t\tscope.enabled = true;\n\n\t};\n\n\tthis.disconnect = function () {\n\n\t\twindow.removeEventListener( 'orientationchange', onScreenOrientationChangeEvent, false );\n\t\twindow.removeEventListener( 'deviceorientation', onDeviceOrientationChangeEvent, false );\n\n\t\tscope.enabled = false;\n\n\t};\n\n\tthis.update = function () {\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\tvar device = scope.deviceOrientation;\n\n\t\tif ( device ) {\n\n\t\t\tvar alpha = device.alpha ? MathUtils.degToRad( device.alpha ) + scope.alphaOffset : 0; // Z\n\n\t\t\tvar beta = device.beta ? MathUtils.degToRad( device.beta ) : 0; // X'\n\n\t\t\tvar gamma = device.gamma ? MathUtils.degToRad( device.gamma ) : 0; // Y''\n\n\t\t\tvar orient = scope.screenOrientation ? MathUtils.degToRad( scope.screenOrientation ) : 0; // O\n\n\t\t\tsetObjectQuaternion( scope.object.quaternion, alpha, beta, gamma, orient );\n\n\t\t}\n\n\n\t};\n\n\tthis.dispose = function () {\n\n\t\tscope.disconnect();\n\n\t};\n\n\tthis.connect();\n\n};\n\nexport { DeviceOrientationControls };\n","/**\n * @author James Baicoianu / http://www.baicoianu.com/\n */\n\nimport {\n\tQuaternion,\n\tVector3\n} from \"../../../build/three.module.js\";\n\nvar FlyControls = function ( object, domElement ) {\n\n\tif ( domElement === undefined ) {\n\n\t\tconsole.warn( 'THREE.FlyControls: The second parameter \"domElement\" is now mandatory.' );\n\t\tdomElement = document;\n\n\t}\n\n\tthis.object = object;\n\tthis.domElement = domElement;\n\n\tif ( domElement ) this.domElement.setAttribute( 'tabindex', - 1 );\n\n\t// API\n\n\tthis.movementSpeed = 1.0;\n\tthis.rollSpeed = 0.005;\n\n\tthis.dragToLook = false;\n\tthis.autoForward = false;\n\n\t// disable default target object behavior\n\n\t// internals\n\n\tthis.tmpQuaternion = new Quaternion();\n\n\tthis.mouseStatus = 0;\n\n\tthis.moveState = { up: 0, down: 0, left: 0, right: 0, forward: 0, back: 0, pitchUp: 0, pitchDown: 0, yawLeft: 0, yawRight: 0, rollLeft: 0, rollRight: 0 };\n\tthis.moveVector = new Vector3( 0, 0, 0 );\n\tthis.rotationVector = new Vector3( 0, 0, 0 );\n\n\tthis.keydown = function ( event ) {\n\n\t\tif ( event.altKey ) {\n\n\t\t\treturn;\n\n\t\t}\n\n\t\t//event.preventDefault();\n\n\t\tswitch ( event.keyCode ) {\n\n\t\t\tcase 16: /* shift */ this.movementSpeedMultiplier = .1; break;\n\n\t\t\tcase 87: /*W*/ this.moveState.forward = 1; break;\n\t\t\tcase 83: /*S*/ this.moveState.back = 1; break;\n\n\t\t\tcase 65: /*A*/ this.moveState.left = 1; break;\n\t\t\tcase 68: /*D*/ this.moveState.right = 1; break;\n\n\t\t\tcase 82: /*R*/ this.moveState.up = 1; break;\n\t\t\tcase 70: /*F*/ this.moveState.down = 1; break;\n\n\t\t\tcase 38: /*up*/ this.moveState.pitchUp = 1; break;\n\t\t\tcase 40: /*down*/ this.moveState.pitchDown = 1; break;\n\n\t\t\tcase 37: /*left*/ this.moveState.yawLeft = 1; break;\n\t\t\tcase 39: /*right*/ this.moveState.yawRight = 1; break;\n\n\t\t\tcase 81: /*Q*/ this.moveState.rollLeft = 1; break;\n\t\t\tcase 69: /*E*/ this.moveState.rollRight = 1; break;\n\n\t\t}\n\n\t\tthis.updateMovementVector();\n\t\tthis.updateRotationVector();\n\n\t};\n\n\tthis.keyup = function ( event ) {\n\n\t\tswitch ( event.keyCode ) {\n\n\t\t\tcase 16: /* shift */ this.movementSpeedMultiplier = 1; break;\n\n\t\t\tcase 87: /*W*/ this.moveState.forward = 0; break;\n\t\t\tcase 83: /*S*/ this.moveState.back = 0; break;\n\n\t\t\tcase 65: /*A*/ this.moveState.left = 0; break;\n\t\t\tcase 68: /*D*/ this.moveState.right = 0; break;\n\n\t\t\tcase 82: /*R*/ this.moveState.up = 0; break;\n\t\t\tcase 70: /*F*/ this.moveState.down = 0; break;\n\n\t\t\tcase 38: /*up*/ this.moveState.pitchUp = 0; break;\n\t\t\tcase 40: /*down*/ this.moveState.pitchDown = 0; break;\n\n\t\t\tcase 37: /*left*/ this.moveState.yawLeft = 0; break;\n\t\t\tcase 39: /*right*/ this.moveState.yawRight = 0; break;\n\n\t\t\tcase 81: /*Q*/ this.moveState.rollLeft = 0; break;\n\t\t\tcase 69: /*E*/ this.moveState.rollRight = 0; break;\n\n\t\t}\n\n\t\tthis.updateMovementVector();\n\t\tthis.updateRotationVector();\n\n\t};\n\n\tthis.mousedown = function ( event ) {\n\n\t\tif ( this.domElement !== document ) {\n\n\t\t\tthis.domElement.focus();\n\n\t\t}\n\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\n\t\tif ( this.dragToLook ) {\n\n\t\t\tthis.mouseStatus ++;\n\n\t\t} else {\n\n\t\t\tswitch ( event.button ) {\n\n\t\t\t\tcase 0: this.moveState.forward = 1; break;\n\t\t\t\tcase 2: this.moveState.back = 1; break;\n\n\t\t\t}\n\n\t\t\tthis.updateMovementVector();\n\n\t\t}\n\n\t};\n\n\tthis.mousemove = function ( event ) {\n\n\t\tif ( ! this.dragToLook || this.mouseStatus > 0 ) {\n\n\t\t\tvar container = this.getContainerDimensions();\n\t\t\tvar halfWidth = container.size[ 0 ] / 2;\n\t\t\tvar halfHeight = container.size[ 1 ] / 2;\n\n\t\t\tthis.moveState.yawLeft = - ( ( event.pageX - container.offset[ 0 ] ) - halfWidth ) / halfWidth;\n\t\t\tthis.moveState.pitchDown = ( ( event.pageY - container.offset[ 1 ] ) - halfHeight ) / halfHeight;\n\n\t\t\tthis.updateRotationVector();\n\n\t\t}\n\n\t};\n\n\tthis.mouseup = function ( event ) {\n\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\n\t\tif ( this.dragToLook ) {\n\n\t\t\tthis.mouseStatus --;\n\n\t\t\tthis.moveState.yawLeft = this.moveState.pitchDown = 0;\n\n\t\t} else {\n\n\t\t\tswitch ( event.button ) {\n\n\t\t\t\tcase 0: this.moveState.forward = 0; break;\n\t\t\t\tcase 2: this.moveState.back = 0; break;\n\n\t\t\t}\n\n\t\t\tthis.updateMovementVector();\n\n\t\t}\n\n\t\tthis.updateRotationVector();\n\n\t};\n\n\tthis.update = function ( delta ) {\n\n\t\tvar moveMult = delta * this.movementSpeed;\n\t\tvar rotMult = delta * this.rollSpeed;\n\n\t\tthis.object.translateX( this.moveVector.x * moveMult );\n\t\tthis.object.translateY( this.moveVector.y * moveMult );\n\t\tthis.object.translateZ( this.moveVector.z * moveMult );\n\n\t\tthis.tmpQuaternion.set( this.rotationVector.x * rotMult, this.rotationVector.y * rotMult, this.rotationVector.z * rotMult, 1 ).normalize();\n\t\tthis.object.quaternion.multiply( this.tmpQuaternion );\n\n\t\t// expose the rotation vector for convenience\n\t\tthis.object.rotation.setFromQuaternion( this.object.quaternion, this.object.rotation.order );\n\n\n\t};\n\n\tthis.updateMovementVector = function () {\n\n\t\tvar forward = ( this.moveState.forward || ( this.autoForward && ! this.moveState.back ) ) ? 1 : 0;\n\n\t\tthis.moveVector.x = ( - this.moveState.left + this.moveState.right );\n\t\tthis.moveVector.y = ( - this.moveState.down + this.moveState.up );\n\t\tthis.moveVector.z = ( - forward + this.moveState.back );\n\n\t\t//console.log( 'move:', [ this.moveVector.x, this.moveVector.y, this.moveVector.z ] );\n\n\t};\n\n\tthis.updateRotationVector = function () {\n\n\t\tthis.rotationVector.x = ( - this.moveState.pitchDown + this.moveState.pitchUp );\n\t\tthis.rotationVector.y = ( - this.moveState.yawRight + this.moveState.yawLeft );\n\t\tthis.rotationVector.z = ( - this.moveState.rollRight + this.moveState.rollLeft );\n\n\t\t//console.log( 'rotate:', [ this.rotationVector.x, this.rotationVector.y, this.rotationVector.z ] );\n\n\t};\n\n\tthis.getContainerDimensions = function () {\n\n\t\tif ( this.domElement != document ) {\n\n\t\t\treturn {\n\t\t\t\tsize: [ this.domElement.offsetWidth, this.domElement.offsetHeight ],\n\t\t\t\toffset: [ this.domElement.offsetLeft, this.domElement.offsetTop ]\n\t\t\t};\n\n\t\t} else {\n\n\t\t\treturn {\n\t\t\t\tsize: [ window.innerWidth, window.innerHeight ],\n\t\t\t\toffset: [ 0, 0 ]\n\t\t\t};\n\n\t\t}\n\n\t};\n\n\tfunction bind( scope, fn ) {\n\n\t\treturn function () {\n\n\t\t\tfn.apply( scope, arguments );\n\n\t\t};\n\n\t}\n\n\tfunction contextmenu( event ) {\n\n\t\tevent.preventDefault();\n\n\t}\n\n\tthis.dispose = function () {\n\n\t\tthis.domElement.removeEventListener( 'contextmenu', contextmenu, false );\n\t\tthis.domElement.removeEventListener( 'mousedown', _mousedown, false );\n\t\tthis.domElement.removeEventListener( 'mousemove', _mousemove, false );\n\t\tthis.domElement.removeEventListener( 'mouseup', _mouseup, false );\n\n\t\twindow.removeEventListener( 'keydown', _keydown, false );\n\t\twindow.removeEventListener( 'keyup', _keyup, false );\n\n\t};\n\n\tvar _mousemove = bind( this, this.mousemove );\n\tvar _mousedown = bind( this, this.mousedown );\n\tvar _mouseup = bind( this, this.mouseup );\n\tvar _keydown = bind( this, this.keydown );\n\tvar _keyup = bind( this, this.keyup );\n\n\tthis.domElement.addEventListener( 'contextmenu', contextmenu, false );\n\n\tthis.domElement.addEventListener( 'mousemove', _mousemove, false );\n\tthis.domElement.addEventListener( 'mousedown', _mousedown, false );\n\tthis.domElement.addEventListener( 'mouseup', _mouseup, false );\n\n\twindow.addEventListener( 'keydown', _keydown, false );\n\twindow.addEventListener( 'keyup', _keyup, false );\n\n\tthis.updateMovementVector();\n\tthis.updateRotationVector();\n\n};\n\nexport { FlyControls };\n","/**\n * @author arodic / https://github.com/arodic\n */\n\nimport {\n\tBoxBufferGeometry,\n\tBufferGeometry,\n\tColor,\n\tCylinderBufferGeometry,\n\tDoubleSide,\n\tEuler,\n\tFloat32BufferAttribute,\n\tLine,\n\tLineBasicMaterial,\n\tMatrix4,\n\tMesh,\n\tMeshBasicMaterial,\n\tObject3D,\n\tOctahedronBufferGeometry,\n\tPlaneBufferGeometry,\n\tQuaternion,\n\tRaycaster,\n\tSphereBufferGeometry,\n\tTorusBufferGeometry,\n\tVector3\n} from \"../../../build/three.module.js\";\n\nvar TransformControls = function ( camera, domElement ) {\n\n\tif ( domElement === undefined ) {\n\n\t\tconsole.warn( 'THREE.TransformControls: The second parameter \"domElement\" is now mandatory.' );\n\t\tdomElement = document;\n\n\t}\n\n\tObject3D.call( this );\n\n\tthis.visible = false;\n\tthis.domElement = domElement;\n\n\tvar _gizmo = new TransformControlsGizmo();\n\tthis.add( _gizmo );\n\n\tvar _plane = new TransformControlsPlane();\n\tthis.add( _plane );\n\n\tvar scope = this;\n\n\t// Define properties with getters/setter\n\t// Setting the defined property will automatically trigger change event\n\t// Defined properties are passed down to gizmo and plane\n\n\tdefineProperty( \"camera\", camera );\n\tdefineProperty( \"object\", undefined );\n\tdefineProperty( \"enabled\", true );\n\tdefineProperty( \"axis\", null );\n\tdefineProperty( \"mode\", \"translate\" );\n\tdefineProperty( \"translationSnap\", null );\n\tdefineProperty( \"rotationSnap\", null );\n\tdefineProperty( \"scaleSnap\", null );\n\tdefineProperty( \"space\", \"world\" );\n\tdefineProperty( \"size\", 1 );\n\tdefineProperty( \"dragging\", false );\n\tdefineProperty( \"showX\", true );\n\tdefineProperty( \"showY\", true );\n\tdefineProperty( \"showZ\", true );\n\n\tvar changeEvent = { type: \"change\" };\n\tvar mouseDownEvent = { type: \"mouseDown\" };\n\tvar mouseUpEvent = { type: \"mouseUp\", mode: scope.mode };\n\tvar objectChangeEvent = { type: \"objectChange\" };\n\n\t// Reusable utility variables\n\n\tvar raycaster = new Raycaster();\n\n\tfunction intersectObjectWithRay( object, raycaster, includeInvisible ) {\n\n\t\tvar allIntersections = raycaster.intersectObject( object, true );\n\n\t\tfor ( var i = 0; i < allIntersections.length; i ++ ) {\n\n\t\t\tif ( allIntersections[ i ].object.visible || includeInvisible ) {\n\n\t\t\t\treturn allIntersections[ i ];\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn false;\n\n\t}\n\n\tvar _tempVector = new Vector3();\n\tvar _tempVector2 = new Vector3();\n\tvar _tempQuaternion = new Quaternion();\n\tvar _unit = {\n\t\tX: new Vector3( 1, 0, 0 ),\n\t\tY: new Vector3( 0, 1, 0 ),\n\t\tZ: new Vector3( 0, 0, 1 )\n\t};\n\n\tvar pointStart = new Vector3();\n\tvar pointEnd = new Vector3();\n\tvar offset = new Vector3();\n\tvar rotationAxis = new Vector3();\n\tvar startNorm = new Vector3();\n\tvar endNorm = new Vector3();\n\tvar rotationAngle = 0;\n\n\tvar cameraPosition = new Vector3();\n\tvar cameraQuaternion = new Quaternion();\n\tvar cameraScale = new Vector3();\n\n\tvar parentPosition = new Vector3();\n\tvar parentQuaternion = new Quaternion();\n\tvar parentQuaternionInv = new Quaternion();\n\tvar parentScale = new Vector3();\n\n\tvar worldPositionStart = new Vector3();\n\tvar worldQuaternionStart = new Quaternion();\n\tvar worldScaleStart = new Vector3();\n\n\tvar worldPosition = new Vector3();\n\tvar worldQuaternion = new Quaternion();\n\tvar worldQuaternionInv = new Quaternion();\n\tvar worldScale = new Vector3();\n\n\tvar eye = new Vector3();\n\n\tvar positionStart = new Vector3();\n\tvar quaternionStart = new Quaternion();\n\tvar scaleStart = new Vector3();\n\n\t// TODO: remove properties unused in plane and gizmo\n\n\tdefineProperty( \"worldPosition\", worldPosition );\n\tdefineProperty( \"worldPositionStart\", worldPositionStart );\n\tdefineProperty( \"worldQuaternion\", worldQuaternion );\n\tdefineProperty( \"worldQuaternionStart\", worldQuaternionStart );\n\tdefineProperty( \"cameraPosition\", cameraPosition );\n\tdefineProperty( \"cameraQuaternion\", cameraQuaternion );\n\tdefineProperty( \"pointStart\", pointStart );\n\tdefineProperty( \"pointEnd\", pointEnd );\n\tdefineProperty( \"rotationAxis\", rotationAxis );\n\tdefineProperty( \"rotationAngle\", rotationAngle );\n\tdefineProperty( \"eye\", eye );\n\n\t{\n\n\t\tdomElement.addEventListener( \"mousedown\", onPointerDown, false );\n\t\tdomElement.addEventListener( \"touchstart\", onPointerDown, false );\n\t\tdomElement.addEventListener( \"mousemove\", onPointerHover, false );\n\t\tdomElement.addEventListener( \"touchmove\", onPointerHover, false );\n\t\tdomElement.addEventListener( \"touchmove\", onPointerMove, false );\n\t\tdocument.addEventListener( \"mouseup\", onPointerUp, false );\n\t\tdomElement.addEventListener( \"touchend\", onPointerUp, false );\n\t\tdomElement.addEventListener( \"touchcancel\", onPointerUp, false );\n\t\tdomElement.addEventListener( \"touchleave\", onPointerUp, false );\n\n\t}\n\n\tthis.dispose = function () {\n\n\t\tdomElement.removeEventListener( \"mousedown\", onPointerDown );\n\t\tdomElement.removeEventListener( \"touchstart\", onPointerDown );\n\t\tdomElement.removeEventListener( \"mousemove\", onPointerHover );\n\t\tdocument.removeEventListener( \"mousemove\", onPointerMove );\n\t\tdomElement.removeEventListener( \"touchmove\", onPointerHover );\n\t\tdomElement.removeEventListener( \"touchmove\", onPointerMove );\n\t\tdocument.removeEventListener( \"mouseup\", onPointerUp );\n\t\tdomElement.removeEventListener( \"touchend\", onPointerUp );\n\t\tdomElement.removeEventListener( \"touchcancel\", onPointerUp );\n\t\tdomElement.removeEventListener( \"touchleave\", onPointerUp );\n\n\t\tthis.traverse( function ( child ) {\n\n\t\t\tif ( child.geometry ) child.geometry.dispose();\n\t\t\tif ( child.material ) child.material.dispose();\n\n\t\t} );\n\n\t};\n\n\t// Set current object\n\tthis.attach = function ( object ) {\n\n\t\tthis.object = object;\n\t\tthis.visible = true;\n\n\t\treturn this;\n\n\t};\n\n\t// Detatch from object\n\tthis.detach = function () {\n\n\t\tthis.object = undefined;\n\t\tthis.visible = false;\n\t\tthis.axis = null;\n\n\t\treturn this;\n\n\t};\n\n\t// Defined getter, setter and store for a property\n\tfunction defineProperty( propName, defaultValue ) {\n\n\t\tvar propValue = defaultValue;\n\n\t\tObject.defineProperty( scope, propName, {\n\n\t\t\tget: function () {\n\n\t\t\t\treturn propValue !== undefined ? propValue : defaultValue;\n\n\t\t\t},\n\n\t\t\tset: function ( value ) {\n\n\t\t\t\tif ( propValue !== value ) {\n\n\t\t\t\t\tpropValue = value;\n\t\t\t\t\t_plane[ propName ] = value;\n\t\t\t\t\t_gizmo[ propName ] = value;\n\n\t\t\t\t\tscope.dispatchEvent( { type: propName + \"-changed\", value: value } );\n\t\t\t\t\tscope.dispatchEvent( changeEvent );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} );\n\n\t\tscope[ propName ] = defaultValue;\n\t\t_plane[ propName ] = defaultValue;\n\t\t_gizmo[ propName ] = defaultValue;\n\n\t}\n\n\t// updateMatrixWorld  updates key transformation variables\n\tthis.updateMatrixWorld = function () {\n\n\t\tif ( this.object !== undefined ) {\n\n\t\t\tthis.object.updateMatrixWorld();\n\n\t\t\tif ( this.object.parent === null ) {\n\n\t\t\t\tconsole.error( 'TransformControls: The attached 3D object must be a part of the scene graph.' );\n\n\t\t\t} else {\n\n\t\t\t\tthis.object.parent.matrixWorld.decompose( parentPosition, parentQuaternion, parentScale );\n\n\t\t\t}\n\n\t\t\tthis.object.matrixWorld.decompose( worldPosition, worldQuaternion, worldScale );\n\n\t\t\tparentQuaternionInv.copy( parentQuaternion ).inverse();\n\t\t\tworldQuaternionInv.copy( worldQuaternion ).inverse();\n\n\t\t}\n\n\t\tthis.camera.updateMatrixWorld();\n\t\tthis.camera.matrixWorld.decompose( cameraPosition, cameraQuaternion, cameraScale );\n\n\t\teye.copy( cameraPosition ).sub( worldPosition ).normalize();\n\n\t\tObject3D.prototype.updateMatrixWorld.call( this );\n\n\t};\n\n\tthis.pointerHover = function ( pointer ) {\n\n\t\tif ( this.object === undefined || this.dragging === true || ( pointer.button !== undefined && pointer.button !== 0 ) ) return;\n\n\t\traycaster.setFromCamera( pointer, this.camera );\n\n\t\tvar intersect = intersectObjectWithRay( _gizmo.picker[ this.mode ], raycaster );\n\n\t\tif ( intersect ) {\n\n\t\t\tthis.axis = intersect.object.name;\n\n\t\t} else {\n\n\t\t\tthis.axis = null;\n\n\t\t}\n\n\t};\n\n\tthis.pointerDown = function ( pointer ) {\n\n\t\tif ( this.object === undefined || this.dragging === true || ( pointer.button !== undefined && pointer.button !== 0 ) ) return;\n\n\t\tif ( ( pointer.button === 0 || pointer.button === undefined ) && this.axis !== null ) {\n\n\t\t\traycaster.setFromCamera( pointer, this.camera );\n\n\t\t\tvar planeIntersect = intersectObjectWithRay( _plane, raycaster, true );\n\n\t\t\tif ( planeIntersect ) {\n\n\t\t\t\tvar space = this.space;\n\n\t\t\t\tif ( this.mode === 'scale' ) {\n\n\t\t\t\t\tspace = 'local';\n\n\t\t\t\t} else if ( this.axis === 'E' || this.axis === 'XYZE' || this.axis === 'XYZ' ) {\n\n\t\t\t\t\tspace = 'world';\n\n\t\t\t\t}\n\n\t\t\t\tif ( space === 'local' && this.mode === 'rotate' ) {\n\n\t\t\t\t\tvar snap = this.rotationSnap;\n\n\t\t\t\t\tif ( this.axis === 'X' && snap ) this.object.rotation.x = Math.round( this.object.rotation.x / snap ) * snap;\n\t\t\t\t\tif ( this.axis === 'Y' && snap ) this.object.rotation.y = Math.round( this.object.rotation.y / snap ) * snap;\n\t\t\t\t\tif ( this.axis === 'Z' && snap ) this.object.rotation.z = Math.round( this.object.rotation.z / snap ) * snap;\n\n\t\t\t\t}\n\n\t\t\t\tthis.object.updateMatrixWorld();\n\t\t\t\tthis.object.parent.updateMatrixWorld();\n\n\t\t\t\tpositionStart.copy( this.object.position );\n\t\t\t\tquaternionStart.copy( this.object.quaternion );\n\t\t\t\tscaleStart.copy( this.object.scale );\n\n\t\t\t\tthis.object.matrixWorld.decompose( worldPositionStart, worldQuaternionStart, worldScaleStart );\n\n\t\t\t\tpointStart.copy( planeIntersect.point ).sub( worldPositionStart );\n\n\t\t\t}\n\n\t\t\tthis.dragging = true;\n\t\t\tmouseDownEvent.mode = this.mode;\n\t\t\tthis.dispatchEvent( mouseDownEvent );\n\n\t\t}\n\n\t};\n\n\tthis.pointerMove = function ( pointer ) {\n\n\t\tvar axis = this.axis;\n\t\tvar mode = this.mode;\n\t\tvar object = this.object;\n\t\tvar space = this.space;\n\n\t\tif ( mode === 'scale' ) {\n\n\t\t\tspace = 'local';\n\n\t\t} else if ( axis === 'E' || axis === 'XYZE' || axis === 'XYZ' ) {\n\n\t\t\tspace = 'world';\n\n\t\t}\n\n\t\tif ( object === undefined || axis === null || this.dragging === false || ( pointer.button !== undefined && pointer.button !== 0 ) ) return;\n\n\t\traycaster.setFromCamera( pointer, this.camera );\n\n\t\tvar planeIntersect = intersectObjectWithRay( _plane, raycaster, true );\n\n\t\tif ( ! planeIntersect ) return;\n\n\t\tpointEnd.copy( planeIntersect.point ).sub( worldPositionStart );\n\n\t\tif ( mode === 'translate' ) {\n\n\t\t\t// Apply translate\n\n\t\t\toffset.copy( pointEnd ).sub( pointStart );\n\n\t\t\tif ( space === 'local' && axis !== 'XYZ' ) {\n\n\t\t\t\toffset.applyQuaternion( worldQuaternionInv );\n\n\t\t\t}\n\n\t\t\tif ( axis.indexOf( 'X' ) === - 1 ) offset.x = 0;\n\t\t\tif ( axis.indexOf( 'Y' ) === - 1 ) offset.y = 0;\n\t\t\tif ( axis.indexOf( 'Z' ) === - 1 ) offset.z = 0;\n\n\t\t\tif ( space === 'local' && axis !== 'XYZ' ) {\n\n\t\t\t\toffset.applyQuaternion( quaternionStart ).divide( parentScale );\n\n\t\t\t} else {\n\n\t\t\t\toffset.applyQuaternion( parentQuaternionInv ).divide( parentScale );\n\n\t\t\t}\n\n\t\t\tobject.position.copy( offset ).add( positionStart );\n\n\t\t\t// Apply translation snap\n\n\t\t\tif ( this.translationSnap ) {\n\n\t\t\t\tif ( space === 'local' ) {\n\n\t\t\t\t\tobject.position.applyQuaternion( _tempQuaternion.copy( quaternionStart ).inverse() );\n\n\t\t\t\t\tif ( axis.search( 'X' ) !== - 1 ) {\n\n\t\t\t\t\t\tobject.position.x = Math.round( object.position.x / this.translationSnap ) * this.translationSnap;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( axis.search( 'Y' ) !== - 1 ) {\n\n\t\t\t\t\t\tobject.position.y = Math.round( object.position.y / this.translationSnap ) * this.translationSnap;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( axis.search( 'Z' ) !== - 1 ) {\n\n\t\t\t\t\t\tobject.position.z = Math.round( object.position.z / this.translationSnap ) * this.translationSnap;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tobject.position.applyQuaternion( quaternionStart );\n\n\t\t\t\t}\n\n\t\t\t\tif ( space === 'world' ) {\n\n\t\t\t\t\tif ( object.parent ) {\n\n\t\t\t\t\t\tobject.position.add( _tempVector.setFromMatrixPosition( object.parent.matrixWorld ) );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( axis.search( 'X' ) !== - 1 ) {\n\n\t\t\t\t\t\tobject.position.x = Math.round( object.position.x / this.translationSnap ) * this.translationSnap;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( axis.search( 'Y' ) !== - 1 ) {\n\n\t\t\t\t\t\tobject.position.y = Math.round( object.position.y / this.translationSnap ) * this.translationSnap;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( axis.search( 'Z' ) !== - 1 ) {\n\n\t\t\t\t\t\tobject.position.z = Math.round( object.position.z / this.translationSnap ) * this.translationSnap;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( object.parent ) {\n\n\t\t\t\t\t\tobject.position.sub( _tempVector.setFromMatrixPosition( object.parent.matrixWorld ) );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else if ( mode === 'scale' ) {\n\n\t\t\tif ( axis.search( 'XYZ' ) !== - 1 ) {\n\n\t\t\t\tvar d = pointEnd.length() / pointStart.length();\n\n\t\t\t\tif ( pointEnd.dot( pointStart ) < 0 ) d *= - 1;\n\n\t\t\t\t_tempVector2.set( d, d, d );\n\n\t\t\t} else {\n\n\t\t\t\t_tempVector.copy( pointStart );\n\t\t\t\t_tempVector2.copy( pointEnd );\n\n\t\t\t\t_tempVector.applyQuaternion( worldQuaternionInv );\n\t\t\t\t_tempVector2.applyQuaternion( worldQuaternionInv );\n\n\t\t\t\t_tempVector2.divide( _tempVector );\n\n\t\t\t\tif ( axis.search( 'X' ) === - 1 ) {\n\n\t\t\t\t\t_tempVector2.x = 1;\n\n\t\t\t\t}\n\n\t\t\t\tif ( axis.search( 'Y' ) === - 1 ) {\n\n\t\t\t\t\t_tempVector2.y = 1;\n\n\t\t\t\t}\n\n\t\t\t\tif ( axis.search( 'Z' ) === - 1 ) {\n\n\t\t\t\t\t_tempVector2.z = 1;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// Apply scale\n\n\t\t\tobject.scale.copy( scaleStart ).multiply( _tempVector2 );\n\n\t\t\tif ( this.scaleSnap ) {\n\n\t\t\t\tif ( axis.search( 'X' ) !== - 1 ) {\n\n\t\t\t\t\tobject.scale.x = Math.round( object.scale.x / this.scaleSnap ) * this.scaleSnap || this.scaleSnap;\n\n\t\t\t\t}\n\n\t\t\t\tif ( axis.search( 'Y' ) !== - 1 ) {\n\n\t\t\t\t\tobject.scale.y = Math.round( object.scale.y / this.scaleSnap ) * this.scaleSnap || this.scaleSnap;\n\n\t\t\t\t}\n\n\t\t\t\tif ( axis.search( 'Z' ) !== - 1 ) {\n\n\t\t\t\t\tobject.scale.z = Math.round( object.scale.z / this.scaleSnap ) * this.scaleSnap || this.scaleSnap;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else if ( mode === 'rotate' ) {\n\n\t\t\toffset.copy( pointEnd ).sub( pointStart );\n\n\t\t\tvar ROTATION_SPEED = 20 / worldPosition.distanceTo( _tempVector.setFromMatrixPosition( this.camera.matrixWorld ) );\n\n\t\t\tif ( axis === 'E' ) {\n\n\t\t\t\trotationAxis.copy( eye );\n\t\t\t\trotationAngle = pointEnd.angleTo( pointStart );\n\n\t\t\t\tstartNorm.copy( pointStart ).normalize();\n\t\t\t\tendNorm.copy( pointEnd ).normalize();\n\n\t\t\t\trotationAngle *= ( endNorm.cross( startNorm ).dot( eye ) < 0 ? 1 : - 1 );\n\n\t\t\t} else if ( axis === 'XYZE' ) {\n\n\t\t\t\trotationAxis.copy( offset ).cross( eye ).normalize();\n\t\t\t\trotationAngle = offset.dot( _tempVector.copy( rotationAxis ).cross( this.eye ) ) * ROTATION_SPEED;\n\n\t\t\t} else if ( axis === 'X' || axis === 'Y' || axis === 'Z' ) {\n\n\t\t\t\trotationAxis.copy( _unit[ axis ] );\n\n\t\t\t\t_tempVector.copy( _unit[ axis ] );\n\n\t\t\t\tif ( space === 'local' ) {\n\n\t\t\t\t\t_tempVector.applyQuaternion( worldQuaternion );\n\n\t\t\t\t}\n\n\t\t\t\trotationAngle = offset.dot( _tempVector.cross( eye ).normalize() ) * ROTATION_SPEED;\n\n\t\t\t}\n\n\t\t\t// Apply rotation snap\n\n\t\t\tif ( this.rotationSnap ) rotationAngle = Math.round( rotationAngle / this.rotationSnap ) * this.rotationSnap;\n\n\t\t\tthis.rotationAngle = rotationAngle;\n\n\t\t\t// Apply rotate\n\t\t\tif ( space === 'local' && axis !== 'E' && axis !== 'XYZE' ) {\n\n\t\t\t\tobject.quaternion.copy( quaternionStart );\n\t\t\t\tobject.quaternion.multiply( _tempQuaternion.setFromAxisAngle( rotationAxis, rotationAngle ) ).normalize();\n\n\t\t\t} else {\n\n\t\t\t\trotationAxis.applyQuaternion( parentQuaternionInv );\n\t\t\t\tobject.quaternion.copy( _tempQuaternion.setFromAxisAngle( rotationAxis, rotationAngle ) );\n\t\t\t\tobject.quaternion.multiply( quaternionStart ).normalize();\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis.dispatchEvent( changeEvent );\n\t\tthis.dispatchEvent( objectChangeEvent );\n\n\t};\n\n\tthis.pointerUp = function ( pointer ) {\n\n\t\tif ( pointer.button !== undefined && pointer.button !== 0 ) return;\n\n\t\tif ( this.dragging && ( this.axis !== null ) ) {\n\n\t\t\tmouseUpEvent.mode = this.mode;\n\t\t\tthis.dispatchEvent( mouseUpEvent );\n\n\t\t}\n\n\t\tthis.dragging = false;\n\n\t\tif ( pointer.button === undefined ) this.axis = null;\n\n\t};\n\n\t// normalize mouse / touch pointer and remap {x,y} to view space.\n\n\tfunction getPointer( event ) {\n\n\t\tif ( document.pointerLockElement ) {\n\n\t\t\treturn {\n\t\t\t\tx: 0,\n\t\t\t\ty: 0,\n\t\t\t\tbutton: event.button\n\t\t\t};\n\n\t\t} else {\n\n\t\t\tvar pointer = event.changedTouches ? event.changedTouches[ 0 ] : event;\n\n\t\t\tvar rect = domElement.getBoundingClientRect();\n\n\t\t\treturn {\n\t\t\t\tx: ( pointer.clientX - rect.left ) / rect.width * 2 - 1,\n\t\t\t\ty: - ( pointer.clientY - rect.top ) / rect.height * 2 + 1,\n\t\t\t\tbutton: event.button\n\t\t\t};\n\n\t\t}\n\n\t}\n\n\t// mouse / touch event handlers\n\n\tfunction onPointerHover( event ) {\n\n\t\tif ( ! scope.enabled ) return;\n\n\t\tscope.pointerHover( getPointer( event ) );\n\n\t}\n\n\tfunction onPointerDown( event ) {\n\n\t\tif ( ! scope.enabled ) return;\n\n\t\tdocument.addEventListener( \"mousemove\", onPointerMove, false );\n\n\t\tscope.pointerHover( getPointer( event ) );\n\t\tscope.pointerDown( getPointer( event ) );\n\n\t}\n\n\tfunction onPointerMove( event ) {\n\n\t\tif ( ! scope.enabled ) return;\n\n\t\tscope.pointerMove( getPointer( event ) );\n\n\t}\n\n\tfunction onPointerUp( event ) {\n\n\t\tif ( ! scope.enabled ) return;\n\n\t\tdocument.removeEventListener( \"mousemove\", onPointerMove, false );\n\n\t\tscope.pointerUp( getPointer( event ) );\n\n\t}\n\n\t// TODO: deprecate\n\n\tthis.getMode = function () {\n\n\t\treturn scope.mode;\n\n\t};\n\n\tthis.setMode = function ( mode ) {\n\n\t\tscope.mode = mode;\n\n\t};\n\n\tthis.setTranslationSnap = function ( translationSnap ) {\n\n\t\tscope.translationSnap = translationSnap;\n\n\t};\n\n\tthis.setRotationSnap = function ( rotationSnap ) {\n\n\t\tscope.rotationSnap = rotationSnap;\n\n\t};\n\n\tthis.setScaleSnap = function ( scaleSnap ) {\n\n\t\tscope.scaleSnap = scaleSnap;\n\n\t};\n\n\tthis.setSize = function ( size ) {\n\n\t\tscope.size = size;\n\n\t};\n\n\tthis.setSpace = function ( space ) {\n\n\t\tscope.space = space;\n\n\t};\n\n\tthis.update = function () {\n\n\t\tconsole.warn( 'THREE.TransformControls: update function has no more functionality and therefore has been deprecated.' );\n\n\t};\n\n};\n\nTransformControls.prototype = Object.assign( Object.create( Object3D.prototype ), {\n\n\tconstructor: TransformControls,\n\n\tisTransformControls: true\n\n} );\n\n\nvar TransformControlsGizmo = function () {\n\n\t'use strict';\n\n\tObject3D.call( this );\n\n\tthis.type = 'TransformControlsGizmo';\n\n\t// shared materials\n\n\tvar gizmoMaterial = new MeshBasicMaterial( {\n\t\tdepthTest: false,\n\t\tdepthWrite: false,\n\t\ttransparent: true,\n\t\tside: DoubleSide,\n\t\tfog: false\n\t} );\n\n\tvar gizmoLineMaterial = new LineBasicMaterial( {\n\t\tdepthTest: false,\n\t\tdepthWrite: false,\n\t\ttransparent: true,\n\t\tlinewidth: 1,\n\t\tfog: false\n\t} );\n\n\t// Make unique material for each axis/color\n\n\tvar matInvisible = gizmoMaterial.clone();\n\tmatInvisible.opacity = 0.15;\n\n\tvar matHelper = gizmoMaterial.clone();\n\tmatHelper.opacity = 0.33;\n\n\tvar matRed = gizmoMaterial.clone();\n\tmatRed.color.set( 0xff0000 );\n\n\tvar matGreen = gizmoMaterial.clone();\n\tmatGreen.color.set( 0x00ff00 );\n\n\tvar matBlue = gizmoMaterial.clone();\n\tmatBlue.color.set( 0x0000ff );\n\n\tvar matWhiteTransparent = gizmoMaterial.clone();\n\tmatWhiteTransparent.opacity = 0.25;\n\n\tvar matYellowTransparent = matWhiteTransparent.clone();\n\tmatYellowTransparent.color.set( 0xffff00 );\n\n\tvar matCyanTransparent = matWhiteTransparent.clone();\n\tmatCyanTransparent.color.set( 0x00ffff );\n\n\tvar matMagentaTransparent = matWhiteTransparent.clone();\n\tmatMagentaTransparent.color.set( 0xff00ff );\n\n\tvar matYellow = gizmoMaterial.clone();\n\tmatYellow.color.set( 0xffff00 );\n\n\tvar matLineRed = gizmoLineMaterial.clone();\n\tmatLineRed.color.set( 0xff0000 );\n\n\tvar matLineGreen = gizmoLineMaterial.clone();\n\tmatLineGreen.color.set( 0x00ff00 );\n\n\tvar matLineBlue = gizmoLineMaterial.clone();\n\tmatLineBlue.color.set( 0x0000ff );\n\n\tvar matLineCyan = gizmoLineMaterial.clone();\n\tmatLineCyan.color.set( 0x00ffff );\n\n\tvar matLineMagenta = gizmoLineMaterial.clone();\n\tmatLineMagenta.color.set( 0xff00ff );\n\n\tvar matLineYellow = gizmoLineMaterial.clone();\n\tmatLineYellow.color.set( 0xffff00 );\n\n\tvar matLineGray = gizmoLineMaterial.clone();\n\tmatLineGray.color.set( 0x787878 );\n\n\tvar matLineYellowTransparent = matLineYellow.clone();\n\tmatLineYellowTransparent.opacity = 0.25;\n\n\t// reusable geometry\n\n\tvar arrowGeometry = new CylinderBufferGeometry( 0, 0.05, 0.2, 12, 1, false );\n\n\tvar scaleHandleGeometry = new BoxBufferGeometry( 0.125, 0.125, 0.125 );\n\n\tvar lineGeometry = new BufferGeometry( );\n\tlineGeometry.setAttribute( 'position', new Float32BufferAttribute( [ 0, 0, 0,\t1, 0, 0 ], 3 ) );\n\n\tvar CircleGeometry = function ( radius, arc ) {\n\n\t\tvar geometry = new BufferGeometry( );\n\t\tvar vertices = [];\n\n\t\tfor ( var i = 0; i <= 64 * arc; ++ i ) {\n\n\t\t\tvertices.push( 0, Math.cos( i / 32 * Math.PI ) * radius, Math.sin( i / 32 * Math.PI ) * radius );\n\n\t\t}\n\n\t\tgeometry.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\n\t\treturn geometry;\n\n\t};\n\n\t// Special geometry for transform helper. If scaled with position vector it spans from [0,0,0] to position\n\n\tvar TranslateHelperGeometry = function () {\n\n\t\tvar geometry = new BufferGeometry();\n\n\t\tgeometry.setAttribute( 'position', new Float32BufferAttribute( [ 0, 0, 0, 1, 1, 1 ], 3 ) );\n\n\t\treturn geometry;\n\n\t};\n\n\t// Gizmo definitions - custom hierarchy definitions for setupGizmo() function\n\n\tvar gizmoTranslate = {\n\t\tX: [\n\t\t\t[ new Mesh( arrowGeometry, matRed ), [ 1, 0, 0 ], [ 0, 0, - Math.PI / 2 ], null, 'fwd' ],\n\t\t\t[ new Mesh( arrowGeometry, matRed ), [ 1, 0, 0 ], [ 0, 0, Math.PI / 2 ], null, 'bwd' ],\n\t\t\t[ new Line( lineGeometry, matLineRed ) ]\n\t\t],\n\t\tY: [\n\t\t\t[ new Mesh( arrowGeometry, matGreen ), [ 0, 1, 0 ], null, null, 'fwd' ],\n\t\t\t[ new Mesh( arrowGeometry, matGreen ), [ 0, 1, 0 ], [ Math.PI, 0, 0 ], null, 'bwd' ],\n\t\t\t[ new Line( lineGeometry, matLineGreen ), null, [ 0, 0, Math.PI / 2 ]]\n\t\t],\n\t\tZ: [\n\t\t\t[ new Mesh( arrowGeometry, matBlue ), [ 0, 0, 1 ], [ Math.PI / 2, 0, 0 ], null, 'fwd' ],\n\t\t\t[ new Mesh( arrowGeometry, matBlue ), [ 0, 0, 1 ], [ - Math.PI / 2, 0, 0 ], null, 'bwd' ],\n\t\t\t[ new Line( lineGeometry, matLineBlue ), null, [ 0, - Math.PI / 2, 0 ]]\n\t\t],\n\t\tXYZ: [\n\t\t\t[ new Mesh( new OctahedronBufferGeometry( 0.1, 0 ), matWhiteTransparent.clone() ), [ 0, 0, 0 ], [ 0, 0, 0 ]]\n\t\t],\n\t\tXY: [\n\t\t\t[ new Mesh( new PlaneBufferGeometry( 0.295, 0.295 ), matYellowTransparent.clone() ), [ 0.15, 0.15, 0 ]],\n\t\t\t[ new Line( lineGeometry, matLineYellow ), [ 0.18, 0.3, 0 ], null, [ 0.125, 1, 1 ]],\n\t\t\t[ new Line( lineGeometry, matLineYellow ), [ 0.3, 0.18, 0 ], [ 0, 0, Math.PI / 2 ], [ 0.125, 1, 1 ]]\n\t\t],\n\t\tYZ: [\n\t\t\t[ new Mesh( new PlaneBufferGeometry( 0.295, 0.295 ), matCyanTransparent.clone() ), [ 0, 0.15, 0.15 ], [ 0, Math.PI / 2, 0 ]],\n\t\t\t[ new Line( lineGeometry, matLineCyan ), [ 0, 0.18, 0.3 ], [ 0, 0, Math.PI / 2 ], [ 0.125, 1, 1 ]],\n\t\t\t[ new Line( lineGeometry, matLineCyan ), [ 0, 0.3, 0.18 ], [ 0, - Math.PI / 2, 0 ], [ 0.125, 1, 1 ]]\n\t\t],\n\t\tXZ: [\n\t\t\t[ new Mesh( new PlaneBufferGeometry( 0.295, 0.295 ), matMagentaTransparent.clone() ), [ 0.15, 0, 0.15 ], [ - Math.PI / 2, 0, 0 ]],\n\t\t\t[ new Line( lineGeometry, matLineMagenta ), [ 0.18, 0, 0.3 ], null, [ 0.125, 1, 1 ]],\n\t\t\t[ new Line( lineGeometry, matLineMagenta ), [ 0.3, 0, 0.18 ], [ 0, - Math.PI / 2, 0 ], [ 0.125, 1, 1 ]]\n\t\t]\n\t};\n\n\tvar pickerTranslate = {\n\t\tX: [\n\t\t\t[ new Mesh( new CylinderBufferGeometry( 0.2, 0, 1, 4, 1, false ), matInvisible ), [ 0.6, 0, 0 ], [ 0, 0, - Math.PI / 2 ]]\n\t\t],\n\t\tY: [\n\t\t\t[ new Mesh( new CylinderBufferGeometry( 0.2, 0, 1, 4, 1, false ), matInvisible ), [ 0, 0.6, 0 ]]\n\t\t],\n\t\tZ: [\n\t\t\t[ new Mesh( new CylinderBufferGeometry( 0.2, 0, 1, 4, 1, false ), matInvisible ), [ 0, 0, 0.6 ], [ Math.PI / 2, 0, 0 ]]\n\t\t],\n\t\tXYZ: [\n\t\t\t[ new Mesh( new OctahedronBufferGeometry( 0.2, 0 ), matInvisible ) ]\n\t\t],\n\t\tXY: [\n\t\t\t[ new Mesh( new PlaneBufferGeometry( 0.4, 0.4 ), matInvisible ), [ 0.2, 0.2, 0 ]]\n\t\t],\n\t\tYZ: [\n\t\t\t[ new Mesh( new PlaneBufferGeometry( 0.4, 0.4 ), matInvisible ), [ 0, 0.2, 0.2 ], [ 0, Math.PI / 2, 0 ]]\n\t\t],\n\t\tXZ: [\n\t\t\t[ new Mesh( new PlaneBufferGeometry( 0.4, 0.4 ), matInvisible ), [ 0.2, 0, 0.2 ], [ - Math.PI / 2, 0, 0 ]]\n\t\t]\n\t};\n\n\tvar helperTranslate = {\n\t\tSTART: [\n\t\t\t[ new Mesh( new OctahedronBufferGeometry( 0.01, 2 ), matHelper ), null, null, null, 'helper' ]\n\t\t],\n\t\tEND: [\n\t\t\t[ new Mesh( new OctahedronBufferGeometry( 0.01, 2 ), matHelper ), null, null, null, 'helper' ]\n\t\t],\n\t\tDELTA: [\n\t\t\t[ new Line( TranslateHelperGeometry(), matHelper ), null, null, null, 'helper' ]\n\t\t],\n\t\tX: [\n\t\t\t[ new Line( lineGeometry, matHelper.clone() ), [ - 1e3, 0, 0 ], null, [ 1e6, 1, 1 ], 'helper' ]\n\t\t],\n\t\tY: [\n\t\t\t[ new Line( lineGeometry, matHelper.clone() ), [ 0, - 1e3, 0 ], [ 0, 0, Math.PI / 2 ], [ 1e6, 1, 1 ], 'helper' ]\n\t\t],\n\t\tZ: [\n\t\t\t[ new Line( lineGeometry, matHelper.clone() ), [ 0, 0, - 1e3 ], [ 0, - Math.PI / 2, 0 ], [ 1e6, 1, 1 ], 'helper' ]\n\t\t]\n\t};\n\n\tvar gizmoRotate = {\n\t\tX: [\n\t\t\t[ new Line( CircleGeometry( 1, 0.5 ), matLineRed ) ],\n\t\t\t[ new Mesh( new OctahedronBufferGeometry( 0.04, 0 ), matRed ), [ 0, 0, 0.99 ], null, [ 1, 3, 1 ]],\n\t\t],\n\t\tY: [\n\t\t\t[ new Line( CircleGeometry( 1, 0.5 ), matLineGreen ), null, [ 0, 0, - Math.PI / 2 ]],\n\t\t\t[ new Mesh( new OctahedronBufferGeometry( 0.04, 0 ), matGreen ), [ 0, 0, 0.99 ], null, [ 3, 1, 1 ]],\n\t\t],\n\t\tZ: [\n\t\t\t[ new Line( CircleGeometry( 1, 0.5 ), matLineBlue ), null, [ 0, Math.PI / 2, 0 ]],\n\t\t\t[ new Mesh( new OctahedronBufferGeometry( 0.04, 0 ), matBlue ), [ 0.99, 0, 0 ], null, [ 1, 3, 1 ]],\n\t\t],\n\t\tE: [\n\t\t\t[ new Line( CircleGeometry( 1.25, 1 ), matLineYellowTransparent ), null, [ 0, Math.PI / 2, 0 ]],\n\t\t\t[ new Mesh( new CylinderBufferGeometry( 0.03, 0, 0.15, 4, 1, false ), matLineYellowTransparent ), [ 1.17, 0, 0 ], [ 0, 0, - Math.PI / 2 ], [ 1, 1, 0.001 ]],\n\t\t\t[ new Mesh( new CylinderBufferGeometry( 0.03, 0, 0.15, 4, 1, false ), matLineYellowTransparent ), [ - 1.17, 0, 0 ], [ 0, 0, Math.PI / 2 ], [ 1, 1, 0.001 ]],\n\t\t\t[ new Mesh( new CylinderBufferGeometry( 0.03, 0, 0.15, 4, 1, false ), matLineYellowTransparent ), [ 0, - 1.17, 0 ], [ Math.PI, 0, 0 ], [ 1, 1, 0.001 ]],\n\t\t\t[ new Mesh( new CylinderBufferGeometry( 0.03, 0, 0.15, 4, 1, false ), matLineYellowTransparent ), [ 0, 1.17, 0 ], [ 0, 0, 0 ], [ 1, 1, 0.001 ]],\n\t\t],\n\t\tXYZE: [\n\t\t\t[ new Line( CircleGeometry( 1, 1 ), matLineGray ), null, [ 0, Math.PI / 2, 0 ]]\n\t\t]\n\t};\n\n\tvar helperRotate = {\n\t\tAXIS: [\n\t\t\t[ new Line( lineGeometry, matHelper.clone() ), [ - 1e3, 0, 0 ], null, [ 1e6, 1, 1 ], 'helper' ]\n\t\t]\n\t};\n\n\tvar pickerRotate = {\n\t\tX: [\n\t\t\t[ new Mesh( new TorusBufferGeometry( 1, 0.1, 4, 24 ), matInvisible ), [ 0, 0, 0 ], [ 0, - Math.PI / 2, - Math.PI / 2 ]],\n\t\t],\n\t\tY: [\n\t\t\t[ new Mesh( new TorusBufferGeometry( 1, 0.1, 4, 24 ), matInvisible ), [ 0, 0, 0 ], [ Math.PI / 2, 0, 0 ]],\n\t\t],\n\t\tZ: [\n\t\t\t[ new Mesh( new TorusBufferGeometry( 1, 0.1, 4, 24 ), matInvisible ), [ 0, 0, 0 ], [ 0, 0, - Math.PI / 2 ]],\n\t\t],\n\t\tE: [\n\t\t\t[ new Mesh( new TorusBufferGeometry( 1.25, 0.1, 2, 24 ), matInvisible ) ]\n\t\t],\n\t\tXYZE: [\n\t\t\t[ new Mesh( new SphereBufferGeometry( 0.7, 10, 8 ), matInvisible ) ]\n\t\t]\n\t};\n\n\tvar gizmoScale = {\n\t\tX: [\n\t\t\t[ new Mesh( scaleHandleGeometry, matRed ), [ 0.8, 0, 0 ], [ 0, 0, - Math.PI / 2 ]],\n\t\t\t[ new Line( lineGeometry, matLineRed ), null, null, [ 0.8, 1, 1 ]]\n\t\t],\n\t\tY: [\n\t\t\t[ new Mesh( scaleHandleGeometry, matGreen ), [ 0, 0.8, 0 ]],\n\t\t\t[ new Line( lineGeometry, matLineGreen ), null, [ 0, 0, Math.PI / 2 ], [ 0.8, 1, 1 ]]\n\t\t],\n\t\tZ: [\n\t\t\t[ new Mesh( scaleHandleGeometry, matBlue ), [ 0, 0, 0.8 ], [ Math.PI / 2, 0, 0 ]],\n\t\t\t[ new Line( lineGeometry, matLineBlue ), null, [ 0, - Math.PI / 2, 0 ], [ 0.8, 1, 1 ]]\n\t\t],\n\t\tXY: [\n\t\t\t[ new Mesh( scaleHandleGeometry, matYellowTransparent ), [ 0.85, 0.85, 0 ], null, [ 2, 2, 0.2 ]],\n\t\t\t[ new Line( lineGeometry, matLineYellow ), [ 0.855, 0.98, 0 ], null, [ 0.125, 1, 1 ]],\n\t\t\t[ new Line( lineGeometry, matLineYellow ), [ 0.98, 0.855, 0 ], [ 0, 0, Math.PI / 2 ], [ 0.125, 1, 1 ]]\n\t\t],\n\t\tYZ: [\n\t\t\t[ new Mesh( scaleHandleGeometry, matCyanTransparent ), [ 0, 0.85, 0.85 ], null, [ 0.2, 2, 2 ]],\n\t\t\t[ new Line( lineGeometry, matLineCyan ), [ 0, 0.855, 0.98 ], [ 0, 0, Math.PI / 2 ], [ 0.125, 1, 1 ]],\n\t\t\t[ new Line( lineGeometry, matLineCyan ), [ 0, 0.98, 0.855 ], [ 0, - Math.PI / 2, 0 ], [ 0.125, 1, 1 ]]\n\t\t],\n\t\tXZ: [\n\t\t\t[ new Mesh( scaleHandleGeometry, matMagentaTransparent ), [ 0.85, 0, 0.85 ], null, [ 2, 0.2, 2 ]],\n\t\t\t[ new Line( lineGeometry, matLineMagenta ), [ 0.855, 0, 0.98 ], null, [ 0.125, 1, 1 ]],\n\t\t\t[ new Line( lineGeometry, matLineMagenta ), [ 0.98, 0, 0.855 ], [ 0, - Math.PI / 2, 0 ], [ 0.125, 1, 1 ]]\n\t\t],\n\t\tXYZX: [\n\t\t\t[ new Mesh( new BoxBufferGeometry( 0.125, 0.125, 0.125 ), matWhiteTransparent.clone() ), [ 1.1, 0, 0 ]],\n\t\t],\n\t\tXYZY: [\n\t\t\t[ new Mesh( new BoxBufferGeometry( 0.125, 0.125, 0.125 ), matWhiteTransparent.clone() ), [ 0, 1.1, 0 ]],\n\t\t],\n\t\tXYZZ: [\n\t\t\t[ new Mesh( new BoxBufferGeometry( 0.125, 0.125, 0.125 ), matWhiteTransparent.clone() ), [ 0, 0, 1.1 ]],\n\t\t]\n\t};\n\n\tvar pickerScale = {\n\t\tX: [\n\t\t\t[ new Mesh( new CylinderBufferGeometry( 0.2, 0, 0.8, 4, 1, false ), matInvisible ), [ 0.5, 0, 0 ], [ 0, 0, - Math.PI / 2 ]]\n\t\t],\n\t\tY: [\n\t\t\t[ new Mesh( new CylinderBufferGeometry( 0.2, 0, 0.8, 4, 1, false ), matInvisible ), [ 0, 0.5, 0 ]]\n\t\t],\n\t\tZ: [\n\t\t\t[ new Mesh( new CylinderBufferGeometry( 0.2, 0, 0.8, 4, 1, false ), matInvisible ), [ 0, 0, 0.5 ], [ Math.PI / 2, 0, 0 ]]\n\t\t],\n\t\tXY: [\n\t\t\t[ new Mesh( scaleHandleGeometry, matInvisible ), [ 0.85, 0.85, 0 ], null, [ 3, 3, 0.2 ]],\n\t\t],\n\t\tYZ: [\n\t\t\t[ new Mesh( scaleHandleGeometry, matInvisible ), [ 0, 0.85, 0.85 ], null, [ 0.2, 3, 3 ]],\n\t\t],\n\t\tXZ: [\n\t\t\t[ new Mesh( scaleHandleGeometry, matInvisible ), [ 0.85, 0, 0.85 ], null, [ 3, 0.2, 3 ]],\n\t\t],\n\t\tXYZX: [\n\t\t\t[ new Mesh( new BoxBufferGeometry( 0.2, 0.2, 0.2 ), matInvisible ), [ 1.1, 0, 0 ]],\n\t\t],\n\t\tXYZY: [\n\t\t\t[ new Mesh( new BoxBufferGeometry( 0.2, 0.2, 0.2 ), matInvisible ), [ 0, 1.1, 0 ]],\n\t\t],\n\t\tXYZZ: [\n\t\t\t[ new Mesh( new BoxBufferGeometry( 0.2, 0.2, 0.2 ), matInvisible ), [ 0, 0, 1.1 ]],\n\t\t]\n\t};\n\n\tvar helperScale = {\n\t\tX: [\n\t\t\t[ new Line( lineGeometry, matHelper.clone() ), [ - 1e3, 0, 0 ], null, [ 1e6, 1, 1 ], 'helper' ]\n\t\t],\n\t\tY: [\n\t\t\t[ new Line( lineGeometry, matHelper.clone() ), [ 0, - 1e3, 0 ], [ 0, 0, Math.PI / 2 ], [ 1e6, 1, 1 ], 'helper' ]\n\t\t],\n\t\tZ: [\n\t\t\t[ new Line( lineGeometry, matHelper.clone() ), [ 0, 0, - 1e3 ], [ 0, - Math.PI / 2, 0 ], [ 1e6, 1, 1 ], 'helper' ]\n\t\t]\n\t};\n\n\t// Creates an Object3D with gizmos described in custom hierarchy definition.\n\n\tvar setupGizmo = function ( gizmoMap ) {\n\n\t\tvar gizmo = new Object3D();\n\n\t\tfor ( var name in gizmoMap ) {\n\n\t\t\tfor ( var i = gizmoMap[ name ].length; i --; ) {\n\n\t\t\t\tvar object = gizmoMap[ name ][ i ][ 0 ].clone();\n\t\t\t\tvar position = gizmoMap[ name ][ i ][ 1 ];\n\t\t\t\tvar rotation = gizmoMap[ name ][ i ][ 2 ];\n\t\t\t\tvar scale = gizmoMap[ name ][ i ][ 3 ];\n\t\t\t\tvar tag = gizmoMap[ name ][ i ][ 4 ];\n\n\t\t\t\t// name and tag properties are essential for picking and updating logic.\n\t\t\t\tobject.name = name;\n\t\t\t\tobject.tag = tag;\n\n\t\t\t\tif ( position ) {\n\n\t\t\t\t\tobject.position.set( position[ 0 ], position[ 1 ], position[ 2 ] );\n\n\t\t\t\t}\n\n\t\t\t\tif ( rotation ) {\n\n\t\t\t\t\tobject.rotation.set( rotation[ 0 ], rotation[ 1 ], rotation[ 2 ] );\n\n\t\t\t\t}\n\n\t\t\t\tif ( scale ) {\n\n\t\t\t\t\tobject.scale.set( scale[ 0 ], scale[ 1 ], scale[ 2 ] );\n\n\t\t\t\t}\n\n\t\t\t\tobject.updateMatrix();\n\n\t\t\t\tvar tempGeometry = object.geometry.clone();\n\t\t\t\ttempGeometry.applyMatrix4( object.matrix );\n\t\t\t\tobject.geometry = tempGeometry;\n\t\t\t\tobject.renderOrder = Infinity;\n\n\t\t\t\tobject.position.set( 0, 0, 0 );\n\t\t\t\tobject.rotation.set( 0, 0, 0 );\n\t\t\t\tobject.scale.set( 1, 1, 1 );\n\n\t\t\t\tgizmo.add( object );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn gizmo;\n\n\t};\n\n\t// Reusable utility variables\n\n\tvar tempVector = new Vector3( 0, 0, 0 );\n\tvar tempEuler = new Euler();\n\tvar alignVector = new Vector3( 0, 1, 0 );\n\tvar zeroVector = new Vector3( 0, 0, 0 );\n\tvar lookAtMatrix = new Matrix4();\n\tvar tempQuaternion = new Quaternion();\n\tvar tempQuaternion2 = new Quaternion();\n\tvar identityQuaternion = new Quaternion();\n\n\tvar unitX = new Vector3( 1, 0, 0 );\n\tvar unitY = new Vector3( 0, 1, 0 );\n\tvar unitZ = new Vector3( 0, 0, 1 );\n\n\t// Gizmo creation\n\n\tthis.gizmo = {};\n\tthis.picker = {};\n\tthis.helper = {};\n\n\tthis.add( this.gizmo[ \"translate\" ] = setupGizmo( gizmoTranslate ) );\n\tthis.add( this.gizmo[ \"rotate\" ] = setupGizmo( gizmoRotate ) );\n\tthis.add( this.gizmo[ \"scale\" ] = setupGizmo( gizmoScale ) );\n\tthis.add( this.picker[ \"translate\" ] = setupGizmo( pickerTranslate ) );\n\tthis.add( this.picker[ \"rotate\" ] = setupGizmo( pickerRotate ) );\n\tthis.add( this.picker[ \"scale\" ] = setupGizmo( pickerScale ) );\n\tthis.add( this.helper[ \"translate\" ] = setupGizmo( helperTranslate ) );\n\tthis.add( this.helper[ \"rotate\" ] = setupGizmo( helperRotate ) );\n\tthis.add( this.helper[ \"scale\" ] = setupGizmo( helperScale ) );\n\n\t// Pickers should be hidden always\n\n\tthis.picker[ \"translate\" ].visible = false;\n\tthis.picker[ \"rotate\" ].visible = false;\n\tthis.picker[ \"scale\" ].visible = false;\n\n\t// updateMatrixWorld will update transformations and appearance of individual handles\n\n\tthis.updateMatrixWorld = function () {\n\n\t\tvar space = this.space;\n\n\t\tif ( this.mode === 'scale' ) space = 'local'; // scale always oriented to local rotation\n\n\t\tvar quaternion = space === \"local\" ? this.worldQuaternion : identityQuaternion;\n\n\t\t// Show only gizmos for current transform mode\n\n\t\tthis.gizmo[ \"translate\" ].visible = this.mode === \"translate\";\n\t\tthis.gizmo[ \"rotate\" ].visible = this.mode === \"rotate\";\n\t\tthis.gizmo[ \"scale\" ].visible = this.mode === \"scale\";\n\n\t\tthis.helper[ \"translate\" ].visible = this.mode === \"translate\";\n\t\tthis.helper[ \"rotate\" ].visible = this.mode === \"rotate\";\n\t\tthis.helper[ \"scale\" ].visible = this.mode === \"scale\";\n\n\n\t\tvar handles = [];\n\t\thandles = handles.concat( this.picker[ this.mode ].children );\n\t\thandles = handles.concat( this.gizmo[ this.mode ].children );\n\t\thandles = handles.concat( this.helper[ this.mode ].children );\n\n\t\tfor ( var i = 0; i < handles.length; i ++ ) {\n\n\t\t\tvar handle = handles[ i ];\n\n\t\t\t// hide aligned to camera\n\n\t\t\thandle.visible = true;\n\t\t\thandle.rotation.set( 0, 0, 0 );\n\t\t\thandle.position.copy( this.worldPosition );\n\n\t\t\tvar factor;\n\n\t\t\tif ( this.camera.isOrthographicCamera ) {\n\n\t\t\t\tfactor = ( this.camera.top - this.camera.bottom ) / this.camera.zoom;\n\n\t\t\t} else {\n\n\t\t\t\tfactor = this.worldPosition.distanceTo( this.cameraPosition ) * Math.min( 1.9 * Math.tan( Math.PI * this.camera.fov / 360 ) / this.camera.zoom, 7 );\n\n\t\t\t}\n\n\t\t\thandle.scale.set( 1, 1, 1 ).multiplyScalar( factor * this.size / 7 );\n\n\t\t\t// TODO: simplify helpers and consider decoupling from gizmo\n\n\t\t\tif ( handle.tag === 'helper' ) {\n\n\t\t\t\thandle.visible = false;\n\n\t\t\t\tif ( handle.name === 'AXIS' ) {\n\n\t\t\t\t\thandle.position.copy( this.worldPositionStart );\n\t\t\t\t\thandle.visible = !! this.axis;\n\n\t\t\t\t\tif ( this.axis === 'X' ) {\n\n\t\t\t\t\t\ttempQuaternion.setFromEuler( tempEuler.set( 0, 0, 0 ) );\n\t\t\t\t\t\thandle.quaternion.copy( quaternion ).multiply( tempQuaternion );\n\n\t\t\t\t\t\tif ( Math.abs( alignVector.copy( unitX ).applyQuaternion( quaternion ).dot( this.eye ) ) > 0.9 ) {\n\n\t\t\t\t\t\t\thandle.visible = false;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( this.axis === 'Y' ) {\n\n\t\t\t\t\t\ttempQuaternion.setFromEuler( tempEuler.set( 0, 0, Math.PI / 2 ) );\n\t\t\t\t\t\thandle.quaternion.copy( quaternion ).multiply( tempQuaternion );\n\n\t\t\t\t\t\tif ( Math.abs( alignVector.copy( unitY ).applyQuaternion( quaternion ).dot( this.eye ) ) > 0.9 ) {\n\n\t\t\t\t\t\t\thandle.visible = false;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( this.axis === 'Z' ) {\n\n\t\t\t\t\t\ttempQuaternion.setFromEuler( tempEuler.set( 0, Math.PI / 2, 0 ) );\n\t\t\t\t\t\thandle.quaternion.copy( quaternion ).multiply( tempQuaternion );\n\n\t\t\t\t\t\tif ( Math.abs( alignVector.copy( unitZ ).applyQuaternion( quaternion ).dot( this.eye ) ) > 0.9 ) {\n\n\t\t\t\t\t\t\thandle.visible = false;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( this.axis === 'XYZE' ) {\n\n\t\t\t\t\t\ttempQuaternion.setFromEuler( tempEuler.set( 0, Math.PI / 2, 0 ) );\n\t\t\t\t\t\talignVector.copy( this.rotationAxis );\n\t\t\t\t\t\thandle.quaternion.setFromRotationMatrix( lookAtMatrix.lookAt( zeroVector, alignVector, unitY ) );\n\t\t\t\t\t\thandle.quaternion.multiply( tempQuaternion );\n\t\t\t\t\t\thandle.visible = this.dragging;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( this.axis === 'E' ) {\n\n\t\t\t\t\t\thandle.visible = false;\n\n\t\t\t\t\t}\n\n\n\t\t\t\t} else if ( handle.name === 'START' ) {\n\n\t\t\t\t\thandle.position.copy( this.worldPositionStart );\n\t\t\t\t\thandle.visible = this.dragging;\n\n\t\t\t\t} else if ( handle.name === 'END' ) {\n\n\t\t\t\t\thandle.position.copy( this.worldPosition );\n\t\t\t\t\thandle.visible = this.dragging;\n\n\t\t\t\t} else if ( handle.name === 'DELTA' ) {\n\n\t\t\t\t\thandle.position.copy( this.worldPositionStart );\n\t\t\t\t\thandle.quaternion.copy( this.worldQuaternionStart );\n\t\t\t\t\ttempVector.set( 1e-10, 1e-10, 1e-10 ).add( this.worldPositionStart ).sub( this.worldPosition ).multiplyScalar( - 1 );\n\t\t\t\t\ttempVector.applyQuaternion( this.worldQuaternionStart.clone().inverse() );\n\t\t\t\t\thandle.scale.copy( tempVector );\n\t\t\t\t\thandle.visible = this.dragging;\n\n\t\t\t\t} else {\n\n\t\t\t\t\thandle.quaternion.copy( quaternion );\n\n\t\t\t\t\tif ( this.dragging ) {\n\n\t\t\t\t\t\thandle.position.copy( this.worldPositionStart );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\thandle.position.copy( this.worldPosition );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( this.axis ) {\n\n\t\t\t\t\t\thandle.visible = this.axis.search( handle.name ) !== - 1;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\t// If updating helper, skip rest of the loop\n\t\t\t\tcontinue;\n\n\t\t\t}\n\n\t\t\t// Align handles to current local or world rotation\n\n\t\t\thandle.quaternion.copy( quaternion );\n\n\t\t\tif ( this.mode === 'translate' || this.mode === 'scale' ) {\n\n\t\t\t\t// Hide translate and scale axis facing the camera\n\n\t\t\t\tvar AXIS_HIDE_TRESHOLD = 0.99;\n\t\t\t\tvar PLANE_HIDE_TRESHOLD = 0.2;\n\t\t\t\tvar AXIS_FLIP_TRESHOLD = 0.0;\n\n\n\t\t\t\tif ( handle.name === 'X' || handle.name === 'XYZX' ) {\n\n\t\t\t\t\tif ( Math.abs( alignVector.copy( unitX ).applyQuaternion( quaternion ).dot( this.eye ) ) > AXIS_HIDE_TRESHOLD ) {\n\n\t\t\t\t\t\thandle.scale.set( 1e-10, 1e-10, 1e-10 );\n\t\t\t\t\t\thandle.visible = false;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tif ( handle.name === 'Y' || handle.name === 'XYZY' ) {\n\n\t\t\t\t\tif ( Math.abs( alignVector.copy( unitY ).applyQuaternion( quaternion ).dot( this.eye ) ) > AXIS_HIDE_TRESHOLD ) {\n\n\t\t\t\t\t\thandle.scale.set( 1e-10, 1e-10, 1e-10 );\n\t\t\t\t\t\thandle.visible = false;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tif ( handle.name === 'Z' || handle.name === 'XYZZ' ) {\n\n\t\t\t\t\tif ( Math.abs( alignVector.copy( unitZ ).applyQuaternion( quaternion ).dot( this.eye ) ) > AXIS_HIDE_TRESHOLD ) {\n\n\t\t\t\t\t\thandle.scale.set( 1e-10, 1e-10, 1e-10 );\n\t\t\t\t\t\thandle.visible = false;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tif ( handle.name === 'XY' ) {\n\n\t\t\t\t\tif ( Math.abs( alignVector.copy( unitZ ).applyQuaternion( quaternion ).dot( this.eye ) ) < PLANE_HIDE_TRESHOLD ) {\n\n\t\t\t\t\t\thandle.scale.set( 1e-10, 1e-10, 1e-10 );\n\t\t\t\t\t\thandle.visible = false;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tif ( handle.name === 'YZ' ) {\n\n\t\t\t\t\tif ( Math.abs( alignVector.copy( unitX ).applyQuaternion( quaternion ).dot( this.eye ) ) < PLANE_HIDE_TRESHOLD ) {\n\n\t\t\t\t\t\thandle.scale.set( 1e-10, 1e-10, 1e-10 );\n\t\t\t\t\t\thandle.visible = false;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tif ( handle.name === 'XZ' ) {\n\n\t\t\t\t\tif ( Math.abs( alignVector.copy( unitY ).applyQuaternion( quaternion ).dot( this.eye ) ) < PLANE_HIDE_TRESHOLD ) {\n\n\t\t\t\t\t\thandle.scale.set( 1e-10, 1e-10, 1e-10 );\n\t\t\t\t\t\thandle.visible = false;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\t// Flip translate and scale axis ocluded behind another axis\n\n\t\t\t\tif ( handle.name.search( 'X' ) !== - 1 ) {\n\n\t\t\t\t\tif ( alignVector.copy( unitX ).applyQuaternion( quaternion ).dot( this.eye ) < AXIS_FLIP_TRESHOLD ) {\n\n\t\t\t\t\t\tif ( handle.tag === 'fwd' ) {\n\n\t\t\t\t\t\t\thandle.visible = false;\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\thandle.scale.x *= - 1;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else if ( handle.tag === 'bwd' ) {\n\n\t\t\t\t\t\thandle.visible = false;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tif ( handle.name.search( 'Y' ) !== - 1 ) {\n\n\t\t\t\t\tif ( alignVector.copy( unitY ).applyQuaternion( quaternion ).dot( this.eye ) < AXIS_FLIP_TRESHOLD ) {\n\n\t\t\t\t\t\tif ( handle.tag === 'fwd' ) {\n\n\t\t\t\t\t\t\thandle.visible = false;\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\thandle.scale.y *= - 1;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else if ( handle.tag === 'bwd' ) {\n\n\t\t\t\t\t\thandle.visible = false;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tif ( handle.name.search( 'Z' ) !== - 1 ) {\n\n\t\t\t\t\tif ( alignVector.copy( unitZ ).applyQuaternion( quaternion ).dot( this.eye ) < AXIS_FLIP_TRESHOLD ) {\n\n\t\t\t\t\t\tif ( handle.tag === 'fwd' ) {\n\n\t\t\t\t\t\t\thandle.visible = false;\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\thandle.scale.z *= - 1;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else if ( handle.tag === 'bwd' ) {\n\n\t\t\t\t\t\thandle.visible = false;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t} else if ( this.mode === 'rotate' ) {\n\n\t\t\t\t// Align handles to current local or world rotation\n\n\t\t\t\ttempQuaternion2.copy( quaternion );\n\t\t\t\talignVector.copy( this.eye ).applyQuaternion( tempQuaternion.copy( quaternion ).inverse() );\n\n\t\t\t\tif ( handle.name.search( \"E\" ) !== - 1 ) {\n\n\t\t\t\t\thandle.quaternion.setFromRotationMatrix( lookAtMatrix.lookAt( this.eye, zeroVector, unitY ) );\n\n\t\t\t\t}\n\n\t\t\t\tif ( handle.name === 'X' ) {\n\n\t\t\t\t\ttempQuaternion.setFromAxisAngle( unitX, Math.atan2( - alignVector.y, alignVector.z ) );\n\t\t\t\t\ttempQuaternion.multiplyQuaternions( tempQuaternion2, tempQuaternion );\n\t\t\t\t\thandle.quaternion.copy( tempQuaternion );\n\n\t\t\t\t}\n\n\t\t\t\tif ( handle.name === 'Y' ) {\n\n\t\t\t\t\ttempQuaternion.setFromAxisAngle( unitY, Math.atan2( alignVector.x, alignVector.z ) );\n\t\t\t\t\ttempQuaternion.multiplyQuaternions( tempQuaternion2, tempQuaternion );\n\t\t\t\t\thandle.quaternion.copy( tempQuaternion );\n\n\t\t\t\t}\n\n\t\t\t\tif ( handle.name === 'Z' ) {\n\n\t\t\t\t\ttempQuaternion.setFromAxisAngle( unitZ, Math.atan2( alignVector.y, alignVector.x ) );\n\t\t\t\t\ttempQuaternion.multiplyQuaternions( tempQuaternion2, tempQuaternion );\n\t\t\t\t\thandle.quaternion.copy( tempQuaternion );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// Hide disabled axes\n\t\t\thandle.visible = handle.visible && ( handle.name.indexOf( \"X\" ) === - 1 || this.showX );\n\t\t\thandle.visible = handle.visible && ( handle.name.indexOf( \"Y\" ) === - 1 || this.showY );\n\t\t\thandle.visible = handle.visible && ( handle.name.indexOf( \"Z\" ) === - 1 || this.showZ );\n\t\t\thandle.visible = handle.visible && ( handle.name.indexOf( \"E\" ) === - 1 || ( this.showX && this.showY && this.showZ ) );\n\n\t\t\t// highlight selected axis\n\n\t\t\thandle.material._opacity = handle.material._opacity || handle.material.opacity;\n\t\t\thandle.material._color = handle.material._color || handle.material.color.clone();\n\n\t\t\thandle.material.color.copy( handle.material._color );\n\t\t\thandle.material.opacity = handle.material._opacity;\n\n\t\t\tif ( ! this.enabled ) {\n\n\t\t\t\thandle.material.opacity *= 0.5;\n\t\t\t\thandle.material.color.lerp( new Color( 1, 1, 1 ), 0.5 );\n\n\t\t\t} else if ( this.axis ) {\n\n\t\t\t\tif ( handle.name === this.axis ) {\n\n\t\t\t\t\thandle.material.opacity = 1.0;\n\t\t\t\t\thandle.material.color.lerp( new Color( 1, 1, 1 ), 0.5 );\n\n\t\t\t\t} else if ( this.axis.split( '' ).some( function ( a ) {\n\n\t\t\t\t\treturn handle.name === a;\n\n\t\t\t\t} ) ) {\n\n\t\t\t\t\thandle.material.opacity = 1.0;\n\t\t\t\t\thandle.material.color.lerp( new Color( 1, 1, 1 ), 0.5 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\thandle.material.opacity *= 0.25;\n\t\t\t\t\thandle.material.color.lerp( new Color( 1, 1, 1 ), 0.5 );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tObject3D.prototype.updateMatrixWorld.call( this );\n\n\t};\n\n};\n\nTransformControlsGizmo.prototype = Object.assign( Object.create( Object3D.prototype ), {\n\n\tconstructor: TransformControlsGizmo,\n\n\tisTransformControlsGizmo: true\n\n} );\n\n\nvar TransformControlsPlane = function () {\n\n\t'use strict';\n\n\tMesh.call( this,\n\t\tnew PlaneBufferGeometry( 100000, 100000, 2, 2 ),\n\t\tnew MeshBasicMaterial( { visible: false, wireframe: true, side: DoubleSide, transparent: true, opacity: 0.1 } )\n\t);\n\n\tthis.type = 'TransformControlsPlane';\n\n\tvar unitX = new Vector3( 1, 0, 0 );\n\tvar unitY = new Vector3( 0, 1, 0 );\n\tvar unitZ = new Vector3( 0, 0, 1 );\n\n\tvar tempVector = new Vector3();\n\tvar dirVector = new Vector3();\n\tvar alignVector = new Vector3();\n\tvar tempMatrix = new Matrix4();\n\tvar identityQuaternion = new Quaternion();\n\n\tthis.updateMatrixWorld = function () {\n\n\t\tvar space = this.space;\n\n\t\tthis.position.copy( this.worldPosition );\n\n\t\tif ( this.mode === 'scale' ) space = 'local'; // scale always oriented to local rotation\n\n\t\tunitX.set( 1, 0, 0 ).applyQuaternion( space === \"local\" ? this.worldQuaternion : identityQuaternion );\n\t\tunitY.set( 0, 1, 0 ).applyQuaternion( space === \"local\" ? this.worldQuaternion : identityQuaternion );\n\t\tunitZ.set( 0, 0, 1 ).applyQuaternion( space === \"local\" ? this.worldQuaternion : identityQuaternion );\n\n\t\t// Align the plane for current transform mode, axis and space.\n\n\t\talignVector.copy( unitY );\n\n\t\tswitch ( this.mode ) {\n\n\t\t\tcase 'translate':\n\t\t\tcase 'scale':\n\t\t\t\tswitch ( this.axis ) {\n\n\t\t\t\t\tcase 'X':\n\t\t\t\t\t\talignVector.copy( this.eye ).cross( unitX );\n\t\t\t\t\t\tdirVector.copy( unitX ).cross( alignVector );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'Y':\n\t\t\t\t\t\talignVector.copy( this.eye ).cross( unitY );\n\t\t\t\t\t\tdirVector.copy( unitY ).cross( alignVector );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'Z':\n\t\t\t\t\t\talignVector.copy( this.eye ).cross( unitZ );\n\t\t\t\t\t\tdirVector.copy( unitZ ).cross( alignVector );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'XY':\n\t\t\t\t\t\tdirVector.copy( unitZ );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'YZ':\n\t\t\t\t\t\tdirVector.copy( unitX );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'XZ':\n\t\t\t\t\t\talignVector.copy( unitZ );\n\t\t\t\t\t\tdirVector.copy( unitY );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'XYZ':\n\t\t\t\t\tcase 'E':\n\t\t\t\t\t\tdirVector.set( 0, 0, 0 );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\t\t\tcase 'rotate':\n\t\t\tdefault:\n\t\t\t\t// special case for rotate\n\t\t\t\tdirVector.set( 0, 0, 0 );\n\n\t\t}\n\n\t\tif ( dirVector.length() === 0 ) {\n\n\t\t\t// If in rotate mode, make the plane parallel to camera\n\t\t\tthis.quaternion.copy( this.cameraQuaternion );\n\n\t\t} else {\n\n\t\t\ttempMatrix.lookAt( tempVector.set( 0, 0, 0 ), dirVector, alignVector );\n\n\t\t\tthis.quaternion.setFromRotationMatrix( tempMatrix );\n\n\t\t}\n\n\t\tObject3D.prototype.updateMatrixWorld.call( this );\n\n\t};\n\n};\n\nTransformControlsPlane.prototype = Object.assign( Object.create( Mesh.prototype ), {\n\n\tconstructor: TransformControlsPlane,\n\n\tisTransformControlsPlane: true\n\n} );\n\nexport { TransformControls, TransformControlsGizmo, TransformControlsPlane };\n","/**\n * lodash (Custom Build) <https://lodash.com/>\n * Build: `lodash modularize exports=\"npm\" -o ./`\n * Copyright jQuery Foundation and other contributors <https://jquery.org/>\n * Released under MIT license <https://lodash.com/license>\n * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n */\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0,\n    MAX_SAFE_INTEGER = 9007199254740991;\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]',\n    funcTag = '[object Function]',\n    genTag = '[object GeneratorFunction]',\n    symbolTag = '[object Symbol]';\n\n/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\n/**\n * A faster alternative to `Function#apply`, this function invokes `func`\n * with the `this` binding of `thisArg` and the arguments of `args`.\n *\n * @private\n * @param {Function} func The function to invoke.\n * @param {*} thisArg The `this` binding of `func`.\n * @param {Array} args The arguments to invoke `func` with.\n * @returns {*} Returns the result of `func`.\n */\nfunction apply(func, thisArg, args) {\n  switch (args.length) {\n    case 0: return func.call(thisArg);\n    case 1: return func.call(thisArg, args[0]);\n    case 2: return func.call(thisArg, args[0], args[1]);\n    case 3: return func.call(thisArg, args[0], args[1], args[2]);\n  }\n  return func.apply(thisArg, args);\n}\n\n/**\n * A specialized version of `_.map` for arrays without support for iteratee\n * shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the new mapped array.\n */\nfunction arrayMap(array, iteratee) {\n  var index = -1,\n      length = array ? array.length : 0,\n      result = Array(length);\n\n  while (++index < length) {\n    result[index] = iteratee(array[index], index, array);\n  }\n  return result;\n}\n\n/**\n * Appends the elements of `values` to `array`.\n *\n * @private\n * @param {Array} array The array to modify.\n * @param {Array} values The values to append.\n * @returns {Array} Returns `array`.\n */\nfunction arrayPush(array, values) {\n  var index = -1,\n      length = values.length,\n      offset = array.length;\n\n  while (++index < length) {\n    array[offset + index] = values[index];\n  }\n  return array;\n}\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar objectToString = objectProto.toString;\n\n/** Built-in value references. */\nvar Symbol = root.Symbol,\n    propertyIsEnumerable = objectProto.propertyIsEnumerable,\n    spreadableSymbol = Symbol ? Symbol.isConcatSpreadable : undefined;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max;\n\n/**\n * The base implementation of `_.flatten` with support for restricting flattening.\n *\n * @private\n * @param {Array} array The array to flatten.\n * @param {number} depth The maximum recursion depth.\n * @param {boolean} [predicate=isFlattenable] The function invoked per iteration.\n * @param {boolean} [isStrict] Restrict to values that pass `predicate` checks.\n * @param {Array} [result=[]] The initial result value.\n * @returns {Array} Returns the new flattened array.\n */\nfunction baseFlatten(array, depth, predicate, isStrict, result) {\n  var index = -1,\n      length = array.length;\n\n  predicate || (predicate = isFlattenable);\n  result || (result = []);\n\n  while (++index < length) {\n    var value = array[index];\n    if (depth > 0 && predicate(value)) {\n      if (depth > 1) {\n        // Recursively flatten arrays (susceptible to call stack limits).\n        baseFlatten(value, depth - 1, predicate, isStrict, result);\n      } else {\n        arrayPush(result, value);\n      }\n    } else if (!isStrict) {\n      result[result.length] = value;\n    }\n  }\n  return result;\n}\n\n/**\n * The base implementation of `_.pick` without support for individual\n * property identifiers.\n *\n * @private\n * @param {Object} object The source object.\n * @param {string[]} props The property identifiers to pick.\n * @returns {Object} Returns the new object.\n */\nfunction basePick(object, props) {\n  object = Object(object);\n  return basePickBy(object, props, function(value, key) {\n    return key in object;\n  });\n}\n\n/**\n * The base implementation of  `_.pickBy` without support for iteratee shorthands.\n *\n * @private\n * @param {Object} object The source object.\n * @param {string[]} props The property identifiers to pick from.\n * @param {Function} predicate The function invoked per property.\n * @returns {Object} Returns the new object.\n */\nfunction basePickBy(object, props, predicate) {\n  var index = -1,\n      length = props.length,\n      result = {};\n\n  while (++index < length) {\n    var key = props[index],\n        value = object[key];\n\n    if (predicate(value, key)) {\n      result[key] = value;\n    }\n  }\n  return result;\n}\n\n/**\n * The base implementation of `_.rest` which doesn't validate or coerce arguments.\n *\n * @private\n * @param {Function} func The function to apply a rest parameter to.\n * @param {number} [start=func.length-1] The start position of the rest parameter.\n * @returns {Function} Returns the new function.\n */\nfunction baseRest(func, start) {\n  start = nativeMax(start === undefined ? (func.length - 1) : start, 0);\n  return function() {\n    var args = arguments,\n        index = -1,\n        length = nativeMax(args.length - start, 0),\n        array = Array(length);\n\n    while (++index < length) {\n      array[index] = args[start + index];\n    }\n    index = -1;\n    var otherArgs = Array(start + 1);\n    while (++index < start) {\n      otherArgs[index] = args[index];\n    }\n    otherArgs[start] = array;\n    return apply(func, this, otherArgs);\n  };\n}\n\n/**\n * Checks if `value` is a flattenable `arguments` object or array.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is flattenable, else `false`.\n */\nfunction isFlattenable(value) {\n  return isArray(value) || isArguments(value) ||\n    !!(spreadableSymbol && value && value[spreadableSymbol]);\n}\n\n/**\n * Converts `value` to a string key if it's not a string or symbol.\n *\n * @private\n * @param {*} value The value to inspect.\n * @returns {string|symbol} Returns the key.\n */\nfunction toKey(value) {\n  if (typeof value == 'string' || isSymbol(value)) {\n    return value;\n  }\n  var result = (value + '');\n  return (result == '0' && (1 / value) == -INFINITY) ? '-0' : result;\n}\n\n/**\n * Checks if `value` is likely an `arguments` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n *  else `false`.\n * @example\n *\n * _.isArguments(function() { return arguments; }());\n * // => true\n *\n * _.isArguments([1, 2, 3]);\n * // => false\n */\nfunction isArguments(value) {\n  // Safari 8.1 makes `arguments.callee` enumerable in strict mode.\n  return isArrayLikeObject(value) && hasOwnProperty.call(value, 'callee') &&\n    (!propertyIsEnumerable.call(value, 'callee') || objectToString.call(value) == argsTag);\n}\n\n/**\n * Checks if `value` is classified as an `Array` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array, else `false`.\n * @example\n *\n * _.isArray([1, 2, 3]);\n * // => true\n *\n * _.isArray(document.body.children);\n * // => false\n *\n * _.isArray('abc');\n * // => false\n *\n * _.isArray(_.noop);\n * // => false\n */\nvar isArray = Array.isArray;\n\n/**\n * Checks if `value` is array-like. A value is considered array-like if it's\n * not a function and has a `value.length` that's an integer greater than or\n * equal to `0` and less than or equal to `Number.MAX_SAFE_INTEGER`.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is array-like, else `false`.\n * @example\n *\n * _.isArrayLike([1, 2, 3]);\n * // => true\n *\n * _.isArrayLike(document.body.children);\n * // => true\n *\n * _.isArrayLike('abc');\n * // => true\n *\n * _.isArrayLike(_.noop);\n * // => false\n */\nfunction isArrayLike(value) {\n  return value != null && isLength(value.length) && !isFunction(value);\n}\n\n/**\n * This method is like `_.isArrayLike` except that it also checks if `value`\n * is an object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array-like object,\n *  else `false`.\n * @example\n *\n * _.isArrayLikeObject([1, 2, 3]);\n * // => true\n *\n * _.isArrayLikeObject(document.body.children);\n * // => true\n *\n * _.isArrayLikeObject('abc');\n * // => false\n *\n * _.isArrayLikeObject(_.noop);\n * // => false\n */\nfunction isArrayLikeObject(value) {\n  return isObjectLike(value) && isArrayLike(value);\n}\n\n/**\n * Checks if `value` is classified as a `Function` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a function, else `false`.\n * @example\n *\n * _.isFunction(_);\n * // => true\n *\n * _.isFunction(/abc/);\n * // => false\n */\nfunction isFunction(value) {\n  // The use of `Object#toString` avoids issues with the `typeof` operator\n  // in Safari 8-9 which returns 'object' for typed array and other constructors.\n  var tag = isObject(value) ? objectToString.call(value) : '';\n  return tag == funcTag || tag == genTag;\n}\n\n/**\n * Checks if `value` is a valid array-like length.\n *\n * **Note:** This method is loosely based on\n * [`ToLength`](http://ecma-international.org/ecma-262/7.0/#sec-tolength).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a valid length, else `false`.\n * @example\n *\n * _.isLength(3);\n * // => true\n *\n * _.isLength(Number.MIN_VALUE);\n * // => false\n *\n * _.isLength(Infinity);\n * // => false\n *\n * _.isLength('3');\n * // => false\n */\nfunction isLength(value) {\n  return typeof value == 'number' &&\n    value > -1 && value % 1 == 0 && value <= MAX_SAFE_INTEGER;\n}\n\n/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return !!value && (type == 'object' || type == 'function');\n}\n\n/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return !!value && typeof value == 'object';\n}\n\n/**\n * Checks if `value` is classified as a `Symbol` primitive or object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n * @example\n *\n * _.isSymbol(Symbol.iterator);\n * // => true\n *\n * _.isSymbol('abc');\n * // => false\n */\nfunction isSymbol(value) {\n  return typeof value == 'symbol' ||\n    (isObjectLike(value) && objectToString.call(value) == symbolTag);\n}\n\n/**\n * Creates an object composed of the picked `object` properties.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Object\n * @param {Object} object The source object.\n * @param {...(string|string[])} [props] The property identifiers to pick.\n * @returns {Object} Returns the new object.\n * @example\n *\n * var object = { 'a': 1, 'b': '2', 'c': 3 };\n *\n * _.pick(object, ['a', 'c']);\n * // => { 'a': 1, 'c': 3 }\n */\nvar pick = baseRest(function(object, props) {\n  return object == null ? {} : basePick(object, arrayMap(baseFlatten(props, 1), toKey));\n});\n\nmodule.exports = pick;\n","/**\n * lodash (Custom Build) <https://lodash.com/>\n * Build: `lodash modularize exports=\"npm\" -o ./`\n * Copyright jQuery Foundation and other contributors <https://jquery.org/>\n * Released under MIT license <https://lodash.com/license>\n * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n */\n\n/** Used as the size to enable large array optimizations. */\nvar LARGE_ARRAY_SIZE = 200;\n\n/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0,\n    MAX_SAFE_INTEGER = 9007199254740991;\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]',\n    funcTag = '[object Function]',\n    genTag = '[object GeneratorFunction]',\n    symbolTag = '[object Symbol]';\n\n/**\n * Used to match `RegExp`\n * [syntax characters](http://ecma-international.org/ecma-262/7.0/#sec-patterns).\n */\nvar reRegExpChar = /[\\\\^$.*+?()[\\]{}|]/g;\n\n/** Used to detect host constructors (Safari). */\nvar reIsHostCtor = /^\\[object .+?Constructor\\]$/;\n\n/** Used to detect unsigned integer values. */\nvar reIsUint = /^(?:0|[1-9]\\d*)$/;\n\n/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\n/**\n * A faster alternative to `Function#apply`, this function invokes `func`\n * with the `this` binding of `thisArg` and the arguments of `args`.\n *\n * @private\n * @param {Function} func The function to invoke.\n * @param {*} thisArg The `this` binding of `func`.\n * @param {Array} args The arguments to invoke `func` with.\n * @returns {*} Returns the result of `func`.\n */\nfunction apply(func, thisArg, args) {\n  switch (args.length) {\n    case 0: return func.call(thisArg);\n    case 1: return func.call(thisArg, args[0]);\n    case 2: return func.call(thisArg, args[0], args[1]);\n    case 3: return func.call(thisArg, args[0], args[1], args[2]);\n  }\n  return func.apply(thisArg, args);\n}\n\n/**\n * A specialized version of `_.includes` for arrays without support for\n * specifying an index to search from.\n *\n * @private\n * @param {Array} [array] The array to inspect.\n * @param {*} target The value to search for.\n * @returns {boolean} Returns `true` if `target` is found, else `false`.\n */\nfunction arrayIncludes(array, value) {\n  var length = array ? array.length : 0;\n  return !!length && baseIndexOf(array, value, 0) > -1;\n}\n\n/**\n * This function is like `arrayIncludes` except that it accepts a comparator.\n *\n * @private\n * @param {Array} [array] The array to inspect.\n * @param {*} target The value to search for.\n * @param {Function} comparator The comparator invoked per element.\n * @returns {boolean} Returns `true` if `target` is found, else `false`.\n */\nfunction arrayIncludesWith(array, value, comparator) {\n  var index = -1,\n      length = array ? array.length : 0;\n\n  while (++index < length) {\n    if (comparator(value, array[index])) {\n      return true;\n    }\n  }\n  return false;\n}\n\n/**\n * A specialized version of `_.map` for arrays without support for iteratee\n * shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the new mapped array.\n */\nfunction arrayMap(array, iteratee) {\n  var index = -1,\n      length = array ? array.length : 0,\n      result = Array(length);\n\n  while (++index < length) {\n    result[index] = iteratee(array[index], index, array);\n  }\n  return result;\n}\n\n/**\n * Appends the elements of `values` to `array`.\n *\n * @private\n * @param {Array} array The array to modify.\n * @param {Array} values The values to append.\n * @returns {Array} Returns `array`.\n */\nfunction arrayPush(array, values) {\n  var index = -1,\n      length = values.length,\n      offset = array.length;\n\n  while (++index < length) {\n    array[offset + index] = values[index];\n  }\n  return array;\n}\n\n/**\n * The base implementation of `_.findIndex` and `_.findLastIndex` without\n * support for iteratee shorthands.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {Function} predicate The function invoked per iteration.\n * @param {number} fromIndex The index to search from.\n * @param {boolean} [fromRight] Specify iterating from right to left.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction baseFindIndex(array, predicate, fromIndex, fromRight) {\n  var length = array.length,\n      index = fromIndex + (fromRight ? 1 : -1);\n\n  while ((fromRight ? index-- : ++index < length)) {\n    if (predicate(array[index], index, array)) {\n      return index;\n    }\n  }\n  return -1;\n}\n\n/**\n * The base implementation of `_.indexOf` without `fromIndex` bounds checks.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} value The value to search for.\n * @param {number} fromIndex The index to search from.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction baseIndexOf(array, value, fromIndex) {\n  if (value !== value) {\n    return baseFindIndex(array, baseIsNaN, fromIndex);\n  }\n  var index = fromIndex - 1,\n      length = array.length;\n\n  while (++index < length) {\n    if (array[index] === value) {\n      return index;\n    }\n  }\n  return -1;\n}\n\n/**\n * The base implementation of `_.isNaN` without support for number objects.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is `NaN`, else `false`.\n */\nfunction baseIsNaN(value) {\n  return value !== value;\n}\n\n/**\n * The base implementation of `_.times` without support for iteratee shorthands\n * or max array length checks.\n *\n * @private\n * @param {number} n The number of times to invoke `iteratee`.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the array of results.\n */\nfunction baseTimes(n, iteratee) {\n  var index = -1,\n      result = Array(n);\n\n  while (++index < n) {\n    result[index] = iteratee(index);\n  }\n  return result;\n}\n\n/**\n * The base implementation of `_.unary` without support for storing metadata.\n *\n * @private\n * @param {Function} func The function to cap arguments for.\n * @returns {Function} Returns the new capped function.\n */\nfunction baseUnary(func) {\n  return function(value) {\n    return func(value);\n  };\n}\n\n/**\n * Checks if a cache value for `key` exists.\n *\n * @private\n * @param {Object} cache The cache to query.\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction cacheHas(cache, key) {\n  return cache.has(key);\n}\n\n/**\n * Gets the value at `key` of `object`.\n *\n * @private\n * @param {Object} [object] The object to query.\n * @param {string} key The key of the property to get.\n * @returns {*} Returns the property value.\n */\nfunction getValue(object, key) {\n  return object == null ? undefined : object[key];\n}\n\n/**\n * Checks if `value` is a host object in IE < 9.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a host object, else `false`.\n */\nfunction isHostObject(value) {\n  // Many host objects are `Object` objects that can coerce to strings\n  // despite having improperly defined `toString` methods.\n  var result = false;\n  if (value != null && typeof value.toString != 'function') {\n    try {\n      result = !!(value + '');\n    } catch (e) {}\n  }\n  return result;\n}\n\n/**\n * Creates a unary function that invokes `func` with its argument transformed.\n *\n * @private\n * @param {Function} func The function to wrap.\n * @param {Function} transform The argument transform.\n * @returns {Function} Returns the new function.\n */\nfunction overArg(func, transform) {\n  return function(arg) {\n    return func(transform(arg));\n  };\n}\n\n/** Used for built-in method references. */\nvar arrayProto = Array.prototype,\n    funcProto = Function.prototype,\n    objectProto = Object.prototype;\n\n/** Used to detect overreaching core-js shims. */\nvar coreJsData = root['__core-js_shared__'];\n\n/** Used to detect methods masquerading as native. */\nvar maskSrcKey = (function() {\n  var uid = /[^.]+$/.exec(coreJsData && coreJsData.keys && coreJsData.keys.IE_PROTO || '');\n  return uid ? ('Symbol(src)_1.' + uid) : '';\n}());\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar objectToString = objectProto.toString;\n\n/** Used to detect if a method is native. */\nvar reIsNative = RegExp('^' +\n  funcToString.call(hasOwnProperty).replace(reRegExpChar, '\\\\$&')\n  .replace(/hasOwnProperty|(function).*?(?=\\\\\\()| for .+?(?=\\\\\\])/g, '$1.*?') + '$'\n);\n\n/** Built-in value references. */\nvar Symbol = root.Symbol,\n    getPrototype = overArg(Object.getPrototypeOf, Object),\n    propertyIsEnumerable = objectProto.propertyIsEnumerable,\n    splice = arrayProto.splice,\n    spreadableSymbol = Symbol ? Symbol.isConcatSpreadable : undefined;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeGetSymbols = Object.getOwnPropertySymbols,\n    nativeMax = Math.max;\n\n/* Built-in method references that are verified to be native. */\nvar Map = getNative(root, 'Map'),\n    nativeCreate = getNative(Object, 'create');\n\n/**\n * Creates a hash object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction Hash(entries) {\n  var index = -1,\n      length = entries ? entries.length : 0;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n/**\n * Removes all key-value entries from the hash.\n *\n * @private\n * @name clear\n * @memberOf Hash\n */\nfunction hashClear() {\n  this.__data__ = nativeCreate ? nativeCreate(null) : {};\n}\n\n/**\n * Removes `key` and its value from the hash.\n *\n * @private\n * @name delete\n * @memberOf Hash\n * @param {Object} hash The hash to modify.\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction hashDelete(key) {\n  return this.has(key) && delete this.__data__[key];\n}\n\n/**\n * Gets the hash value for `key`.\n *\n * @private\n * @name get\n * @memberOf Hash\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction hashGet(key) {\n  var data = this.__data__;\n  if (nativeCreate) {\n    var result = data[key];\n    return result === HASH_UNDEFINED ? undefined : result;\n  }\n  return hasOwnProperty.call(data, key) ? data[key] : undefined;\n}\n\n/**\n * Checks if a hash value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf Hash\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction hashHas(key) {\n  var data = this.__data__;\n  return nativeCreate ? data[key] !== undefined : hasOwnProperty.call(data, key);\n}\n\n/**\n * Sets the hash `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf Hash\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the hash instance.\n */\nfunction hashSet(key, value) {\n  var data = this.__data__;\n  data[key] = (nativeCreate && value === undefined) ? HASH_UNDEFINED : value;\n  return this;\n}\n\n// Add methods to `Hash`.\nHash.prototype.clear = hashClear;\nHash.prototype['delete'] = hashDelete;\nHash.prototype.get = hashGet;\nHash.prototype.has = hashHas;\nHash.prototype.set = hashSet;\n\n/**\n * Creates an list cache object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction ListCache(entries) {\n  var index = -1,\n      length = entries ? entries.length : 0;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n/**\n * Removes all key-value entries from the list cache.\n *\n * @private\n * @name clear\n * @memberOf ListCache\n */\nfunction listCacheClear() {\n  this.__data__ = [];\n}\n\n/**\n * Removes `key` and its value from the list cache.\n *\n * @private\n * @name delete\n * @memberOf ListCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction listCacheDelete(key) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  if (index < 0) {\n    return false;\n  }\n  var lastIndex = data.length - 1;\n  if (index == lastIndex) {\n    data.pop();\n  } else {\n    splice.call(data, index, 1);\n  }\n  return true;\n}\n\n/**\n * Gets the list cache value for `key`.\n *\n * @private\n * @name get\n * @memberOf ListCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction listCacheGet(key) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  return index < 0 ? undefined : data[index][1];\n}\n\n/**\n * Checks if a list cache value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf ListCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction listCacheHas(key) {\n  return assocIndexOf(this.__data__, key) > -1;\n}\n\n/**\n * Sets the list cache `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf ListCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the list cache instance.\n */\nfunction listCacheSet(key, value) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  if (index < 0) {\n    data.push([key, value]);\n  } else {\n    data[index][1] = value;\n  }\n  return this;\n}\n\n// Add methods to `ListCache`.\nListCache.prototype.clear = listCacheClear;\nListCache.prototype['delete'] = listCacheDelete;\nListCache.prototype.get = listCacheGet;\nListCache.prototype.has = listCacheHas;\nListCache.prototype.set = listCacheSet;\n\n/**\n * Creates a map cache object to store key-value pairs.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction MapCache(entries) {\n  var index = -1,\n      length = entries ? entries.length : 0;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n/**\n * Removes all key-value entries from the map.\n *\n * @private\n * @name clear\n * @memberOf MapCache\n */\nfunction mapCacheClear() {\n  this.__data__ = {\n    'hash': new Hash,\n    'map': new (Map || ListCache),\n    'string': new Hash\n  };\n}\n\n/**\n * Removes `key` and its value from the map.\n *\n * @private\n * @name delete\n * @memberOf MapCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction mapCacheDelete(key) {\n  return getMapData(this, key)['delete'](key);\n}\n\n/**\n * Gets the map value for `key`.\n *\n * @private\n * @name get\n * @memberOf MapCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction mapCacheGet(key) {\n  return getMapData(this, key).get(key);\n}\n\n/**\n * Checks if a map value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf MapCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction mapCacheHas(key) {\n  return getMapData(this, key).has(key);\n}\n\n/**\n * Sets the map `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf MapCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the map cache instance.\n */\nfunction mapCacheSet(key, value) {\n  getMapData(this, key).set(key, value);\n  return this;\n}\n\n// Add methods to `MapCache`.\nMapCache.prototype.clear = mapCacheClear;\nMapCache.prototype['delete'] = mapCacheDelete;\nMapCache.prototype.get = mapCacheGet;\nMapCache.prototype.has = mapCacheHas;\nMapCache.prototype.set = mapCacheSet;\n\n/**\n *\n * Creates an array cache object to store unique values.\n *\n * @private\n * @constructor\n * @param {Array} [values] The values to cache.\n */\nfunction SetCache(values) {\n  var index = -1,\n      length = values ? values.length : 0;\n\n  this.__data__ = new MapCache;\n  while (++index < length) {\n    this.add(values[index]);\n  }\n}\n\n/**\n * Adds `value` to the array cache.\n *\n * @private\n * @name add\n * @memberOf SetCache\n * @alias push\n * @param {*} value The value to cache.\n * @returns {Object} Returns the cache instance.\n */\nfunction setCacheAdd(value) {\n  this.__data__.set(value, HASH_UNDEFINED);\n  return this;\n}\n\n/**\n * Checks if `value` is in the array cache.\n *\n * @private\n * @name has\n * @memberOf SetCache\n * @param {*} value The value to search for.\n * @returns {number} Returns `true` if `value` is found, else `false`.\n */\nfunction setCacheHas(value) {\n  return this.__data__.has(value);\n}\n\n// Add methods to `SetCache`.\nSetCache.prototype.add = SetCache.prototype.push = setCacheAdd;\nSetCache.prototype.has = setCacheHas;\n\n/**\n * Creates an array of the enumerable property names of the array-like `value`.\n *\n * @private\n * @param {*} value The value to query.\n * @param {boolean} inherited Specify returning inherited property names.\n * @returns {Array} Returns the array of property names.\n */\nfunction arrayLikeKeys(value, inherited) {\n  // Safari 8.1 makes `arguments.callee` enumerable in strict mode.\n  // Safari 9 makes `arguments.length` enumerable in strict mode.\n  var result = (isArray(value) || isArguments(value))\n    ? baseTimes(value.length, String)\n    : [];\n\n  var length = result.length,\n      skipIndexes = !!length;\n\n  for (var key in value) {\n    if ((inherited || hasOwnProperty.call(value, key)) &&\n        !(skipIndexes && (key == 'length' || isIndex(key, length)))) {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\n/**\n * Gets the index at which the `key` is found in `array` of key-value pairs.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} key The key to search for.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction assocIndexOf(array, key) {\n  var length = array.length;\n  while (length--) {\n    if (eq(array[length][0], key)) {\n      return length;\n    }\n  }\n  return -1;\n}\n\n/**\n * The base implementation of methods like `_.difference` without support\n * for excluding multiple arrays or iteratee shorthands.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {Array} values The values to exclude.\n * @param {Function} [iteratee] The iteratee invoked per element.\n * @param {Function} [comparator] The comparator invoked per element.\n * @returns {Array} Returns the new array of filtered values.\n */\nfunction baseDifference(array, values, iteratee, comparator) {\n  var index = -1,\n      includes = arrayIncludes,\n      isCommon = true,\n      length = array.length,\n      result = [],\n      valuesLength = values.length;\n\n  if (!length) {\n    return result;\n  }\n  if (iteratee) {\n    values = arrayMap(values, baseUnary(iteratee));\n  }\n  if (comparator) {\n    includes = arrayIncludesWith;\n    isCommon = false;\n  }\n  else if (values.length >= LARGE_ARRAY_SIZE) {\n    includes = cacheHas;\n    isCommon = false;\n    values = new SetCache(values);\n  }\n  outer:\n  while (++index < length) {\n    var value = array[index],\n        computed = iteratee ? iteratee(value) : value;\n\n    value = (comparator || value !== 0) ? value : 0;\n    if (isCommon && computed === computed) {\n      var valuesIndex = valuesLength;\n      while (valuesIndex--) {\n        if (values[valuesIndex] === computed) {\n          continue outer;\n        }\n      }\n      result.push(value);\n    }\n    else if (!includes(values, computed, comparator)) {\n      result.push(value);\n    }\n  }\n  return result;\n}\n\n/**\n * The base implementation of `_.flatten` with support for restricting flattening.\n *\n * @private\n * @param {Array} array The array to flatten.\n * @param {number} depth The maximum recursion depth.\n * @param {boolean} [predicate=isFlattenable] The function invoked per iteration.\n * @param {boolean} [isStrict] Restrict to values that pass `predicate` checks.\n * @param {Array} [result=[]] The initial result value.\n * @returns {Array} Returns the new flattened array.\n */\nfunction baseFlatten(array, depth, predicate, isStrict, result) {\n  var index = -1,\n      length = array.length;\n\n  predicate || (predicate = isFlattenable);\n  result || (result = []);\n\n  while (++index < length) {\n    var value = array[index];\n    if (depth > 0 && predicate(value)) {\n      if (depth > 1) {\n        // Recursively flatten arrays (susceptible to call stack limits).\n        baseFlatten(value, depth - 1, predicate, isStrict, result);\n      } else {\n        arrayPush(result, value);\n      }\n    } else if (!isStrict) {\n      result[result.length] = value;\n    }\n  }\n  return result;\n}\n\n/**\n * The base implementation of `getAllKeys` and `getAllKeysIn` which uses\n * `keysFunc` and `symbolsFunc` to get the enumerable property names and\n * symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {Function} keysFunc The function to get the keys of `object`.\n * @param {Function} symbolsFunc The function to get the symbols of `object`.\n * @returns {Array} Returns the array of property names and symbols.\n */\nfunction baseGetAllKeys(object, keysFunc, symbolsFunc) {\n  var result = keysFunc(object);\n  return isArray(object) ? result : arrayPush(result, symbolsFunc(object));\n}\n\n/**\n * The base implementation of `_.isNative` without bad shim checks.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a native function,\n *  else `false`.\n */\nfunction baseIsNative(value) {\n  if (!isObject(value) || isMasked(value)) {\n    return false;\n  }\n  var pattern = (isFunction(value) || isHostObject(value)) ? reIsNative : reIsHostCtor;\n  return pattern.test(toSource(value));\n}\n\n/**\n * The base implementation of `_.keysIn` which doesn't treat sparse arrays as dense.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n */\nfunction baseKeysIn(object) {\n  if (!isObject(object)) {\n    return nativeKeysIn(object);\n  }\n  var isProto = isPrototype(object),\n      result = [];\n\n  for (var key in object) {\n    if (!(key == 'constructor' && (isProto || !hasOwnProperty.call(object, key)))) {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\n/**\n * The base implementation of `_.pick` without support for individual\n * property identifiers.\n *\n * @private\n * @param {Object} object The source object.\n * @param {string[]} props The property identifiers to pick.\n * @returns {Object} Returns the new object.\n */\nfunction basePick(object, props) {\n  object = Object(object);\n  return basePickBy(object, props, function(value, key) {\n    return key in object;\n  });\n}\n\n/**\n * The base implementation of  `_.pickBy` without support for iteratee shorthands.\n *\n * @private\n * @param {Object} object The source object.\n * @param {string[]} props The property identifiers to pick from.\n * @param {Function} predicate The function invoked per property.\n * @returns {Object} Returns the new object.\n */\nfunction basePickBy(object, props, predicate) {\n  var index = -1,\n      length = props.length,\n      result = {};\n\n  while (++index < length) {\n    var key = props[index],\n        value = object[key];\n\n    if (predicate(value, key)) {\n      result[key] = value;\n    }\n  }\n  return result;\n}\n\n/**\n * The base implementation of `_.rest` which doesn't validate or coerce arguments.\n *\n * @private\n * @param {Function} func The function to apply a rest parameter to.\n * @param {number} [start=func.length-1] The start position of the rest parameter.\n * @returns {Function} Returns the new function.\n */\nfunction baseRest(func, start) {\n  start = nativeMax(start === undefined ? (func.length - 1) : start, 0);\n  return function() {\n    var args = arguments,\n        index = -1,\n        length = nativeMax(args.length - start, 0),\n        array = Array(length);\n\n    while (++index < length) {\n      array[index] = args[start + index];\n    }\n    index = -1;\n    var otherArgs = Array(start + 1);\n    while (++index < start) {\n      otherArgs[index] = args[index];\n    }\n    otherArgs[start] = array;\n    return apply(func, this, otherArgs);\n  };\n}\n\n/**\n * Creates an array of own and inherited enumerable property names and\n * symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names and symbols.\n */\nfunction getAllKeysIn(object) {\n  return baseGetAllKeys(object, keysIn, getSymbolsIn);\n}\n\n/**\n * Gets the data for `map`.\n *\n * @private\n * @param {Object} map The map to query.\n * @param {string} key The reference key.\n * @returns {*} Returns the map data.\n */\nfunction getMapData(map, key) {\n  var data = map.__data__;\n  return isKeyable(key)\n    ? data[typeof key == 'string' ? 'string' : 'hash']\n    : data.map;\n}\n\n/**\n * Gets the native function at `key` of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {string} key The key of the method to get.\n * @returns {*} Returns the function if it's native, else `undefined`.\n */\nfunction getNative(object, key) {\n  var value = getValue(object, key);\n  return baseIsNative(value) ? value : undefined;\n}\n\n/**\n * Creates an array of the own enumerable symbol properties of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of symbols.\n */\nvar getSymbols = nativeGetSymbols ? overArg(nativeGetSymbols, Object) : stubArray;\n\n/**\n * Creates an array of the own and inherited enumerable symbol properties\n * of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of symbols.\n */\nvar getSymbolsIn = !nativeGetSymbols ? stubArray : function(object) {\n  var result = [];\n  while (object) {\n    arrayPush(result, getSymbols(object));\n    object = getPrototype(object);\n  }\n  return result;\n};\n\n/**\n * Checks if `value` is a flattenable `arguments` object or array.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is flattenable, else `false`.\n */\nfunction isFlattenable(value) {\n  return isArray(value) || isArguments(value) ||\n    !!(spreadableSymbol && value && value[spreadableSymbol]);\n}\n\n/**\n * Checks if `value` is a valid array-like index.\n *\n * @private\n * @param {*} value The value to check.\n * @param {number} [length=MAX_SAFE_INTEGER] The upper bounds of a valid index.\n * @returns {boolean} Returns `true` if `value` is a valid index, else `false`.\n */\nfunction isIndex(value, length) {\n  length = length == null ? MAX_SAFE_INTEGER : length;\n  return !!length &&\n    (typeof value == 'number' || reIsUint.test(value)) &&\n    (value > -1 && value % 1 == 0 && value < length);\n}\n\n/**\n * Checks if `value` is suitable for use as unique object key.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is suitable, else `false`.\n */\nfunction isKeyable(value) {\n  var type = typeof value;\n  return (type == 'string' || type == 'number' || type == 'symbol' || type == 'boolean')\n    ? (value !== '__proto__')\n    : (value === null);\n}\n\n/**\n * Checks if `func` has its source masked.\n *\n * @private\n * @param {Function} func The function to check.\n * @returns {boolean} Returns `true` if `func` is masked, else `false`.\n */\nfunction isMasked(func) {\n  return !!maskSrcKey && (maskSrcKey in func);\n}\n\n/**\n * Checks if `value` is likely a prototype object.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a prototype, else `false`.\n */\nfunction isPrototype(value) {\n  var Ctor = value && value.constructor,\n      proto = (typeof Ctor == 'function' && Ctor.prototype) || objectProto;\n\n  return value === proto;\n}\n\n/**\n * This function is like\n * [`Object.keys`](http://ecma-international.org/ecma-262/7.0/#sec-object.keys)\n * except that it includes inherited enumerable properties.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n */\nfunction nativeKeysIn(object) {\n  var result = [];\n  if (object != null) {\n    for (var key in Object(object)) {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\n/**\n * Converts `value` to a string key if it's not a string or symbol.\n *\n * @private\n * @param {*} value The value to inspect.\n * @returns {string|symbol} Returns the key.\n */\nfunction toKey(value) {\n  if (typeof value == 'string' || isSymbol(value)) {\n    return value;\n  }\n  var result = (value + '');\n  return (result == '0' && (1 / value) == -INFINITY) ? '-0' : result;\n}\n\n/**\n * Converts `func` to its source code.\n *\n * @private\n * @param {Function} func The function to process.\n * @returns {string} Returns the source code.\n */\nfunction toSource(func) {\n  if (func != null) {\n    try {\n      return funcToString.call(func);\n    } catch (e) {}\n    try {\n      return (func + '');\n    } catch (e) {}\n  }\n  return '';\n}\n\n/**\n * Performs a\n * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * comparison between two values to determine if they are equivalent.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n * @example\n *\n * var object = { 'a': 1 };\n * var other = { 'a': 1 };\n *\n * _.eq(object, object);\n * // => true\n *\n * _.eq(object, other);\n * // => false\n *\n * _.eq('a', 'a');\n * // => true\n *\n * _.eq('a', Object('a'));\n * // => false\n *\n * _.eq(NaN, NaN);\n * // => true\n */\nfunction eq(value, other) {\n  return value === other || (value !== value && other !== other);\n}\n\n/**\n * Checks if `value` is likely an `arguments` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n *  else `false`.\n * @example\n *\n * _.isArguments(function() { return arguments; }());\n * // => true\n *\n * _.isArguments([1, 2, 3]);\n * // => false\n */\nfunction isArguments(value) {\n  // Safari 8.1 makes `arguments.callee` enumerable in strict mode.\n  return isArrayLikeObject(value) && hasOwnProperty.call(value, 'callee') &&\n    (!propertyIsEnumerable.call(value, 'callee') || objectToString.call(value) == argsTag);\n}\n\n/**\n * Checks if `value` is classified as an `Array` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array, else `false`.\n * @example\n *\n * _.isArray([1, 2, 3]);\n * // => true\n *\n * _.isArray(document.body.children);\n * // => false\n *\n * _.isArray('abc');\n * // => false\n *\n * _.isArray(_.noop);\n * // => false\n */\nvar isArray = Array.isArray;\n\n/**\n * Checks if `value` is array-like. A value is considered array-like if it's\n * not a function and has a `value.length` that's an integer greater than or\n * equal to `0` and less than or equal to `Number.MAX_SAFE_INTEGER`.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is array-like, else `false`.\n * @example\n *\n * _.isArrayLike([1, 2, 3]);\n * // => true\n *\n * _.isArrayLike(document.body.children);\n * // => true\n *\n * _.isArrayLike('abc');\n * // => true\n *\n * _.isArrayLike(_.noop);\n * // => false\n */\nfunction isArrayLike(value) {\n  return value != null && isLength(value.length) && !isFunction(value);\n}\n\n/**\n * This method is like `_.isArrayLike` except that it also checks if `value`\n * is an object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array-like object,\n *  else `false`.\n * @example\n *\n * _.isArrayLikeObject([1, 2, 3]);\n * // => true\n *\n * _.isArrayLikeObject(document.body.children);\n * // => true\n *\n * _.isArrayLikeObject('abc');\n * // => false\n *\n * _.isArrayLikeObject(_.noop);\n * // => false\n */\nfunction isArrayLikeObject(value) {\n  return isObjectLike(value) && isArrayLike(value);\n}\n\n/**\n * Checks if `value` is classified as a `Function` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a function, else `false`.\n * @example\n *\n * _.isFunction(_);\n * // => true\n *\n * _.isFunction(/abc/);\n * // => false\n */\nfunction isFunction(value) {\n  // The use of `Object#toString` avoids issues with the `typeof` operator\n  // in Safari 8-9 which returns 'object' for typed array and other constructors.\n  var tag = isObject(value) ? objectToString.call(value) : '';\n  return tag == funcTag || tag == genTag;\n}\n\n/**\n * Checks if `value` is a valid array-like length.\n *\n * **Note:** This method is loosely based on\n * [`ToLength`](http://ecma-international.org/ecma-262/7.0/#sec-tolength).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a valid length, else `false`.\n * @example\n *\n * _.isLength(3);\n * // => true\n *\n * _.isLength(Number.MIN_VALUE);\n * // => false\n *\n * _.isLength(Infinity);\n * // => false\n *\n * _.isLength('3');\n * // => false\n */\nfunction isLength(value) {\n  return typeof value == 'number' &&\n    value > -1 && value % 1 == 0 && value <= MAX_SAFE_INTEGER;\n}\n\n/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return !!value && (type == 'object' || type == 'function');\n}\n\n/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return !!value && typeof value == 'object';\n}\n\n/**\n * Checks if `value` is classified as a `Symbol` primitive or object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n * @example\n *\n * _.isSymbol(Symbol.iterator);\n * // => true\n *\n * _.isSymbol('abc');\n * // => false\n */\nfunction isSymbol(value) {\n  return typeof value == 'symbol' ||\n    (isObjectLike(value) && objectToString.call(value) == symbolTag);\n}\n\n/**\n * Creates an array of the own and inherited enumerable property names of `object`.\n *\n * **Note:** Non-object values are coerced to objects.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category Object\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n *   this.b = 2;\n * }\n *\n * Foo.prototype.c = 3;\n *\n * _.keysIn(new Foo);\n * // => ['a', 'b', 'c'] (iteration order is not guaranteed)\n */\nfunction keysIn(object) {\n  return isArrayLike(object) ? arrayLikeKeys(object, true) : baseKeysIn(object);\n}\n\n/**\n * The opposite of `_.pick`; this method creates an object composed of the\n * own and inherited enumerable string keyed properties of `object` that are\n * not omitted.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Object\n * @param {Object} object The source object.\n * @param {...(string|string[])} [props] The property identifiers to omit.\n * @returns {Object} Returns the new object.\n * @example\n *\n * var object = { 'a': 1, 'b': '2', 'c': 3 };\n *\n * _.omit(object, ['a', 'c']);\n * // => { 'b': '2' }\n */\nvar omit = baseRest(function(object, props) {\n  if (object == null) {\n    return {};\n  }\n  props = arrayMap(baseFlatten(props, 1), toKey);\n  return basePick(object, baseDifference(getAllKeysIn(object), props));\n});\n\n/**\n * This method returns a new empty array.\n *\n * @static\n * @memberOf _\n * @since 4.13.0\n * @category Util\n * @returns {Array} Returns the new empty array.\n * @example\n *\n * var arrays = _.times(2, _.stubArray);\n *\n * console.log(arrays);\n * // => [[], []]\n *\n * console.log(arrays[0] === arrays[1]);\n * // => false\n */\nfunction stubArray() {\n  return [];\n}\n\nmodule.exports = omit;\n","/**\n * @author mrdoob / http://mrdoob.com/\n * @author Mugen87 / https://github.com/Mugen87\n */\n\nimport {\n\tEuler,\n\tEventDispatcher,\n\tVector3\n} from \"../../../build/three.module.js\";\n\nvar PointerLockControls = function ( camera, domElement ) {\n\n\tif ( domElement === undefined ) {\n\n\t\tconsole.warn( 'THREE.PointerLockControls: The second parameter \"domElement\" is now mandatory.' );\n\t\tdomElement = document.body;\n\n\t}\n\n\tthis.domElement = domElement;\n\tthis.isLocked = false;\n\n\t//\n\t// internals\n\t//\n\n\tvar scope = this;\n\n\tvar changeEvent = { type: 'change' };\n\tvar lockEvent = { type: 'lock' };\n\tvar unlockEvent = { type: 'unlock' };\n\n\tvar euler = new Euler( 0, 0, 0, 'YXZ' );\n\n\tvar PI_2 = Math.PI / 2;\n\n\tvar vec = new Vector3();\n\n\tfunction onMouseMove( event ) {\n\n\t\tif ( scope.isLocked === false ) return;\n\n\t\tvar movementX = event.movementX || event.mozMovementX || event.webkitMovementX || 0;\n\t\tvar movementY = event.movementY || event.mozMovementY || event.webkitMovementY || 0;\n\n\t\teuler.setFromQuaternion( camera.quaternion );\n\n\t\teuler.y -= movementX * 0.002;\n\t\teuler.x -= movementY * 0.002;\n\n\t\teuler.x = Math.max( - PI_2, Math.min( PI_2, euler.x ) );\n\n\t\tcamera.quaternion.setFromEuler( euler );\n\n\t\tscope.dispatchEvent( changeEvent );\n\n\t}\n\n\tfunction onPointerlockChange() {\n\n\t\tif ( document.pointerLockElement === scope.domElement ) {\n\n\t\t\tscope.dispatchEvent( lockEvent );\n\n\t\t\tscope.isLocked = true;\n\n\t\t} else {\n\n\t\t\tscope.dispatchEvent( unlockEvent );\n\n\t\t\tscope.isLocked = false;\n\n\t\t}\n\n\t}\n\n\tfunction onPointerlockError() {\n\n\t\tconsole.error( 'THREE.PointerLockControls: Unable to use Pointer Lock API' );\n\n\t}\n\n\tthis.connect = function () {\n\n\t\tdocument.addEventListener( 'mousemove', onMouseMove, false );\n\t\tdocument.addEventListener( 'pointerlockchange', onPointerlockChange, false );\n\t\tdocument.addEventListener( 'pointerlockerror', onPointerlockError, false );\n\n\t};\n\n\tthis.disconnect = function () {\n\n\t\tdocument.removeEventListener( 'mousemove', onMouseMove, false );\n\t\tdocument.removeEventListener( 'pointerlockchange', onPointerlockChange, false );\n\t\tdocument.removeEventListener( 'pointerlockerror', onPointerlockError, false );\n\n\t};\n\n\tthis.dispose = function () {\n\n\t\tthis.disconnect();\n\n\t};\n\n\tthis.getObject = function () { // retaining this method for backward compatibility\n\n\t\treturn camera;\n\n\t};\n\n\tthis.getDirection = function () {\n\n\t\tvar direction = new Vector3( 0, 0, - 1 );\n\n\t\treturn function ( v ) {\n\n\t\t\treturn v.copy( direction ).applyQuaternion( camera.quaternion );\n\n\t\t};\n\n\t}();\n\n\tthis.moveForward = function ( distance ) {\n\n\t\t// move forward parallel to the xz-plane\n\t\t// assumes camera.up is y-up\n\n\t\tvec.setFromMatrixColumn( camera.matrix, 0 );\n\n\t\tvec.crossVectors( camera.up, vec );\n\n\t\tcamera.position.addScaledVector( vec, distance );\n\n\t};\n\n\tthis.moveRight = function ( distance ) {\n\n\t\tvec.setFromMatrixColumn( camera.matrix, 0 );\n\n\t\tcamera.position.addScaledVector( vec, distance );\n\n\t};\n\n\tthis.lock = function () {\n\n\t\tthis.domElement.requestPointerLock();\n\n\t};\n\n\tthis.unlock = function () {\n\n\t\tdocument.exitPointerLock();\n\n\t};\n\n\tthis.connect();\n\n};\n\nPointerLockControls.prototype = Object.create( EventDispatcher.prototype );\nPointerLockControls.prototype.constructor = PointerLockControls;\n\nexport { PointerLockControls };\n","/**\n * @author Don McCurdy / https://www.donmccurdy.com\n */\n\nimport {\n\tBufferAttribute,\n\tBufferGeometry,\n\tFileLoader,\n\tLoader\n} from \"../../../build/three.module.js\";\n\nvar DRACOLoader = function ( manager ) {\n\n\tLoader.call( this, manager );\n\n\tthis.decoderPath = '';\n\tthis.decoderConfig = {};\n\tthis.decoderBinary = null;\n\tthis.decoderPending = null;\n\n\tthis.workerLimit = 4;\n\tthis.workerPool = [];\n\tthis.workerNextTaskID = 1;\n\tthis.workerSourceURL = '';\n\n\tthis.defaultAttributeIDs = {\n\t\tposition: 'POSITION',\n\t\tnormal: 'NORMAL',\n\t\tcolor: 'COLOR',\n\t\tuv: 'TEX_COORD'\n\t};\n\tthis.defaultAttributeTypes = {\n\t\tposition: 'Float32Array',\n\t\tnormal: 'Float32Array',\n\t\tcolor: 'Float32Array',\n\t\tuv: 'Float32Array'\n\t};\n\n};\n\nDRACOLoader.prototype = Object.assign( Object.create( Loader.prototype ), {\n\n\tconstructor: DRACOLoader,\n\n\tsetDecoderPath: function ( path ) {\n\n\t\tthis.decoderPath = path;\n\n\t\treturn this;\n\n\t},\n\n\tsetDecoderConfig: function ( config ) {\n\n\t\tthis.decoderConfig = config;\n\n\t\treturn this;\n\n\t},\n\n\tsetWorkerLimit: function ( workerLimit ) {\n\n\t\tthis.workerLimit = workerLimit;\n\n\t\treturn this;\n\n\t},\n\n\t/** @deprecated */\n\tsetVerbosity: function () {\n\n\t\tconsole.warn( 'THREE.DRACOLoader: The .setVerbosity() method has been removed.' );\n\n\t},\n\n\t/** @deprecated */\n\tsetDrawMode: function () {\n\n\t\tconsole.warn( 'THREE.DRACOLoader: The .setDrawMode() method has been removed.' );\n\n\t},\n\n\t/** @deprecated */\n\tsetSkipDequantization: function () {\n\n\t\tconsole.warn( 'THREE.DRACOLoader: The .setSkipDequantization() method has been removed.' );\n\n\t},\n\n\tload: function ( url, onLoad, onProgress, onError ) {\n\n\t\tvar loader = new FileLoader( this.manager );\n\n\t\tloader.setPath( this.path );\n\t\tloader.setResponseType( 'arraybuffer' );\n\n\t\tif ( this.crossOrigin === 'use-credentials' ) {\n\n\t\t\tloader.setWithCredentials( true );\n\n\t\t}\n\n\t\tloader.load( url, ( buffer ) => {\n\n\t\t\tvar taskConfig = {\n\t\t\t\tattributeIDs: this.defaultAttributeIDs,\n\t\t\t\tattributeTypes: this.defaultAttributeTypes,\n\t\t\t\tuseUniqueIDs: false\n\t\t\t};\n\n\t\t\tthis.decodeGeometry( buffer, taskConfig )\n\t\t\t\t.then( onLoad )\n\t\t\t\t.catch( onError );\n\n\t\t}, onProgress, onError );\n\n\t},\n\n\t/** @deprecated Kept for backward-compatibility with previous DRACOLoader versions. */\n\tdecodeDracoFile: function ( buffer, callback, attributeIDs, attributeTypes ) {\n\n\t\tvar taskConfig = {\n\t\t\tattributeIDs: attributeIDs || this.defaultAttributeIDs,\n\t\t\tattributeTypes: attributeTypes || this.defaultAttributeTypes,\n\t\t\tuseUniqueIDs: !! attributeIDs\n\t\t};\n\n\t\tthis.decodeGeometry( buffer, taskConfig ).then( callback );\n\n\t},\n\n\tdecodeGeometry: function ( buffer, taskConfig ) {\n\n\t\t// TODO: For backward-compatibility, support 'attributeTypes' objects containing\n\t\t// references (rather than names) to typed array constructors. These must be\n\t\t// serialized before sending them to the worker.\n\t\tfor ( var attribute in taskConfig.attributeTypes ) {\n\n\t\t\tvar type = taskConfig.attributeTypes[ attribute ];\n\n\t\t\tif ( type.BYTES_PER_ELEMENT !== undefined ) {\n\n\t\t\t\ttaskConfig.attributeTypes[ attribute ] = type.name;\n\n\t\t\t}\n\n\t\t}\n\n\t\t//\n\n\t\tvar taskKey = JSON.stringify( taskConfig );\n\n\t\t// Check for an existing task using this buffer. A transferred buffer cannot be transferred\n\t\t// again from this thread.\n\t\tif ( DRACOLoader.taskCache.has( buffer ) ) {\n\n\t\t\tvar cachedTask = DRACOLoader.taskCache.get( buffer );\n\n\t\t\tif ( cachedTask.key === taskKey ) {\n\n\t\t\t\treturn cachedTask.promise;\n\n\t\t\t} else if ( buffer.byteLength === 0 ) {\n\n\t\t\t\t// Technically, it would be possible to wait for the previous task to complete,\n\t\t\t\t// transfer the buffer back, and decode again with the second configuration. That\n\t\t\t\t// is complex, and I don't know of any reason to decode a Draco buffer twice in\n\t\t\t\t// different ways, so this is left unimplemented.\n\t\t\t\tthrow new Error(\n\n\t\t\t\t\t'THREE.DRACOLoader: Unable to re-decode a buffer with different ' +\n\t\t\t\t\t'settings. Buffer has already been transferred.'\n\n\t\t\t\t);\n\n\t\t\t}\n\n\t\t}\n\n\t\t//\n\n\t\tvar worker;\n\t\tvar taskID = this.workerNextTaskID ++;\n\t\tvar taskCost = buffer.byteLength;\n\n\t\t// Obtain a worker and assign a task, and construct a geometry instance\n\t\t// when the task completes.\n\t\tvar geometryPending = this._getWorker( taskID, taskCost )\n\t\t\t.then( ( _worker ) => {\n\n\t\t\t\tworker = _worker;\n\n\t\t\t\treturn new Promise( ( resolve, reject ) => {\n\n\t\t\t\t\tworker._callbacks[ taskID ] = { resolve, reject };\n\n\t\t\t\t\tworker.postMessage( { type: 'decode', id: taskID, taskConfig, buffer }, [ buffer ] );\n\n\t\t\t\t\t// this.debug();\n\n\t\t\t\t} );\n\n\t\t\t} )\n\t\t\t.then( ( message ) => this._createGeometry( message.geometry ) );\n\n\t\t// Remove task from the task list.\n\t\t// Note: replaced '.finally()' with '.catch().then()' block - iOS 11 support (#19416)\n\t\tgeometryPending\n\t\t\t.catch( () => true )\n\t\t\t.then( () => {\n\n\t\t\t\tif ( worker && taskID ) {\n\n\t\t\t\t\tthis._releaseTask( worker, taskID );\n\n\t\t\t\t\t// this.debug();\n\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t// Cache the task result.\n\t\tDRACOLoader.taskCache.set( buffer, {\n\n\t\t\tkey: taskKey,\n\t\t\tpromise: geometryPending\n\n\t\t} );\n\n\t\treturn geometryPending;\n\n\t},\n\n\t_createGeometry: function ( geometryData ) {\n\n\t\tvar geometry = new BufferGeometry();\n\n\t\tif ( geometryData.index ) {\n\n\t\t\tgeometry.setIndex( new BufferAttribute( geometryData.index.array, 1 ) );\n\n\t\t}\n\n\t\tfor ( var i = 0; i < geometryData.attributes.length; i ++ ) {\n\n\t\t\tvar attribute = geometryData.attributes[ i ];\n\t\t\tvar name = attribute.name;\n\t\t\tvar array = attribute.array;\n\t\t\tvar itemSize = attribute.itemSize;\n\n\t\t\tgeometry.setAttribute( name, new BufferAttribute( array, itemSize ) );\n\n\t\t}\n\n\t\treturn geometry;\n\n\t},\n\n\t_loadLibrary: function ( url, responseType ) {\n\n\t\tvar loader = new FileLoader( this.manager );\n\t\tloader.setPath( this.decoderPath );\n\t\tloader.setResponseType( responseType );\n\n\t\treturn new Promise( ( resolve, reject ) => {\n\n\t\t\tloader.load( url, resolve, undefined, reject );\n\n\t\t} );\n\n\t},\n\n\tpreload: function () {\n\n\t\tthis._initDecoder();\n\n\t\treturn this;\n\n\t},\n\n\t_initDecoder: function () {\n\n\t\tif ( this.decoderPending ) return this.decoderPending;\n\n\t\tvar useJS = typeof WebAssembly !== 'object' || this.decoderConfig.type === 'js';\n\t\tvar librariesPending = [];\n\n\t\tif ( useJS ) {\n\n\t\t\tlibrariesPending.push( this._loadLibrary( 'draco_decoder.js', 'text' ) );\n\n\t\t} else {\n\n\t\t\tlibrariesPending.push( this._loadLibrary( 'draco_wasm_wrapper.js', 'text' ) );\n\t\t\tlibrariesPending.push( this._loadLibrary( 'draco_decoder.wasm', 'arraybuffer' ) );\n\n\t\t}\n\n\t\tthis.decoderPending = Promise.all( librariesPending )\n\t\t\t.then( ( libraries ) => {\n\n\t\t\t\tvar jsContent = libraries[ 0 ];\n\n\t\t\t\tif ( ! useJS ) {\n\n\t\t\t\t\tthis.decoderConfig.wasmBinary = libraries[ 1 ];\n\n\t\t\t\t}\n\n\t\t\t\tvar fn = DRACOLoader.DRACOWorker.toString();\n\n\t\t\t\tvar body = [\n\t\t\t\t\t'/* draco decoder */',\n\t\t\t\t\tjsContent,\n\t\t\t\t\t'',\n\t\t\t\t\t'/* worker */',\n\t\t\t\t\tfn.substring( fn.indexOf( '{' ) + 1, fn.lastIndexOf( '}' ) )\n\t\t\t\t].join( '\\n' );\n\n\t\t\t\tthis.workerSourceURL = URL.createObjectURL( new Blob( [ body ] ) );\n\n\t\t\t} );\n\n\t\treturn this.decoderPending;\n\n\t},\n\n\t_getWorker: function ( taskID, taskCost ) {\n\n\t\treturn this._initDecoder().then( () => {\n\n\t\t\tif ( this.workerPool.length < this.workerLimit ) {\n\n\t\t\t\tvar worker = new Worker( this.workerSourceURL );\n\n\t\t\t\tworker._callbacks = {};\n\t\t\t\tworker._taskCosts = {};\n\t\t\t\tworker._taskLoad = 0;\n\n\t\t\t\tworker.postMessage( { type: 'init', decoderConfig: this.decoderConfig } );\n\n\t\t\t\tworker.onmessage = function ( e ) {\n\n\t\t\t\t\tvar message = e.data;\n\n\t\t\t\t\tswitch ( message.type ) {\n\n\t\t\t\t\t\tcase 'decode':\n\t\t\t\t\t\t\tworker._callbacks[ message.id ].resolve( message );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase 'error':\n\t\t\t\t\t\t\tworker._callbacks[ message.id ].reject( message );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tconsole.error( 'THREE.DRACOLoader: Unexpected message, \"' + message.type + '\"' );\n\n\t\t\t\t\t}\n\n\t\t\t\t};\n\n\t\t\t\tthis.workerPool.push( worker );\n\n\t\t\t} else {\n\n\t\t\t\tthis.workerPool.sort( function ( a, b ) {\n\n\t\t\t\t\treturn a._taskLoad > b._taskLoad ? - 1 : 1;\n\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t\tvar worker = this.workerPool[ this.workerPool.length - 1 ];\n\t\t\tworker._taskCosts[ taskID ] = taskCost;\n\t\t\tworker._taskLoad += taskCost;\n\t\t\treturn worker;\n\n\t\t} );\n\n\t},\n\n\t_releaseTask: function ( worker, taskID ) {\n\n\t\tworker._taskLoad -= worker._taskCosts[ taskID ];\n\t\tdelete worker._callbacks[ taskID ];\n\t\tdelete worker._taskCosts[ taskID ];\n\n\t},\n\n\tdebug: function () {\n\n\t\tconsole.log( 'Task load: ', this.workerPool.map( ( worker ) => worker._taskLoad ) );\n\n\t},\n\n\tdispose: function () {\n\n\t\tfor ( var i = 0; i < this.workerPool.length; ++ i ) {\n\n\t\t\tthis.workerPool[ i ].terminate();\n\n\t\t}\n\n\t\tthis.workerPool.length = 0;\n\n\t\treturn this;\n\n\t}\n\n} );\n\n/* WEB WORKER */\n\nDRACOLoader.DRACOWorker = function () {\n\n\tvar decoderConfig;\n\tvar decoderPending;\n\n\tonmessage = function ( e ) {\n\n\t\tvar message = e.data;\n\n\t\tswitch ( message.type ) {\n\n\t\t\tcase 'init':\n\t\t\t\tdecoderConfig = message.decoderConfig;\n\t\t\t\tdecoderPending = new Promise( function ( resolve/*, reject*/ ) {\n\n\t\t\t\t\tdecoderConfig.onModuleLoaded = function ( draco ) {\n\n\t\t\t\t\t\t// Module is Promise-like. Wrap before resolving to avoid loop.\n\t\t\t\t\t\tresolve( { draco: draco } );\n\n\t\t\t\t\t};\n\n\t\t\t\t\tDracoDecoderModule( decoderConfig );\n\n\t\t\t\t} );\n\t\t\t\tbreak;\n\n\t\t\tcase 'decode':\n\t\t\t\tvar buffer = message.buffer;\n\t\t\t\tvar taskConfig = message.taskConfig;\n\t\t\t\tdecoderPending.then( ( module ) => {\n\n\t\t\t\t\tvar draco = module.draco;\n\t\t\t\t\tvar decoder = new draco.Decoder();\n\t\t\t\t\tvar decoderBuffer = new draco.DecoderBuffer();\n\t\t\t\t\tdecoderBuffer.Init( new Int8Array( buffer ), buffer.byteLength );\n\n\t\t\t\t\ttry {\n\n\t\t\t\t\t\tvar geometry = decodeGeometry( draco, decoder, decoderBuffer, taskConfig );\n\n\t\t\t\t\t\tvar buffers = geometry.attributes.map( ( attr ) => attr.array.buffer );\n\n\t\t\t\t\t\tif ( geometry.index ) buffers.push( geometry.index.array.buffer );\n\n\t\t\t\t\t\tself.postMessage( { type: 'decode', id: message.id, geometry }, buffers );\n\n\t\t\t\t\t} catch ( error ) {\n\n\t\t\t\t\t\tconsole.error( error );\n\n\t\t\t\t\t\tself.postMessage( { type: 'error', id: message.id, error: error.message } );\n\n\t\t\t\t\t} finally {\n\n\t\t\t\t\t\tdraco.destroy( decoderBuffer );\n\t\t\t\t\t\tdraco.destroy( decoder );\n\n\t\t\t\t\t}\n\n\t\t\t\t} );\n\t\t\t\tbreak;\n\n\t\t}\n\n\t};\n\n\tfunction decodeGeometry( draco, decoder, decoderBuffer, taskConfig ) {\n\n\t\tvar attributeIDs = taskConfig.attributeIDs;\n\t\tvar attributeTypes = taskConfig.attributeTypes;\n\n\t\tvar dracoGeometry;\n\t\tvar decodingStatus;\n\n\t\tvar geometryType = decoder.GetEncodedGeometryType( decoderBuffer );\n\n\t\tif ( geometryType === draco.TRIANGULAR_MESH ) {\n\n\t\t\tdracoGeometry = new draco.Mesh();\n\t\t\tdecodingStatus = decoder.DecodeBufferToMesh( decoderBuffer, dracoGeometry );\n\n\t\t} else if ( geometryType === draco.POINT_CLOUD ) {\n\n\t\t\tdracoGeometry = new draco.PointCloud();\n\t\t\tdecodingStatus = decoder.DecodeBufferToPointCloud( decoderBuffer, dracoGeometry );\n\n\t\t} else {\n\n\t\t\tthrow new Error( 'THREE.DRACOLoader: Unexpected geometry type.' );\n\n\t\t}\n\n\t\tif ( ! decodingStatus.ok() || dracoGeometry.ptr === 0 ) {\n\n\t\t\tthrow new Error( 'THREE.DRACOLoader: Decoding failed: ' + decodingStatus.error_msg() );\n\n\t\t}\n\n\t\tvar geometry = { index: null, attributes: [] };\n\n\t\t// Gather all vertex attributes.\n\t\tfor ( var attributeName in attributeIDs ) {\n\n\t\t\tvar attributeType = self[ attributeTypes[ attributeName ] ];\n\n\t\t\tvar attribute;\n\t\t\tvar attributeID;\n\n\t\t\t// A Draco file may be created with default vertex attributes, whose attribute IDs\n\t\t\t// are mapped 1:1 from their semantic name (POSITION, NORMAL, ...). Alternatively,\n\t\t\t// a Draco file may contain a custom set of attributes, identified by known unique\n\t\t\t// IDs. glTF files always do the latter, and `.drc` files typically do the former.\n\t\t\tif ( taskConfig.useUniqueIDs ) {\n\n\t\t\t\tattributeID = attributeIDs[ attributeName ];\n\t\t\t\tattribute = decoder.GetAttributeByUniqueId( dracoGeometry, attributeID );\n\n\t\t\t} else {\n\n\t\t\t\tattributeID = decoder.GetAttributeId( dracoGeometry, draco[ attributeIDs[ attributeName ] ] );\n\n\t\t\t\tif ( attributeID === - 1 ) continue;\n\n\t\t\t\tattribute = decoder.GetAttribute( dracoGeometry, attributeID );\n\n\t\t\t}\n\n\t\t\tgeometry.attributes.push( decodeAttribute( draco, decoder, dracoGeometry, attributeName, attributeType, attribute ) );\n\n\t\t}\n\n\t\t// Add index.\n\t\tif ( geometryType === draco.TRIANGULAR_MESH ) {\n\n\t\t\t// Generate mesh faces.\n\t\t\tvar numFaces = dracoGeometry.num_faces();\n\t\t\tvar numIndices = numFaces * 3;\n\t\t\tvar index = new Uint32Array( numIndices );\n\t\t\tvar indexArray = new draco.DracoInt32Array();\n\n\t\t\tfor ( var i = 0; i < numFaces; ++ i ) {\n\n\t\t\t\tdecoder.GetFaceFromMesh( dracoGeometry, i, indexArray );\n\n\t\t\t\tfor ( var j = 0; j < 3; ++ j ) {\n\n\t\t\t\t\tindex[ i * 3 + j ] = indexArray.GetValue( j );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tgeometry.index = { array: index, itemSize: 1 };\n\n\t\t\tdraco.destroy( indexArray );\n\n\t\t}\n\n\t\tdraco.destroy( dracoGeometry );\n\n\t\treturn geometry;\n\n\t}\n\n\tfunction decodeAttribute( draco, decoder, dracoGeometry, attributeName, attributeType, attribute ) {\n\n\t\tvar numComponents = attribute.num_components();\n\t\tvar numPoints = dracoGeometry.num_points();\n\t\tvar numValues = numPoints * numComponents;\n\t\tvar dracoArray;\n\n\t\tvar array;\n\n\t\tswitch ( attributeType ) {\n\n\t\t\tcase Float32Array:\n\t\t\t\tdracoArray = new draco.DracoFloat32Array();\n\t\t\t\tdecoder.GetAttributeFloatForAllPoints( dracoGeometry, attribute, dracoArray );\n\t\t\t\tarray = new Float32Array( numValues );\n\t\t\t\tbreak;\n\n\t\t\tcase Int8Array:\n\t\t\t\tdracoArray = new draco.DracoInt8Array();\n\t\t\t\tdecoder.GetAttributeInt8ForAllPoints( dracoGeometry, attribute, dracoArray );\n\t\t\t\tarray = new Int8Array( numValues );\n\t\t\t\tbreak;\n\n\t\t\tcase Int16Array:\n\t\t\t\tdracoArray = new draco.DracoInt16Array();\n\t\t\t\tdecoder.GetAttributeInt16ForAllPoints( dracoGeometry, attribute, dracoArray );\n\t\t\t\tarray = new Int16Array( numValues );\n\t\t\t\tbreak;\n\n\t\t\tcase Int32Array:\n\t\t\t\tdracoArray = new draco.DracoInt32Array();\n\t\t\t\tdecoder.GetAttributeInt32ForAllPoints( dracoGeometry, attribute, dracoArray );\n\t\t\t\tarray = new Int32Array( numValues );\n\t\t\t\tbreak;\n\n\t\t\tcase Uint8Array:\n\t\t\t\tdracoArray = new draco.DracoUInt8Array();\n\t\t\t\tdecoder.GetAttributeUInt8ForAllPoints( dracoGeometry, attribute, dracoArray );\n\t\t\t\tarray = new Uint8Array( numValues );\n\t\t\t\tbreak;\n\n\t\t\tcase Uint16Array:\n\t\t\t\tdracoArray = new draco.DracoUInt16Array();\n\t\t\t\tdecoder.GetAttributeUInt16ForAllPoints( dracoGeometry, attribute, dracoArray );\n\t\t\t\tarray = new Uint16Array( numValues );\n\t\t\t\tbreak;\n\n\t\t\tcase Uint32Array:\n\t\t\t\tdracoArray = new draco.DracoUInt32Array();\n\t\t\t\tdecoder.GetAttributeUInt32ForAllPoints( dracoGeometry, attribute, dracoArray );\n\t\t\t\tarray = new Uint32Array( numValues );\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tthrow new Error( 'THREE.DRACOLoader: Unexpected attribute type.' );\n\n\t\t}\n\n\t\tfor ( var i = 0; i < numValues; i ++ ) {\n\n\t\t\tarray[ i ] = dracoArray.GetValue( i );\n\n\t\t}\n\n\t\tdraco.destroy( dracoArray );\n\n\t\treturn {\n\t\t\tname: attributeName,\n\t\t\tarray: array,\n\t\t\titemSize: numComponents\n\t\t};\n\n\t}\n\n};\n\nDRACOLoader.taskCache = new WeakMap();\n\n/** Deprecated static methods */\n\n/** @deprecated */\nDRACOLoader.setDecoderPath = function () {\n\n\tconsole.warn( 'THREE.DRACOLoader: The .setDecoderPath() method has been removed. Use instance methods.' );\n\n};\n\n/** @deprecated */\nDRACOLoader.setDecoderConfig = function () {\n\n\tconsole.warn( 'THREE.DRACOLoader: The .setDecoderConfig() method has been removed. Use instance methods.' );\n\n};\n\n/** @deprecated */\nDRACOLoader.releaseDecoderModule = function () {\n\n\tconsole.warn( 'THREE.DRACOLoader: The .releaseDecoderModule() method has been removed. Use instance methods.' );\n\n};\n\n/** @deprecated */\nDRACOLoader.getDecoderModule = function () {\n\n\tconsole.warn( 'THREE.DRACOLoader: The .getDecoderModule() method has been removed. Use instance methods.' );\n\n};\n\nexport { DRACOLoader };\n","/**\n * @author Rich Tibbett / https://github.com/richtr\n * @author mrdoob / http://mrdoob.com/\n * @author Tony Parisi / http://www.tonyparisi.com/\n * @author Takahiro / https://github.com/takahirox\n * @author Don McCurdy / https://www.donmccurdy.com\n */\n\nimport {\n\tAnimationClip,\n\tBone,\n\tBox3,\n\tBufferAttribute,\n\tBufferGeometry,\n\tClampToEdgeWrapping,\n\tColor,\n\tDirectionalLight,\n\tDoubleSide,\n\tFileLoader,\n\tFrontSide,\n\tGroup,\n\tInterleavedBuffer,\n\tInterleavedBufferAttribute,\n\tInterpolant,\n\tInterpolateDiscrete,\n\tInterpolateLinear,\n\tLine,\n\tLineBasicMaterial,\n\tLineLoop,\n\tLineSegments,\n\tLinearFilter,\n\tLinearMipmapLinearFilter,\n\tLinearMipmapNearestFilter,\n\tLoader,\n\tLoaderUtils,\n\tMaterial,\n\tMathUtils,\n\tMatrix4,\n\tMesh,\n\tMeshBasicMaterial,\n\tMeshPhysicalMaterial,\n\tMeshStandardMaterial,\n\tMirroredRepeatWrapping,\n\tNearestFilter,\n\tNearestMipmapLinearFilter,\n\tNearestMipmapNearestFilter,\n\tNumberKeyframeTrack,\n\tObject3D,\n\tOrthographicCamera,\n\tPerspectiveCamera,\n\tPointLight,\n\tPoints,\n\tPointsMaterial,\n\tPropertyBinding,\n\tQuaternionKeyframeTrack,\n\tRGBAFormat,\n\tRGBFormat,\n\tRepeatWrapping,\n\tSkeleton,\n\tSkinnedMesh,\n\tSphere,\n\tSpotLight,\n\tTangentSpaceNormalMap,\n\tTextureLoader,\n\tTriangleFanDrawMode,\n\tTriangleStripDrawMode,\n\tVector2,\n\tVector3,\n\tVectorKeyframeTrack,\n\tsRGBEncoding\n} from \"../../../build/three.module.js\";\n\nvar GLTFLoader = ( function () {\n\n\tfunction GLTFLoader( manager ) {\n\n\t\tLoader.call( this, manager );\n\n\t\tthis.dracoLoader = null;\n\t\tthis.ddsLoader = null;\n\n\t}\n\n\tGLTFLoader.prototype = Object.assign( Object.create( Loader.prototype ), {\n\n\t\tconstructor: GLTFLoader,\n\n\t\tload: function ( url, onLoad, onProgress, onError ) {\n\n\t\t\tvar scope = this;\n\n\t\t\tvar resourcePath;\n\n\t\t\tif ( this.resourcePath !== '' ) {\n\n\t\t\t\tresourcePath = this.resourcePath;\n\n\t\t\t} else if ( this.path !== '' ) {\n\n\t\t\t\tresourcePath = this.path;\n\n\t\t\t} else {\n\n\t\t\t\tresourcePath = LoaderUtils.extractUrlBase( url );\n\n\t\t\t}\n\n\t\t\t// Tells the LoadingManager to track an extra item, which resolves after\n\t\t\t// the model is fully loaded. This means the count of items loaded will\n\t\t\t// be incorrect, but ensures manager.onLoad() does not fire early.\n\t\t\tscope.manager.itemStart( url );\n\n\t\t\tvar _onError = function ( e ) {\n\n\t\t\t\tif ( onError ) {\n\n\t\t\t\t\tonError( e );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.error( e );\n\n\t\t\t\t}\n\n\t\t\t\tscope.manager.itemError( url );\n\t\t\t\tscope.manager.itemEnd( url );\n\n\t\t\t};\n\n\t\t\tvar loader = new FileLoader( scope.manager );\n\n\t\t\tloader.setPath( this.path );\n\t\t\tloader.setResponseType( 'arraybuffer' );\n\t\t\tloader.setRequestHeader( this.requestHeader );\n\n\t\t\tif ( scope.crossOrigin === 'use-credentials' ) {\n\n\t\t\t\tloader.setWithCredentials( true );\n\n\t\t\t}\n\n\t\t\tloader.load( url, function ( data ) {\n\n\t\t\t\ttry {\n\n\t\t\t\t\tscope.parse( data, resourcePath, function ( gltf ) {\n\n\t\t\t\t\t\tonLoad( gltf );\n\n\t\t\t\t\t\tscope.manager.itemEnd( url );\n\n\t\t\t\t\t}, _onError );\n\n\t\t\t\t} catch ( e ) {\n\n\t\t\t\t\t_onError( e );\n\n\t\t\t\t}\n\n\t\t\t}, onProgress, _onError );\n\n\t\t},\n\n\t\tsetDRACOLoader: function ( dracoLoader ) {\n\n\t\t\tthis.dracoLoader = dracoLoader;\n\t\t\treturn this;\n\n\t\t},\n\n\t\tsetDDSLoader: function ( ddsLoader ) {\n\n\t\t\tthis.ddsLoader = ddsLoader;\n\t\t\treturn this;\n\n\t\t},\n\n\t\tparse: function ( data, path, onLoad, onError ) {\n\n\t\t\tvar content;\n\t\t\tvar extensions = {};\n\n\t\t\tif ( typeof data === 'string' ) {\n\n\t\t\t\tcontent = data;\n\n\t\t\t} else {\n\n\t\t\t\tvar magic = LoaderUtils.decodeText( new Uint8Array( data, 0, 4 ) );\n\n\t\t\t\tif ( magic === BINARY_EXTENSION_HEADER_MAGIC ) {\n\n\t\t\t\t\ttry {\n\n\t\t\t\t\t\textensions[ EXTENSIONS.KHR_BINARY_GLTF ] = new GLTFBinaryExtension( data );\n\n\t\t\t\t\t} catch ( error ) {\n\n\t\t\t\t\t\tif ( onError ) onError( error );\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tcontent = extensions[ EXTENSIONS.KHR_BINARY_GLTF ].content;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tcontent = LoaderUtils.decodeText( new Uint8Array( data ) );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tvar json = JSON.parse( content );\n\n\t\t\tif ( json.asset === undefined || json.asset.version[ 0 ] < 2 ) {\n\n\t\t\t\tif ( onError ) onError( new Error( 'THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.' ) );\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t\tif ( json.extensionsUsed ) {\n\n\t\t\t\tfor ( var i = 0; i < json.extensionsUsed.length; ++ i ) {\n\n\t\t\t\t\tvar extensionName = json.extensionsUsed[ i ];\n\t\t\t\t\tvar extensionsRequired = json.extensionsRequired || [];\n\n\t\t\t\t\tswitch ( extensionName ) {\n\n\t\t\t\t\t\tcase EXTENSIONS.KHR_LIGHTS_PUNCTUAL:\n\t\t\t\t\t\t\textensions[ extensionName ] = new GLTFLightsExtension( json );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase EXTENSIONS.KHR_MATERIALS_CLEARCOAT:\n\t\t\t\t\t\t\textensions[ extensionName ] = new GLTFMaterialsClearcoatExtension();\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase EXTENSIONS.KHR_MATERIALS_UNLIT:\n\t\t\t\t\t\t\textensions[ extensionName ] = new GLTFMaterialsUnlitExtension();\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:\n\t\t\t\t\t\t\textensions[ extensionName ] = new GLTFMaterialsPbrSpecularGlossinessExtension();\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase EXTENSIONS.KHR_DRACO_MESH_COMPRESSION:\n\t\t\t\t\t\t\textensions[ extensionName ] = new GLTFDracoMeshCompressionExtension( json, this.dracoLoader );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase EXTENSIONS.MSFT_TEXTURE_DDS:\n\t\t\t\t\t\t\textensions[ extensionName ] = new GLTFTextureDDSExtension( this.ddsLoader );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase EXTENSIONS.KHR_TEXTURE_TRANSFORM:\n\t\t\t\t\t\t\textensions[ extensionName ] = new GLTFTextureTransformExtension();\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase EXTENSIONS.KHR_MESH_QUANTIZATION:\n\t\t\t\t\t\t\textensions[ extensionName ] = new GLTFMeshQuantizationExtension();\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tdefault:\n\n\t\t\t\t\t\t\tif ( extensionsRequired.indexOf( extensionName ) >= 0 ) {\n\n\t\t\t\t\t\t\t\tconsole.warn( 'THREE.GLTFLoader: Unknown extension \"' + extensionName + '\".' );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tvar parser = new GLTFParser( json, extensions, {\n\n\t\t\t\tpath: path || this.resourcePath || '',\n\t\t\t\tcrossOrigin: this.crossOrigin,\n\t\t\t\tmanager: this.manager\n\n\t\t\t} );\n\n\t\t\tparser.fileLoader.setRequestHeader( this.requestHeader );\n\t\t\tparser.parse( onLoad, onError );\n\n\t\t}\n\n\t} );\n\n\t/* GLTFREGISTRY */\n\n\tfunction GLTFRegistry() {\n\n\t\tvar objects = {};\n\n\t\treturn\t{\n\n\t\t\tget: function ( key ) {\n\n\t\t\t\treturn objects[ key ];\n\n\t\t\t},\n\n\t\t\tadd: function ( key, object ) {\n\n\t\t\t\tobjects[ key ] = object;\n\n\t\t\t},\n\n\t\t\tremove: function ( key ) {\n\n\t\t\t\tdelete objects[ key ];\n\n\t\t\t},\n\n\t\t\tremoveAll: function () {\n\n\t\t\t\tobjects = {};\n\n\t\t\t}\n\n\t\t};\n\n\t}\n\n\t/*********************************/\n\t/********** EXTENSIONS ***********/\n\t/*********************************/\n\n\tvar EXTENSIONS = {\n\t\tKHR_BINARY_GLTF: 'KHR_binary_glTF',\n\t\tKHR_DRACO_MESH_COMPRESSION: 'KHR_draco_mesh_compression',\n\t\tKHR_LIGHTS_PUNCTUAL: 'KHR_lights_punctual',\n\t\tKHR_MATERIALS_CLEARCOAT: 'KHR_materials_clearcoat',\n\t\tKHR_MATERIALS_PBR_SPECULAR_GLOSSINESS: 'KHR_materials_pbrSpecularGlossiness',\n\t\tKHR_MATERIALS_UNLIT: 'KHR_materials_unlit',\n\t\tKHR_TEXTURE_TRANSFORM: 'KHR_texture_transform',\n\t\tKHR_MESH_QUANTIZATION: 'KHR_mesh_quantization',\n\t\tMSFT_TEXTURE_DDS: 'MSFT_texture_dds'\n\t};\n\n\t/**\n\t * DDS Texture Extension\n\t *\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Vendor/MSFT_texture_dds\n\t *\n\t */\n\tfunction GLTFTextureDDSExtension( ddsLoader ) {\n\n\t\tif ( ! ddsLoader ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: Attempting to load .dds texture without importing DDSLoader' );\n\n\t\t}\n\n\t\tthis.name = EXTENSIONS.MSFT_TEXTURE_DDS;\n\t\tthis.ddsLoader = ddsLoader;\n\n\t}\n\n\t/**\n\t * Punctual Lights Extension\n\t *\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_lights_punctual\n\t */\n\tfunction GLTFLightsExtension( json ) {\n\n\t\tthis.name = EXTENSIONS.KHR_LIGHTS_PUNCTUAL;\n\n\t\tvar extension = ( json.extensions && json.extensions[ EXTENSIONS.KHR_LIGHTS_PUNCTUAL ] ) || {};\n\t\tthis.lightDefs = extension.lights || [];\n\n\t}\n\n\tGLTFLightsExtension.prototype.loadLight = function ( lightIndex ) {\n\n\t\tvar lightDef = this.lightDefs[ lightIndex ];\n\t\tvar lightNode;\n\n\t\tvar color = new Color( 0xffffff );\n\t\tif ( lightDef.color !== undefined ) color.fromArray( lightDef.color );\n\n\t\tvar range = lightDef.range !== undefined ? lightDef.range : 0;\n\n\t\tswitch ( lightDef.type ) {\n\n\t\t\tcase 'directional':\n\t\t\t\tlightNode = new DirectionalLight( color );\n\t\t\t\tlightNode.target.position.set( 0, 0, - 1 );\n\t\t\t\tlightNode.add( lightNode.target );\n\t\t\t\tbreak;\n\n\t\t\tcase 'point':\n\t\t\t\tlightNode = new PointLight( color );\n\t\t\t\tlightNode.distance = range;\n\t\t\t\tbreak;\n\n\t\t\tcase 'spot':\n\t\t\t\tlightNode = new SpotLight( color );\n\t\t\t\tlightNode.distance = range;\n\t\t\t\t// Handle spotlight properties.\n\t\t\t\tlightDef.spot = lightDef.spot || {};\n\t\t\t\tlightDef.spot.innerConeAngle = lightDef.spot.innerConeAngle !== undefined ? lightDef.spot.innerConeAngle : 0;\n\t\t\t\tlightDef.spot.outerConeAngle = lightDef.spot.outerConeAngle !== undefined ? lightDef.spot.outerConeAngle : Math.PI / 4.0;\n\t\t\t\tlightNode.angle = lightDef.spot.outerConeAngle;\n\t\t\t\tlightNode.penumbra = 1.0 - lightDef.spot.innerConeAngle / lightDef.spot.outerConeAngle;\n\t\t\t\tlightNode.target.position.set( 0, 0, - 1 );\n\t\t\t\tlightNode.add( lightNode.target );\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tthrow new Error( 'THREE.GLTFLoader: Unexpected light type, \"' + lightDef.type + '\".' );\n\n\t\t}\n\n\t\t// Some lights (e.g. spot) default to a position other than the origin. Reset the position\n\t\t// here, because node-level parsing will only override position if explicitly specified.\n\t\tlightNode.position.set( 0, 0, 0 );\n\n\t\tlightNode.decay = 2;\n\n\t\tif ( lightDef.intensity !== undefined ) lightNode.intensity = lightDef.intensity;\n\n\t\tlightNode.name = lightDef.name || ( 'light_' + lightIndex );\n\n\t\treturn Promise.resolve( lightNode );\n\n\t};\n\n\t/**\n\t * Unlit Materials Extension\n\t *\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_unlit\n\t */\n\tfunction GLTFMaterialsUnlitExtension() {\n\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_UNLIT;\n\n\t}\n\n\tGLTFMaterialsUnlitExtension.prototype.getMaterialType = function () {\n\n\t\treturn MeshBasicMaterial;\n\n\t};\n\n\tGLTFMaterialsUnlitExtension.prototype.extendParams = function ( materialParams, materialDef, parser ) {\n\n\t\tvar pending = [];\n\n\t\tmaterialParams.color = new Color( 1.0, 1.0, 1.0 );\n\t\tmaterialParams.opacity = 1.0;\n\n\t\tvar metallicRoughness = materialDef.pbrMetallicRoughness;\n\n\t\tif ( metallicRoughness ) {\n\n\t\t\tif ( Array.isArray( metallicRoughness.baseColorFactor ) ) {\n\n\t\t\t\tvar array = metallicRoughness.baseColorFactor;\n\n\t\t\t\tmaterialParams.color.fromArray( array );\n\t\t\t\tmaterialParams.opacity = array[ 3 ];\n\n\t\t\t}\n\n\t\t\tif ( metallicRoughness.baseColorTexture !== undefined ) {\n\n\t\t\t\tpending.push( parser.assignTexture( materialParams, 'map', metallicRoughness.baseColorTexture ) );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t};\n\n\t/**\n\t * Clearcoat Materials Extension\n\t *\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_clearcoat\n\t */\n\tfunction GLTFMaterialsClearcoatExtension() {\n\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_CLEARCOAT;\n\n\t}\n\n\tGLTFMaterialsClearcoatExtension.prototype.getMaterialType = function () {\n\n\t\treturn MeshPhysicalMaterial;\n\n\t};\n\n\tGLTFMaterialsClearcoatExtension.prototype.extendParams = function ( materialParams, materialDef, parser ) {\n\n\t\tvar pending = [];\n\n\t\tvar extension = materialDef.extensions[ this.name ];\n\n\t\tif ( extension.clearcoatFactor !== undefined ) {\n\n\t\t\tmaterialParams.clearcoat = extension.clearcoatFactor;\n\n\t\t}\n\n\t\tif ( extension.clearcoatTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'clearcoatMap', extension.clearcoatTexture ) );\n\n\t\t}\n\n\t\tif ( extension.clearcoatRoughnessFactor !== undefined ) {\n\n\t\t\tmaterialParams.clearcoatRoughness = extension.clearcoatRoughnessFactor;\n\n\t\t}\n\n\t\tif ( extension.clearcoatRoughnessTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'clearcoatRoughnessMap', extension.clearcoatRoughnessTexture ) );\n\n\t\t}\n\n\t\tif ( extension.clearcoatNormalTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'clearcoatNormalMap', extension.clearcoatNormalTexture ) );\n\n\t\t\tif ( extension.clearcoatNormalTexture.scale !== undefined ) {\n\n\t\t\t\tvar scale = extension.clearcoatNormalTexture.scale;\n\n\t\t\t\tmaterialParams.clearcoatNormalScale = new Vector2( scale, scale );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t};\n\n\t/* BINARY EXTENSION */\n\tvar BINARY_EXTENSION_HEADER_MAGIC = 'glTF';\n\tvar BINARY_EXTENSION_HEADER_LENGTH = 12;\n\tvar BINARY_EXTENSION_CHUNK_TYPES = { JSON: 0x4E4F534A, BIN: 0x004E4942 };\n\n\tfunction GLTFBinaryExtension( data ) {\n\n\t\tthis.name = EXTENSIONS.KHR_BINARY_GLTF;\n\t\tthis.content = null;\n\t\tthis.body = null;\n\n\t\tvar headerView = new DataView( data, 0, BINARY_EXTENSION_HEADER_LENGTH );\n\n\t\tthis.header = {\n\t\t\tmagic: LoaderUtils.decodeText( new Uint8Array( data.slice( 0, 4 ) ) ),\n\t\t\tversion: headerView.getUint32( 4, true ),\n\t\t\tlength: headerView.getUint32( 8, true )\n\t\t};\n\n\t\tif ( this.header.magic !== BINARY_EXTENSION_HEADER_MAGIC ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: Unsupported glTF-Binary header.' );\n\n\t\t} else if ( this.header.version < 2.0 ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: Legacy binary file detected.' );\n\n\t\t}\n\n\t\tvar chunkView = new DataView( data, BINARY_EXTENSION_HEADER_LENGTH );\n\t\tvar chunkIndex = 0;\n\n\t\twhile ( chunkIndex < chunkView.byteLength ) {\n\n\t\t\tvar chunkLength = chunkView.getUint32( chunkIndex, true );\n\t\t\tchunkIndex += 4;\n\n\t\t\tvar chunkType = chunkView.getUint32( chunkIndex, true );\n\t\t\tchunkIndex += 4;\n\n\t\t\tif ( chunkType === BINARY_EXTENSION_CHUNK_TYPES.JSON ) {\n\n\t\t\t\tvar contentArray = new Uint8Array( data, BINARY_EXTENSION_HEADER_LENGTH + chunkIndex, chunkLength );\n\t\t\t\tthis.content = LoaderUtils.decodeText( contentArray );\n\n\t\t\t} else if ( chunkType === BINARY_EXTENSION_CHUNK_TYPES.BIN ) {\n\n\t\t\t\tvar byteOffset = BINARY_EXTENSION_HEADER_LENGTH + chunkIndex;\n\t\t\t\tthis.body = data.slice( byteOffset, byteOffset + chunkLength );\n\n\t\t\t}\n\n\t\t\t// Clients must ignore chunks with unknown types.\n\n\t\t\tchunkIndex += chunkLength;\n\n\t\t}\n\n\t\tif ( this.content === null ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: JSON content not found.' );\n\n\t\t}\n\n\t}\n\n\t/**\n\t * DRACO Mesh Compression Extension\n\t *\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_draco_mesh_compression\n\t */\n\tfunction GLTFDracoMeshCompressionExtension( json, dracoLoader ) {\n\n\t\tif ( ! dracoLoader ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: No DRACOLoader instance provided.' );\n\n\t\t}\n\n\t\tthis.name = EXTENSIONS.KHR_DRACO_MESH_COMPRESSION;\n\t\tthis.json = json;\n\t\tthis.dracoLoader = dracoLoader;\n\t\tthis.dracoLoader.preload();\n\n\t}\n\n\tGLTFDracoMeshCompressionExtension.prototype.decodePrimitive = function ( primitive, parser ) {\n\n\t\tvar json = this.json;\n\t\tvar dracoLoader = this.dracoLoader;\n\t\tvar bufferViewIndex = primitive.extensions[ this.name ].bufferView;\n\t\tvar gltfAttributeMap = primitive.extensions[ this.name ].attributes;\n\t\tvar threeAttributeMap = {};\n\t\tvar attributeNormalizedMap = {};\n\t\tvar attributeTypeMap = {};\n\n\t\tfor ( var attributeName in gltfAttributeMap ) {\n\n\t\t\tvar threeAttributeName = ATTRIBUTES[ attributeName ] || attributeName.toLowerCase();\n\n\t\t\tthreeAttributeMap[ threeAttributeName ] = gltfAttributeMap[ attributeName ];\n\n\t\t}\n\n\t\tfor ( attributeName in primitive.attributes ) {\n\n\t\t\tvar threeAttributeName = ATTRIBUTES[ attributeName ] || attributeName.toLowerCase();\n\n\t\t\tif ( gltfAttributeMap[ attributeName ] !== undefined ) {\n\n\t\t\t\tvar accessorDef = json.accessors[ primitive.attributes[ attributeName ] ];\n\t\t\t\tvar componentType = WEBGL_COMPONENT_TYPES[ accessorDef.componentType ];\n\n\t\t\t\tattributeTypeMap[ threeAttributeName ] = componentType;\n\t\t\t\tattributeNormalizedMap[ threeAttributeName ] = accessorDef.normalized === true;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn parser.getDependency( 'bufferView', bufferViewIndex ).then( function ( bufferView ) {\n\n\t\t\treturn new Promise( function ( resolve ) {\n\n\t\t\t\tdracoLoader.decodeDracoFile( bufferView, function ( geometry ) {\n\n\t\t\t\t\tfor ( var attributeName in geometry.attributes ) {\n\n\t\t\t\t\t\tvar attribute = geometry.attributes[ attributeName ];\n\t\t\t\t\t\tvar normalized = attributeNormalizedMap[ attributeName ];\n\n\t\t\t\t\t\tif ( normalized !== undefined ) attribute.normalized = normalized;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tresolve( geometry );\n\n\t\t\t\t}, threeAttributeMap, attributeTypeMap );\n\n\t\t\t} );\n\n\t\t} );\n\n\t};\n\n\t/**\n\t * Texture Transform Extension\n\t *\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_texture_transform\n\t */\n\tfunction GLTFTextureTransformExtension() {\n\n\t\tthis.name = EXTENSIONS.KHR_TEXTURE_TRANSFORM;\n\n\t}\n\n\tGLTFTextureTransformExtension.prototype.extendTexture = function ( texture, transform ) {\n\n\t\ttexture = texture.clone();\n\n\t\tif ( transform.offset !== undefined ) {\n\n\t\t\ttexture.offset.fromArray( transform.offset );\n\n\t\t}\n\n\t\tif ( transform.rotation !== undefined ) {\n\n\t\t\ttexture.rotation = transform.rotation;\n\n\t\t}\n\n\t\tif ( transform.scale !== undefined ) {\n\n\t\t\ttexture.repeat.fromArray( transform.scale );\n\n\t\t}\n\n\t\tif ( transform.texCoord !== undefined ) {\n\n\t\t\tconsole.warn( 'THREE.GLTFLoader: Custom UV sets in \"' + this.name + '\" extension not yet supported.' );\n\n\t\t}\n\n\t\ttexture.needsUpdate = true;\n\n\t\treturn texture;\n\n\t};\n\n\t/**\n\t * Specular-Glossiness Extension\n\t *\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_pbrSpecularGlossiness\n\t */\n\n\t/**\n\t * A sub class of StandardMaterial with some of the functionality\n\t * changed via the `onBeforeCompile` callback\n\t * @pailhead\n\t */\n\n\tfunction GLTFMeshStandardSGMaterial( params ) {\n\n\t\tMeshStandardMaterial.call( this );\n\n\t\tthis.isGLTFSpecularGlossinessMaterial = true;\n\n\t\t//various chunks that need replacing\n\t\tvar specularMapParsFragmentChunk = [\n\t\t\t'#ifdef USE_SPECULARMAP',\n\t\t\t'\tuniform sampler2D specularMap;',\n\t\t\t'#endif'\n\t\t].join( '\\n' );\n\n\t\tvar glossinessMapParsFragmentChunk = [\n\t\t\t'#ifdef USE_GLOSSINESSMAP',\n\t\t\t'\tuniform sampler2D glossinessMap;',\n\t\t\t'#endif'\n\t\t].join( '\\n' );\n\n\t\tvar specularMapFragmentChunk = [\n\t\t\t'vec3 specularFactor = specular;',\n\t\t\t'#ifdef USE_SPECULARMAP',\n\t\t\t'\tvec4 texelSpecular = texture2D( specularMap, vUv );',\n\t\t\t'\ttexelSpecular = sRGBToLinear( texelSpecular );',\n\t\t\t'\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture',\n\t\t\t'\tspecularFactor *= texelSpecular.rgb;',\n\t\t\t'#endif'\n\t\t].join( '\\n' );\n\n\t\tvar glossinessMapFragmentChunk = [\n\t\t\t'float glossinessFactor = glossiness;',\n\t\t\t'#ifdef USE_GLOSSINESSMAP',\n\t\t\t'\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );',\n\t\t\t'\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture',\n\t\t\t'\tglossinessFactor *= texelGlossiness.a;',\n\t\t\t'#endif'\n\t\t].join( '\\n' );\n\n\t\tvar lightPhysicalFragmentChunk = [\n\t\t\t'PhysicalMaterial material;',\n\t\t\t'material.diffuseColor = diffuseColor.rgb;',\n\t\t\t'vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );',\n\t\t\t'float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );',\n\t\t\t'material.specularRoughness = max( 1.0 - glossinessFactor, 0.0525 );// 0.0525 corresponds to the base mip of a 256 cubemap.',\n\t\t\t'material.specularRoughness += geometryRoughness;',\n\t\t\t'material.specularRoughness = min( material.specularRoughness, 1.0 );',\n\t\t\t'material.specularColor = specularFactor.rgb;',\n\t\t].join( '\\n' );\n\n\t\tvar uniforms = {\n\t\t\tspecular: { value: new Color().setHex( 0xffffff ) },\n\t\t\tglossiness: { value: 1 },\n\t\t\tspecularMap: { value: null },\n\t\t\tglossinessMap: { value: null }\n\t\t};\n\n\t\tthis._extraUniforms = uniforms;\n\n\t\t// please see #14031 or #13198 for an alternate approach\n\t\tthis.onBeforeCompile = function ( shader ) {\n\n\t\t\tfor ( var uniformName in uniforms ) {\n\n\t\t\t\tshader.uniforms[ uniformName ] = uniforms[ uniformName ];\n\n\t\t\t}\n\n\t\t\tshader.fragmentShader = shader.fragmentShader.replace( 'uniform float roughness;', 'uniform vec3 specular;' );\n\t\t\tshader.fragmentShader = shader.fragmentShader.replace( 'uniform float metalness;', 'uniform float glossiness;' );\n\t\t\tshader.fragmentShader = shader.fragmentShader.replace( '#include <roughnessmap_pars_fragment>', specularMapParsFragmentChunk );\n\t\t\tshader.fragmentShader = shader.fragmentShader.replace( '#include <metalnessmap_pars_fragment>', glossinessMapParsFragmentChunk );\n\t\t\tshader.fragmentShader = shader.fragmentShader.replace( '#include <roughnessmap_fragment>', specularMapFragmentChunk );\n\t\t\tshader.fragmentShader = shader.fragmentShader.replace( '#include <metalnessmap_fragment>', glossinessMapFragmentChunk );\n\t\t\tshader.fragmentShader = shader.fragmentShader.replace( '#include <lights_physical_fragment>', lightPhysicalFragmentChunk );\n\n\t\t};\n\n\t\t/*eslint-disable*/\n\t\tObject.defineProperties(\n\t\t\tthis,\n\t\t\t{\n\t\t\t\tspecular: {\n\t\t\t\t\tget: function () { return uniforms.specular.value; },\n\t\t\t\t\tset: function ( v ) { uniforms.specular.value = v; }\n\t\t\t\t},\n\t\t\t\tspecularMap: {\n\t\t\t\t\tget: function () { return uniforms.specularMap.value; },\n\t\t\t\t\tset: function ( v ) { uniforms.specularMap.value = v; }\n\t\t\t\t},\n\t\t\t\tglossiness: {\n\t\t\t\t\tget: function () { return uniforms.glossiness.value; },\n\t\t\t\t\tset: function ( v ) { uniforms.glossiness.value = v; }\n\t\t\t\t},\n\t\t\t\tglossinessMap: {\n\t\t\t\t\tget: function () { return uniforms.glossinessMap.value; },\n\t\t\t\t\tset: function ( v ) {\n\n\t\t\t\t\t\tuniforms.glossinessMap.value = v;\n\t\t\t\t\t\t//how about something like this - @pailhead\n\t\t\t\t\t\tif ( v ) {\n\n\t\t\t\t\t\t\tthis.defines.USE_GLOSSINESSMAP = '';\n\t\t\t\t\t\t\t// set USE_ROUGHNESSMAP to enable vUv\n\t\t\t\t\t\t\tthis.defines.USE_ROUGHNESSMAP = '';\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tdelete this.defines.USE_ROUGHNESSMAP;\n\t\t\t\t\t\t\tdelete this.defines.USE_GLOSSINESSMAP;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\n\t\t/*eslint-enable*/\n\t\tdelete this.metalness;\n\t\tdelete this.roughness;\n\t\tdelete this.metalnessMap;\n\t\tdelete this.roughnessMap;\n\n\t\tthis.setValues( params );\n\n\t}\n\n\tGLTFMeshStandardSGMaterial.prototype = Object.create( MeshStandardMaterial.prototype );\n\tGLTFMeshStandardSGMaterial.prototype.constructor = GLTFMeshStandardSGMaterial;\n\n\tGLTFMeshStandardSGMaterial.prototype.copy = function ( source ) {\n\n\t\tMeshStandardMaterial.prototype.copy.call( this, source );\n\t\tthis.specularMap = source.specularMap;\n\t\tthis.specular.copy( source.specular );\n\t\tthis.glossinessMap = source.glossinessMap;\n\t\tthis.glossiness = source.glossiness;\n\t\tdelete this.metalness;\n\t\tdelete this.roughness;\n\t\tdelete this.metalnessMap;\n\t\tdelete this.roughnessMap;\n\t\treturn this;\n\n\t};\n\n\tfunction GLTFMaterialsPbrSpecularGlossinessExtension() {\n\n\t\treturn {\n\n\t\t\tname: EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,\n\n\t\t\tspecularGlossinessParams: [\n\t\t\t\t'color',\n\t\t\t\t'map',\n\t\t\t\t'lightMap',\n\t\t\t\t'lightMapIntensity',\n\t\t\t\t'aoMap',\n\t\t\t\t'aoMapIntensity',\n\t\t\t\t'emissive',\n\t\t\t\t'emissiveIntensity',\n\t\t\t\t'emissiveMap',\n\t\t\t\t'bumpMap',\n\t\t\t\t'bumpScale',\n\t\t\t\t'normalMap',\n\t\t\t\t'normalMapType',\n\t\t\t\t'displacementMap',\n\t\t\t\t'displacementScale',\n\t\t\t\t'displacementBias',\n\t\t\t\t'specularMap',\n\t\t\t\t'specular',\n\t\t\t\t'glossinessMap',\n\t\t\t\t'glossiness',\n\t\t\t\t'alphaMap',\n\t\t\t\t'envMap',\n\t\t\t\t'envMapIntensity',\n\t\t\t\t'refractionRatio',\n\t\t\t],\n\n\t\t\tgetMaterialType: function () {\n\n\t\t\t\treturn GLTFMeshStandardSGMaterial;\n\n\t\t\t},\n\n\t\t\textendParams: function ( materialParams, materialDef, parser ) {\n\n\t\t\t\tvar pbrSpecularGlossiness = materialDef.extensions[ this.name ];\n\n\t\t\t\tmaterialParams.color = new Color( 1.0, 1.0, 1.0 );\n\t\t\t\tmaterialParams.opacity = 1.0;\n\n\t\t\t\tvar pending = [];\n\n\t\t\t\tif ( Array.isArray( pbrSpecularGlossiness.diffuseFactor ) ) {\n\n\t\t\t\t\tvar array = pbrSpecularGlossiness.diffuseFactor;\n\n\t\t\t\t\tmaterialParams.color.fromArray( array );\n\t\t\t\t\tmaterialParams.opacity = array[ 3 ];\n\n\t\t\t\t}\n\n\t\t\t\tif ( pbrSpecularGlossiness.diffuseTexture !== undefined ) {\n\n\t\t\t\t\tpending.push( parser.assignTexture( materialParams, 'map', pbrSpecularGlossiness.diffuseTexture ) );\n\n\t\t\t\t}\n\n\t\t\t\tmaterialParams.emissive = new Color( 0.0, 0.0, 0.0 );\n\t\t\t\tmaterialParams.glossiness = pbrSpecularGlossiness.glossinessFactor !== undefined ? pbrSpecularGlossiness.glossinessFactor : 1.0;\n\t\t\t\tmaterialParams.specular = new Color( 1.0, 1.0, 1.0 );\n\n\t\t\t\tif ( Array.isArray( pbrSpecularGlossiness.specularFactor ) ) {\n\n\t\t\t\t\tmaterialParams.specular.fromArray( pbrSpecularGlossiness.specularFactor );\n\n\t\t\t\t}\n\n\t\t\t\tif ( pbrSpecularGlossiness.specularGlossinessTexture !== undefined ) {\n\n\t\t\t\t\tvar specGlossMapDef = pbrSpecularGlossiness.specularGlossinessTexture;\n\t\t\t\t\tpending.push( parser.assignTexture( materialParams, 'glossinessMap', specGlossMapDef ) );\n\t\t\t\t\tpending.push( parser.assignTexture( materialParams, 'specularMap', specGlossMapDef ) );\n\n\t\t\t\t}\n\n\t\t\t\treturn Promise.all( pending );\n\n\t\t\t},\n\n\t\t\tcreateMaterial: function ( materialParams ) {\n\n\t\t\t\tvar material = new GLTFMeshStandardSGMaterial( materialParams );\n\t\t\t\tmaterial.fog = true;\n\n\t\t\t\tmaterial.color = materialParams.color;\n\n\t\t\t\tmaterial.map = materialParams.map === undefined ? null : materialParams.map;\n\n\t\t\t\tmaterial.lightMap = null;\n\t\t\t\tmaterial.lightMapIntensity = 1.0;\n\n\t\t\t\tmaterial.aoMap = materialParams.aoMap === undefined ? null : materialParams.aoMap;\n\t\t\t\tmaterial.aoMapIntensity = 1.0;\n\n\t\t\t\tmaterial.emissive = materialParams.emissive;\n\t\t\t\tmaterial.emissiveIntensity = 1.0;\n\t\t\t\tmaterial.emissiveMap = materialParams.emissiveMap === undefined ? null : materialParams.emissiveMap;\n\n\t\t\t\tmaterial.bumpMap = materialParams.bumpMap === undefined ? null : materialParams.bumpMap;\n\t\t\t\tmaterial.bumpScale = 1;\n\n\t\t\t\tmaterial.normalMap = materialParams.normalMap === undefined ? null : materialParams.normalMap;\n\t\t\t\tmaterial.normalMapType = TangentSpaceNormalMap;\n\n\t\t\t\tif ( materialParams.normalScale ) material.normalScale = materialParams.normalScale;\n\n\t\t\t\tmaterial.displacementMap = null;\n\t\t\t\tmaterial.displacementScale = 1;\n\t\t\t\tmaterial.displacementBias = 0;\n\n\t\t\t\tmaterial.specularMap = materialParams.specularMap === undefined ? null : materialParams.specularMap;\n\t\t\t\tmaterial.specular = materialParams.specular;\n\n\t\t\t\tmaterial.glossinessMap = materialParams.glossinessMap === undefined ? null : materialParams.glossinessMap;\n\t\t\t\tmaterial.glossiness = materialParams.glossiness;\n\n\t\t\t\tmaterial.alphaMap = null;\n\n\t\t\t\tmaterial.envMap = materialParams.envMap === undefined ? null : materialParams.envMap;\n\t\t\t\tmaterial.envMapIntensity = 1.0;\n\n\t\t\t\tmaterial.refractionRatio = 0.98;\n\n\t\t\t\treturn material;\n\n\t\t\t},\n\n\t\t};\n\n\t}\n\n\t/**\n\t * Mesh Quantization Extension\n\t *\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_mesh_quantization\n\t */\n\tfunction GLTFMeshQuantizationExtension() {\n\n\t\tthis.name = EXTENSIONS.KHR_MESH_QUANTIZATION;\n\n\t}\n\n\t/*********************************/\n\t/********** INTERPOLATION ********/\n\t/*********************************/\n\n\t// Spline Interpolation\n\t// Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#appendix-c-spline-interpolation\n\tfunction GLTFCubicSplineInterpolant( parameterPositions, sampleValues, sampleSize, resultBuffer ) {\n\n\t\tInterpolant.call( this, parameterPositions, sampleValues, sampleSize, resultBuffer );\n\n\t}\n\n\tGLTFCubicSplineInterpolant.prototype = Object.create( Interpolant.prototype );\n\tGLTFCubicSplineInterpolant.prototype.constructor = GLTFCubicSplineInterpolant;\n\n\tGLTFCubicSplineInterpolant.prototype.copySampleValue_ = function ( index ) {\n\n\t\t// Copies a sample value to the result buffer. See description of glTF\n\t\t// CUBICSPLINE values layout in interpolate_() function below.\n\n\t\tvar result = this.resultBuffer,\n\t\t\tvalues = this.sampleValues,\n\t\t\tvalueSize = this.valueSize,\n\t\t\toffset = index * valueSize * 3 + valueSize;\n\n\t\tfor ( var i = 0; i !== valueSize; i ++ ) {\n\n\t\t\tresult[ i ] = values[ offset + i ];\n\n\t\t}\n\n\t\treturn result;\n\n\t};\n\n\tGLTFCubicSplineInterpolant.prototype.beforeStart_ = GLTFCubicSplineInterpolant.prototype.copySampleValue_;\n\n\tGLTFCubicSplineInterpolant.prototype.afterEnd_ = GLTFCubicSplineInterpolant.prototype.copySampleValue_;\n\n\tGLTFCubicSplineInterpolant.prototype.interpolate_ = function ( i1, t0, t, t1 ) {\n\n\t\tvar result = this.resultBuffer;\n\t\tvar values = this.sampleValues;\n\t\tvar stride = this.valueSize;\n\n\t\tvar stride2 = stride * 2;\n\t\tvar stride3 = stride * 3;\n\n\t\tvar td = t1 - t0;\n\n\t\tvar p = ( t - t0 ) / td;\n\t\tvar pp = p * p;\n\t\tvar ppp = pp * p;\n\n\t\tvar offset1 = i1 * stride3;\n\t\tvar offset0 = offset1 - stride3;\n\n\t\tvar s2 = - 2 * ppp + 3 * pp;\n\t\tvar s3 = ppp - pp;\n\t\tvar s0 = 1 - s2;\n\t\tvar s1 = s3 - pp + p;\n\n\t\t// Layout of keyframe output values for CUBICSPLINE animations:\n\t\t//   [ inTangent_1, splineVertex_1, outTangent_1, inTangent_2, splineVertex_2, ... ]\n\t\tfor ( var i = 0; i !== stride; i ++ ) {\n\n\t\t\tvar p0 = values[ offset0 + i + stride ]; // splineVertex_k\n\t\t\tvar m0 = values[ offset0 + i + stride2 ] * td; // outTangent_k * (t_k+1 - t_k)\n\t\t\tvar p1 = values[ offset1 + i + stride ]; // splineVertex_k+1\n\t\t\tvar m1 = values[ offset1 + i ] * td; // inTangent_k+1 * (t_k+1 - t_k)\n\n\t\t\tresult[ i ] = s0 * p0 + s1 * m0 + s2 * p1 + s3 * m1;\n\n\t\t}\n\n\t\treturn result;\n\n\t};\n\n\t/*********************************/\n\t/********** INTERNALS ************/\n\t/*********************************/\n\n\t/* CONSTANTS */\n\n\tvar WEBGL_CONSTANTS = {\n\t\tFLOAT: 5126,\n\t\t//FLOAT_MAT2: 35674,\n\t\tFLOAT_MAT3: 35675,\n\t\tFLOAT_MAT4: 35676,\n\t\tFLOAT_VEC2: 35664,\n\t\tFLOAT_VEC3: 35665,\n\t\tFLOAT_VEC4: 35666,\n\t\tLINEAR: 9729,\n\t\tREPEAT: 10497,\n\t\tSAMPLER_2D: 35678,\n\t\tPOINTS: 0,\n\t\tLINES: 1,\n\t\tLINE_LOOP: 2,\n\t\tLINE_STRIP: 3,\n\t\tTRIANGLES: 4,\n\t\tTRIANGLE_STRIP: 5,\n\t\tTRIANGLE_FAN: 6,\n\t\tUNSIGNED_BYTE: 5121,\n\t\tUNSIGNED_SHORT: 5123\n\t};\n\n\tvar WEBGL_COMPONENT_TYPES = {\n\t\t5120: Int8Array,\n\t\t5121: Uint8Array,\n\t\t5122: Int16Array,\n\t\t5123: Uint16Array,\n\t\t5125: Uint32Array,\n\t\t5126: Float32Array\n\t};\n\n\tvar WEBGL_FILTERS = {\n\t\t9728: NearestFilter,\n\t\t9729: LinearFilter,\n\t\t9984: NearestMipmapNearestFilter,\n\t\t9985: LinearMipmapNearestFilter,\n\t\t9986: NearestMipmapLinearFilter,\n\t\t9987: LinearMipmapLinearFilter\n\t};\n\n\tvar WEBGL_WRAPPINGS = {\n\t\t33071: ClampToEdgeWrapping,\n\t\t33648: MirroredRepeatWrapping,\n\t\t10497: RepeatWrapping\n\t};\n\n\tvar WEBGL_TYPE_SIZES = {\n\t\t'SCALAR': 1,\n\t\t'VEC2': 2,\n\t\t'VEC3': 3,\n\t\t'VEC4': 4,\n\t\t'MAT2': 4,\n\t\t'MAT3': 9,\n\t\t'MAT4': 16\n\t};\n\n\tvar ATTRIBUTES = {\n\t\tPOSITION: 'position',\n\t\tNORMAL: 'normal',\n\t\tTANGENT: 'tangent',\n\t\tTEXCOORD_0: 'uv',\n\t\tTEXCOORD_1: 'uv2',\n\t\tCOLOR_0: 'color',\n\t\tWEIGHTS_0: 'skinWeight',\n\t\tJOINTS_0: 'skinIndex',\n\t};\n\n\tvar PATH_PROPERTIES = {\n\t\tscale: 'scale',\n\t\ttranslation: 'position',\n\t\trotation: 'quaternion',\n\t\tweights: 'morphTargetInfluences'\n\t};\n\n\tvar INTERPOLATION = {\n\t\tCUBICSPLINE: undefined, // We use a custom interpolant (GLTFCubicSplineInterpolation) for CUBICSPLINE tracks. Each\n\t\t                        // keyframe track will be initialized with a default interpolation type, then modified.\n\t\tLINEAR: InterpolateLinear,\n\t\tSTEP: InterpolateDiscrete\n\t};\n\n\tvar ALPHA_MODES = {\n\t\tOPAQUE: 'OPAQUE',\n\t\tMASK: 'MASK',\n\t\tBLEND: 'BLEND'\n\t};\n\n\tvar MIME_TYPE_FORMATS = {\n\t\t'image/png': RGBAFormat,\n\t\t'image/jpeg': RGBFormat\n\t};\n\n\t/* UTILITY FUNCTIONS */\n\n\tfunction resolveURL( url, path ) {\n\n\t\t// Invalid URL\n\t\tif ( typeof url !== 'string' || url === '' ) return '';\n\n\t\t// Host Relative URL\n\t\tif ( /^https?:\\/\\//i.test( path ) && /^\\//.test( url ) ) {\n\n\t\t\tpath = path.replace( /(^https?:\\/\\/[^\\/]+).*/i, '$1' );\n\n\t\t}\n\n\t\t// Absolute URL http://,https://,//\n\t\tif ( /^(https?:)?\\/\\//i.test( url ) ) return url;\n\n\t\t// Data URI\n\t\tif ( /^data:.*,.*$/i.test( url ) ) return url;\n\n\t\t// Blob URL\n\t\tif ( /^blob:.*$/i.test( url ) ) return url;\n\n\t\t// Relative URL\n\t\treturn path + url;\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#default-material\n\t */\n\tfunction createDefaultMaterial( cache ) {\n\n\t\tif ( cache[ 'DefaultMaterial' ] === undefined ) {\n\n\t\t\tcache[ 'DefaultMaterial' ] = new MeshStandardMaterial( {\n\t\t\t\tcolor: 0xFFFFFF,\n\t\t\t\temissive: 0x000000,\n\t\t\t\tmetalness: 1,\n\t\t\t\troughness: 1,\n\t\t\t\ttransparent: false,\n\t\t\t\tdepthTest: true,\n\t\t\t\tside: FrontSide\n\t\t\t} );\n\n\t\t}\n\n\t\treturn cache[ 'DefaultMaterial' ];\n\n\t}\n\n\tfunction addUnknownExtensionsToUserData( knownExtensions, object, objectDef ) {\n\n\t\t// Add unknown glTF extensions to an object's userData.\n\n\t\tfor ( var name in objectDef.extensions ) {\n\n\t\t\tif ( knownExtensions[ name ] === undefined ) {\n\n\t\t\t\tobject.userData.gltfExtensions = object.userData.gltfExtensions || {};\n\t\t\t\tobject.userData.gltfExtensions[ name ] = objectDef.extensions[ name ];\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t/**\n\t * @param {Object3D|Material|BufferGeometry} object\n\t * @param {GLTF.definition} gltfDef\n\t */\n\tfunction assignExtrasToUserData( object, gltfDef ) {\n\n\t\tif ( gltfDef.extras !== undefined ) {\n\n\t\t\tif ( typeof gltfDef.extras === 'object' ) {\n\n\t\t\t\tObject.assign( object.userData, gltfDef.extras );\n\n\t\t\t} else {\n\n\t\t\t\tconsole.warn( 'THREE.GLTFLoader: Ignoring primitive type .extras, ' + gltfDef.extras );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#morph-targets\n\t *\n\t * @param {BufferGeometry} geometry\n\t * @param {Array<GLTF.Target>} targets\n\t * @param {GLTFParser} parser\n\t * @return {Promise<BufferGeometry>}\n\t */\n\tfunction addMorphTargets( geometry, targets, parser ) {\n\n\t\tvar hasMorphPosition = false;\n\t\tvar hasMorphNormal = false;\n\n\t\tfor ( var i = 0, il = targets.length; i < il; i ++ ) {\n\n\t\t\tvar target = targets[ i ];\n\n\t\t\tif ( target.POSITION !== undefined ) hasMorphPosition = true;\n\t\t\tif ( target.NORMAL !== undefined ) hasMorphNormal = true;\n\n\t\t\tif ( hasMorphPosition && hasMorphNormal ) break;\n\n\t\t}\n\n\t\tif ( ! hasMorphPosition && ! hasMorphNormal ) return Promise.resolve( geometry );\n\n\t\tvar pendingPositionAccessors = [];\n\t\tvar pendingNormalAccessors = [];\n\n\t\tfor ( var i = 0, il = targets.length; i < il; i ++ ) {\n\n\t\t\tvar target = targets[ i ];\n\n\t\t\tif ( hasMorphPosition ) {\n\n\t\t\t\tvar pendingAccessor = target.POSITION !== undefined\n\t\t\t\t\t? parser.getDependency( 'accessor', target.POSITION )\n\t\t\t\t\t: geometry.attributes.position;\n\n\t\t\t\tpendingPositionAccessors.push( pendingAccessor );\n\n\t\t\t}\n\n\t\t\tif ( hasMorphNormal ) {\n\n\t\t\t\tvar pendingAccessor = target.NORMAL !== undefined\n\t\t\t\t\t? parser.getDependency( 'accessor', target.NORMAL )\n\t\t\t\t\t: geometry.attributes.normal;\n\n\t\t\t\tpendingNormalAccessors.push( pendingAccessor );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn Promise.all( [\n\t\t\tPromise.all( pendingPositionAccessors ),\n\t\t\tPromise.all( pendingNormalAccessors )\n\t\t] ).then( function ( accessors ) {\n\n\t\t\tvar morphPositions = accessors[ 0 ];\n\t\t\tvar morphNormals = accessors[ 1 ];\n\n\t\t\tif ( hasMorphPosition ) geometry.morphAttributes.position = morphPositions;\n\t\t\tif ( hasMorphNormal ) geometry.morphAttributes.normal = morphNormals;\n\t\t\tgeometry.morphTargetsRelative = true;\n\n\t\t\treturn geometry;\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * @param {Mesh} mesh\n\t * @param {GLTF.Mesh} meshDef\n\t */\n\tfunction updateMorphTargets( mesh, meshDef ) {\n\n\t\tmesh.updateMorphTargets();\n\n\t\tif ( meshDef.weights !== undefined ) {\n\n\t\t\tfor ( var i = 0, il = meshDef.weights.length; i < il; i ++ ) {\n\n\t\t\t\tmesh.morphTargetInfluences[ i ] = meshDef.weights[ i ];\n\n\t\t\t}\n\n\t\t}\n\n\t\t// .extras has user-defined data, so check that .extras.targetNames is an array.\n\t\tif ( meshDef.extras && Array.isArray( meshDef.extras.targetNames ) ) {\n\n\t\t\tvar targetNames = meshDef.extras.targetNames;\n\n\t\t\tif ( mesh.morphTargetInfluences.length === targetNames.length ) {\n\n\t\t\t\tmesh.morphTargetDictionary = {};\n\n\t\t\t\tfor ( var i = 0, il = targetNames.length; i < il; i ++ ) {\n\n\t\t\t\t\tmesh.morphTargetDictionary[ targetNames[ i ] ] = i;\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tconsole.warn( 'THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.' );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tfunction createPrimitiveKey( primitiveDef ) {\n\n\t\tvar dracoExtension = primitiveDef.extensions && primitiveDef.extensions[ EXTENSIONS.KHR_DRACO_MESH_COMPRESSION ];\n\t\tvar geometryKey;\n\n\t\tif ( dracoExtension ) {\n\n\t\t\tgeometryKey = 'draco:' + dracoExtension.bufferView\n\t\t\t\t+ ':' + dracoExtension.indices\n\t\t\t\t+ ':' + createAttributesKey( dracoExtension.attributes );\n\n\t\t} else {\n\n\t\t\tgeometryKey = primitiveDef.indices + ':' + createAttributesKey( primitiveDef.attributes ) + ':' + primitiveDef.mode;\n\n\t\t}\n\n\t\treturn geometryKey;\n\n\t}\n\n\tfunction createAttributesKey( attributes ) {\n\n\t\tvar attributesKey = '';\n\n\t\tvar keys = Object.keys( attributes ).sort();\n\n\t\tfor ( var i = 0, il = keys.length; i < il; i ++ ) {\n\n\t\t\tattributesKey += keys[ i ] + ':' + attributes[ keys[ i ] ] + ';';\n\n\t\t}\n\n\t\treturn attributesKey;\n\n\t}\n\n\t/* GLTF PARSER */\n\n\tfunction GLTFParser( json, extensions, options ) {\n\n\t\tthis.json = json || {};\n\t\tthis.extensions = extensions || {};\n\t\tthis.options = options || {};\n\n\t\t// loader object cache\n\t\tthis.cache = new GLTFRegistry();\n\n\t\t// associations between Three.js objects and glTF elements\n\t\tthis.associations = new Map();\n\n\t\t// BufferGeometry caching\n\t\tthis.primitiveCache = {};\n\n\t\tthis.textureLoader = new TextureLoader( this.options.manager );\n\t\tthis.textureLoader.setCrossOrigin( this.options.crossOrigin );\n\n\t\tthis.fileLoader = new FileLoader( this.options.manager );\n\t\tthis.fileLoader.setResponseType( 'arraybuffer' );\n\n\t\tif ( this.options.crossOrigin === 'use-credentials' ) {\n\n\t\t\tthis.fileLoader.setWithCredentials( true );\n\n\t\t}\n\n\t}\n\n\tGLTFParser.prototype.parse = function ( onLoad, onError ) {\n\n\t\tvar parser = this;\n\t\tvar json = this.json;\n\t\tvar extensions = this.extensions;\n\n\t\t// Clear the loader cache\n\t\tthis.cache.removeAll();\n\n\t\t// Mark the special nodes/meshes in json for efficient parse\n\t\tthis.markDefs();\n\n\t\tPromise.all( [\n\n\t\t\tthis.getDependencies( 'scene' ),\n\t\t\tthis.getDependencies( 'animation' ),\n\t\t\tthis.getDependencies( 'camera' ),\n\n\t\t] ).then( function ( dependencies ) {\n\n\t\t\tvar result = {\n\t\t\t\tscene: dependencies[ 0 ][ json.scene || 0 ],\n\t\t\t\tscenes: dependencies[ 0 ],\n\t\t\t\tanimations: dependencies[ 1 ],\n\t\t\t\tcameras: dependencies[ 2 ],\n\t\t\t\tasset: json.asset,\n\t\t\t\tparser: parser,\n\t\t\t\tuserData: {}\n\t\t\t};\n\n\t\t\taddUnknownExtensionsToUserData( extensions, result, json );\n\n\t\t\tassignExtrasToUserData( result, json );\n\n\t\t\tonLoad( result );\n\n\t\t} ).catch( onError );\n\n\t};\n\n\t/**\n\t * Marks the special nodes/meshes in json for efficient parse.\n\t */\n\tGLTFParser.prototype.markDefs = function () {\n\n\t\tvar nodeDefs = this.json.nodes || [];\n\t\tvar skinDefs = this.json.skins || [];\n\t\tvar meshDefs = this.json.meshes || [];\n\n\t\tvar meshReferences = {};\n\t\tvar meshUses = {};\n\n\t\t// Nothing in the node definition indicates whether it is a Bone or an\n\t\t// Object3D. Use the skins' joint references to mark bones.\n\t\tfor ( var skinIndex = 0, skinLength = skinDefs.length; skinIndex < skinLength; skinIndex ++ ) {\n\n\t\t\tvar joints = skinDefs[ skinIndex ].joints;\n\n\t\t\tfor ( var i = 0, il = joints.length; i < il; i ++ ) {\n\n\t\t\t\tnodeDefs[ joints[ i ] ].isBone = true;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// Meshes can (and should) be reused by multiple nodes in a glTF asset. To\n\t\t// avoid having more than one Mesh with the same name, count\n\t\t// references and rename instances below.\n\t\t//\n\t\t// Example: CesiumMilkTruck sample model reuses \"Wheel\" meshes.\n\t\tfor ( var nodeIndex = 0, nodeLength = nodeDefs.length; nodeIndex < nodeLength; nodeIndex ++ ) {\n\n\t\t\tvar nodeDef = nodeDefs[ nodeIndex ];\n\n\t\t\tif ( nodeDef.mesh !== undefined ) {\n\n\t\t\t\tif ( meshReferences[ nodeDef.mesh ] === undefined ) {\n\n\t\t\t\t\tmeshReferences[ nodeDef.mesh ] = meshUses[ nodeDef.mesh ] = 0;\n\n\t\t\t\t}\n\n\t\t\t\tmeshReferences[ nodeDef.mesh ] ++;\n\n\t\t\t\t// Nothing in the mesh definition indicates whether it is\n\t\t\t\t// a SkinnedMesh or Mesh. Use the node's mesh reference\n\t\t\t\t// to mark SkinnedMesh if node has skin.\n\t\t\t\tif ( nodeDef.skin !== undefined ) {\n\n\t\t\t\t\tmeshDefs[ nodeDef.mesh ].isSkinnedMesh = true;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis.json.meshReferences = meshReferences;\n\t\tthis.json.meshUses = meshUses;\n\n\t};\n\n\t/**\n\t * Requests the specified dependency asynchronously, with caching.\n\t * @param {string} type\n\t * @param {number} index\n\t * @return {Promise<Object3D|Material|THREE.Texture|AnimationClip|ArrayBuffer|Object>}\n\t */\n\tGLTFParser.prototype.getDependency = function ( type, index ) {\n\n\t\tvar cacheKey = type + ':' + index;\n\t\tvar dependency = this.cache.get( cacheKey );\n\n\t\tif ( ! dependency ) {\n\n\t\t\tswitch ( type ) {\n\n\t\t\t\tcase 'scene':\n\t\t\t\t\tdependency = this.loadScene( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'node':\n\t\t\t\t\tdependency = this.loadNode( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'mesh':\n\t\t\t\t\tdependency = this.loadMesh( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'accessor':\n\t\t\t\t\tdependency = this.loadAccessor( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'bufferView':\n\t\t\t\t\tdependency = this.loadBufferView( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'buffer':\n\t\t\t\t\tdependency = this.loadBuffer( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'material':\n\t\t\t\t\tdependency = this.loadMaterial( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'texture':\n\t\t\t\t\tdependency = this.loadTexture( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'skin':\n\t\t\t\t\tdependency = this.loadSkin( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'animation':\n\t\t\t\t\tdependency = this.loadAnimation( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'camera':\n\t\t\t\t\tdependency = this.loadCamera( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'light':\n\t\t\t\t\tdependency = this.extensions[ EXTENSIONS.KHR_LIGHTS_PUNCTUAL ].loadLight( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tthrow new Error( 'Unknown type: ' + type );\n\n\t\t\t}\n\n\t\t\tthis.cache.add( cacheKey, dependency );\n\n\t\t}\n\n\t\treturn dependency;\n\n\t};\n\n\t/**\n\t * Requests all dependencies of the specified type asynchronously, with caching.\n\t * @param {string} type\n\t * @return {Promise<Array<Object>>}\n\t */\n\tGLTFParser.prototype.getDependencies = function ( type ) {\n\n\t\tvar dependencies = this.cache.get( type );\n\n\t\tif ( ! dependencies ) {\n\n\t\t\tvar parser = this;\n\t\t\tvar defs = this.json[ type + ( type === 'mesh' ? 'es' : 's' ) ] || [];\n\n\t\t\tdependencies = Promise.all( defs.map( function ( def, index ) {\n\n\t\t\t\treturn parser.getDependency( type, index );\n\n\t\t\t} ) );\n\n\t\t\tthis.cache.add( type, dependencies );\n\n\t\t}\n\n\t\treturn dependencies;\n\n\t};\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#buffers-and-buffer-views\n\t * @param {number} bufferIndex\n\t * @return {Promise<ArrayBuffer>}\n\t */\n\tGLTFParser.prototype.loadBuffer = function ( bufferIndex ) {\n\n\t\tvar bufferDef = this.json.buffers[ bufferIndex ];\n\t\tvar loader = this.fileLoader;\n\n\t\tif ( bufferDef.type && bufferDef.type !== 'arraybuffer' ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: ' + bufferDef.type + ' buffer type is not supported.' );\n\n\t\t}\n\n\t\t// If present, GLB container is required to be the first buffer.\n\t\tif ( bufferDef.uri === undefined && bufferIndex === 0 ) {\n\n\t\t\treturn Promise.resolve( this.extensions[ EXTENSIONS.KHR_BINARY_GLTF ].body );\n\n\t\t}\n\n\t\tvar options = this.options;\n\n\t\treturn new Promise( function ( resolve, reject ) {\n\n\t\t\tloader.load( resolveURL( bufferDef.uri, options.path ), resolve, undefined, function () {\n\n\t\t\t\treject( new Error( 'THREE.GLTFLoader: Failed to load buffer \"' + bufferDef.uri + '\".' ) );\n\n\t\t\t} );\n\n\t\t} );\n\n\t};\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#buffers-and-buffer-views\n\t * @param {number} bufferViewIndex\n\t * @return {Promise<ArrayBuffer>}\n\t */\n\tGLTFParser.prototype.loadBufferView = function ( bufferViewIndex ) {\n\n\t\tvar bufferViewDef = this.json.bufferViews[ bufferViewIndex ];\n\n\t\treturn this.getDependency( 'buffer', bufferViewDef.buffer ).then( function ( buffer ) {\n\n\t\t\tvar byteLength = bufferViewDef.byteLength || 0;\n\t\t\tvar byteOffset = bufferViewDef.byteOffset || 0;\n\t\t\treturn buffer.slice( byteOffset, byteOffset + byteLength );\n\n\t\t} );\n\n\t};\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#accessors\n\t * @param {number} accessorIndex\n\t * @return {Promise<BufferAttribute|InterleavedBufferAttribute>}\n\t */\n\tGLTFParser.prototype.loadAccessor = function ( accessorIndex ) {\n\n\t\tvar parser = this;\n\t\tvar json = this.json;\n\n\t\tvar accessorDef = this.json.accessors[ accessorIndex ];\n\n\t\tif ( accessorDef.bufferView === undefined && accessorDef.sparse === undefined ) {\n\n\t\t\t// Ignore empty accessors, which may be used to declare runtime\n\t\t\t// information about attributes coming from another source (e.g. Draco\n\t\t\t// compression extension).\n\t\t\treturn Promise.resolve( null );\n\n\t\t}\n\n\t\tvar pendingBufferViews = [];\n\n\t\tif ( accessorDef.bufferView !== undefined ) {\n\n\t\t\tpendingBufferViews.push( this.getDependency( 'bufferView', accessorDef.bufferView ) );\n\n\t\t} else {\n\n\t\t\tpendingBufferViews.push( null );\n\n\t\t}\n\n\t\tif ( accessorDef.sparse !== undefined ) {\n\n\t\t\tpendingBufferViews.push( this.getDependency( 'bufferView', accessorDef.sparse.indices.bufferView ) );\n\t\t\tpendingBufferViews.push( this.getDependency( 'bufferView', accessorDef.sparse.values.bufferView ) );\n\n\t\t}\n\n\t\treturn Promise.all( pendingBufferViews ).then( function ( bufferViews ) {\n\n\t\t\tvar bufferView = bufferViews[ 0 ];\n\n\t\t\tvar itemSize = WEBGL_TYPE_SIZES[ accessorDef.type ];\n\t\t\tvar TypedArray = WEBGL_COMPONENT_TYPES[ accessorDef.componentType ];\n\n\t\t\t// For VEC3: itemSize is 3, elementBytes is 4, itemBytes is 12.\n\t\t\tvar elementBytes = TypedArray.BYTES_PER_ELEMENT;\n\t\t\tvar itemBytes = elementBytes * itemSize;\n\t\t\tvar byteOffset = accessorDef.byteOffset || 0;\n\t\t\tvar byteStride = accessorDef.bufferView !== undefined ? json.bufferViews[ accessorDef.bufferView ].byteStride : undefined;\n\t\t\tvar normalized = accessorDef.normalized === true;\n\t\t\tvar array, bufferAttribute;\n\n\t\t\t// The buffer is not interleaved if the stride is the item size in bytes.\n\t\t\tif ( byteStride && byteStride !== itemBytes ) {\n\n\t\t\t\t// Each \"slice\" of the buffer, as defined by 'count' elements of 'byteStride' bytes, gets its own InterleavedBuffer\n\t\t\t\t// This makes sure that IBA.count reflects accessor.count properly\n\t\t\t\tvar ibSlice = Math.floor( byteOffset / byteStride );\n\t\t\t\tvar ibCacheKey = 'InterleavedBuffer:' + accessorDef.bufferView + ':' + accessorDef.componentType + ':' + ibSlice + ':' + accessorDef.count;\n\t\t\t\tvar ib = parser.cache.get( ibCacheKey );\n\n\t\t\t\tif ( ! ib ) {\n\n\t\t\t\t\tarray = new TypedArray( bufferView, ibSlice * byteStride, accessorDef.count * byteStride / elementBytes );\n\n\t\t\t\t\t// Integer parameters to IB/IBA are in array elements, not bytes.\n\t\t\t\t\tib = new InterleavedBuffer( array, byteStride / elementBytes );\n\n\t\t\t\t\tparser.cache.add( ibCacheKey, ib );\n\n\t\t\t\t}\n\n\t\t\t\tbufferAttribute = new InterleavedBufferAttribute( ib, itemSize, ( byteOffset % byteStride ) / elementBytes, normalized );\n\n\t\t\t} else {\n\n\t\t\t\tif ( bufferView === null ) {\n\n\t\t\t\t\tarray = new TypedArray( accessorDef.count * itemSize );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tarray = new TypedArray( bufferView, byteOffset, accessorDef.count * itemSize );\n\n\t\t\t\t}\n\n\t\t\t\tbufferAttribute = new BufferAttribute( array, itemSize, normalized );\n\n\t\t\t}\n\n\t\t\t// https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#sparse-accessors\n\t\t\tif ( accessorDef.sparse !== undefined ) {\n\n\t\t\t\tvar itemSizeIndices = WEBGL_TYPE_SIZES.SCALAR;\n\t\t\t\tvar TypedArrayIndices = WEBGL_COMPONENT_TYPES[ accessorDef.sparse.indices.componentType ];\n\n\t\t\t\tvar byteOffsetIndices = accessorDef.sparse.indices.byteOffset || 0;\n\t\t\t\tvar byteOffsetValues = accessorDef.sparse.values.byteOffset || 0;\n\n\t\t\t\tvar sparseIndices = new TypedArrayIndices( bufferViews[ 1 ], byteOffsetIndices, accessorDef.sparse.count * itemSizeIndices );\n\t\t\t\tvar sparseValues = new TypedArray( bufferViews[ 2 ], byteOffsetValues, accessorDef.sparse.count * itemSize );\n\n\t\t\t\tif ( bufferView !== null ) {\n\n\t\t\t\t\t// Avoid modifying the original ArrayBuffer, if the bufferView wasn't initialized with zeroes.\n\t\t\t\t\tbufferAttribute = new BufferAttribute( bufferAttribute.array.slice(), bufferAttribute.itemSize, bufferAttribute.normalized );\n\n\t\t\t\t}\n\n\t\t\t\tfor ( var i = 0, il = sparseIndices.length; i < il; i ++ ) {\n\n\t\t\t\t\tvar index = sparseIndices[ i ];\n\n\t\t\t\t\tbufferAttribute.setX( index, sparseValues[ i * itemSize ] );\n\t\t\t\t\tif ( itemSize >= 2 ) bufferAttribute.setY( index, sparseValues[ i * itemSize + 1 ] );\n\t\t\t\t\tif ( itemSize >= 3 ) bufferAttribute.setZ( index, sparseValues[ i * itemSize + 2 ] );\n\t\t\t\t\tif ( itemSize >= 4 ) bufferAttribute.setW( index, sparseValues[ i * itemSize + 3 ] );\n\t\t\t\t\tif ( itemSize >= 5 ) throw new Error( 'THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.' );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn bufferAttribute;\n\n\t\t} );\n\n\t};\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#textures\n\t * @param {number} textureIndex\n\t * @return {Promise<THREE.Texture>}\n\t */\n\tGLTFParser.prototype.loadTexture = function ( textureIndex ) {\n\n\t\tvar parser = this;\n\t\tvar json = this.json;\n\t\tvar options = this.options;\n\t\tvar textureLoader = this.textureLoader;\n\n\t\tvar URL = self.URL || self.webkitURL;\n\n\t\tvar textureDef = json.textures[ textureIndex ];\n\n\t\tvar textureExtensions = textureDef.extensions || {};\n\n\t\tvar source;\n\n\t\tif ( textureExtensions[ EXTENSIONS.MSFT_TEXTURE_DDS ] ) {\n\n\t\t\tsource = json.images[ textureExtensions[ EXTENSIONS.MSFT_TEXTURE_DDS ].source ];\n\n\t\t} else {\n\n\t\t\tsource = json.images[ textureDef.source ];\n\n\t\t}\n\n\t\tvar sourceURI = source.uri;\n\t\tvar isObjectURL = false;\n\n\t\tif ( source.bufferView !== undefined ) {\n\n\t\t\t// Load binary image data from bufferView, if provided.\n\n\t\t\tsourceURI = parser.getDependency( 'bufferView', source.bufferView ).then( function ( bufferView ) {\n\n\t\t\t\tisObjectURL = true;\n\t\t\t\tvar blob = new Blob( [ bufferView ], { type: source.mimeType } );\n\t\t\t\tsourceURI = URL.createObjectURL( blob );\n\t\t\t\treturn sourceURI;\n\n\t\t\t} );\n\n\t\t}\n\n\t\treturn Promise.resolve( sourceURI ).then( function ( sourceURI ) {\n\n\t\t\t// Load Texture resource.\n\n\t\t\tvar loader = options.manager.getHandler( sourceURI );\n\n\t\t\tif ( ! loader ) {\n\n\t\t\t\tloader = textureExtensions[ EXTENSIONS.MSFT_TEXTURE_DDS ]\n\t\t\t\t\t? parser.extensions[ EXTENSIONS.MSFT_TEXTURE_DDS ].ddsLoader\n\t\t\t\t\t: textureLoader;\n\n\t\t\t}\n\n\t\t\treturn new Promise( function ( resolve, reject ) {\n\n\t\t\t\tloader.load( resolveURL( sourceURI, options.path ), resolve, undefined, reject );\n\n\t\t\t} );\n\n\t\t} ).then( function ( texture ) {\n\n\t\t\t// Clean up resources and configure Texture.\n\n\t\t\tif ( isObjectURL === true ) {\n\n\t\t\t\tURL.revokeObjectURL( sourceURI );\n\n\t\t\t}\n\n\t\t\ttexture.flipY = false;\n\n\t\t\tif ( textureDef.name ) texture.name = textureDef.name;\n\n\t\t\t// Ignore unknown mime types, like DDS files.\n\t\t\tif ( source.mimeType in MIME_TYPE_FORMATS ) {\n\n\t\t\t\ttexture.format = MIME_TYPE_FORMATS[ source.mimeType ];\n\n\t\t\t}\n\n\t\t\tvar samplers = json.samplers || {};\n\t\t\tvar sampler = samplers[ textureDef.sampler ] || {};\n\n\t\t\ttexture.magFilter = WEBGL_FILTERS[ sampler.magFilter ] || LinearFilter;\n\t\t\ttexture.minFilter = WEBGL_FILTERS[ sampler.minFilter ] || LinearMipmapLinearFilter;\n\t\t\ttexture.wrapS = WEBGL_WRAPPINGS[ sampler.wrapS ] || RepeatWrapping;\n\t\t\ttexture.wrapT = WEBGL_WRAPPINGS[ sampler.wrapT ] || RepeatWrapping;\n\n\t\t\tparser.associations.set( texture, {\n\t\t\t\ttype: 'textures',\n\t\t\t\tindex: textureIndex\n\t\t\t} );\n\n\t\t\treturn texture;\n\n\t\t} );\n\n\t};\n\n\t/**\n\t * Asynchronously assigns a texture to the given material parameters.\n\t * @param {Object} materialParams\n\t * @param {string} mapName\n\t * @param {Object} mapDef\n\t * @return {Promise}\n\t */\n\tGLTFParser.prototype.assignTexture = function ( materialParams, mapName, mapDef ) {\n\n\t\tvar parser = this;\n\n\t\treturn this.getDependency( 'texture', mapDef.index ).then( function ( texture ) {\n\n\t\t\tif ( ! texture.isCompressedTexture ) {\n\n\t\t\t\tswitch ( mapName ) {\n\n\t\t\t\t\tcase 'aoMap':\n\t\t\t\t\tcase 'emissiveMap':\n\t\t\t\t\tcase 'metalnessMap':\n\t\t\t\t\tcase 'normalMap':\n\t\t\t\t\tcase 'roughnessMap':\n\t\t\t\t\t\ttexture.format = RGBFormat;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// Materials sample aoMap from UV set 1 and other maps from UV set 0 - this can't be configured\n\t\t\t// However, we will copy UV set 0 to UV set 1 on demand for aoMap\n\t\t\tif ( mapDef.texCoord !== undefined && mapDef.texCoord != 0 && ! ( mapName === 'aoMap' && mapDef.texCoord == 1 ) ) {\n\n\t\t\t\tconsole.warn( 'THREE.GLTFLoader: Custom UV set ' + mapDef.texCoord + ' for texture ' + mapName + ' not yet supported.' );\n\n\t\t\t}\n\n\t\t\tif ( parser.extensions[ EXTENSIONS.KHR_TEXTURE_TRANSFORM ] ) {\n\n\t\t\t\tvar transform = mapDef.extensions !== undefined ? mapDef.extensions[ EXTENSIONS.KHR_TEXTURE_TRANSFORM ] : undefined;\n\n\t\t\t\tif ( transform ) {\n\n\t\t\t\t\tvar gltfReference = parser.associations.get( texture );\n\t\t\t\t\ttexture = parser.extensions[ EXTENSIONS.KHR_TEXTURE_TRANSFORM ].extendTexture( texture, transform );\n\t\t\t\t\tparser.associations.set( texture, gltfReference );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tmaterialParams[ mapName ] = texture;\n\n\t\t} );\n\n\t};\n\n\t/**\n\t * Assigns final material to a Mesh, Line, or Points instance. The instance\n\t * already has a material (generated from the glTF material options alone)\n\t * but reuse of the same glTF material may require multiple threejs materials\n\t * to accomodate different primitive types, defines, etc. New materials will\n\t * be created if necessary, and reused from a cache.\n\t * @param  {Object3D} mesh Mesh, Line, or Points instance.\n\t */\n\tGLTFParser.prototype.assignFinalMaterial = function ( mesh ) {\n\n\t\tvar geometry = mesh.geometry;\n\t\tvar material = mesh.material;\n\n\t\tvar useVertexTangents = geometry.attributes.tangent !== undefined;\n\t\tvar useVertexColors = geometry.attributes.color !== undefined;\n\t\tvar useFlatShading = geometry.attributes.normal === undefined;\n\t\tvar useSkinning = mesh.isSkinnedMesh === true;\n\t\tvar useMorphTargets = Object.keys( geometry.morphAttributes ).length > 0;\n\t\tvar useMorphNormals = useMorphTargets && geometry.morphAttributes.normal !== undefined;\n\n\t\tif ( mesh.isPoints ) {\n\n\t\t\tvar cacheKey = 'PointsMaterial:' + material.uuid;\n\n\t\t\tvar pointsMaterial = this.cache.get( cacheKey );\n\n\t\t\tif ( ! pointsMaterial ) {\n\n\t\t\t\tpointsMaterial = new PointsMaterial();\n\t\t\t\tMaterial.prototype.copy.call( pointsMaterial, material );\n\t\t\t\tpointsMaterial.color.copy( material.color );\n\t\t\t\tpointsMaterial.map = material.map;\n\t\t\t\tpointsMaterial.sizeAttenuation = false; // glTF spec says points should be 1px\n\n\t\t\t\tthis.cache.add( cacheKey, pointsMaterial );\n\n\t\t\t}\n\n\t\t\tmaterial = pointsMaterial;\n\n\t\t} else if ( mesh.isLine ) {\n\n\t\t\tvar cacheKey = 'LineBasicMaterial:' + material.uuid;\n\n\t\t\tvar lineMaterial = this.cache.get( cacheKey );\n\n\t\t\tif ( ! lineMaterial ) {\n\n\t\t\t\tlineMaterial = new LineBasicMaterial();\n\t\t\t\tMaterial.prototype.copy.call( lineMaterial, material );\n\t\t\t\tlineMaterial.color.copy( material.color );\n\n\t\t\t\tthis.cache.add( cacheKey, lineMaterial );\n\n\t\t\t}\n\n\t\t\tmaterial = lineMaterial;\n\n\t\t}\n\n\t\t// Clone the material if it will be modified\n\t\tif ( useVertexTangents || useVertexColors || useFlatShading || useSkinning || useMorphTargets ) {\n\n\t\t\tvar cacheKey = 'ClonedMaterial:' + material.uuid + ':';\n\n\t\t\tif ( material.isGLTFSpecularGlossinessMaterial ) cacheKey += 'specular-glossiness:';\n\t\t\tif ( useSkinning ) cacheKey += 'skinning:';\n\t\t\tif ( useVertexTangents ) cacheKey += 'vertex-tangents:';\n\t\t\tif ( useVertexColors ) cacheKey += 'vertex-colors:';\n\t\t\tif ( useFlatShading ) cacheKey += 'flat-shading:';\n\t\t\tif ( useMorphTargets ) cacheKey += 'morph-targets:';\n\t\t\tif ( useMorphNormals ) cacheKey += 'morph-normals:';\n\n\t\t\tvar cachedMaterial = this.cache.get( cacheKey );\n\n\t\t\tif ( ! cachedMaterial ) {\n\n\t\t\t\tcachedMaterial = material.clone();\n\n\t\t\t\tif ( useSkinning ) cachedMaterial.skinning = true;\n\t\t\t\tif ( useVertexTangents ) cachedMaterial.vertexTangents = true;\n\t\t\t\tif ( useVertexColors ) cachedMaterial.vertexColors = true;\n\t\t\t\tif ( useFlatShading ) cachedMaterial.flatShading = true;\n\t\t\t\tif ( useMorphTargets ) cachedMaterial.morphTargets = true;\n\t\t\t\tif ( useMorphNormals ) cachedMaterial.morphNormals = true;\n\n\t\t\t\tthis.cache.add( cacheKey, cachedMaterial );\n\n\t\t\t\tthis.associations.set( cachedMaterial, this.associations.get( material ) );\n\n\t\t\t}\n\n\t\t\tmaterial = cachedMaterial;\n\n\t\t}\n\n\t\t// workarounds for mesh and geometry\n\n\t\tif ( material.aoMap && geometry.attributes.uv2 === undefined && geometry.attributes.uv !== undefined ) {\n\n\t\t\tgeometry.setAttribute( 'uv2', geometry.attributes.uv );\n\n\t\t}\n\n\t\t// https://github.com/mrdoob/three.js/issues/11438#issuecomment-507003995\n\t\tif ( material.normalScale && ! useVertexTangents ) {\n\n\t\t\tmaterial.normalScale.y = - material.normalScale.y;\n\n\t\t}\n\n\t\tif ( material.clearcoatNormalScale && ! useVertexTangents ) {\n\n\t\t\tmaterial.clearcoatNormalScale.y = - material.clearcoatNormalScale.y;\n\n\t\t}\n\n\t\tmesh.material = material;\n\n\t};\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#materials\n\t * @param {number} materialIndex\n\t * @return {Promise<Material>}\n\t */\n\tGLTFParser.prototype.loadMaterial = function ( materialIndex ) {\n\n\t\tvar parser = this;\n\t\tvar json = this.json;\n\t\tvar extensions = this.extensions;\n\t\tvar materialDef = json.materials[ materialIndex ];\n\n\t\tvar materialType;\n\t\tvar materialParams = {};\n\t\tvar materialExtensions = materialDef.extensions || {};\n\n\t\tvar pending = [];\n\n\t\tif ( materialExtensions[ EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS ] ) {\n\n\t\t\tvar sgExtension = extensions[ EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS ];\n\t\t\tmaterialType = sgExtension.getMaterialType();\n\t\t\tpending.push( sgExtension.extendParams( materialParams, materialDef, parser ) );\n\n\t\t} else if ( materialExtensions[ EXTENSIONS.KHR_MATERIALS_UNLIT ] ) {\n\n\t\t\tvar kmuExtension = extensions[ EXTENSIONS.KHR_MATERIALS_UNLIT ];\n\t\t\tmaterialType = kmuExtension.getMaterialType();\n\t\t\tpending.push( kmuExtension.extendParams( materialParams, materialDef, parser ) );\n\n\t\t} else {\n\n\t\t\t// Specification:\n\t\t\t// https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#metallic-roughness-material\n\n\t\t\tmaterialType = MeshStandardMaterial;\n\n\t\t\tvar metallicRoughness = materialDef.pbrMetallicRoughness || {};\n\n\t\t\tmaterialParams.color = new Color( 1.0, 1.0, 1.0 );\n\t\t\tmaterialParams.opacity = 1.0;\n\n\t\t\tif ( Array.isArray( metallicRoughness.baseColorFactor ) ) {\n\n\t\t\t\tvar array = metallicRoughness.baseColorFactor;\n\n\t\t\t\tmaterialParams.color.fromArray( array );\n\t\t\t\tmaterialParams.opacity = array[ 3 ];\n\n\t\t\t}\n\n\t\t\tif ( metallicRoughness.baseColorTexture !== undefined ) {\n\n\t\t\t\tpending.push( parser.assignTexture( materialParams, 'map', metallicRoughness.baseColorTexture ) );\n\n\t\t\t}\n\n\t\t\tmaterialParams.metalness = metallicRoughness.metallicFactor !== undefined ? metallicRoughness.metallicFactor : 1.0;\n\t\t\tmaterialParams.roughness = metallicRoughness.roughnessFactor !== undefined ? metallicRoughness.roughnessFactor : 1.0;\n\n\t\t\tif ( metallicRoughness.metallicRoughnessTexture !== undefined ) {\n\n\t\t\t\tpending.push( parser.assignTexture( materialParams, 'metalnessMap', metallicRoughness.metallicRoughnessTexture ) );\n\t\t\t\tpending.push( parser.assignTexture( materialParams, 'roughnessMap', metallicRoughness.metallicRoughnessTexture ) );\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( materialDef.doubleSided === true ) {\n\n\t\t\tmaterialParams.side = DoubleSide;\n\n\t\t}\n\n\t\tvar alphaMode = materialDef.alphaMode || ALPHA_MODES.OPAQUE;\n\n\t\tif ( alphaMode === ALPHA_MODES.BLEND ) {\n\n\t\t\tmaterialParams.transparent = true;\n\n\t\t\t// See: https://github.com/mrdoob/three.js/issues/17706\n\t\t\tmaterialParams.depthWrite = false;\n\n\t\t} else {\n\n\t\t\tmaterialParams.transparent = false;\n\n\t\t\tif ( alphaMode === ALPHA_MODES.MASK ) {\n\n\t\t\t\tmaterialParams.alphaTest = materialDef.alphaCutoff !== undefined ? materialDef.alphaCutoff : 0.5;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( materialDef.normalTexture !== undefined && materialType !== MeshBasicMaterial ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'normalMap', materialDef.normalTexture ) );\n\n\t\t\tmaterialParams.normalScale = new Vector2( 1, 1 );\n\n\t\t\tif ( materialDef.normalTexture.scale !== undefined ) {\n\n\t\t\t\tmaterialParams.normalScale.set( materialDef.normalTexture.scale, materialDef.normalTexture.scale );\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( materialDef.occlusionTexture !== undefined && materialType !== MeshBasicMaterial ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'aoMap', materialDef.occlusionTexture ) );\n\n\t\t\tif ( materialDef.occlusionTexture.strength !== undefined ) {\n\n\t\t\t\tmaterialParams.aoMapIntensity = materialDef.occlusionTexture.strength;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( materialDef.emissiveFactor !== undefined && materialType !== MeshBasicMaterial ) {\n\n\t\t\tmaterialParams.emissive = new Color().fromArray( materialDef.emissiveFactor );\n\n\t\t}\n\n\t\tif ( materialDef.emissiveTexture !== undefined && materialType !== MeshBasicMaterial ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'emissiveMap', materialDef.emissiveTexture ) );\n\n\t\t}\n\n\t\tif ( materialExtensions[ EXTENSIONS.KHR_MATERIALS_CLEARCOAT ] ) {\n\n\t\t\tvar clearcoatExtension = extensions[ EXTENSIONS.KHR_MATERIALS_CLEARCOAT ];\n\t\t\tmaterialType = clearcoatExtension.getMaterialType();\n\t\t\tpending.push( clearcoatExtension.extendParams( materialParams, { extensions: materialExtensions }, parser ) );\n\n\t\t}\n\n\t\treturn Promise.all( pending ).then( function () {\n\n\t\t\tvar material;\n\n\t\t\tif ( materialType === GLTFMeshStandardSGMaterial ) {\n\n\t\t\t\tmaterial = extensions[ EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS ].createMaterial( materialParams );\n\n\t\t\t} else {\n\n\t\t\t\tmaterial = new materialType( materialParams );\n\n\t\t\t}\n\n\t\t\tif ( materialDef.name ) material.name = materialDef.name;\n\n\t\t\t// baseColorTexture, emissiveTexture, and specularGlossinessTexture use sRGB encoding.\n\t\t\tif ( material.map ) material.map.encoding = sRGBEncoding;\n\t\t\tif ( material.emissiveMap ) material.emissiveMap.encoding = sRGBEncoding;\n\n\t\t\tassignExtrasToUserData( material, materialDef );\n\n\t\t\tparser.associations.set( material, { type: 'materials', index: materialIndex } );\n\n\t\t\tif ( materialDef.extensions ) addUnknownExtensionsToUserData( extensions, material, materialDef );\n\n\t\t\treturn material;\n\n\t\t} );\n\n\t};\n\n\t/**\n\t * @param {BufferGeometry} geometry\n\t * @param {GLTF.Primitive} primitiveDef\n\t * @param {GLTFParser} parser\n\t */\n\tfunction computeBounds( geometry, primitiveDef, parser ) {\n\n\t\tvar attributes = primitiveDef.attributes;\n\n\t\tvar box = new Box3();\n\n\t\tif ( attributes.POSITION !== undefined ) {\n\n\t\t\tvar accessor = parser.json.accessors[ attributes.POSITION ];\n\n\t\t\tvar min = accessor.min;\n\t\t\tvar max = accessor.max;\n\n\t\t\t// glTF requires 'min' and 'max', but VRM (which extends glTF) currently ignores that requirement.\n\n\t\t\tif ( min !== undefined && max !== undefined ) {\n\n\t\t\t\tbox.set(\n\t\t\t\t\tnew Vector3( min[ 0 ], min[ 1 ], min[ 2 ] ),\n\t\t\t\t\tnew Vector3( max[ 0 ], max[ 1 ], max[ 2 ] ) );\n\n\t\t\t} else {\n\n\t\t\t\tconsole.warn( 'THREE.GLTFLoader: Missing min/max properties for accessor POSITION.' );\n\n\t\t\t\treturn;\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\treturn;\n\n\t\t}\n\n\t\tvar targets = primitiveDef.targets;\n\n\t\tif ( targets !== undefined ) {\n\n\t\t\tvar maxDisplacement = new Vector3();\n\t\t\tvar vector = new Vector3();\n\n\t\t\tfor ( var i = 0, il = targets.length; i < il; i ++ ) {\n\n\t\t\t\tvar target = targets[ i ];\n\n\t\t\t\tif ( target.POSITION !== undefined ) {\n\n\t\t\t\t\tvar accessor = parser.json.accessors[ target.POSITION ];\n\t\t\t\t\tvar min = accessor.min;\n\t\t\t\t\tvar max = accessor.max;\n\n\t\t\t\t\t// glTF requires 'min' and 'max', but VRM (which extends glTF) currently ignores that requirement.\n\n\t\t\t\t\tif ( min !== undefined && max !== undefined ) {\n\n\t\t\t\t\t\t// we need to get max of absolute components because target weight is [-1,1]\n\t\t\t\t\t\tvector.setX( Math.max( Math.abs( min[ 0 ] ), Math.abs( max[ 0 ] ) ) );\n\t\t\t\t\t\tvector.setY( Math.max( Math.abs( min[ 1 ] ), Math.abs( max[ 1 ] ) ) );\n\t\t\t\t\t\tvector.setZ( Math.max( Math.abs( min[ 2 ] ), Math.abs( max[ 2 ] ) ) );\n\n\t\t\t\t\t\t// Note: this assumes that the sum of all weights is at most 1. This isn't quite correct - it's more conservative\n\t\t\t\t\t\t// to assume that each target can have a max weight of 1. However, for some use cases - notably, when morph targets\n\t\t\t\t\t\t// are used to implement key-frame animations and as such only two are active at a time - this results in very large\n\t\t\t\t\t\t// boxes. So for now we make a box that's sometimes a touch too small but is hopefully mostly of reasonable size.\n\t\t\t\t\t\tmaxDisplacement.max( vector );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tconsole.warn( 'THREE.GLTFLoader: Missing min/max properties for accessor POSITION.' );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// As per comment above this box isn't conservative, but has a reasonable size for a very large number of morph targets.\n\t\t\tbox.expandByVector( maxDisplacement );\n\n\t\t}\n\n\t\tgeometry.boundingBox = box;\n\n\t\tvar sphere = new Sphere();\n\n\t\tbox.getCenter( sphere.center );\n\t\tsphere.radius = box.min.distanceTo( box.max ) / 2;\n\n\t\tgeometry.boundingSphere = sphere;\n\n\t}\n\n\t/**\n\t * @param {BufferGeometry} geometry\n\t * @param {GLTF.Primitive} primitiveDef\n\t * @param {GLTFParser} parser\n\t * @return {Promise<BufferGeometry>}\n\t */\n\tfunction addPrimitiveAttributes( geometry, primitiveDef, parser ) {\n\n\t\tvar attributes = primitiveDef.attributes;\n\n\t\tvar pending = [];\n\n\t\tfunction assignAttributeAccessor( accessorIndex, attributeName ) {\n\n\t\t\treturn parser.getDependency( 'accessor', accessorIndex )\n\t\t\t\t.then( function ( accessor ) {\n\n\t\t\t\t\tgeometry.setAttribute( attributeName, accessor );\n\n\t\t\t\t} );\n\n\t\t}\n\n\t\tfor ( var gltfAttributeName in attributes ) {\n\n\t\t\tvar threeAttributeName = ATTRIBUTES[ gltfAttributeName ] || gltfAttributeName.toLowerCase();\n\n\t\t\t// Skip attributes already provided by e.g. Draco extension.\n\t\t\tif ( threeAttributeName in geometry.attributes ) continue;\n\n\t\t\tpending.push( assignAttributeAccessor( attributes[ gltfAttributeName ], threeAttributeName ) );\n\n\t\t}\n\n\t\tif ( primitiveDef.indices !== undefined && ! geometry.index ) {\n\n\t\t\tvar accessor = parser.getDependency( 'accessor', primitiveDef.indices ).then( function ( accessor ) {\n\n\t\t\t\tgeometry.setIndex( accessor );\n\n\t\t\t} );\n\n\t\t\tpending.push( accessor );\n\n\t\t}\n\n\t\tassignExtrasToUserData( geometry, primitiveDef );\n\n\t\tcomputeBounds( geometry, primitiveDef, parser );\n\n\t\treturn Promise.all( pending ).then( function () {\n\n\t\t\treturn primitiveDef.targets !== undefined\n\t\t\t\t? addMorphTargets( geometry, primitiveDef.targets, parser )\n\t\t\t\t: geometry;\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * @param {BufferGeometry} geometry\n\t * @param {Number} drawMode\n\t * @return {BufferGeometry}\n\t */\n\tfunction toTrianglesDrawMode( geometry, drawMode ) {\n\n\t\tvar index = geometry.getIndex();\n\n\t\t// generate index if not present\n\n\t\tif ( index === null ) {\n\n\t\t\tvar indices = [];\n\n\t\t\tvar position = geometry.getAttribute( 'position' );\n\n\t\t\tif ( position !== undefined ) {\n\n\t\t\t\tfor ( var i = 0; i < position.count; i ++ ) {\n\n\t\t\t\t\tindices.push( i );\n\n\t\t\t\t}\n\n\t\t\t\tgeometry.setIndex( indices );\n\t\t\t\tindex = geometry.getIndex();\n\n\t\t\t} else {\n\n\t\t\t\tconsole.error( 'THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible.' );\n\t\t\t\treturn geometry;\n\n\t\t\t}\n\n\t\t}\n\n\t\t//\n\n\t\tvar numberOfTriangles = index.count - 2;\n\t\tvar newIndices = [];\n\n\t\tif ( drawMode === TriangleFanDrawMode ) {\n\n\t\t\t// gl.TRIANGLE_FAN\n\n\t\t\tfor ( var i = 1; i <= numberOfTriangles; i ++ ) {\n\n\t\t\t\tnewIndices.push( index.getX( 0 ) );\n\t\t\t\tnewIndices.push( index.getX( i ) );\n\t\t\t\tnewIndices.push( index.getX( i + 1 ) );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\t// gl.TRIANGLE_STRIP\n\n\t\t\tfor ( var i = 0; i < numberOfTriangles; i ++ ) {\n\n\t\t\t\tif ( i % 2 === 0 ) {\n\n\t\t\t\t\tnewIndices.push( index.getX( i ) );\n\t\t\t\t\tnewIndices.push( index.getX( i + 1 ) );\n\t\t\t\t\tnewIndices.push( index.getX( i + 2 ) );\n\n\n\t\t\t\t} else {\n\n\t\t\t\t\tnewIndices.push( index.getX( i + 2 ) );\n\t\t\t\t\tnewIndices.push( index.getX( i + 1 ) );\n\t\t\t\t\tnewIndices.push( index.getX( i ) );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( ( newIndices.length / 3 ) !== numberOfTriangles ) {\n\n\t\t\tconsole.error( 'THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.' );\n\n\t\t}\n\n\t\t// build final geometry\n\n\t\tvar newGeometry = geometry.clone();\n\t\tnewGeometry.setIndex( newIndices );\n\n\t\treturn newGeometry;\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#geometry\n\t *\n\t * Creates BufferGeometries from primitives.\n\t *\n\t * @param {Array<GLTF.Primitive>} primitives\n\t * @return {Promise<Array<BufferGeometry>>}\n\t */\n\tGLTFParser.prototype.loadGeometries = function ( primitives ) {\n\n\t\tvar parser = this;\n\t\tvar extensions = this.extensions;\n\t\tvar cache = this.primitiveCache;\n\n\t\tfunction createDracoPrimitive( primitive ) {\n\n\t\t\treturn extensions[ EXTENSIONS.KHR_DRACO_MESH_COMPRESSION ]\n\t\t\t\t.decodePrimitive( primitive, parser )\n\t\t\t\t.then( function ( geometry ) {\n\n\t\t\t\t\treturn addPrimitiveAttributes( geometry, primitive, parser );\n\n\t\t\t\t} );\n\n\t\t}\n\n\t\tvar pending = [];\n\n\t\tfor ( var i = 0, il = primitives.length; i < il; i ++ ) {\n\n\t\t\tvar primitive = primitives[ i ];\n\t\t\tvar cacheKey = createPrimitiveKey( primitive );\n\n\t\t\t// See if we've already created this geometry\n\t\t\tvar cached = cache[ cacheKey ];\n\n\t\t\tif ( cached ) {\n\n\t\t\t\t// Use the cached geometry if it exists\n\t\t\t\tpending.push( cached.promise );\n\n\t\t\t} else {\n\n\t\t\t\tvar geometryPromise;\n\n\t\t\t\tif ( primitive.extensions && primitive.extensions[ EXTENSIONS.KHR_DRACO_MESH_COMPRESSION ] ) {\n\n\t\t\t\t\t// Use DRACO geometry if available\n\t\t\t\t\tgeometryPromise = createDracoPrimitive( primitive );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// Otherwise create a new geometry\n\t\t\t\t\tgeometryPromise = addPrimitiveAttributes( new BufferGeometry(), primitive, parser );\n\n\t\t\t\t}\n\n\t\t\t\t// Cache this geometry\n\t\t\t\tcache[ cacheKey ] = { primitive: primitive, promise: geometryPromise };\n\n\t\t\t\tpending.push( geometryPromise );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t};\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#meshes\n\t * @param {number} meshIndex\n\t * @return {Promise<Group|Mesh|SkinnedMesh>}\n\t */\n\tGLTFParser.prototype.loadMesh = function ( meshIndex ) {\n\n\t\tvar parser = this;\n\t\tvar json = this.json;\n\n\t\tvar meshDef = json.meshes[ meshIndex ];\n\t\tvar primitives = meshDef.primitives;\n\n\t\tvar pending = [];\n\n\t\tfor ( var i = 0, il = primitives.length; i < il; i ++ ) {\n\n\t\t\tvar material = primitives[ i ].material === undefined\n\t\t\t\t? createDefaultMaterial( this.cache )\n\t\t\t\t: this.getDependency( 'material', primitives[ i ].material );\n\n\t\t\tpending.push( material );\n\n\t\t}\n\n\t\tpending.push( parser.loadGeometries( primitives ) );\n\n\t\treturn Promise.all( pending ).then( function ( results ) {\n\n\t\t\tvar materials = results.slice( 0, results.length - 1 );\n\t\t\tvar geometries = results[ results.length - 1 ];\n\n\t\t\tvar meshes = [];\n\n\t\t\tfor ( var i = 0, il = geometries.length; i < il; i ++ ) {\n\n\t\t\t\tvar geometry = geometries[ i ];\n\t\t\t\tvar primitive = primitives[ i ];\n\n\t\t\t\t// 1. create Mesh\n\n\t\t\t\tvar mesh;\n\n\t\t\t\tvar material = materials[ i ];\n\n\t\t\t\tif ( primitive.mode === WEBGL_CONSTANTS.TRIANGLES ||\n\t\t\t\t\tprimitive.mode === WEBGL_CONSTANTS.TRIANGLE_STRIP ||\n\t\t\t\t\tprimitive.mode === WEBGL_CONSTANTS.TRIANGLE_FAN ||\n\t\t\t\t\tprimitive.mode === undefined ) {\n\n\t\t\t\t\t// .isSkinnedMesh isn't in glTF spec. See .markDefs()\n\t\t\t\t\tmesh = meshDef.isSkinnedMesh === true\n\t\t\t\t\t\t? new SkinnedMesh( geometry, material )\n\t\t\t\t\t\t: new Mesh( geometry, material );\n\n\t\t\t\t\tif ( mesh.isSkinnedMesh === true && ! mesh.geometry.attributes.skinWeight.normalized ) {\n\n\t\t\t\t\t\t// we normalize floating point skin weight array to fix malformed assets (see #15319)\n\t\t\t\t\t\t// it's important to skip this for non-float32 data since normalizeSkinWeights assumes non-normalized inputs\n\t\t\t\t\t\tmesh.normalizeSkinWeights();\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( primitive.mode === WEBGL_CONSTANTS.TRIANGLE_STRIP ) {\n\n\t\t\t\t\t\tmesh.geometry = toTrianglesDrawMode( mesh.geometry, TriangleStripDrawMode );\n\n\t\t\t\t\t} else if ( primitive.mode === WEBGL_CONSTANTS.TRIANGLE_FAN ) {\n\n\t\t\t\t\t\tmesh.geometry = toTrianglesDrawMode( mesh.geometry, TriangleFanDrawMode );\n\n\t\t\t\t\t}\n\n\t\t\t\t} else if ( primitive.mode === WEBGL_CONSTANTS.LINES ) {\n\n\t\t\t\t\tmesh = new LineSegments( geometry, material );\n\n\t\t\t\t} else if ( primitive.mode === WEBGL_CONSTANTS.LINE_STRIP ) {\n\n\t\t\t\t\tmesh = new Line( geometry, material );\n\n\t\t\t\t} else if ( primitive.mode === WEBGL_CONSTANTS.LINE_LOOP ) {\n\n\t\t\t\t\tmesh = new LineLoop( geometry, material );\n\n\t\t\t\t} else if ( primitive.mode === WEBGL_CONSTANTS.POINTS ) {\n\n\t\t\t\t\tmesh = new Points( geometry, material );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthrow new Error( 'THREE.GLTFLoader: Primitive mode unsupported: ' + primitive.mode );\n\n\t\t\t\t}\n\n\t\t\t\tif ( Object.keys( mesh.geometry.morphAttributes ).length > 0 ) {\n\n\t\t\t\t\tupdateMorphTargets( mesh, meshDef );\n\n\t\t\t\t}\n\n\t\t\t\tmesh.name = meshDef.name || ( 'mesh_' + meshIndex );\n\n\t\t\t\tif ( geometries.length > 1 ) mesh.name += '_' + i;\n\n\t\t\t\tassignExtrasToUserData( mesh, meshDef );\n\n\t\t\t\tparser.assignFinalMaterial( mesh );\n\n\t\t\t\tmeshes.push( mesh );\n\n\t\t\t}\n\n\t\t\tif ( meshes.length === 1 ) {\n\n\t\t\t\treturn meshes[ 0 ];\n\n\t\t\t}\n\n\t\t\tvar group = new Group();\n\n\t\t\tfor ( var i = 0, il = meshes.length; i < il; i ++ ) {\n\n\t\t\t\tgroup.add( meshes[ i ] );\n\n\t\t\t}\n\n\t\t\treturn group;\n\n\t\t} );\n\n\t};\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#cameras\n\t * @param {number} cameraIndex\n\t * @return {Promise<THREE.Camera>}\n\t */\n\tGLTFParser.prototype.loadCamera = function ( cameraIndex ) {\n\n\t\tvar camera;\n\t\tvar cameraDef = this.json.cameras[ cameraIndex ];\n\t\tvar params = cameraDef[ cameraDef.type ];\n\n\t\tif ( ! params ) {\n\n\t\t\tconsole.warn( 'THREE.GLTFLoader: Missing camera parameters.' );\n\t\t\treturn;\n\n\t\t}\n\n\t\tif ( cameraDef.type === 'perspective' ) {\n\n\t\t\tcamera = new PerspectiveCamera( MathUtils.radToDeg( params.yfov ), params.aspectRatio || 1, params.znear || 1, params.zfar || 2e6 );\n\n\t\t} else if ( cameraDef.type === 'orthographic' ) {\n\n\t\t\tcamera = new OrthographicCamera( - params.xmag, params.xmag, params.ymag, - params.ymag, params.znear, params.zfar );\n\n\t\t}\n\n\t\tif ( cameraDef.name ) camera.name = cameraDef.name;\n\n\t\tassignExtrasToUserData( camera, cameraDef );\n\n\t\treturn Promise.resolve( camera );\n\n\t};\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#skins\n\t * @param {number} skinIndex\n\t * @return {Promise<Object>}\n\t */\n\tGLTFParser.prototype.loadSkin = function ( skinIndex ) {\n\n\t\tvar skinDef = this.json.skins[ skinIndex ];\n\n\t\tvar skinEntry = { joints: skinDef.joints };\n\n\t\tif ( skinDef.inverseBindMatrices === undefined ) {\n\n\t\t\treturn Promise.resolve( skinEntry );\n\n\t\t}\n\n\t\treturn this.getDependency( 'accessor', skinDef.inverseBindMatrices ).then( function ( accessor ) {\n\n\t\t\tskinEntry.inverseBindMatrices = accessor;\n\n\t\t\treturn skinEntry;\n\n\t\t} );\n\n\t};\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#animations\n\t * @param {number} animationIndex\n\t * @return {Promise<AnimationClip>}\n\t */\n\tGLTFParser.prototype.loadAnimation = function ( animationIndex ) {\n\n\t\tvar json = this.json;\n\n\t\tvar animationDef = json.animations[ animationIndex ];\n\n\t\tvar pendingNodes = [];\n\t\tvar pendingInputAccessors = [];\n\t\tvar pendingOutputAccessors = [];\n\t\tvar pendingSamplers = [];\n\t\tvar pendingTargets = [];\n\n\t\tfor ( var i = 0, il = animationDef.channels.length; i < il; i ++ ) {\n\n\t\t\tvar channel = animationDef.channels[ i ];\n\t\t\tvar sampler = animationDef.samplers[ channel.sampler ];\n\t\t\tvar target = channel.target;\n\t\t\tvar name = target.node !== undefined ? target.node : target.id; // NOTE: target.id is deprecated.\n\t\t\tvar input = animationDef.parameters !== undefined ? animationDef.parameters[ sampler.input ] : sampler.input;\n\t\t\tvar output = animationDef.parameters !== undefined ? animationDef.parameters[ sampler.output ] : sampler.output;\n\n\t\t\tpendingNodes.push( this.getDependency( 'node', name ) );\n\t\t\tpendingInputAccessors.push( this.getDependency( 'accessor', input ) );\n\t\t\tpendingOutputAccessors.push( this.getDependency( 'accessor', output ) );\n\t\t\tpendingSamplers.push( sampler );\n\t\t\tpendingTargets.push( target );\n\n\t\t}\n\n\t\treturn Promise.all( [\n\n\t\t\tPromise.all( pendingNodes ),\n\t\t\tPromise.all( pendingInputAccessors ),\n\t\t\tPromise.all( pendingOutputAccessors ),\n\t\t\tPromise.all( pendingSamplers ),\n\t\t\tPromise.all( pendingTargets )\n\n\t\t] ).then( function ( dependencies ) {\n\n\t\t\tvar nodes = dependencies[ 0 ];\n\t\t\tvar inputAccessors = dependencies[ 1 ];\n\t\t\tvar outputAccessors = dependencies[ 2 ];\n\t\t\tvar samplers = dependencies[ 3 ];\n\t\t\tvar targets = dependencies[ 4 ];\n\n\t\t\tvar tracks = [];\n\n\t\t\tfor ( var i = 0, il = nodes.length; i < il; i ++ ) {\n\n\t\t\t\tvar node = nodes[ i ];\n\t\t\t\tvar inputAccessor = inputAccessors[ i ];\n\t\t\t\tvar outputAccessor = outputAccessors[ i ];\n\t\t\t\tvar sampler = samplers[ i ];\n\t\t\t\tvar target = targets[ i ];\n\n\t\t\t\tif ( node === undefined ) continue;\n\n\t\t\t\tnode.updateMatrix();\n\t\t\t\tnode.matrixAutoUpdate = true;\n\n\t\t\t\tvar TypedKeyframeTrack;\n\n\t\t\t\tswitch ( PATH_PROPERTIES[ target.path ] ) {\n\n\t\t\t\t\tcase PATH_PROPERTIES.weights:\n\n\t\t\t\t\t\tTypedKeyframeTrack = NumberKeyframeTrack;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase PATH_PROPERTIES.rotation:\n\n\t\t\t\t\t\tTypedKeyframeTrack = QuaternionKeyframeTrack;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase PATH_PROPERTIES.position:\n\t\t\t\t\tcase PATH_PROPERTIES.scale:\n\t\t\t\t\tdefault:\n\n\t\t\t\t\t\tTypedKeyframeTrack = VectorKeyframeTrack;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t\tvar targetName = node.name ? node.name : node.uuid;\n\n\t\t\t\tvar interpolation = sampler.interpolation !== undefined ? INTERPOLATION[ sampler.interpolation ] : InterpolateLinear;\n\n\t\t\t\tvar targetNames = [];\n\n\t\t\t\tif ( PATH_PROPERTIES[ target.path ] === PATH_PROPERTIES.weights ) {\n\n\t\t\t\t\t// Node may be a Group (glTF mesh with several primitives) or a Mesh.\n\t\t\t\t\tnode.traverse( function ( object ) {\n\n\t\t\t\t\t\tif ( object.isMesh === true && object.morphTargetInfluences ) {\n\n\t\t\t\t\t\t\ttargetNames.push( object.name ? object.name : object.uuid );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} );\n\n\t\t\t\t} else {\n\n\t\t\t\t\ttargetNames.push( targetName );\n\n\t\t\t\t}\n\n\t\t\t\tvar outputArray = outputAccessor.array;\n\n\t\t\t\tif ( outputAccessor.normalized ) {\n\n\t\t\t\t\tvar scale;\n\n\t\t\t\t\tif ( outputArray.constructor === Int8Array ) {\n\n\t\t\t\t\t\tscale = 1 / 127;\n\n\t\t\t\t\t} else if ( outputArray.constructor === Uint8Array ) {\n\n\t\t\t\t\t\tscale = 1 / 255;\n\n\t\t\t\t\t} else if ( outputArray.constructor == Int16Array ) {\n\n\t\t\t\t\t\tscale = 1 / 32767;\n\n\t\t\t\t\t} else if ( outputArray.constructor === Uint16Array ) {\n\n\t\t\t\t\t\tscale = 1 / 65535;\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tthrow new Error( 'THREE.GLTFLoader: Unsupported output accessor component type.' );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tvar scaled = new Float32Array( outputArray.length );\n\n\t\t\t\t\tfor ( var j = 0, jl = outputArray.length; j < jl; j ++ ) {\n\n\t\t\t\t\t\tscaled[ j ] = outputArray[ j ] * scale;\n\n\t\t\t\t\t}\n\n\t\t\t\t\toutputArray = scaled;\n\n\t\t\t\t}\n\n\t\t\t\tfor ( var j = 0, jl = targetNames.length; j < jl; j ++ ) {\n\n\t\t\t\t\tvar track = new TypedKeyframeTrack(\n\t\t\t\t\t\ttargetNames[ j ] + '.' + PATH_PROPERTIES[ target.path ],\n\t\t\t\t\t\tinputAccessor.array,\n\t\t\t\t\t\toutputArray,\n\t\t\t\t\t\tinterpolation\n\t\t\t\t\t);\n\n\t\t\t\t\t// Override interpolation with custom factory method.\n\t\t\t\t\tif ( sampler.interpolation === 'CUBICSPLINE' ) {\n\n\t\t\t\t\t\ttrack.createInterpolant = function InterpolantFactoryMethodGLTFCubicSpline( result ) {\n\n\t\t\t\t\t\t\t// A CUBICSPLINE keyframe in glTF has three output values for each input value,\n\t\t\t\t\t\t\t// representing inTangent, splineVertex, and outTangent. As a result, track.getValueSize()\n\t\t\t\t\t\t\t// must be divided by three to get the interpolant's sampleSize argument.\n\n\t\t\t\t\t\t\treturn new GLTFCubicSplineInterpolant( this.times, this.values, this.getValueSize() / 3, result );\n\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\t// Mark as CUBICSPLINE. `track.getInterpolation()` doesn't support custom interpolants.\n\t\t\t\t\t\ttrack.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline = true;\n\n\t\t\t\t\t}\n\n\t\t\t\t\ttracks.push( track );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tvar name = animationDef.name ? animationDef.name : 'animation_' + animationIndex;\n\n\t\t\treturn new AnimationClip( name, undefined, tracks );\n\n\t\t} );\n\n\t};\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#nodes-and-hierarchy\n\t * @param {number} nodeIndex\n\t * @return {Promise<Object3D>}\n\t */\n\tGLTFParser.prototype.loadNode = function ( nodeIndex ) {\n\n\t\tvar json = this.json;\n\t\tvar extensions = this.extensions;\n\t\tvar parser = this;\n\n\t\tvar meshReferences = json.meshReferences;\n\t\tvar meshUses = json.meshUses;\n\n\t\tvar nodeDef = json.nodes[ nodeIndex ];\n\n\t\treturn ( function () {\n\n\t\t\tvar pending = [];\n\n\t\t\tif ( nodeDef.mesh !== undefined ) {\n\n\t\t\t\tpending.push( parser.getDependency( 'mesh', nodeDef.mesh ).then( function ( mesh ) {\n\n\t\t\t\t\tvar node;\n\n\t\t\t\t\tif ( meshReferences[ nodeDef.mesh ] > 1 ) {\n\n\t\t\t\t\t\tvar instanceNum = meshUses[ nodeDef.mesh ] ++;\n\n\t\t\t\t\t\tnode = mesh.clone();\n\t\t\t\t\t\tnode.name += '_instance_' + instanceNum;\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tnode = mesh;\n\n\t\t\t\t\t}\n\n\t\t\t\t\t// if weights are provided on the node, override weights on the mesh.\n\t\t\t\t\tif ( nodeDef.weights !== undefined ) {\n\n\t\t\t\t\t\tnode.traverse( function ( o ) {\n\n\t\t\t\t\t\t\tif ( ! o.isMesh ) return;\n\n\t\t\t\t\t\t\tfor ( var i = 0, il = nodeDef.weights.length; i < il; i ++ ) {\n\n\t\t\t\t\t\t\t\to.morphTargetInfluences[ i ] = nodeDef.weights[ i ];\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t} );\n\n\t\t\t\t\t}\n\n\t\t\t\t\treturn node;\n\n\t\t\t\t} ) );\n\n\t\t\t}\n\n\t\t\tif ( nodeDef.camera !== undefined ) {\n\n\t\t\t\tpending.push( parser.getDependency( 'camera', nodeDef.camera ) );\n\n\t\t\t}\n\n\t\t\tif ( nodeDef.extensions\n\t\t\t\t&& nodeDef.extensions[ EXTENSIONS.KHR_LIGHTS_PUNCTUAL ]\n\t\t\t\t&& nodeDef.extensions[ EXTENSIONS.KHR_LIGHTS_PUNCTUAL ].light !== undefined ) {\n\n\t\t\t\tpending.push( parser.getDependency( 'light', nodeDef.extensions[ EXTENSIONS.KHR_LIGHTS_PUNCTUAL ].light ) );\n\n\t\t\t}\n\n\t\t\treturn Promise.all( pending );\n\n\t\t}() ).then( function ( objects ) {\n\n\t\t\tvar node;\n\n\t\t\t// .isBone isn't in glTF spec. See .markDefs\n\t\t\tif ( nodeDef.isBone === true ) {\n\n\t\t\t\tnode = new Bone();\n\n\t\t\t} else if ( objects.length > 1 ) {\n\n\t\t\t\tnode = new Group();\n\n\t\t\t} else if ( objects.length === 1 ) {\n\n\t\t\t\tnode = objects[ 0 ];\n\n\t\t\t} else {\n\n\t\t\t\tnode = new Object3D();\n\n\t\t\t}\n\n\t\t\tif ( node !== objects[ 0 ] ) {\n\n\t\t\t\tfor ( var i = 0, il = objects.length; i < il; i ++ ) {\n\n\t\t\t\t\tnode.add( objects[ i ] );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( nodeDef.name ) {\n\n\t\t\t\tnode.userData.name = nodeDef.name;\n\t\t\t\tnode.name = PropertyBinding.sanitizeNodeName( nodeDef.name );\n\n\t\t\t}\n\n\t\t\tassignExtrasToUserData( node, nodeDef );\n\n\t\t\tif ( nodeDef.extensions ) addUnknownExtensionsToUserData( extensions, node, nodeDef );\n\n\t\t\tif ( nodeDef.matrix !== undefined ) {\n\n\t\t\t\tvar matrix = new Matrix4();\n\t\t\t\tmatrix.fromArray( nodeDef.matrix );\n\t\t\t\tnode.applyMatrix4( matrix );\n\n\t\t\t} else {\n\n\t\t\t\tif ( nodeDef.translation !== undefined ) {\n\n\t\t\t\t\tnode.position.fromArray( nodeDef.translation );\n\n\t\t\t\t}\n\n\t\t\t\tif ( nodeDef.rotation !== undefined ) {\n\n\t\t\t\t\tnode.quaternion.fromArray( nodeDef.rotation );\n\n\t\t\t\t}\n\n\t\t\t\tif ( nodeDef.scale !== undefined ) {\n\n\t\t\t\t\tnode.scale.fromArray( nodeDef.scale );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tparser.associations.set( node, { type: 'nodes', index: nodeIndex } );\n\n\t\t\treturn node;\n\n\t\t} );\n\n\t};\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#scenes\n\t * @param {number} sceneIndex\n\t * @return {Promise<Group>}\n\t */\n\tGLTFParser.prototype.loadScene = function () {\n\n\t\t// scene node hierachy builder\n\n\t\tfunction buildNodeHierachy( nodeId, parentObject, json, parser ) {\n\n\t\t\tvar nodeDef = json.nodes[ nodeId ];\n\n\t\t\treturn parser.getDependency( 'node', nodeId ).then( function ( node ) {\n\n\t\t\t\tif ( nodeDef.skin === undefined ) return node;\n\n\t\t\t\t// build skeleton here as well\n\n\t\t\t\tvar skinEntry;\n\n\t\t\t\treturn parser.getDependency( 'skin', nodeDef.skin ).then( function ( skin ) {\n\n\t\t\t\t\tskinEntry = skin;\n\n\t\t\t\t\tvar pendingJoints = [];\n\n\t\t\t\t\tfor ( var i = 0, il = skinEntry.joints.length; i < il; i ++ ) {\n\n\t\t\t\t\t\tpendingJoints.push( parser.getDependency( 'node', skinEntry.joints[ i ] ) );\n\n\t\t\t\t\t}\n\n\t\t\t\t\treturn Promise.all( pendingJoints );\n\n\t\t\t\t} ).then( function ( jointNodes ) {\n\n\t\t\t\t\tnode.traverse( function ( mesh ) {\n\n\t\t\t\t\t\tif ( ! mesh.isMesh ) return;\n\n\t\t\t\t\t\tvar bones = [];\n\t\t\t\t\t\tvar boneInverses = [];\n\n\t\t\t\t\t\tfor ( var j = 0, jl = jointNodes.length; j < jl; j ++ ) {\n\n\t\t\t\t\t\t\tvar jointNode = jointNodes[ j ];\n\n\t\t\t\t\t\t\tif ( jointNode ) {\n\n\t\t\t\t\t\t\t\tbones.push( jointNode );\n\n\t\t\t\t\t\t\t\tvar mat = new Matrix4();\n\n\t\t\t\t\t\t\t\tif ( skinEntry.inverseBindMatrices !== undefined ) {\n\n\t\t\t\t\t\t\t\t\tmat.fromArray( skinEntry.inverseBindMatrices.array, j * 16 );\n\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tboneInverses.push( mat );\n\n\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\tconsole.warn( 'THREE.GLTFLoader: Joint \"%s\" could not be found.', skinEntry.joints[ j ] );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tmesh.bind( new Skeleton( bones, boneInverses ), mesh.matrixWorld );\n\n\t\t\t\t\t} );\n\n\t\t\t\t\treturn node;\n\n\t\t\t\t} );\n\n\t\t\t} ).then( function ( node ) {\n\n\t\t\t\t// build node hierachy\n\n\t\t\t\tparentObject.add( node );\n\n\t\t\t\tvar pending = [];\n\n\t\t\t\tif ( nodeDef.children ) {\n\n\t\t\t\t\tvar children = nodeDef.children;\n\n\t\t\t\t\tfor ( var i = 0, il = children.length; i < il; i ++ ) {\n\n\t\t\t\t\t\tvar child = children[ i ];\n\t\t\t\t\t\tpending.push( buildNodeHierachy( child, node, json, parser ) );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\treturn Promise.all( pending );\n\n\t\t\t} );\n\n\t\t}\n\n\t\treturn function loadScene( sceneIndex ) {\n\n\t\t\tvar json = this.json;\n\t\t\tvar extensions = this.extensions;\n\t\t\tvar sceneDef = this.json.scenes[ sceneIndex ];\n\t\t\tvar parser = this;\n\n\t\t\t// Loader returns Group, not Scene.\n\t\t\t// See: https://github.com/mrdoob/three.js/issues/18342#issuecomment-578981172\n\t\t\tvar scene = new Group();\n\t\t\tif ( sceneDef.name ) scene.name = sceneDef.name;\n\n\t\t\tassignExtrasToUserData( scene, sceneDef );\n\n\t\t\tif ( sceneDef.extensions ) addUnknownExtensionsToUserData( extensions, scene, sceneDef );\n\n\t\t\tvar nodeIds = sceneDef.nodes || [];\n\n\t\t\tvar pending = [];\n\n\t\t\tfor ( var i = 0, il = nodeIds.length; i < il; i ++ ) {\n\n\t\t\t\tpending.push( buildNodeHierachy( nodeIds[ i ], scene, json, parser ) );\n\n\t\t\t}\n\n\t\t\treturn Promise.all( pending ).then( function () {\n\n\t\t\t\treturn scene;\n\n\t\t\t} );\n\n\t\t};\n\n\t}();\n\n\treturn GLTFLoader;\n\n} )();\n\nexport { GLTFLoader };\n","/**\n * @author Slayvin / http://slayvin.net\n */\n\nimport {\n\tColor,\n\tLinearEncoding,\n\tLinearFilter,\n\tMathUtils,\n\tMatrix4,\n\tMesh,\n\tPerspectiveCamera,\n\tPlane,\n\tRGBFormat,\n\tShaderMaterial,\n\tUniformsUtils,\n\tVector3,\n\tVector4,\n\tWebGLRenderTarget\n} from \"../../../build/three.module.js\";\n\nvar Reflector = function ( geometry, options ) {\n\n\tMesh.call( this, geometry );\n\n\tthis.type = 'Reflector';\n\n\tvar scope = this;\n\n\toptions = options || {};\n\n\tvar color = ( options.color !== undefined ) ? new Color( options.color ) : new Color( 0x7F7F7F );\n\tvar textureWidth = options.textureWidth || 512;\n\tvar textureHeight = options.textureHeight || 512;\n\tvar clipBias = options.clipBias || 0;\n\tvar shader = options.shader || Reflector.ReflectorShader;\n\tvar encoding = options.encoding !== undefined ? options.encoding : LinearEncoding;\n\n\t//\n\n\tvar reflectorPlane = new Plane();\n\tvar normal = new Vector3();\n\tvar reflectorWorldPosition = new Vector3();\n\tvar cameraWorldPosition = new Vector3();\n\tvar rotationMatrix = new Matrix4();\n\tvar lookAtPosition = new Vector3( 0, 0, - 1 );\n\tvar clipPlane = new Vector4();\n\n\tvar view = new Vector3();\n\tvar target = new Vector3();\n\tvar q = new Vector4();\n\n\tvar textureMatrix = new Matrix4();\n\tvar virtualCamera = new PerspectiveCamera();\n\n\tvar parameters = {\n\t\tminFilter: LinearFilter,\n\t\tmagFilter: LinearFilter,\n\t\tformat: RGBFormat,\n\t\tstencilBuffer: false,\n\t\tencoding: encoding\n\t};\n\n\tvar renderTarget = new WebGLRenderTarget( textureWidth, textureHeight, parameters );\n\n\tif ( ! MathUtils.isPowerOfTwo( textureWidth ) || ! MathUtils.isPowerOfTwo( textureHeight ) ) {\n\n\t\trenderTarget.texture.generateMipmaps = false;\n\n\t}\n\n\tvar material = new ShaderMaterial( {\n\t\tuniforms: UniformsUtils.clone( shader.uniforms ),\n\t\tfragmentShader: shader.fragmentShader,\n\t\tvertexShader: shader.vertexShader\n\t} );\n\n\tmaterial.uniforms[ \"tDiffuse\" ].value = renderTarget.texture;\n\tmaterial.uniforms[ \"color\" ].value = color;\n\tmaterial.uniforms[ \"textureMatrix\" ].value = textureMatrix;\n\n\tthis.material = material;\n\n\tthis.onBeforeRender = function ( renderer, scene, camera ) {\n\n\t\treflectorWorldPosition.setFromMatrixPosition( scope.matrixWorld );\n\t\tcameraWorldPosition.setFromMatrixPosition( camera.matrixWorld );\n\n\t\trotationMatrix.extractRotation( scope.matrixWorld );\n\n\t\tnormal.set( 0, 0, 1 );\n\t\tnormal.applyMatrix4( rotationMatrix );\n\n\t\tview.subVectors( reflectorWorldPosition, cameraWorldPosition );\n\n\t\t// Avoid rendering when reflector is facing away\n\n\t\tif ( view.dot( normal ) > 0 ) return;\n\n\t\tview.reflect( normal ).negate();\n\t\tview.add( reflectorWorldPosition );\n\n\t\trotationMatrix.extractRotation( camera.matrixWorld );\n\n\t\tlookAtPosition.set( 0, 0, - 1 );\n\t\tlookAtPosition.applyMatrix4( rotationMatrix );\n\t\tlookAtPosition.add( cameraWorldPosition );\n\n\t\ttarget.subVectors( reflectorWorldPosition, lookAtPosition );\n\t\ttarget.reflect( normal ).negate();\n\t\ttarget.add( reflectorWorldPosition );\n\n\t\tvirtualCamera.position.copy( view );\n\t\tvirtualCamera.up.set( 0, 1, 0 );\n\t\tvirtualCamera.up.applyMatrix4( rotationMatrix );\n\t\tvirtualCamera.up.reflect( normal );\n\t\tvirtualCamera.lookAt( target );\n\n\t\tvirtualCamera.far = camera.far; // Used in WebGLBackground\n\n\t\tvirtualCamera.updateMatrixWorld();\n\t\tvirtualCamera.projectionMatrix.copy( camera.projectionMatrix );\n\n\t\t// Update the texture matrix\n\t\ttextureMatrix.set(\n\t\t\t0.5, 0.0, 0.0, 0.5,\n\t\t\t0.0, 0.5, 0.0, 0.5,\n\t\t\t0.0, 0.0, 0.5, 0.5,\n\t\t\t0.0, 0.0, 0.0, 1.0\n\t\t);\n\t\ttextureMatrix.multiply( virtualCamera.projectionMatrix );\n\t\ttextureMatrix.multiply( virtualCamera.matrixWorldInverse );\n\t\ttextureMatrix.multiply( scope.matrixWorld );\n\n\t\t// Now update projection matrix with new clip plane, implementing code from: http://www.terathon.com/code/oblique.html\n\t\t// Paper explaining this technique: http://www.terathon.com/lengyel/Lengyel-Oblique.pdf\n\t\treflectorPlane.setFromNormalAndCoplanarPoint( normal, reflectorWorldPosition );\n\t\treflectorPlane.applyMatrix4( virtualCamera.matrixWorldInverse );\n\n\t\tclipPlane.set( reflectorPlane.normal.x, reflectorPlane.normal.y, reflectorPlane.normal.z, reflectorPlane.constant );\n\n\t\tvar projectionMatrix = virtualCamera.projectionMatrix;\n\n\t\tq.x = ( Math.sign( clipPlane.x ) + projectionMatrix.elements[ 8 ] ) / projectionMatrix.elements[ 0 ];\n\t\tq.y = ( Math.sign( clipPlane.y ) + projectionMatrix.elements[ 9 ] ) / projectionMatrix.elements[ 5 ];\n\t\tq.z = - 1.0;\n\t\tq.w = ( 1.0 + projectionMatrix.elements[ 10 ] ) / projectionMatrix.elements[ 14 ];\n\n\t\t// Calculate the scaled plane vector\n\t\tclipPlane.multiplyScalar( 2.0 / clipPlane.dot( q ) );\n\n\t\t// Replacing the third row of the projection matrix\n\t\tprojectionMatrix.elements[ 2 ] = clipPlane.x;\n\t\tprojectionMatrix.elements[ 6 ] = clipPlane.y;\n\t\tprojectionMatrix.elements[ 10 ] = clipPlane.z + 1.0 - clipBias;\n\t\tprojectionMatrix.elements[ 14 ] = clipPlane.w;\n\n\t\t// Render\n\n\t\tscope.visible = false;\n\n\t\tvar currentRenderTarget = renderer.getRenderTarget();\n\n\t\tvar currentXrEnabled = renderer.xr.enabled;\n\t\tvar currentShadowAutoUpdate = renderer.shadowMap.autoUpdate;\n\n\t\trenderer.xr.enabled = false; // Avoid camera modification\n\t\trenderer.shadowMap.autoUpdate = false; // Avoid re-computing shadows\n\n\t\trenderer.setRenderTarget( renderTarget );\n\n\t\trenderer.state.buffers.depth.setMask( true ); // make sure the depth buffer is writable so it can be properly cleared, see #18897\n\n\t\tif ( renderer.autoClear === false ) renderer.clear();\n\t\trenderer.render( scene, virtualCamera );\n\n\t\trenderer.xr.enabled = currentXrEnabled;\n\t\trenderer.shadowMap.autoUpdate = currentShadowAutoUpdate;\n\n\t\trenderer.setRenderTarget( currentRenderTarget );\n\n\t\t// Restore viewport\n\n\t\tvar viewport = camera.viewport;\n\n\t\tif ( viewport !== undefined ) {\n\n\t\t\trenderer.state.viewport( viewport );\n\n\t\t}\n\n\t\tscope.visible = true;\n\n\t};\n\n\tthis.getRenderTarget = function () {\n\n\t\treturn renderTarget;\n\n\t};\n\n};\n\nReflector.prototype = Object.create( Mesh.prototype );\nReflector.prototype.constructor = Reflector;\n\nReflector.ReflectorShader = {\n\n\tuniforms: {\n\n\t\t'color': {\n\t\t\tvalue: null\n\t\t},\n\n\t\t'tDiffuse': {\n\t\t\tvalue: null\n\t\t},\n\n\t\t'textureMatrix': {\n\t\t\tvalue: null\n\t\t}\n\n\t},\n\n\tvertexShader: [\n\t\t'uniform mat4 textureMatrix;',\n\t\t'varying vec4 vUv;',\n\n\t\t'void main() {',\n\n\t\t'\tvUv = textureMatrix * vec4( position, 1.0 );',\n\n\t\t'\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );',\n\n\t\t'}'\n\t].join( '\\n' ),\n\n\tfragmentShader: [\n\t\t'uniform vec3 color;',\n\t\t'uniform sampler2D tDiffuse;',\n\t\t'varying vec4 vUv;',\n\n\t\t'float blendOverlay( float base, float blend ) {',\n\n\t\t'\treturn( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );',\n\n\t\t'}',\n\n\t\t'vec3 blendOverlay( vec3 base, vec3 blend ) {',\n\n\t\t'\treturn vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ), blendOverlay( base.b, blend.b ) );',\n\n\t\t'}',\n\n\t\t'void main() {',\n\n\t\t'\tvec4 base = texture2DProj( tDiffuse, vUv );',\n\t\t'\tgl_FragColor = vec4( blendOverlay( base.rgb, color ), 1.0 );',\n\n\t\t'}'\n\t].join( '\\n' )\n};\n\nexport { Reflector };\n","// stats.js - http://github.com/mrdoob/stats.js\nvar Stats=function(){function h(a){c.appendChild(a.dom);return a}function k(a){for(var d=0;d<c.children.length;d++)c.children[d].style.display=d===a?\"block\":\"none\";l=a}var l=0,c=document.createElement(\"div\");c.style.cssText=\"position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000\";c.addEventListener(\"click\",function(a){a.preventDefault();k(++l%c.children.length)},!1);var g=(performance||Date).now(),e=g,a=0,r=h(new Stats.Panel(\"FPS\",\"#0ff\",\"#002\")),f=h(new Stats.Panel(\"MS\",\"#0f0\",\"#020\"));\nif(self.performance&&self.performance.memory)var t=h(new Stats.Panel(\"MB\",\"#f08\",\"#201\"));k(0);return{REVISION:16,dom:c,addPanel:h,showPanel:k,begin:function(){g=(performance||Date).now()},end:function(){a++;var c=(performance||Date).now();f.update(c-g,200);if(c>e+1E3&&(r.update(1E3*a/(c-e),100),e=c,a=0,t)){var d=performance.memory;t.update(d.usedJSHeapSize/1048576,d.jsHeapSizeLimit/1048576)}return c},update:function(){g=this.end()},domElement:c,setMode:k}};\nStats.Panel=function(h,k,l){var c=Infinity,g=0,e=Math.round,a=e(window.devicePixelRatio||1),r=80*a,f=48*a,t=3*a,u=2*a,d=3*a,m=15*a,n=74*a,p=30*a,q=document.createElement(\"canvas\");q.width=r;q.height=f;q.style.cssText=\"width:80px;height:48px\";var b=q.getContext(\"2d\");b.font=\"bold \"+9*a+\"px Helvetica,Arial,sans-serif\";b.textBaseline=\"top\";b.fillStyle=l;b.fillRect(0,0,r,f);b.fillStyle=k;b.fillText(h,t,u);b.fillRect(d,m,n,p);b.fillStyle=l;b.globalAlpha=.9;b.fillRect(d,m,n,p);return{dom:q,update:function(f,\nv){c=Math.min(c,f);g=Math.max(g,f);b.fillStyle=l;b.globalAlpha=1;b.fillRect(0,0,r,m);b.fillStyle=k;b.fillText(e(f)+\" \"+h+\" (\"+e(c)+\"-\"+e(g)+\")\",t,u);b.drawImage(q,d+a,m,n-a,p,d,m,n-a,p);b.fillRect(d+n-a,m,a,p);b.fillStyle=l;b.globalAlpha=.9;b.fillRect(d+n-a,m,a,e((1-f/v)*p))}}};\"object\"===typeof module&&(module.exports=Stats);\n","/**\n *\t@author zz85 / http://twitter.com/blurspline / http://www.lab4games.net/zz85/blog\n *\n *\tSimplification Geometry Modifier\n *    - based on code and technique\n *\t  - by Stan Melax in 1998\n *\t  - Progressive Mesh type Polygon Reduction Algorithm\n *    - http://www.melax.com/polychop/\n */\n\nimport {\n\tBufferGeometry,\n\tFloat32BufferAttribute,\n\tGeometry,\n\tVector3\n} from \"../../../build/three.module.js\";\n\nvar SimplifyModifier = function () {};\n\n( function () {\n\n\tvar cb = new Vector3(), ab = new Vector3();\n\n\tfunction pushIfUnique( array, object ) {\n\n\t\tif ( array.indexOf( object ) === - 1 ) array.push( object );\n\n\t}\n\n\tfunction removeFromArray( array, object ) {\n\n\t\tvar k = array.indexOf( object );\n\t\tif ( k > - 1 ) array.splice( k, 1 );\n\n\t}\n\n\tfunction computeEdgeCollapseCost( u, v ) {\n\n\t\t// if we collapse edge uv by moving u to v then how\n\t\t// much different will the model change, i.e. the \"error\".\n\n\t\tvar edgelength = v.position.distanceTo( u.position );\n\t\tvar curvature = 0;\n\n\t\tvar sideFaces = [];\n\t\tvar i, il = u.faces.length, face, sideFace;\n\n\t\t// find the \"sides\" triangles that are on the edge uv\n\t\tfor ( i = 0; i < il; i ++ ) {\n\n\t\t\tface = u.faces[ i ];\n\n\t\t\tif ( face.hasVertex( v ) ) {\n\n\t\t\t\tsideFaces.push( face );\n\n\t\t\t}\n\n\t\t}\n\n\t\t// use the triangle facing most away from the sides\n\t\t// to determine our curvature term\n\t\tfor ( i = 0; i < il; i ++ ) {\n\n\t\t\tvar minCurvature = 1;\n\t\t\tface = u.faces[ i ];\n\n\t\t\tfor ( var j = 0; j < sideFaces.length; j ++ ) {\n\n\t\t\t\tsideFace = sideFaces[ j ];\n\t\t\t\t// use dot product of face normals.\n\t\t\t\tvar dotProd = face.normal.dot( sideFace.normal );\n\t\t\t\tminCurvature = Math.min( minCurvature, ( 1.001 - dotProd ) / 2 );\n\n\t\t\t}\n\n\t\t\tcurvature = Math.max( curvature, minCurvature );\n\n\t\t}\n\n\t\t// crude approach in attempt to preserve borders\n\t\t// though it seems not to be totally correct\n\t\tvar borders = 0;\n\t\tif ( sideFaces.length < 2 ) {\n\n\t\t\t// we add some arbitrary cost for borders,\n\t\t\t// borders += 10;\n\t\t\tcurvature = 1;\n\n\t\t}\n\n\t\tvar amt = edgelength * curvature + borders;\n\n\t\treturn amt;\n\n\t}\n\n\tfunction computeEdgeCostAtVertex( v ) {\n\n\t\t// compute the edge collapse cost for all edges that start\n\t\t// from vertex v.  Since we are only interested in reducing\n\t\t// the object by selecting the min cost edge at each step, we\n\t\t// only cache the cost of the least cost edge at this vertex\n\t\t// (in member variable collapse) as well as the value of the\n\t\t// cost (in member variable collapseCost).\n\n\t\tif ( v.neighbors.length === 0 ) {\n\n\t\t\t// collapse if no neighbors.\n\t\t\tv.collapseNeighbor = null;\n\t\t\tv.collapseCost = - 0.01;\n\n\t\t\treturn;\n\n\t\t}\n\n\t\tv.collapseCost = 100000;\n\t\tv.collapseNeighbor = null;\n\n\t\t// search all neighboring edges for \"least cost\" edge\n\t\tfor ( var i = 0; i < v.neighbors.length; i ++ ) {\n\n\t\t\tvar collapseCost = computeEdgeCollapseCost( v, v.neighbors[ i ] );\n\n\t\t\tif ( ! v.collapseNeighbor ) {\n\n\t\t\t\tv.collapseNeighbor = v.neighbors[ i ];\n\t\t\t\tv.collapseCost = collapseCost;\n\t\t\t\tv.minCost = collapseCost;\n\t\t\t\tv.totalCost = 0;\n\t\t\t\tv.costCount = 0;\n\n\t\t\t}\n\n\t\t\tv.costCount ++;\n\t\t\tv.totalCost += collapseCost;\n\n\t\t\tif ( collapseCost < v.minCost ) {\n\n\t\t\t\tv.collapseNeighbor = v.neighbors[ i ];\n\t\t\t\tv.minCost = collapseCost;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// we average the cost of collapsing at this vertex\n\t\tv.collapseCost = v.totalCost / v.costCount;\n\t\t// v.collapseCost = v.minCost;\n\n\t}\n\n\tfunction removeVertex( v, vertices ) {\n\n\t\tconsole.assert( v.faces.length === 0 );\n\n\t\twhile ( v.neighbors.length ) {\n\n\t\t\tvar n = v.neighbors.pop();\n\t\t\tremoveFromArray( n.neighbors, v );\n\n\t\t}\n\n\t\tremoveFromArray( vertices, v );\n\n\t}\n\n\tfunction removeFace( f, faces ) {\n\n\t\tremoveFromArray( faces, f );\n\n\t\tif ( f.v1 ) removeFromArray( f.v1.faces, f );\n\t\tif ( f.v2 ) removeFromArray( f.v2.faces, f );\n\t\tif ( f.v3 ) removeFromArray( f.v3.faces, f );\n\n\t\t// TODO optimize this!\n\t\tvar vs = [ f.v1, f.v2, f.v3 ];\n\t\tvar v1, v2;\n\n\t\tfor ( var i = 0; i < 3; i ++ ) {\n\n\t\t\tv1 = vs[ i ];\n\t\t\tv2 = vs[ ( i + 1 ) % 3 ];\n\n\t\t\tif ( ! v1 || ! v2 ) continue;\n\n\t\t\tv1.removeIfNonNeighbor( v2 );\n\t\t\tv2.removeIfNonNeighbor( v1 );\n\n\t\t}\n\n\t}\n\n\tfunction collapse( vertices, faces, u, v ) { // u and v are pointers to vertices of an edge\n\n\t\t// Collapse the edge uv by moving vertex u onto v\n\n\t\tif ( ! v ) {\n\n\t\t\t// u is a vertex all by itself so just delete it..\n\t\t\tremoveVertex( u, vertices );\n\t\t\treturn;\n\n\t\t}\n\n\t\tvar i;\n\t\tvar tmpVertices = [];\n\n\t\tfor ( i = 0; i < u.neighbors.length; i ++ ) {\n\n\t\t\ttmpVertices.push( u.neighbors[ i ] );\n\n\t\t}\n\n\n\t\t// delete triangles on edge uv:\n\t\tfor ( i = u.faces.length - 1; i >= 0; i -- ) {\n\n\t\t\tif ( u.faces[ i ].hasVertex( v ) ) {\n\n\t\t\t\tremoveFace( u.faces[ i ], faces );\n\n\t\t\t}\n\n\t\t}\n\n\t\t// update remaining triangles to have v instead of u\n\t\tfor ( i = u.faces.length - 1; i >= 0; i -- ) {\n\n\t\t\tu.faces[ i ].replaceVertex( u, v );\n\n\t\t}\n\n\n\t\tremoveVertex( u, vertices );\n\n\t\t// recompute the edge collapse costs in neighborhood\n\t\tfor ( i = 0; i < tmpVertices.length; i ++ ) {\n\n\t\t\tcomputeEdgeCostAtVertex( tmpVertices[ i ] );\n\n\t\t}\n\n\t}\n\n\n\n\tfunction minimumCostEdge( vertices ) {\n\n\t\t// O(n * n) approach. TODO optimize this\n\n\t\tvar least = vertices[ 0 ];\n\n\t\tfor ( var i = 0; i < vertices.length; i ++ ) {\n\n\t\t\tif ( vertices[ i ].collapseCost < least.collapseCost ) {\n\n\t\t\t\tleast = vertices[ i ];\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn least;\n\n\t}\n\n\t// we use a triangle class to represent structure of face slightly differently\n\n\tfunction Triangle( v1, v2, v3, a, b, c ) {\n\n\t\tthis.a = a;\n\t\tthis.b = b;\n\t\tthis.c = c;\n\n\t\tthis.v1 = v1;\n\t\tthis.v2 = v2;\n\t\tthis.v3 = v3;\n\n\t\tthis.normal = new Vector3();\n\n\t\tthis.computeNormal();\n\n\t\tv1.faces.push( this );\n\t\tv1.addUniqueNeighbor( v2 );\n\t\tv1.addUniqueNeighbor( v3 );\n\n\t\tv2.faces.push( this );\n\t\tv2.addUniqueNeighbor( v1 );\n\t\tv2.addUniqueNeighbor( v3 );\n\n\n\t\tv3.faces.push( this );\n\t\tv3.addUniqueNeighbor( v1 );\n\t\tv3.addUniqueNeighbor( v2 );\n\n\t}\n\n\tTriangle.prototype.computeNormal = function () {\n\n\t\tvar vA = this.v1.position;\n\t\tvar vB = this.v2.position;\n\t\tvar vC = this.v3.position;\n\n\t\tcb.subVectors( vC, vB );\n\t\tab.subVectors( vA, vB );\n\t\tcb.cross( ab ).normalize();\n\n\t\tthis.normal.copy( cb );\n\n\t};\n\n\tTriangle.prototype.hasVertex = function ( v ) {\n\n\t\treturn v === this.v1 || v === this.v2 || v === this.v3;\n\n\t};\n\n\tTriangle.prototype.replaceVertex = function ( oldv, newv ) {\n\n\t\tif ( oldv === this.v1 ) this.v1 = newv;\n\t\telse if ( oldv === this.v2 ) this.v2 = newv;\n\t\telse if ( oldv === this.v3 ) this.v3 = newv;\n\n\t\tremoveFromArray( oldv.faces, this );\n\t\tnewv.faces.push( this );\n\n\n\t\toldv.removeIfNonNeighbor( this.v1 );\n\t\tthis.v1.removeIfNonNeighbor( oldv );\n\n\t\toldv.removeIfNonNeighbor( this.v2 );\n\t\tthis.v2.removeIfNonNeighbor( oldv );\n\n\t\toldv.removeIfNonNeighbor( this.v3 );\n\t\tthis.v3.removeIfNonNeighbor( oldv );\n\n\t\tthis.v1.addUniqueNeighbor( this.v2 );\n\t\tthis.v1.addUniqueNeighbor( this.v3 );\n\n\t\tthis.v2.addUniqueNeighbor( this.v1 );\n\t\tthis.v2.addUniqueNeighbor( this.v3 );\n\n\t\tthis.v3.addUniqueNeighbor( this.v1 );\n\t\tthis.v3.addUniqueNeighbor( this.v2 );\n\n\t\tthis.computeNormal();\n\n\t};\n\n\tfunction Vertex( v, id ) {\n\n\t\tthis.position = v;\n\n\t\tthis.id = id; // old index id\n\n\t\tthis.faces = []; // faces vertex is connected\n\t\tthis.neighbors = []; // neighbouring vertices aka \"adjacentVertices\"\n\n\t\t// these will be computed in computeEdgeCostAtVertex()\n\t\tthis.collapseCost = 0; // cost of collapsing this vertex, the less the better. aka objdist\n\t\tthis.collapseNeighbor = null; // best candinate for collapsing\n\n\t}\n\n\tVertex.prototype.addUniqueNeighbor = function ( vertex ) {\n\n\t\tpushIfUnique( this.neighbors, vertex );\n\n\t};\n\n\tVertex.prototype.removeIfNonNeighbor = function ( n ) {\n\n\t\tvar neighbors = this.neighbors;\n\t\tvar faces = this.faces;\n\n\t\tvar offset = neighbors.indexOf( n );\n\t\tif ( offset === - 1 ) return;\n\t\tfor ( var i = 0; i < faces.length; i ++ ) {\n\n\t\t\tif ( faces[ i ].hasVertex( n ) ) return;\n\n\t\t}\n\n\t\tneighbors.splice( offset, 1 );\n\n\t};\n\n\tSimplifyModifier.prototype.modify = function ( geometry, count ) {\n\n\t\tif ( geometry.isBufferGeometry ) {\n\n\t\t\tgeometry = new Geometry().fromBufferGeometry( geometry );\n\n\t\t}\n\n\t\tgeometry.mergeVertices();\n\n\t\tvar oldVertices = geometry.vertices; // Three Position\n\t\tvar oldFaces = geometry.faces; // Three Face\n\n\t\t// conversion\n\t\tvar vertices = [];\n\t\tvar faces = [];\n\n\t\tvar i, il;\n\n\t\t//\n\t\t// put data of original geometry in different data structures\n\t\t//\n\n\t\t// add vertices\n\n\t\tfor ( i = 0, il = oldVertices.length; i < il; i ++ ) {\n\n\t\t\tvar vertex = new Vertex( oldVertices[ i ], i );\n\t\t\tvertices.push( vertex );\n\n\t\t}\n\n\t\t// add faces\n\n\t\tfor ( i = 0, il = oldFaces.length; i < il; i ++ ) {\n\n\t\t\tvar face = oldFaces[ i ];\n\n\t\t\tvar a = face.a;\n\t\t\tvar b = face.b;\n\t\t\tvar c = face.c;\n\n\t\t\tvar triangle = new Triangle( vertices[ a ], vertices[ b ], vertices[ c ], a, b, c );\n\t\t\tfaces.push( triangle );\n\n\t\t}\n\n\t\t// compute all edge collapse costs\n\n\t\tfor ( i = 0, il = vertices.length; i < il; i ++ ) {\n\n\t\t\tcomputeEdgeCostAtVertex( vertices[ i ] );\n\n\t\t}\n\n\t\tvar nextVertex;\n\n\t\tvar z = count;\n\n\t\twhile ( z -- ) {\n\n\t\t\tnextVertex = minimumCostEdge( vertices );\n\n\t\t\tif ( ! nextVertex ) {\n\n\t\t\t\tconsole.log( 'THREE.SimplifyModifier: No next vertex' );\n\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t\tcollapse( vertices, faces, nextVertex, nextVertex.collapseNeighbor );\n\n\t\t}\n\n\t\t//\n\n\t\tvar simplifiedGeometry = new BufferGeometry();\n\t\tvar position = [];\n\t\tvar index = [];\n\n\t\t//\n\n\t\tfor ( i = 0; i < vertices.length; i ++ ) {\n\n\t\t\tvar vertex = vertices[ i ].position;\n\t\t\tposition.push( vertex.x, vertex.y, vertex.z );\n\n\t\t}\n\n\t\t//\n\n\t\tfor ( i = 0; i < faces.length; i ++ ) {\n\n\t\t\tvar face = faces[ i ];\n\n\t\t\tvar a = vertices.indexOf( face.v1 );\n\t\t\tvar b = vertices.indexOf( face.v2 );\n\t\t\tvar c = vertices.indexOf( face.v3 );\n\n\t\t\tindex.push( a, b, c );\n\n\t\t}\n\n\t\t//\n\n\t\tsimplifiedGeometry.setAttribute( 'position', new Float32BufferAttribute( position, 3 ) );\n\t\tsimplifiedGeometry.setIndex( index );\n\n\t\treturn simplifiedGeometry;\n\n\t};\n\n} )();\n\nexport { SimplifyModifier };\n","/**\n *\t@author zz85 / http://twitter.com/blurspline / http://www.lab4games.net/zz85/blog\n *\t@author centerionware / http://www.centerionware.com\n *\n *\tSubdivision Geometry Modifier\n *\t\tusing Loop Subdivision Scheme\n *\n *\tReferences:\n *\t\thttp://graphics.stanford.edu/~mdfisher/subdivision.html\n *\t\thttp://www.holmes3d.net/graphics/subdivision/\n *\t\thttp://www.cs.rutgers.edu/~decarlo/readings/subdiv-sg00c.pdf\n *\n *\tKnown Issues:\n *\t\t- currently doesn't handle \"Sharp Edges\"\n */\n\nimport {\n\tFace3,\n\tGeometry,\n\tVector2,\n\tVector3\n} from \"../../../build/three.module.js\";\n\nvar SubdivisionModifier = function ( subdivisions ) {\n\n\tthis.subdivisions = ( subdivisions === undefined ) ? 1 : subdivisions;\n\n};\n\n// Applies the \"modify\" pattern\nSubdivisionModifier.prototype.modify = function ( geometry ) {\n\n\tif ( geometry.isBufferGeometry ) {\n\n\t\tgeometry = new Geometry().fromBufferGeometry( geometry );\n\n\t} else {\n\n\t\tgeometry = geometry.clone();\n\n\t}\n\n\tgeometry.mergeVertices();\n\n\tvar repeats = this.subdivisions;\n\n\twhile ( repeats -- > 0 ) {\n\n\t\tthis.smooth( geometry );\n\n\t}\n\n\tgeometry.computeFaceNormals();\n\tgeometry.computeVertexNormals();\n\n\treturn geometry;\n\n};\n\n( function () {\n\n\t// Some constants\n\tvar ABC = [ 'a', 'b', 'c' ];\n\n\n\tfunction getEdge( a, b, map ) {\n\n\t\tvar vertexIndexA = Math.min( a, b );\n\t\tvar vertexIndexB = Math.max( a, b );\n\n\t\tvar key = vertexIndexA + \"_\" + vertexIndexB;\n\n\t\treturn map[ key ];\n\n\t}\n\n\n\tfunction processEdge( a, b, vertices, map, face, metaVertices ) {\n\n\t\tvar vertexIndexA = Math.min( a, b );\n\t\tvar vertexIndexB = Math.max( a, b );\n\n\t\tvar key = vertexIndexA + \"_\" + vertexIndexB;\n\n\t\tvar edge;\n\n\t\tif ( key in map ) {\n\n\t\t\tedge = map[ key ];\n\n\t\t} else {\n\n\t\t\tvar vertexA = vertices[ vertexIndexA ];\n\t\t\tvar vertexB = vertices[ vertexIndexB ];\n\n\t\t\tedge = {\n\n\t\t\t\ta: vertexA, // pointer reference\n\t\t\t\tb: vertexB,\n\t\t\t\tnewEdge: null,\n\t\t\t\t// aIndex: a, // numbered reference\n\t\t\t\t// bIndex: b,\n\t\t\t\tfaces: [] // pointers to face\n\n\t\t\t};\n\n\t\t\tmap[ key ] = edge;\n\n\t\t}\n\n\t\tedge.faces.push( face );\n\n\t\tmetaVertices[ a ].edges.push( edge );\n\t\tmetaVertices[ b ].edges.push( edge );\n\n\n\t}\n\n\tfunction generateLookups( vertices, faces, metaVertices, edges ) {\n\n\t\tvar i, il, face;\n\n\t\tfor ( i = 0, il = vertices.length; i < il; i ++ ) {\n\n\t\t\tmetaVertices[ i ] = { edges: [] };\n\n\t\t}\n\n\t\tfor ( i = 0, il = faces.length; i < il; i ++ ) {\n\n\t\t\tface = faces[ i ];\n\n\t\t\tprocessEdge( face.a, face.b, vertices, edges, face, metaVertices );\n\t\t\tprocessEdge( face.b, face.c, vertices, edges, face, metaVertices );\n\t\t\tprocessEdge( face.c, face.a, vertices, edges, face, metaVertices );\n\n\t\t}\n\n\t}\n\n\tfunction newFace( newFaces, a, b, c, materialIndex ) {\n\n\t\tnewFaces.push( new Face3( a, b, c, undefined, undefined, materialIndex ) );\n\n\t}\n\n\tfunction midpoint( a, b ) {\n\n\t\treturn ( Math.abs( b - a ) / 2 ) + Math.min( a, b );\n\n\t}\n\n\tfunction newUv( newUvs, a, b, c ) {\n\n\t\tnewUvs.push( [ a.clone(), b.clone(), c.clone() ] );\n\n\t}\n\n\t/////////////////////////////\n\n\t// Performs one iteration of Subdivision\n\tSubdivisionModifier.prototype.smooth = function ( geometry ) {\n\n\t\tvar tmp = new Vector3();\n\n\t\tvar oldVertices, oldFaces, oldUvs;\n\t\tvar newVertices, newFaces, newUVs = [];\n\n\t\tvar n, i, il, j, k;\n\t\tvar metaVertices, sourceEdges;\n\n\t\t// new stuff.\n\t\tvar sourceEdges, newEdgeVertices, newSourceVertices;\n\n\t\toldVertices = geometry.vertices; // { x, y, z}\n\t\toldFaces = geometry.faces; // { a: oldVertex1, b: oldVertex2, c: oldVertex3 }\n\t\toldUvs = geometry.faceVertexUvs;\n\n\t\tvar hasUvs = oldUvs[ 0 ] !== undefined && oldUvs[ 0 ].length > 0;\n\n\t\tif ( hasUvs ) {\n\n\t\t\tfor ( var j = 0; j < oldUvs.length; j ++ ) {\n\n\t\t\t\tnewUVs.push( [] );\n\n\t\t\t}\n\n\t\t}\n\n\t\t/******************************************************\n\t\t *\n\t\t * Step 0: Preprocess Geometry to Generate edges Lookup\n\t\t *\n\t\t *******************************************************/\n\n\t\tmetaVertices = new Array( oldVertices.length );\n\t\tsourceEdges = {}; // Edge => { oldVertex1, oldVertex2, faces[]  }\n\n\t\tgenerateLookups( oldVertices, oldFaces, metaVertices, sourceEdges );\n\n\n\t\t/******************************************************\n\t\t *\n\t\t *\tStep 1.\n\t\t *\tFor each edge, create a new Edge Vertex,\n\t\t *\tthen position it.\n\t\t *\n\t\t *******************************************************/\n\n\t\tnewEdgeVertices = [];\n\t\tvar other, currentEdge, newEdge, face;\n\t\tvar edgeVertexWeight, adjacentVertexWeight, connectedFaces;\n\n\t\tfor ( i in sourceEdges ) {\n\n\t\t\tcurrentEdge = sourceEdges[ i ];\n\t\t\tnewEdge = new Vector3();\n\n\t\t\tedgeVertexWeight = 3 / 8;\n\t\t\tadjacentVertexWeight = 1 / 8;\n\n\t\t\tconnectedFaces = currentEdge.faces.length;\n\n\t\t\t// check how many linked faces. 2 should be correct.\n\t\t\tif ( connectedFaces != 2 ) {\n\n\t\t\t\t// if length is not 2, handle condition\n\t\t\t\tedgeVertexWeight = 0.5;\n\t\t\t\tadjacentVertexWeight = 0;\n\n\t\t\t\tif ( connectedFaces != 1 ) {\n\n\t\t\t\t\t// console.warn( 'Subdivision Modifier: Number of connected faces != 2, is: ', connectedFaces, currentEdge );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tnewEdge.addVectors( currentEdge.a, currentEdge.b ).multiplyScalar( edgeVertexWeight );\n\n\t\t\ttmp.set( 0, 0, 0 );\n\n\t\t\tfor ( j = 0; j < connectedFaces; j ++ ) {\n\n\t\t\t\tface = currentEdge.faces[ j ];\n\n\t\t\t\tfor ( k = 0; k < 3; k ++ ) {\n\n\t\t\t\t\tother = oldVertices[ face[ ABC[ k ] ] ];\n\t\t\t\t\tif ( other !== currentEdge.a && other !== currentEdge.b ) break;\n\n\t\t\t\t}\n\n\t\t\t\ttmp.add( other );\n\n\t\t\t}\n\n\t\t\ttmp.multiplyScalar( adjacentVertexWeight );\n\t\t\tnewEdge.add( tmp );\n\n\t\t\tcurrentEdge.newEdge = newEdgeVertices.length;\n\t\t\tnewEdgeVertices.push( newEdge );\n\n\t\t\t// console.log(currentEdge, newEdge);\n\n\t\t}\n\n\t\t/******************************************************\n\t\t *\n\t\t *\tStep 2.\n\t\t *\tReposition each source vertices.\n\t\t *\n\t\t *******************************************************/\n\n\t\tvar beta, sourceVertexWeight, connectingVertexWeight;\n\t\tvar connectingEdge, connectingEdges, oldVertex, newSourceVertex;\n\t\tnewSourceVertices = [];\n\n\t\tfor ( i = 0, il = oldVertices.length; i < il; i ++ ) {\n\n\t\t\toldVertex = oldVertices[ i ];\n\n\t\t\t// find all connecting edges (using lookupTable)\n\t\t\tconnectingEdges = metaVertices[ i ].edges;\n\t\t\tn = connectingEdges.length;\n\n\t\t\tif ( n == 3 ) {\n\n\t\t\t\tbeta = 3 / 16;\n\n\t\t\t} else if ( n > 3 ) {\n\n\t\t\t\tbeta = 3 / ( 8 * n ); // Warren's modified formula\n\n\t\t\t}\n\n\t\t\t// Loop's original beta formula\n\t\t\t// beta = 1 / n * ( 5/8 - Math.pow( 3/8 + 1/4 * Math.cos( 2 * Math. PI / n ), 2) );\n\n\t\t\tsourceVertexWeight = 1 - n * beta;\n\t\t\tconnectingVertexWeight = beta;\n\n\t\t\tif ( n <= 2 ) {\n\n\t\t\t\t// crease and boundary rules\n\t\t\t\t// console.warn('crease and boundary rules');\n\n\t\t\t\tif ( n == 2 ) {\n\n\t\t\t\t\t// console.warn( '2 connecting edges', connectingEdges );\n\t\t\t\t\tsourceVertexWeight = 3 / 4;\n\t\t\t\t\tconnectingVertexWeight = 1 / 8;\n\n\t\t\t\t\t// sourceVertexWeight = 1;\n\t\t\t\t\t// connectingVertexWeight = 0;\n\n\t\t\t\t} else if ( n == 1 ) {\n\n\t\t\t\t\t// console.warn( 'only 1 connecting edge' );\n\n\t\t\t\t} else if ( n == 0 ) {\n\n\t\t\t\t\t// console.warn( '0 connecting edges' );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tnewSourceVertex = oldVertex.clone().multiplyScalar( sourceVertexWeight );\n\n\t\t\ttmp.set( 0, 0, 0 );\n\n\t\t\tfor ( j = 0; j < n; j ++ ) {\n\n\t\t\t\tconnectingEdge = connectingEdges[ j ];\n\t\t\t\tother = connectingEdge.a !== oldVertex ? connectingEdge.a : connectingEdge.b;\n\t\t\t\ttmp.add( other );\n\n\t\t\t}\n\n\t\t\ttmp.multiplyScalar( connectingVertexWeight );\n\t\t\tnewSourceVertex.add( tmp );\n\n\t\t\tnewSourceVertices.push( newSourceVertex );\n\n\t\t}\n\n\n\t\t/******************************************************\n\t\t *\n\t\t *\tStep 3.\n\t\t *\tGenerate Faces between source vertices\n\t\t *\tand edge vertices.\n\t\t *\n\t\t *******************************************************/\n\n\t\tnewVertices = newSourceVertices.concat( newEdgeVertices );\n\t\tvar sl = newSourceVertices.length, edge1, edge2, edge3;\n\t\tnewFaces = [];\n\n\t\tvar uv, x0, x1, x2;\n\t\tvar x3 = new Vector2();\n\t\tvar x4 = new Vector2();\n\t\tvar x5 = new Vector2();\n\n\t\tfor ( i = 0, il = oldFaces.length; i < il; i ++ ) {\n\n\t\t\tface = oldFaces[ i ];\n\n\t\t\t// find the 3 new edges vertex of each old face\n\n\t\t\tedge1 = getEdge( face.a, face.b, sourceEdges ).newEdge + sl;\n\t\t\tedge2 = getEdge( face.b, face.c, sourceEdges ).newEdge + sl;\n\t\t\tedge3 = getEdge( face.c, face.a, sourceEdges ).newEdge + sl;\n\n\t\t\t// create 4 faces.\n\n\t\t\tnewFace( newFaces, edge1, edge2, edge3, face.materialIndex );\n\t\t\tnewFace( newFaces, face.a, edge1, edge3, face.materialIndex );\n\t\t\tnewFace( newFaces, face.b, edge2, edge1, face.materialIndex );\n\t\t\tnewFace( newFaces, face.c, edge3, edge2, face.materialIndex );\n\n\t\t\t// create 4 new uv's\n\n\t\t\tif ( hasUvs ) {\n\n\t\t\t\tfor ( var j = 0; j < oldUvs.length; j ++ ) {\n\n\t\t\t\t\tuv = oldUvs[ j ][ i ];\n\n\t\t\t\t\tx0 = uv[ 0 ];\n\t\t\t\t\tx1 = uv[ 1 ];\n\t\t\t\t\tx2 = uv[ 2 ];\n\n\t\t\t\t\tx3.set( midpoint( x0.x, x1.x ), midpoint( x0.y, x1.y ) );\n\t\t\t\t\tx4.set( midpoint( x1.x, x2.x ), midpoint( x1.y, x2.y ) );\n\t\t\t\t\tx5.set( midpoint( x0.x, x2.x ), midpoint( x0.y, x2.y ) );\n\n\t\t\t\t\tnewUv( newUVs[ j ], x3, x4, x5 );\n\t\t\t\t\tnewUv( newUVs[ j ], x0, x3, x5 );\n\n\t\t\t\t\tnewUv( newUVs[ j ], x1, x4, x3 );\n\t\t\t\t\tnewUv( newUVs[ j ], x2, x5, x4 );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\t// Overwrite old arrays\n\t\tgeometry.vertices = newVertices;\n\t\tgeometry.faces = newFaces;\n\t\tif ( hasUvs ) geometry.faceVertexUvs = newUVs;\n\n\t\t// console.log('done');\n\n\t};\n\n} )();\n\nexport { SubdivisionModifier };\n","/**\n * Break faces with edges longer than maxEdgeLength\n * - not recursive\n *\n * @author alteredq / http://alteredqualia.com/\n */\n\nimport {\n\tFace3\n} from \"../../../build/three.module.js\";\n\nvar TessellateModifier = function ( maxEdgeLength ) {\n\n\tthis.maxEdgeLength = maxEdgeLength;\n\n};\n\nTessellateModifier.prototype.modify = function ( geometry ) {\n\n\tvar edge;\n\n\tvar faces = [];\n\tvar faceVertexUvs = [];\n\tvar maxEdgeLengthSquared = this.maxEdgeLength * this.maxEdgeLength;\n\n\tfor ( var i = 0, il = geometry.faceVertexUvs.length; i < il; i ++ ) {\n\n\t\tfaceVertexUvs[ i ] = [];\n\n\t}\n\n\tfor ( var i = 0, il = geometry.faces.length; i < il; i ++ ) {\n\n\t\tvar face = geometry.faces[ i ];\n\n\t\tif ( face instanceof Face3 ) {\n\n\t\t\tvar a = face.a;\n\t\t\tvar b = face.b;\n\t\t\tvar c = face.c;\n\n\t\t\tvar va = geometry.vertices[ a ];\n\t\t\tvar vb = geometry.vertices[ b ];\n\t\t\tvar vc = geometry.vertices[ c ];\n\n\t\t\tvar dab = va.distanceToSquared( vb );\n\t\t\tvar dbc = vb.distanceToSquared( vc );\n\t\t\tvar dac = va.distanceToSquared( vc );\n\n\t\t\tif ( dab > maxEdgeLengthSquared || dbc > maxEdgeLengthSquared || dac > maxEdgeLengthSquared ) {\n\n\t\t\t\tvar m = geometry.vertices.length;\n\n\t\t\t\tvar triA = face.clone();\n\t\t\t\tvar triB = face.clone();\n\n\t\t\t\tif ( dab >= dbc && dab >= dac ) {\n\n\t\t\t\t\tvar vm = va.clone();\n\t\t\t\t\tvm.lerp( vb, 0.5 );\n\n\t\t\t\t\ttriA.a = a;\n\t\t\t\t\ttriA.b = m;\n\t\t\t\t\ttriA.c = c;\n\n\t\t\t\t\ttriB.a = m;\n\t\t\t\t\ttriB.b = b;\n\t\t\t\t\ttriB.c = c;\n\n\t\t\t\t\tif ( face.vertexNormals.length === 3 ) {\n\n\t\t\t\t\t\tvar vnm = face.vertexNormals[ 0 ].clone();\n\t\t\t\t\t\tvnm.lerp( face.vertexNormals[ 1 ], 0.5 );\n\n\t\t\t\t\t\ttriA.vertexNormals[ 1 ].copy( vnm );\n\t\t\t\t\t\ttriB.vertexNormals[ 0 ].copy( vnm );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( face.vertexColors.length === 3 ) {\n\n\t\t\t\t\t\tvar vcm = face.vertexColors[ 0 ].clone();\n\t\t\t\t\t\tvcm.lerp( face.vertexColors[ 1 ], 0.5 );\n\n\t\t\t\t\t\ttriA.vertexColors[ 1 ].copy( vcm );\n\t\t\t\t\t\ttriB.vertexColors[ 0 ].copy( vcm );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tedge = 0;\n\n\t\t\t\t} else if ( dbc >= dab && dbc >= dac ) {\n\n\t\t\t\t\tvar vm = vb.clone();\n\t\t\t\t\tvm.lerp( vc, 0.5 );\n\n\t\t\t\t\ttriA.a = a;\n\t\t\t\t\ttriA.b = b;\n\t\t\t\t\ttriA.c = m;\n\n\t\t\t\t\ttriB.a = m;\n\t\t\t\t\ttriB.b = c;\n\t\t\t\t\ttriB.c = a;\n\n\t\t\t\t\tif ( face.vertexNormals.length === 3 ) {\n\n\t\t\t\t\t\tvar vnm = face.vertexNormals[ 1 ].clone();\n\t\t\t\t\t\tvnm.lerp( face.vertexNormals[ 2 ], 0.5 );\n\n\t\t\t\t\t\ttriA.vertexNormals[ 2 ].copy( vnm );\n\n\t\t\t\t\t\ttriB.vertexNormals[ 0 ].copy( vnm );\n\t\t\t\t\t\ttriB.vertexNormals[ 1 ].copy( face.vertexNormals[ 2 ] );\n\t\t\t\t\t\ttriB.vertexNormals[ 2 ].copy( face.vertexNormals[ 0 ] );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( face.vertexColors.length === 3 ) {\n\n\t\t\t\t\t\tvar vcm = face.vertexColors[ 1 ].clone();\n\t\t\t\t\t\tvcm.lerp( face.vertexColors[ 2 ], 0.5 );\n\n\t\t\t\t\t\ttriA.vertexColors[ 2 ].copy( vcm );\n\n\t\t\t\t\t\ttriB.vertexColors[ 0 ].copy( vcm );\n\t\t\t\t\t\ttriB.vertexColors[ 1 ].copy( face.vertexColors[ 2 ] );\n\t\t\t\t\t\ttriB.vertexColors[ 2 ].copy( face.vertexColors[ 0 ] );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tedge = 1;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tvar vm = va.clone();\n\t\t\t\t\tvm.lerp( vc, 0.5 );\n\n\t\t\t\t\ttriA.a = a;\n\t\t\t\t\ttriA.b = b;\n\t\t\t\t\ttriA.c = m;\n\n\t\t\t\t\ttriB.a = m;\n\t\t\t\t\ttriB.b = b;\n\t\t\t\t\ttriB.c = c;\n\n\t\t\t\t\tif ( face.vertexNormals.length === 3 ) {\n\n\t\t\t\t\t\tvar vnm = face.vertexNormals[ 0 ].clone();\n\t\t\t\t\t\tvnm.lerp( face.vertexNormals[ 2 ], 0.5 );\n\n\t\t\t\t\t\ttriA.vertexNormals[ 2 ].copy( vnm );\n\t\t\t\t\t\ttriB.vertexNormals[ 0 ].copy( vnm );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( face.vertexColors.length === 3 ) {\n\n\t\t\t\t\t\tvar vcm = face.vertexColors[ 0 ].clone();\n\t\t\t\t\t\tvcm.lerp( face.vertexColors[ 2 ], 0.5 );\n\n\t\t\t\t\t\ttriA.vertexColors[ 2 ].copy( vcm );\n\t\t\t\t\t\ttriB.vertexColors[ 0 ].copy( vcm );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tedge = 2;\n\n\t\t\t\t}\n\n\t\t\t\tfaces.push( triA, triB );\n\t\t\t\tgeometry.vertices.push( vm );\n\n\t\t\t\tfor ( var j = 0, jl = geometry.faceVertexUvs.length; j < jl; j ++ ) {\n\n\t\t\t\t\tif ( geometry.faceVertexUvs[ j ].length ) {\n\n\t\t\t\t\t\tvar uvs = geometry.faceVertexUvs[ j ][ i ];\n\n\t\t\t\t\t\tvar uvA = uvs[ 0 ];\n\t\t\t\t\t\tvar uvB = uvs[ 1 ];\n\t\t\t\t\t\tvar uvC = uvs[ 2 ];\n\n\t\t\t\t\t\t// AB\n\n\t\t\t\t\t\tif ( edge === 0 ) {\n\n\t\t\t\t\t\t\tvar uvM = uvA.clone();\n\t\t\t\t\t\t\tuvM.lerp( uvB, 0.5 );\n\n\t\t\t\t\t\t\tvar uvsTriA = [ uvA.clone(), uvM.clone(), uvC.clone() ];\n\t\t\t\t\t\t\tvar uvsTriB = [ uvM.clone(), uvB.clone(), uvC.clone() ];\n\n\t\t\t\t\t\t\t// BC\n\n\t\t\t\t\t\t} else if ( edge === 1 ) {\n\n\t\t\t\t\t\t\tvar uvM = uvB.clone();\n\t\t\t\t\t\t\tuvM.lerp( uvC, 0.5 );\n\n\t\t\t\t\t\t\tvar uvsTriA = [ uvA.clone(), uvB.clone(), uvM.clone() ];\n\t\t\t\t\t\t\tvar uvsTriB = [ uvM.clone(), uvC.clone(), uvA.clone() ];\n\n\t\t\t\t\t\t\t// AC\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tvar uvM = uvA.clone();\n\t\t\t\t\t\t\tuvM.lerp( uvC, 0.5 );\n\n\t\t\t\t\t\t\tvar uvsTriA = [ uvA.clone(), uvB.clone(), uvM.clone() ];\n\t\t\t\t\t\t\tvar uvsTriB = [ uvM.clone(), uvB.clone(), uvC.clone() ];\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tfaceVertexUvs[ j ].push( uvsTriA, uvsTriB );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\tfaces.push( face );\n\n\t\t\t\tfor ( var j = 0, jl = geometry.faceVertexUvs.length; j < jl; j ++ ) {\n\n\t\t\t\t\tfaceVertexUvs[ j ].push( geometry.faceVertexUvs[ j ][ i ] );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tgeometry.faces = faces;\n\tgeometry.faceVertexUvs = faceVertexUvs;\n\n};\n\nexport { TessellateModifier };\n","/**\n * @author zz85 / https://github.com/zz85\n *\n * Based on \"A Practical Analytic Model for Daylight\"\n * aka The Preetham Model, the de facto standard analytic skydome model\n * http://www.cs.utah.edu/~shirley/papers/sunsky/sunsky.pdf\n *\n * First implemented by Simon Wallner\n * http://www.simonwallner.at/projects/atmospheric-scattering\n *\n * Improved by Martin Upitis\n * http://blenderartists.org/forum/showthread.php?245954-preethams-sky-impementation-HDR\n *\n * Three.js integration by zz85 http://twitter.com/blurspline\n*/\n\nimport {\n\tBackSide,\n\tBoxBufferGeometry,\n\tMesh,\n\tShaderMaterial,\n\tUniformsUtils,\n\tVector3\n} from \"../../../build/three.module.js\";\n\nvar Sky = function () {\n\n\tvar shader = Sky.SkyShader;\n\n\tvar material = new ShaderMaterial( {\n\t\tfragmentShader: shader.fragmentShader,\n\t\tvertexShader: shader.vertexShader,\n\t\tuniforms: UniformsUtils.clone( shader.uniforms ),\n\t\tside: BackSide,\n\t\tdepthWrite: false\n\t} );\n\n\tMesh.call( this, new BoxBufferGeometry( 1, 1, 1 ), material );\n\n};\n\nSky.prototype = Object.create( Mesh.prototype );\n\nSky.SkyShader = {\n\n\tuniforms: {\n\t\t\"luminance\": { value: 1 },\n\t\t\"turbidity\": { value: 2 },\n\t\t\"rayleigh\": { value: 1 },\n\t\t\"mieCoefficient\": { value: 0.005 },\n\t\t\"mieDirectionalG\": { value: 0.8 },\n\t\t\"sunPosition\": { value: new Vector3() },\n\t\t\"up\": { value: new Vector3( 0, 1, 0 ) }\n\t},\n\n\tvertexShader: [\n\t\t'uniform vec3 sunPosition;',\n\t\t'uniform float rayleigh;',\n\t\t'uniform float turbidity;',\n\t\t'uniform float mieCoefficient;',\n\t\t'uniform vec3 up;',\n\n\t\t'varying vec3 vWorldPosition;',\n\t\t'varying vec3 vSunDirection;',\n\t\t'varying float vSunfade;',\n\t\t'varying vec3 vBetaR;',\n\t\t'varying vec3 vBetaM;',\n\t\t'varying float vSunE;',\n\n\t\t// constants for atmospheric scattering\n\t\t'const float e = 2.71828182845904523536028747135266249775724709369995957;',\n\t\t'const float pi = 3.141592653589793238462643383279502884197169;',\n\n\t\t// wavelength of used primaries, according to preetham\n\t\t'const vec3 lambda = vec3( 680E-9, 550E-9, 450E-9 );',\n\t\t// this pre-calcuation replaces older TotalRayleigh(vec3 lambda) function:\n\t\t// (8.0 * pow(pi, 3.0) * pow(pow(n, 2.0) - 1.0, 2.0) * (6.0 + 3.0 * pn)) / (3.0 * N * pow(lambda, vec3(4.0)) * (6.0 - 7.0 * pn))\n\t\t'const vec3 totalRayleigh = vec3( 5.804542996261093E-6, 1.3562911419845635E-5, 3.0265902468824876E-5 );',\n\n\t\t// mie stuff\n\t\t// K coefficient for the primaries\n\t\t'const float v = 4.0;',\n\t\t'const vec3 K = vec3( 0.686, 0.678, 0.666 );',\n\t\t// MieConst = pi * pow( ( 2.0 * pi ) / lambda, vec3( v - 2.0 ) ) * K\n\t\t'const vec3 MieConst = vec3( 1.8399918514433978E14, 2.7798023919660528E14, 4.0790479543861094E14 );',\n\n\t\t// earth shadow hack\n\t\t// cutoffAngle = pi / 1.95;\n\t\t'const float cutoffAngle = 1.6110731556870734;',\n\t\t'const float steepness = 1.5;',\n\t\t'const float EE = 1000.0;',\n\n\t\t'float sunIntensity( float zenithAngleCos ) {',\n\t\t'\tzenithAngleCos = clamp( zenithAngleCos, -1.0, 1.0 );',\n\t\t'\treturn EE * max( 0.0, 1.0 - pow( e, -( ( cutoffAngle - acos( zenithAngleCos ) ) / steepness ) ) );',\n\t\t'}',\n\n\t\t'vec3 totalMie( float T ) {',\n\t\t'\tfloat c = ( 0.2 * T ) * 10E-18;',\n\t\t'\treturn 0.434 * c * MieConst;',\n\t\t'}',\n\n\t\t'void main() {',\n\n\t\t'\tvec4 worldPosition = modelMatrix * vec4( position, 1.0 );',\n\t\t'\tvWorldPosition = worldPosition.xyz;',\n\n\t\t'\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );',\n\t\t'\tgl_Position.z = gl_Position.w;', // set z to camera.far\n\n\t\t'\tvSunDirection = normalize( sunPosition );',\n\n\t\t'\tvSunE = sunIntensity( dot( vSunDirection, up ) );',\n\n\t\t'\tvSunfade = 1.0 - clamp( 1.0 - exp( ( sunPosition.y / 450000.0 ) ), 0.0, 1.0 );',\n\n\t\t'\tfloat rayleighCoefficient = rayleigh - ( 1.0 * ( 1.0 - vSunfade ) );',\n\n\t\t// extinction (absorbtion + out scattering)\n\t\t// rayleigh coefficients\n\t\t'\tvBetaR = totalRayleigh * rayleighCoefficient;',\n\n\t\t// mie coefficients\n\t\t'\tvBetaM = totalMie( turbidity ) * mieCoefficient;',\n\n\t\t'}'\n\t].join( '\\n' ),\n\n\tfragmentShader: [\n\t\t'varying vec3 vWorldPosition;',\n\t\t'varying vec3 vSunDirection;',\n\t\t'varying float vSunfade;',\n\t\t'varying vec3 vBetaR;',\n\t\t'varying vec3 vBetaM;',\n\t\t'varying float vSunE;',\n\n\t\t'uniform float luminance;',\n\t\t'uniform float mieDirectionalG;',\n\t\t'uniform vec3 up;',\n\n\t\t'const vec3 cameraPos = vec3( 0.0, 0.0, 0.0 );',\n\n\t\t// constants for atmospheric scattering\n\t\t'const float pi = 3.141592653589793238462643383279502884197169;',\n\n\t\t'const float n = 1.0003;', // refractive index of air\n\t\t'const float N = 2.545E25;', // number of molecules per unit volume for air at 288.15K and 1013mb (sea level -45 celsius)\n\n\t\t// optical length at zenith for molecules\n\t\t'const float rayleighZenithLength = 8.4E3;',\n\t\t'const float mieZenithLength = 1.25E3;',\n\t\t// 66 arc seconds -> degrees, and the cosine of that\n\t\t'const float sunAngularDiameterCos = 0.999956676946448443553574619906976478926848692873900859324;',\n\n\t\t// 3.0 / ( 16.0 * pi )\n\t\t'const float THREE_OVER_SIXTEENPI = 0.05968310365946075;',\n\t\t// 1.0 / ( 4.0 * pi )\n\t\t'const float ONE_OVER_FOURPI = 0.07957747154594767;',\n\n\t\t'float rayleighPhase( float cosTheta ) {',\n\t\t'\treturn THREE_OVER_SIXTEENPI * ( 1.0 + pow( cosTheta, 2.0 ) );',\n\t\t'}',\n\n\t\t'float hgPhase( float cosTheta, float g ) {',\n\t\t'\tfloat g2 = pow( g, 2.0 );',\n\t\t'\tfloat inverse = 1.0 / pow( 1.0 - 2.0 * g * cosTheta + g2, 1.5 );',\n\t\t'\treturn ONE_OVER_FOURPI * ( ( 1.0 - g2 ) * inverse );',\n\t\t'}',\n\n\t\t// Filmic ToneMapping http://filmicgames.com/archives/75\n\t\t'const float A = 0.15;',\n\t\t'const float B = 0.50;',\n\t\t'const float C = 0.10;',\n\t\t'const float D = 0.20;',\n\t\t'const float E = 0.02;',\n\t\t'const float F = 0.30;',\n\n\t\t'const float whiteScale = 1.0748724675633854;', // 1.0 / Uncharted2Tonemap(1000.0)\n\n\t\t'vec3 Uncharted2Tonemap( vec3 x ) {',\n\t\t'\treturn ( ( x * ( A * x + C * B ) + D * E ) / ( x * ( A * x + B ) + D * F ) ) - E / F;',\n\t\t'}',\n\n\n\t\t'void main() {',\n\n\t\t'\tvec3 direction = normalize( vWorldPosition - cameraPos );',\n\n\t\t// optical length\n\t\t// cutoff angle at 90 to avoid singularity in next formula.\n\t\t'\tfloat zenithAngle = acos( max( 0.0, dot( up, direction ) ) );',\n\t\t'\tfloat inverse = 1.0 / ( cos( zenithAngle ) + 0.15 * pow( 93.885 - ( ( zenithAngle * 180.0 ) / pi ), -1.253 ) );',\n\t\t'\tfloat sR = rayleighZenithLength * inverse;',\n\t\t'\tfloat sM = mieZenithLength * inverse;',\n\n\t\t// combined extinction factor\n\t\t'\tvec3 Fex = exp( -( vBetaR * sR + vBetaM * sM ) );',\n\n\t\t// in scattering\n\t\t'\tfloat cosTheta = dot( direction, vSunDirection );',\n\n\t\t'\tfloat rPhase = rayleighPhase( cosTheta * 0.5 + 0.5 );',\n\t\t'\tvec3 betaRTheta = vBetaR * rPhase;',\n\n\t\t'\tfloat mPhase = hgPhase( cosTheta, mieDirectionalG );',\n\t\t'\tvec3 betaMTheta = vBetaM * mPhase;',\n\n\t\t'\tvec3 Lin = pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * ( 1.0 - Fex ), vec3( 1.5 ) );',\n\t\t'\tLin *= mix( vec3( 1.0 ), pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * Fex, vec3( 1.0 / 2.0 ) ), clamp( pow( 1.0 - dot( up, vSunDirection ), 5.0 ), 0.0, 1.0 ) );',\n\n\t\t// nightsky\n\t\t'\tfloat theta = acos( direction.y ); // elevation --> y-axis, [-pi/2, pi/2]',\n\t\t'\tfloat phi = atan( direction.z, direction.x ); // azimuth --> x-axis [-pi/2, pi/2]',\n\t\t'\tvec2 uv = vec2( phi, theta ) / vec2( 2.0 * pi, pi ) + vec2( 0.5, 0.0 );',\n\t\t'\tvec3 L0 = vec3( 0.1 ) * Fex;',\n\n\t\t// composition + solar disc\n\t\t'\tfloat sundisk = smoothstep( sunAngularDiameterCos, sunAngularDiameterCos + 0.00002, cosTheta );',\n\t\t'\tL0 += ( vSunE * 19000.0 * Fex ) * sundisk;',\n\n\t\t'\tvec3 texColor = ( Lin + L0 ) * 0.04 + vec3( 0.0, 0.0003, 0.00075 );',\n\n\t\t'\tvec3 curr = Uncharted2Tonemap( ( log2( 2.0 / pow( luminance, 4.0 ) ) ) * texColor );',\n\t\t'\tvec3 color = curr * whiteScale;',\n\n\t\t'\tvec3 retColor = pow( color, vec3( 1.0 / ( 1.2 + ( 1.2 * vSunfade ) ) ) );',\n\n\t\t'\tgl_FragColor = vec4( retColor, 1.0 );',\n\n\t\t'}'\n\t].join( '\\n' )\n\n};\n\nexport { Sky };\n","import { useReducer, useRef, useEffect, useLayoutEffect } from 'react';\n\nfunction create(createState) {\n  let state;\n  const listeners = new Set();\n\n  const setState = (partial, replace) => {\n    const nextState = typeof partial === 'function' ? partial(state) : partial;\n\n    if (nextState !== state) {\n      state = replace ? nextState : Object.assign({}, state, nextState);\n      listeners.forEach(listener => listener(state));\n    }\n  };\n\n  const getState = () => state;\n\n  const subscribeWithSelector = (listener, selector = getState, equalityFn = Object.is) => {\n    let currentSlice = selector(state);\n\n    function listenerToAdd() {\n      // Selector or equality function could throw but we don't want to stop\n      // the listener from being called.\n      // https://github.com/react-spring/zustand/pull/37\n      try {\n        const newStateSlice = selector(state);\n\n        if (!equalityFn(currentSlice, newStateSlice)) {\n          listener(currentSlice = newStateSlice);\n        }\n      } catch (error) {\n        listener(null, error);\n      }\n    }\n\n    listeners.add(listenerToAdd); // Unsubscribe\n\n    return () => listeners.delete(listenerToAdd);\n  };\n\n  const subscribe = (listener, selector, equalityFn) => {\n    if (selector || equalityFn) {\n      return subscribeWithSelector(listener, selector, equalityFn);\n    }\n\n    listeners.add(listener); // Unsubscribe\n\n    return () => listeners.delete(listener);\n  };\n\n  const destroy = () => listeners.clear();\n\n  const api = {\n    setState,\n    getState,\n    subscribe,\n    destroy\n  };\n  state = createState(setState, getState, api);\n  return api;\n}\n\nconst useIsoLayoutEffect = typeof window === 'undefined' ? useEffect : useLayoutEffect;\nfunction create$1(createState) {\n  const api = typeof createState === 'function' ? create(createState) : createState;\n\n  const useStore = (selector = api.getState, equalityFn = Object.is) => {\n    const [, forceUpdate] = useReducer(c => c + 1, 0);\n    const state = api.getState();\n    const stateRef = useRef(state);\n    const selectorRef = useRef(selector);\n    const equalityFnRef = useRef(equalityFn);\n    const erroredRef = useRef(false);\n    const currentSliceRef = useRef();\n\n    if (currentSliceRef.current === undefined) {\n      currentSliceRef.current = selector(state);\n    }\n\n    let newStateSlice;\n    let hasNewStateSlice = false; // The selector or equalityFn need to be called during the render phase if\n    // they change. We also want legitimate errors to be visible so we re-run\n    // them if they errored in the subscriber.\n\n    if (stateRef.current !== state || selectorRef.current !== selector || equalityFnRef.current !== equalityFn || erroredRef.current) {\n      // Using local variables to avoid mutations in the render phase.\n      newStateSlice = selector(state);\n      hasNewStateSlice = !equalityFn(currentSliceRef.current, newStateSlice);\n    } // Syncing changes in useEffect.\n\n\n    useIsoLayoutEffect(() => {\n      if (hasNewStateSlice) {\n        currentSliceRef.current = newStateSlice;\n      }\n\n      stateRef.current = state;\n      selectorRef.current = selector;\n      equalityFnRef.current = equalityFn;\n      erroredRef.current = false;\n    });\n    const stateBeforeSubscriptionRef = useRef(state);\n    useEffect(() => {\n      const listener = () => {\n        try {\n          const nextState = api.getState();\n          const nextStateSlice = selectorRef.current(nextState);\n\n          if (!equalityFnRef.current(currentSliceRef.current, nextStateSlice)) {\n            stateRef.current = nextState;\n            currentSliceRef.current = nextStateSlice;\n            forceUpdate();\n          }\n        } catch (error) {\n          erroredRef.current = true;\n          forceUpdate();\n        }\n      };\n\n      const unsubscribe = api.subscribe(listener);\n\n      if (api.getState() !== stateBeforeSubscriptionRef.current) {\n        listener(); // state has changed before subscription\n      }\n\n      return unsubscribe;\n    }, []);\n    return hasNewStateSlice ? newStateSlice : currentSliceRef.current;\n  };\n\n  Object.assign(useStore, api); // For backward compatibility (No TS types for this)\n\n  useStore[Symbol.iterator] = function* () {\n    console.warn('[useStore, api] = create() is deprecated and will be removed in v4');\n    yield useStore;\n    yield api;\n  };\n\n  return useStore;\n}\n\nexport default create$1;\n","/**\n * @author WestLangley / http://github.com/WestLangley\n *\n * parameters = {\n *  color: <hex>,\n *  linewidth: <float>,\n *  dashed: <boolean>,\n *  dashScale: <float>,\n *  dashSize: <float>,\n *  gapSize: <float>,\n *  resolution: <Vector2>, // to be set by renderer\n * }\n */\n\nimport {\n\tShaderLib,\n\tShaderMaterial,\n\tUniformsLib,\n\tUniformsUtils,\n\tVector2\n} from \"../../../build/three.module.js\";\n\nUniformsLib.line = {\n\n\tlinewidth: { value: 1 },\n\tresolution: { value: new Vector2( 1, 1 ) },\n\tdashScale: { value: 1 },\n\tdashSize: { value: 1 },\n\tgapSize: { value: 1 }, // todo FIX - maybe change to totalSize\n\topacity: { value: 1 }\n\n};\n\nShaderLib[ 'line' ] = {\n\n\tuniforms: UniformsUtils.merge( [\n\t\tUniformsLib.common,\n\t\tUniformsLib.fog,\n\t\tUniformsLib.line\n\t] ),\n\n\tvertexShader:\n\t\t`\n\t\t#include <common>\n\t\t#include <color_pars_vertex>\n\t\t#include <fog_pars_vertex>\n\t\t#include <logdepthbuf_pars_vertex>\n\t\t#include <clipping_planes_pars_vertex>\n\n\t\tuniform float linewidth;\n\t\tuniform vec2 resolution;\n\n\t\tattribute vec3 instanceStart;\n\t\tattribute vec3 instanceEnd;\n\n\t\tattribute vec3 instanceColorStart;\n\t\tattribute vec3 instanceColorEnd;\n\n\t\tvarying vec2 vUv;\n\n\t\t#ifdef USE_DASH\n\n\t\t\tuniform float dashScale;\n\t\t\tattribute float instanceDistanceStart;\n\t\t\tattribute float instanceDistanceEnd;\n\t\t\tvarying float vLineDistance;\n\n\t\t#endif\n\n\t\tvoid trimSegment( const in vec4 start, inout vec4 end ) {\n\n\t\t\t// trim end segment so it terminates between the camera plane and the near plane\n\n\t\t\t// conservative estimate of the near plane\n\t\t\tfloat a = projectionMatrix[ 2 ][ 2 ]; // 3nd entry in 3th column\n\t\t\tfloat b = projectionMatrix[ 3 ][ 2 ]; // 3nd entry in 4th column\n\t\t\tfloat nearEstimate = - 0.5 * b / a;\n\n\t\t\tfloat alpha = ( nearEstimate - start.z ) / ( end.z - start.z );\n\n\t\t\tend.xyz = mix( start.xyz, end.xyz, alpha );\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\t#ifdef USE_COLOR\n\n\t\t\t\tvColor.xyz = ( position.y < 0.5 ) ? instanceColorStart : instanceColorEnd;\n\n\t\t\t#endif\n\n\t\t\t#ifdef USE_DASH\n\n\t\t\t\tvLineDistance = ( position.y < 0.5 ) ? dashScale * instanceDistanceStart : dashScale * instanceDistanceEnd;\n\n\t\t\t#endif\n\n\t\t\tfloat aspect = resolution.x / resolution.y;\n\n\t\t\tvUv = uv;\n\n\t\t\t// camera space\n\t\t\tvec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );\n\t\t\tvec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );\n\n\t\t\t// special case for perspective projection, and segments that terminate either in, or behind, the camera plane\n\t\t\t// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space\n\t\t\t// but we need to perform ndc-space calculations in the shader, so we must address this issue directly\n\t\t\t// perhaps there is a more elegant solution -- WestLangley\n\n\t\t\tbool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 ); // 4th entry in the 3rd column\n\n\t\t\tif ( perspective ) {\n\n\t\t\t\tif ( start.z < 0.0 && end.z >= 0.0 ) {\n\n\t\t\t\t\ttrimSegment( start, end );\n\n\t\t\t\t} else if ( end.z < 0.0 && start.z >= 0.0 ) {\n\n\t\t\t\t\ttrimSegment( end, start );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// clip space\n\t\t\tvec4 clipStart = projectionMatrix * start;\n\t\t\tvec4 clipEnd = projectionMatrix * end;\n\n\t\t\t// ndc space\n\t\t\tvec2 ndcStart = clipStart.xy / clipStart.w;\n\t\t\tvec2 ndcEnd = clipEnd.xy / clipEnd.w;\n\n\t\t\t// direction\n\t\t\tvec2 dir = ndcEnd - ndcStart;\n\n\t\t\t// account for clip-space aspect ratio\n\t\t\tdir.x *= aspect;\n\t\t\tdir = normalize( dir );\n\n\t\t\t// perpendicular to dir\n\t\t\tvec2 offset = vec2( dir.y, - dir.x );\n\n\t\t\t// undo aspect ratio adjustment\n\t\t\tdir.x /= aspect;\n\t\t\toffset.x /= aspect;\n\n\t\t\t// sign flip\n\t\t\tif ( position.x < 0.0 ) offset *= - 1.0;\n\n\t\t\t// endcaps\n\t\t\tif ( position.y < 0.0 ) {\n\n\t\t\t\toffset += - dir;\n\n\t\t\t} else if ( position.y > 1.0 ) {\n\n\t\t\t\toffset += dir;\n\n\t\t\t}\n\n\t\t\t// adjust for linewidth\n\t\t\toffset *= linewidth;\n\n\t\t\t// adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...\n\t\t\toffset /= resolution.y;\n\n\t\t\t// select end\n\t\t\tvec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;\n\n\t\t\t// back to clip space\n\t\t\toffset *= clip.w;\n\n\t\t\tclip.xy += offset;\n\n\t\t\tgl_Position = clip;\n\n\t\t\tvec4 mvPosition = ( position.y < 0.5 ) ? start : end; // this is an approximation\n\n\t\t\t#include <logdepthbuf_vertex>\n\t\t\t#include <clipping_planes_vertex>\n\t\t\t#include <fog_vertex>\n\n\t\t}\n\t\t`,\n\n\tfragmentShader:\n\t\t`\n\t\tuniform vec3 diffuse;\n\t\tuniform float opacity;\n\n\t\t#ifdef USE_DASH\n\n\t\t\tuniform float dashSize;\n\t\t\tuniform float gapSize;\n\n\t\t#endif\n\n\t\tvarying float vLineDistance;\n\n\t\t#include <common>\n\t\t#include <color_pars_fragment>\n\t\t#include <fog_pars_fragment>\n\t\t#include <logdepthbuf_pars_fragment>\n\t\t#include <clipping_planes_pars_fragment>\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\t#include <clipping_planes_fragment>\n\n\t\t\t#ifdef USE_DASH\n\n\t\t\t\tif ( vUv.y < - 1.0 || vUv.y > 1.0 ) discard; // discard endcaps\n\n\t\t\t\tif ( mod( vLineDistance, dashSize + gapSize ) > dashSize ) discard; // todo - FIX\n\n\t\t\t#endif\n\n\t\t\tif ( abs( vUv.y ) > 1.0 ) {\n\n\t\t\t\tfloat a = vUv.x;\n\t\t\t\tfloat b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;\n\t\t\t\tfloat len2 = a * a + b * b;\n\n\t\t\t\tif ( len2 > 1.0 ) discard;\n\n\t\t\t}\n\n\t\t\tvec4 diffuseColor = vec4( diffuse, opacity );\n\n\t\t\t#include <logdepthbuf_fragment>\n\t\t\t#include <color_fragment>\n\n\t\t\tgl_FragColor = vec4( diffuseColor.rgb, diffuseColor.a );\n\n\t\t\t#include <tonemapping_fragment>\n\t\t\t#include <encodings_fragment>\n\t\t\t#include <fog_fragment>\n\t\t\t#include <premultiplied_alpha_fragment>\n\n\t\t}\n\t\t`\n};\n\nvar LineMaterial = function ( parameters ) {\n\n\tShaderMaterial.call( this, {\n\n\t\ttype: 'LineMaterial',\n\n\t\tuniforms: UniformsUtils.clone( ShaderLib[ 'line' ].uniforms ),\n\n\t\tvertexShader: ShaderLib[ 'line' ].vertexShader,\n\t\tfragmentShader: ShaderLib[ 'line' ].fragmentShader,\n\n\t\tclipping: true // required for clipping support\n\n\t} );\n\n\tthis.dashed = false;\n\n\tObject.defineProperties( this, {\n\n\t\tcolor: {\n\n\t\t\tenumerable: true,\n\n\t\t\tget: function () {\n\n\t\t\t\treturn this.uniforms.diffuse.value;\n\n\t\t\t},\n\n\t\t\tset: function ( value ) {\n\n\t\t\t\tthis.uniforms.diffuse.value = value;\n\n\t\t\t}\n\n\t\t},\n\n\t\tlinewidth: {\n\n\t\t\tenumerable: true,\n\n\t\t\tget: function () {\n\n\t\t\t\treturn this.uniforms.linewidth.value;\n\n\t\t\t},\n\n\t\t\tset: function ( value ) {\n\n\t\t\t\tthis.uniforms.linewidth.value = value;\n\n\t\t\t}\n\n\t\t},\n\n\t\tdashScale: {\n\n\t\t\tenumerable: true,\n\n\t\t\tget: function () {\n\n\t\t\t\treturn this.uniforms.dashScale.value;\n\n\t\t\t},\n\n\t\t\tset: function ( value ) {\n\n\t\t\t\tthis.uniforms.dashScale.value = value;\n\n\t\t\t}\n\n\t\t},\n\n\t\tdashSize: {\n\n\t\t\tenumerable: true,\n\n\t\t\tget: function () {\n\n\t\t\t\treturn this.uniforms.dashSize.value;\n\n\t\t\t},\n\n\t\t\tset: function ( value ) {\n\n\t\t\t\tthis.uniforms.dashSize.value = value;\n\n\t\t\t}\n\n\t\t},\n\n\t\tgapSize: {\n\n\t\t\tenumerable: true,\n\n\t\t\tget: function () {\n\n\t\t\t\treturn this.uniforms.gapSize.value;\n\n\t\t\t},\n\n\t\t\tset: function ( value ) {\n\n\t\t\t\tthis.uniforms.gapSize.value = value;\n\n\t\t\t}\n\n\t\t},\n\n\t\topacity: {\n\n\t\t\tenumerable: true,\n\n\t\t\tget: function () {\n\n\t\t\t\treturn this.uniforms.opacity.value;\n\n\t\t\t},\n\n\t\t\tset: function ( value ) {\n\n\t\t\t\tthis.uniforms.opacity.value = value;\n\n\t\t\t}\n\n\t\t},\n\n\t\tresolution: {\n\n\t\t\tenumerable: true,\n\n\t\t\tget: function () {\n\n\t\t\t\treturn this.uniforms.resolution.value;\n\n\t\t\t},\n\n\t\t\tset: function ( value ) {\n\n\t\t\t\tthis.uniforms.resolution.value.copy( value );\n\n\t\t\t}\n\n\t\t}\n\n\t} );\n\n\tthis.setValues( parameters );\n\n};\n\nLineMaterial.prototype = Object.create( ShaderMaterial.prototype );\nLineMaterial.prototype.constructor = LineMaterial;\n\nLineMaterial.prototype.isLineMaterial = true;\n\n\nexport { LineMaterial };\n","/**\n * @author WestLangley / http://github.com/WestLangley\n *\n */\n\n\nimport { LineSegmentsGeometry } from \"../lines/LineSegmentsGeometry.js\";\n\nvar LineGeometry = function () {\n\n\tLineSegmentsGeometry.call( this );\n\n\tthis.type = 'LineGeometry';\n\n};\n\nLineGeometry.prototype = Object.assign( Object.create( LineSegmentsGeometry.prototype ), {\n\n\tconstructor: LineGeometry,\n\n\tisLineGeometry: true,\n\n\tsetPositions: function ( array ) {\n\n\t\t// converts [ x1, y1, z1,  x2, y2, z2, ... ] to pairs format\n\n\t\tvar length = array.length - 3;\n\t\tvar points = new Float32Array( 2 * length );\n\n\t\tfor ( var i = 0; i < length; i += 3 ) {\n\n\t\t\tpoints[ 2 * i ] = array[ i ];\n\t\t\tpoints[ 2 * i + 1 ] = array[ i + 1 ];\n\t\t\tpoints[ 2 * i + 2 ] = array[ i + 2 ];\n\n\t\t\tpoints[ 2 * i + 3 ] = array[ i + 3 ];\n\t\t\tpoints[ 2 * i + 4 ] = array[ i + 4 ];\n\t\t\tpoints[ 2 * i + 5 ] = array[ i + 5 ];\n\n\t\t}\n\n\t\tLineSegmentsGeometry.prototype.setPositions.call( this, points );\n\n\t\treturn this;\n\n\t},\n\n\tsetColors: function ( array ) {\n\n\t\t// converts [ r1, g1, b1,  r2, g2, b2, ... ] to pairs format\n\n\t\tvar length = array.length - 3;\n\t\tvar colors = new Float32Array( 2 * length );\n\n\t\tfor ( var i = 0; i < length; i += 3 ) {\n\n\t\t\tcolors[ 2 * i ] = array[ i ];\n\t\t\tcolors[ 2 * i + 1 ] = array[ i + 1 ];\n\t\t\tcolors[ 2 * i + 2 ] = array[ i + 2 ];\n\n\t\t\tcolors[ 2 * i + 3 ] = array[ i + 3 ];\n\t\t\tcolors[ 2 * i + 4 ] = array[ i + 4 ];\n\t\t\tcolors[ 2 * i + 5 ] = array[ i + 5 ];\n\n\t\t}\n\n\t\tLineSegmentsGeometry.prototype.setColors.call( this, colors );\n\n\t\treturn this;\n\n\t},\n\n\tfromLine: function ( line ) {\n\n\t\tvar geometry = line.geometry;\n\n\t\tif ( geometry.isGeometry ) {\n\n\t\t\tthis.setPositions( geometry.vertices );\n\n\t\t} else if ( geometry.isBufferGeometry ) {\n\n\t\t\tthis.setPositions( geometry.attributes.position.array ); // assumes non-indexed\n\n\t\t}\n\n\t\t// set colors, maybe\n\n\t\treturn this;\n\n\t},\n\n\tcopy: function ( /* source */ ) {\n\n\t\t// todo\n\n\t\treturn this;\n\n\t}\n\n} );\n\nexport { LineGeometry };\n","/**\n * @author WestLangley / http://github.com/WestLangley\n *\n */\n\nimport {\n\tInstancedInterleavedBuffer,\n\tInterleavedBufferAttribute,\n\tLine3,\n\tMathUtils,\n\tMatrix4,\n\tMesh,\n\tVector3,\n\tVector4\n} from \"../../../build/three.module.js\";\nimport { LineSegmentsGeometry } from \"../lines/LineSegmentsGeometry.js\";\nimport { LineMaterial } from \"../lines/LineMaterial.js\";\n\nvar LineSegments2 = function ( geometry, material ) {\n\n\tMesh.call( this );\n\n\tthis.type = 'LineSegments2';\n\n\tthis.geometry = geometry !== undefined ? geometry : new LineSegmentsGeometry();\n\tthis.material = material !== undefined ? material : new LineMaterial( { color: Math.random() * 0xffffff } );\n\n};\n\nLineSegments2.prototype = Object.assign( Object.create( Mesh.prototype ), {\n\n\tconstructor: LineSegments2,\n\n\tisLineSegments2: true,\n\n\tcomputeLineDistances: ( function () { // for backwards-compatability, but could be a method of LineSegmentsGeometry...\n\n\t\tvar start = new Vector3();\n\t\tvar end = new Vector3();\n\n\t\treturn function computeLineDistances() {\n\n\t\t\tvar geometry = this.geometry;\n\n\t\t\tvar instanceStart = geometry.attributes.instanceStart;\n\t\t\tvar instanceEnd = geometry.attributes.instanceEnd;\n\t\t\tvar lineDistances = new Float32Array( 2 * instanceStart.data.count );\n\n\t\t\tfor ( var i = 0, j = 0, l = instanceStart.data.count; i < l; i ++, j += 2 ) {\n\n\t\t\t\tstart.fromBufferAttribute( instanceStart, i );\n\t\t\t\tend.fromBufferAttribute( instanceEnd, i );\n\n\t\t\t\tlineDistances[ j ] = ( j === 0 ) ? 0 : lineDistances[ j - 1 ];\n\t\t\t\tlineDistances[ j + 1 ] = lineDistances[ j ] + start.distanceTo( end );\n\n\t\t\t}\n\n\t\t\tvar instanceDistanceBuffer = new InstancedInterleavedBuffer( lineDistances, 2, 1 ); // d0, d1\n\n\t\t\tgeometry.setAttribute( 'instanceDistanceStart', new InterleavedBufferAttribute( instanceDistanceBuffer, 1, 0 ) ); // d0\n\t\t\tgeometry.setAttribute( 'instanceDistanceEnd', new InterleavedBufferAttribute( instanceDistanceBuffer, 1, 1 ) ); // d1\n\n\t\t\treturn this;\n\n\t\t};\n\n\t}() ),\n\n\traycast: ( function () {\n\n\t\tvar start = new Vector4();\n\t\tvar end = new Vector4();\n\n\t\tvar ssOrigin = new Vector4();\n\t\tvar ssOrigin3 = new Vector3();\n\t\tvar mvMatrix = new Matrix4();\n\t\tvar line = new Line3();\n\t\tvar closestPoint = new Vector3();\n\n\t\treturn function raycast( raycaster, intersects ) {\n\n\t\t\tif ( raycaster.camera === null ) {\n\n\t\t\t\tconsole.error( 'LineSegments2: \"Raycaster.camera\" needs to be set in order to raycast against LineSegments2.' );\n\n\t\t\t}\n\n\t\t\tvar ray = raycaster.ray;\n\t\t\tvar camera = raycaster.camera;\n\t\t\tvar projectionMatrix = camera.projectionMatrix;\n\n\t\t\tvar geometry = this.geometry;\n\t\t\tvar material = this.material;\n\t\t\tvar resolution = material.resolution;\n\t\t\tvar lineWidth = material.linewidth;\n\n\t\t\tvar instanceStart = geometry.attributes.instanceStart;\n\t\t\tvar instanceEnd = geometry.attributes.instanceEnd;\n\n\t\t\t// pick a point 1 unit out along the ray to avoid the ray origin\n\t\t\t// sitting at the camera origin which will cause \"w\" to be 0 when\n\t\t\t// applying the projection matrix.\n\t\t\tray.at( 1, ssOrigin );\n\n\t\t\t// ndc space [ - 1.0, 1.0 ]\n\t\t\tssOrigin.w = 1;\n\t\t\tssOrigin.applyMatrix4( camera.matrixWorldInverse );\n\t\t\tssOrigin.applyMatrix4( projectionMatrix );\n\t\t\tssOrigin.multiplyScalar( 1 / ssOrigin.w );\n\n\t\t\t// screen space\n\t\t\tssOrigin.x *= resolution.x / 2;\n\t\t\tssOrigin.y *= resolution.y / 2;\n\t\t\tssOrigin.z = 0;\n\n\t\t\tssOrigin3.copy( ssOrigin );\n\n\t\t\tvar matrixWorld = this.matrixWorld;\n\t\t\tmvMatrix.multiplyMatrices( camera.matrixWorldInverse, matrixWorld );\n\n\t\t\tfor ( var i = 0, l = instanceStart.count; i < l; i ++ ) {\n\n\t\t\t\tstart.fromBufferAttribute( instanceStart, i );\n\t\t\t\tend.fromBufferAttribute( instanceEnd, i );\n\n\t\t\t\tstart.w = 1;\n\t\t\t\tend.w = 1;\n\n\t\t\t\t// camera space\n\t\t\t\tstart.applyMatrix4( mvMatrix );\n\t\t\t\tend.applyMatrix4( mvMatrix );\n\n\t\t\t\t// clip space\n\t\t\t\tstart.applyMatrix4( projectionMatrix );\n\t\t\t\tend.applyMatrix4( projectionMatrix );\n\n\t\t\t\t// ndc space [ - 1.0, 1.0 ]\n\t\t\t\tstart.multiplyScalar( 1 / start.w );\n\t\t\t\tend.multiplyScalar( 1 / end.w );\n\n\t\t\t\t// skip the segment if it's outside the camera near and far planes\n\t\t\t\tvar isBehindCameraNear = start.z < - 1 && end.z < - 1;\n\t\t\t\tvar isPastCameraFar = start.z > 1 && end.z > 1;\n\t\t\t\tif ( isBehindCameraNear || isPastCameraFar ) {\n\n\t\t\t\t\tcontinue;\n\n\t\t\t\t}\n\n\t\t\t\t// screen space\n\t\t\t\tstart.x *= resolution.x / 2;\n\t\t\t\tstart.y *= resolution.y / 2;\n\n\t\t\t\tend.x *= resolution.x / 2;\n\t\t\t\tend.y *= resolution.y / 2;\n\n\t\t\t\t// create 2d segment\n\t\t\t\tline.start.copy( start );\n\t\t\t\tline.start.z = 0;\n\n\t\t\t\tline.end.copy( end );\n\t\t\t\tline.end.z = 0;\n\n\t\t\t\t// get closest point on ray to segment\n\t\t\t\tvar param = line.closestPointToPointParameter( ssOrigin3, true );\n\t\t\t\tline.at( param, closestPoint );\n\n\t\t\t\t// check if the intersection point is within clip space\n\t\t\t\tvar zPos = MathUtils.lerp( start.z, end.z, param );\n\t\t\t\tvar isInClipSpace = zPos >= - 1 && zPos <= 1;\n\n\t\t\t\tvar isInside = ssOrigin3.distanceTo( closestPoint ) < lineWidth * 0.5;\n\n\t\t\t\tif ( isInClipSpace && isInside ) {\n\n\t\t\t\t\tline.start.fromBufferAttribute( instanceStart, i );\n\t\t\t\t\tline.end.fromBufferAttribute( instanceEnd, i );\n\n\t\t\t\t\tline.start.applyMatrix4( matrixWorld );\n\t\t\t\t\tline.end.applyMatrix4( matrixWorld );\n\n\t\t\t\t\tvar pointOnLine = new Vector3();\n\t\t\t\t\tvar point = new Vector3();\n\n\t\t\t\t\tray.distanceSqToSegment( line.start, line.end, point, pointOnLine );\n\n\t\t\t\t\tintersects.push( {\n\n\t\t\t\t\t\tpoint: point,\n\t\t\t\t\t\tpointOnLine: pointOnLine,\n\t\t\t\t\t\tdistance: ray.origin.distanceTo( point ),\n\n\t\t\t\t\t\tobject: this,\n\t\t\t\t\t\tface: null,\n\t\t\t\t\t\tfaceIndex: i,\n\t\t\t\t\t\tuv: null,\n\t\t\t\t\t\tuv2: null,\n\n\t\t\t\t\t} );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t};\n\n\t}() )\n\n} );\n\nexport { LineSegments2 };\n","/**\n * @author WestLangley / http://github.com/WestLangley\n *\n */\n\n\nimport { LineSegments2 } from \"../lines/LineSegments2.js\";\nimport { LineGeometry } from \"../lines/LineGeometry.js\";\nimport { LineMaterial } from \"../lines/LineMaterial.js\";\n\nvar Line2 = function ( geometry, material ) {\n\n\tLineSegments2.call( this );\n\n\tthis.type = 'Line2';\n\n\tthis.geometry = geometry !== undefined ? geometry : new LineGeometry();\n\tthis.material = material !== undefined ? material : new LineMaterial( { color: Math.random() * 0xffffff } );\n\n};\n\nLine2.prototype = Object.assign( Object.create( LineSegments2.prototype ), {\n\n\tconstructor: Line2,\n\n\tisLine2: true\n\n} );\n\nexport { Line2 };\n","/**\n * @author Eberhard Graether / http://egraether.com/\n * @author Mark Lundin \t/ http://mark-lundin.com\n * @author Simone Manini / http://daron1337.github.io\n * @author Luca Antiga \t/ http://lantiga.github.io\n */\n\nimport {\n\tEventDispatcher,\n\tMOUSE,\n\tQuaternion,\n\tVector2,\n\tVector3\n} from \"../../../build/three.module.js\";\n\nvar TrackballControls = function ( object, domElement ) {\n\n\tif ( domElement === undefined ) console.warn( 'THREE.TrackballControls: The second parameter \"domElement\" is now mandatory.' );\n\tif ( domElement === document ) console.error( 'THREE.TrackballControls: \"document\" should not be used as the target \"domElement\". Please use \"renderer.domElement\" instead.' );\n\n\tvar _this = this;\n\tvar STATE = { NONE: - 1, ROTATE: 0, ZOOM: 1, PAN: 2, TOUCH_ROTATE: 3, TOUCH_ZOOM_PAN: 4 };\n\n\tthis.object = object;\n\tthis.domElement = domElement;\n\n\t// API\n\n\tthis.enabled = true;\n\n\tthis.screen = { left: 0, top: 0, width: 0, height: 0 };\n\n\tthis.rotateSpeed = 1.0;\n\tthis.zoomSpeed = 1.2;\n\tthis.panSpeed = 0.3;\n\n\tthis.noRotate = false;\n\tthis.noZoom = false;\n\tthis.noPan = false;\n\n\tthis.staticMoving = false;\n\tthis.dynamicDampingFactor = 0.2;\n\n\tthis.minDistance = 0;\n\tthis.maxDistance = Infinity;\n\n\tthis.keys = [ 65 /*A*/, 83 /*S*/, 68 /*D*/ ];\n\n\tthis.mouseButtons = { LEFT: MOUSE.ROTATE, MIDDLE: MOUSE.ZOOM, RIGHT: MOUSE.PAN };\n\n\t// internals\n\n\tthis.target = new Vector3();\n\n\tvar EPS = 0.000001;\n\n\tvar lastPosition = new Vector3();\n\tvar lastZoom = 1;\n\n\tvar _state = STATE.NONE,\n\t\t_keyState = STATE.NONE,\n\n\t\t_eye = new Vector3(),\n\n\t\t_movePrev = new Vector2(),\n\t\t_moveCurr = new Vector2(),\n\n\t\t_lastAxis = new Vector3(),\n\t\t_lastAngle = 0,\n\n\t\t_zoomStart = new Vector2(),\n\t\t_zoomEnd = new Vector2(),\n\n\t\t_touchZoomDistanceStart = 0,\n\t\t_touchZoomDistanceEnd = 0,\n\n\t\t_panStart = new Vector2(),\n\t\t_panEnd = new Vector2();\n\n\t// for reset\n\n\tthis.target0 = this.target.clone();\n\tthis.position0 = this.object.position.clone();\n\tthis.up0 = this.object.up.clone();\n\tthis.zoom0 = this.object.zoom;\n\n\t// events\n\n\tvar changeEvent = { type: 'change' };\n\tvar startEvent = { type: 'start' };\n\tvar endEvent = { type: 'end' };\n\n\n\t// methods\n\n\tthis.handleResize = function () {\n\n\t\tvar box = this.domElement.getBoundingClientRect();\n\t\t// adjustments come from similar code in the jquery offset() function\n\t\tvar d = this.domElement.ownerDocument.documentElement;\n\t\tthis.screen.left = box.left + window.pageXOffset - d.clientLeft;\n\t\tthis.screen.top = box.top + window.pageYOffset - d.clientTop;\n\t\tthis.screen.width = box.width;\n\t\tthis.screen.height = box.height;\n\n\t};\n\n\tvar getMouseOnScreen = ( function () {\n\n\t\tvar vector = new Vector2();\n\n\t\treturn function getMouseOnScreen( pageX, pageY ) {\n\n\t\t\tvector.set(\n\t\t\t\t( pageX - _this.screen.left ) / _this.screen.width,\n\t\t\t\t( pageY - _this.screen.top ) / _this.screen.height\n\t\t\t);\n\n\t\t\treturn vector;\n\n\t\t};\n\n\t}() );\n\n\tvar getMouseOnCircle = ( function () {\n\n\t\tvar vector = new Vector2();\n\n\t\treturn function getMouseOnCircle( pageX, pageY ) {\n\n\t\t\tvector.set(\n\t\t\t\t( ( pageX - _this.screen.width * 0.5 - _this.screen.left ) / ( _this.screen.width * 0.5 ) ),\n\t\t\t\t( ( _this.screen.height + 2 * ( _this.screen.top - pageY ) ) / _this.screen.width ) // screen.width intentional\n\t\t\t);\n\n\t\t\treturn vector;\n\n\t\t};\n\n\t}() );\n\n\tthis.rotateCamera = ( function () {\n\n\t\tvar axis = new Vector3(),\n\t\t\tquaternion = new Quaternion(),\n\t\t\teyeDirection = new Vector3(),\n\t\t\tobjectUpDirection = new Vector3(),\n\t\t\tobjectSidewaysDirection = new Vector3(),\n\t\t\tmoveDirection = new Vector3(),\n\t\t\tangle;\n\n\t\treturn function rotateCamera() {\n\n\t\t\tmoveDirection.set( _moveCurr.x - _movePrev.x, _moveCurr.y - _movePrev.y, 0 );\n\t\t\tangle = moveDirection.length();\n\n\t\t\tif ( angle ) {\n\n\t\t\t\t_eye.copy( _this.object.position ).sub( _this.target );\n\n\t\t\t\teyeDirection.copy( _eye ).normalize();\n\t\t\t\tobjectUpDirection.copy( _this.object.up ).normalize();\n\t\t\t\tobjectSidewaysDirection.crossVectors( objectUpDirection, eyeDirection ).normalize();\n\n\t\t\t\tobjectUpDirection.setLength( _moveCurr.y - _movePrev.y );\n\t\t\t\tobjectSidewaysDirection.setLength( _moveCurr.x - _movePrev.x );\n\n\t\t\t\tmoveDirection.copy( objectUpDirection.add( objectSidewaysDirection ) );\n\n\t\t\t\taxis.crossVectors( moveDirection, _eye ).normalize();\n\n\t\t\t\tangle *= _this.rotateSpeed;\n\t\t\t\tquaternion.setFromAxisAngle( axis, angle );\n\n\t\t\t\t_eye.applyQuaternion( quaternion );\n\t\t\t\t_this.object.up.applyQuaternion( quaternion );\n\n\t\t\t\t_lastAxis.copy( axis );\n\t\t\t\t_lastAngle = angle;\n\n\t\t\t} else if ( ! _this.staticMoving && _lastAngle ) {\n\n\t\t\t\t_lastAngle *= Math.sqrt( 1.0 - _this.dynamicDampingFactor );\n\t\t\t\t_eye.copy( _this.object.position ).sub( _this.target );\n\t\t\t\tquaternion.setFromAxisAngle( _lastAxis, _lastAngle );\n\t\t\t\t_eye.applyQuaternion( quaternion );\n\t\t\t\t_this.object.up.applyQuaternion( quaternion );\n\n\t\t\t}\n\n\t\t\t_movePrev.copy( _moveCurr );\n\n\t\t};\n\n\t}() );\n\n\n\tthis.zoomCamera = function () {\n\n\t\tvar factor;\n\n\t\tif ( _state === STATE.TOUCH_ZOOM_PAN ) {\n\n\t\t\tfactor = _touchZoomDistanceStart / _touchZoomDistanceEnd;\n\t\t\t_touchZoomDistanceStart = _touchZoomDistanceEnd;\n\n\t\t\tif ( _this.object.isPerspectiveCamera ) {\n\n\t\t\t\t_eye.multiplyScalar( factor );\n\n\t\t\t} else if ( _this.object.isOrthographicCamera ) {\n\n\t\t\t\t_this.object.zoom *= factor;\n\t\t\t\t_this.object.updateProjectionMatrix();\n\n\t\t\t} else {\n\n\t\t\t\tconsole.warn( 'THREE.TrackballControls: Unsupported camera type' );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tfactor = 1.0 + ( _zoomEnd.y - _zoomStart.y ) * _this.zoomSpeed;\n\n\t\t\tif ( factor !== 1.0 && factor > 0.0 ) {\n\n\t\t\t\tif ( _this.object.isPerspectiveCamera ) {\n\n\t\t\t\t\t_eye.multiplyScalar( factor );\n\n\t\t\t\t} else if ( _this.object.isOrthographicCamera ) {\n\n\t\t\t\t\t_this.object.zoom /= factor;\n\t\t\t\t\t_this.object.updateProjectionMatrix();\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.warn( 'THREE.TrackballControls: Unsupported camera type' );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( _this.staticMoving ) {\n\n\t\t\t\t_zoomStart.copy( _zoomEnd );\n\n\t\t\t} else {\n\n\t\t\t\t_zoomStart.y += ( _zoomEnd.y - _zoomStart.y ) * this.dynamicDampingFactor;\n\n\t\t\t}\n\n\t\t}\n\n\t};\n\n\tthis.panCamera = ( function () {\n\n\t\tvar mouseChange = new Vector2(),\n\t\t\tobjectUp = new Vector3(),\n\t\t\tpan = new Vector3();\n\n\t\treturn function panCamera() {\n\n\t\t\tmouseChange.copy( _panEnd ).sub( _panStart );\n\n\t\t\tif ( mouseChange.lengthSq() ) {\n\n\t\t\t\tif ( _this.object.isOrthographicCamera ) {\n\n\t\t\t\t\tvar scale_x = ( _this.object.right - _this.object.left ) / _this.object.zoom / _this.domElement.clientWidth;\n\t\t\t\t\tvar scale_y = ( _this.object.top - _this.object.bottom ) / _this.object.zoom / _this.domElement.clientWidth;\n\n\t\t\t\t\tmouseChange.x *= scale_x;\n\t\t\t\t\tmouseChange.y *= scale_y;\n\n\t\t\t\t}\n\n\t\t\t\tmouseChange.multiplyScalar( _eye.length() * _this.panSpeed );\n\n\t\t\t\tpan.copy( _eye ).cross( _this.object.up ).setLength( mouseChange.x );\n\t\t\t\tpan.add( objectUp.copy( _this.object.up ).setLength( mouseChange.y ) );\n\n\t\t\t\t_this.object.position.add( pan );\n\t\t\t\t_this.target.add( pan );\n\n\t\t\t\tif ( _this.staticMoving ) {\n\n\t\t\t\t\t_panStart.copy( _panEnd );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t_panStart.add( mouseChange.subVectors( _panEnd, _panStart ).multiplyScalar( _this.dynamicDampingFactor ) );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t};\n\n\t}() );\n\n\tthis.checkDistances = function () {\n\n\t\tif ( ! _this.noZoom || ! _this.noPan ) {\n\n\t\t\tif ( _eye.lengthSq() > _this.maxDistance * _this.maxDistance ) {\n\n\t\t\t\t_this.object.position.addVectors( _this.target, _eye.setLength( _this.maxDistance ) );\n\t\t\t\t_zoomStart.copy( _zoomEnd );\n\n\t\t\t}\n\n\t\t\tif ( _eye.lengthSq() < _this.minDistance * _this.minDistance ) {\n\n\t\t\t\t_this.object.position.addVectors( _this.target, _eye.setLength( _this.minDistance ) );\n\t\t\t\t_zoomStart.copy( _zoomEnd );\n\n\t\t\t}\n\n\t\t}\n\n\t};\n\n\tthis.update = function () {\n\n\t\t_eye.subVectors( _this.object.position, _this.target );\n\n\t\tif ( ! _this.noRotate ) {\n\n\t\t\t_this.rotateCamera();\n\n\t\t}\n\n\t\tif ( ! _this.noZoom ) {\n\n\t\t\t_this.zoomCamera();\n\n\t\t}\n\n\t\tif ( ! _this.noPan ) {\n\n\t\t\t_this.panCamera();\n\n\t\t}\n\n\t\t_this.object.position.addVectors( _this.target, _eye );\n\n\t\tif ( _this.object.isPerspectiveCamera ) {\n\n\t\t\t_this.checkDistances();\n\n\t\t\t_this.object.lookAt( _this.target );\n\n\t\t\tif ( lastPosition.distanceToSquared( _this.object.position ) > EPS ) {\n\n\t\t\t\t_this.dispatchEvent( changeEvent );\n\n\t\t\t\tlastPosition.copy( _this.object.position );\n\n\t\t\t}\n\n\t\t} else if ( _this.object.isOrthographicCamera ) {\n\n\t\t\t_this.object.lookAt( _this.target );\n\n\t\t\tif ( lastPosition.distanceToSquared( _this.object.position ) > EPS || lastZoom !== _this.object.zoom ) {\n\n\t\t\t\t_this.dispatchEvent( changeEvent );\n\n\t\t\t\tlastPosition.copy( _this.object.position );\n\t\t\t\tlastZoom = _this.object.zoom;\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'THREE.TrackballControls: Unsupported camera type' );\n\n\t\t}\n\n\t};\n\n\tthis.reset = function () {\n\n\t\t_state = STATE.NONE;\n\t\t_keyState = STATE.NONE;\n\n\t\t_this.target.copy( _this.target0 );\n\t\t_this.object.position.copy( _this.position0 );\n\t\t_this.object.up.copy( _this.up0 );\n\t\t_this.object.zoom = _this.zoom0;\n\n\t\t_this.object.updateProjectionMatrix();\n\n\t\t_eye.subVectors( _this.object.position, _this.target );\n\n\t\t_this.object.lookAt( _this.target );\n\n\t\t_this.dispatchEvent( changeEvent );\n\n\t\tlastPosition.copy( _this.object.position );\n\t\tlastZoom = _this.object.zoom;\n\n\t};\n\n\t// listeners\n\n\tfunction keydown( event ) {\n\n\t\tif ( _this.enabled === false ) return;\n\n\t\twindow.removeEventListener( 'keydown', keydown );\n\n\t\tif ( _keyState !== STATE.NONE ) {\n\n\t\t\treturn;\n\n\t\t} else if ( event.keyCode === _this.keys[ STATE.ROTATE ] && ! _this.noRotate ) {\n\n\t\t\t_keyState = STATE.ROTATE;\n\n\t\t} else if ( event.keyCode === _this.keys[ STATE.ZOOM ] && ! _this.noZoom ) {\n\n\t\t\t_keyState = STATE.ZOOM;\n\n\t\t} else if ( event.keyCode === _this.keys[ STATE.PAN ] && ! _this.noPan ) {\n\n\t\t\t_keyState = STATE.PAN;\n\n\t\t}\n\n\t}\n\n\tfunction keyup() {\n\n\t\tif ( _this.enabled === false ) return;\n\n\t\t_keyState = STATE.NONE;\n\n\t\twindow.addEventListener( 'keydown', keydown, false );\n\n\t}\n\n\tfunction mousedown( event ) {\n\n\t\tif ( _this.enabled === false ) return;\n\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\n\t\tif ( _state === STATE.NONE ) {\n\n\t\t\tswitch ( event.button ) {\n\n\t\t\t\tcase _this.mouseButtons.LEFT:\n\t\t\t\t\t_state = STATE.ROTATE;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase _this.mouseButtons.MIDDLE:\n\t\t\t\t\t_state = STATE.ZOOM;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase _this.mouseButtons.RIGHT:\n\t\t\t\t\t_state = STATE.PAN;\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\t_state = STATE.NONE;\n\n\t\t\t}\n\n\t\t}\n\n\t\tvar state = ( _keyState !== STATE.NONE ) ? _keyState : _state;\n\n\t\tif ( state === STATE.ROTATE && ! _this.noRotate ) {\n\n\t\t\t_moveCurr.copy( getMouseOnCircle( event.pageX, event.pageY ) );\n\t\t\t_movePrev.copy( _moveCurr );\n\n\t\t} else if ( state === STATE.ZOOM && ! _this.noZoom ) {\n\n\t\t\t_zoomStart.copy( getMouseOnScreen( event.pageX, event.pageY ) );\n\t\t\t_zoomEnd.copy( _zoomStart );\n\n\t\t} else if ( state === STATE.PAN && ! _this.noPan ) {\n\n\t\t\t_panStart.copy( getMouseOnScreen( event.pageX, event.pageY ) );\n\t\t\t_panEnd.copy( _panStart );\n\n\t\t}\n\n\t\tdocument.addEventListener( 'mousemove', mousemove, false );\n\t\tdocument.addEventListener( 'mouseup', mouseup, false );\n\n\t\t_this.dispatchEvent( startEvent );\n\n\t}\n\n\tfunction mousemove( event ) {\n\n\t\tif ( _this.enabled === false ) return;\n\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\n\t\tvar state = ( _keyState !== STATE.NONE ) ? _keyState : _state;\n\n\t\tif ( state === STATE.ROTATE && ! _this.noRotate ) {\n\n\t\t\t_movePrev.copy( _moveCurr );\n\t\t\t_moveCurr.copy( getMouseOnCircle( event.pageX, event.pageY ) );\n\n\t\t} else if ( state === STATE.ZOOM && ! _this.noZoom ) {\n\n\t\t\t_zoomEnd.copy( getMouseOnScreen( event.pageX, event.pageY ) );\n\n\t\t} else if ( state === STATE.PAN && ! _this.noPan ) {\n\n\t\t\t_panEnd.copy( getMouseOnScreen( event.pageX, event.pageY ) );\n\n\t\t}\n\n\t}\n\n\tfunction mouseup( event ) {\n\n\t\tif ( _this.enabled === false ) return;\n\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\n\t\t_state = STATE.NONE;\n\n\t\tdocument.removeEventListener( 'mousemove', mousemove );\n\t\tdocument.removeEventListener( 'mouseup', mouseup );\n\t\t_this.dispatchEvent( endEvent );\n\n\t}\n\n\tfunction mousewheel( event ) {\n\n\t\tif ( _this.enabled === false ) return;\n\n\t\tif ( _this.noZoom === true ) return;\n\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\n\t\tswitch ( event.deltaMode ) {\n\n\t\t\tcase 2:\n\t\t\t\t// Zoom in pages\n\t\t\t\t_zoomStart.y -= event.deltaY * 0.025;\n\t\t\t\tbreak;\n\n\t\t\tcase 1:\n\t\t\t\t// Zoom in lines\n\t\t\t\t_zoomStart.y -= event.deltaY * 0.01;\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\t// undefined, 0, assume pixels\n\t\t\t\t_zoomStart.y -= event.deltaY * 0.00025;\n\t\t\t\tbreak;\n\n\t\t}\n\n\t\t_this.dispatchEvent( startEvent );\n\t\t_this.dispatchEvent( endEvent );\n\n\t}\n\n\tfunction touchstart( event ) {\n\n\t\tif ( _this.enabled === false ) return;\n\n\t\tevent.preventDefault();\n\n\t\tswitch ( event.touches.length ) {\n\n\t\t\tcase 1:\n\t\t\t\t_state = STATE.TOUCH_ROTATE;\n\t\t\t\t_moveCurr.copy( getMouseOnCircle( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY ) );\n\t\t\t\t_movePrev.copy( _moveCurr );\n\t\t\t\tbreak;\n\n\t\t\tdefault: // 2 or more\n\t\t\t\t_state = STATE.TOUCH_ZOOM_PAN;\n\t\t\t\tvar dx = event.touches[ 0 ].pageX - event.touches[ 1 ].pageX;\n\t\t\t\tvar dy = event.touches[ 0 ].pageY - event.touches[ 1 ].pageY;\n\t\t\t\t_touchZoomDistanceEnd = _touchZoomDistanceStart = Math.sqrt( dx * dx + dy * dy );\n\n\t\t\t\tvar x = ( event.touches[ 0 ].pageX + event.touches[ 1 ].pageX ) / 2;\n\t\t\t\tvar y = ( event.touches[ 0 ].pageY + event.touches[ 1 ].pageY ) / 2;\n\t\t\t\t_panStart.copy( getMouseOnScreen( x, y ) );\n\t\t\t\t_panEnd.copy( _panStart );\n\t\t\t\tbreak;\n\n\t\t}\n\n\t\t_this.dispatchEvent( startEvent );\n\n\t}\n\n\tfunction touchmove( event ) {\n\n\t\tif ( _this.enabled === false ) return;\n\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\n\t\tswitch ( event.touches.length ) {\n\n\t\t\tcase 1:\n\t\t\t\t_movePrev.copy( _moveCurr );\n\t\t\t\t_moveCurr.copy( getMouseOnCircle( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY ) );\n\t\t\t\tbreak;\n\n\t\t\tdefault: // 2 or more\n\t\t\t\tvar dx = event.touches[ 0 ].pageX - event.touches[ 1 ].pageX;\n\t\t\t\tvar dy = event.touches[ 0 ].pageY - event.touches[ 1 ].pageY;\n\t\t\t\t_touchZoomDistanceEnd = Math.sqrt( dx * dx + dy * dy );\n\n\t\t\t\tvar x = ( event.touches[ 0 ].pageX + event.touches[ 1 ].pageX ) / 2;\n\t\t\t\tvar y = ( event.touches[ 0 ].pageY + event.touches[ 1 ].pageY ) / 2;\n\t\t\t\t_panEnd.copy( getMouseOnScreen( x, y ) );\n\t\t\t\tbreak;\n\n\t\t}\n\n\t}\n\n\tfunction touchend( event ) {\n\n\t\tif ( _this.enabled === false ) return;\n\n\t\tswitch ( event.touches.length ) {\n\n\t\t\tcase 0:\n\t\t\t\t_state = STATE.NONE;\n\t\t\t\tbreak;\n\n\t\t\tcase 1:\n\t\t\t\t_state = STATE.TOUCH_ROTATE;\n\t\t\t\t_moveCurr.copy( getMouseOnCircle( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY ) );\n\t\t\t\t_movePrev.copy( _moveCurr );\n\t\t\t\tbreak;\n\n\t\t}\n\n\t\t_this.dispatchEvent( endEvent );\n\n\t}\n\n\tfunction contextmenu( event ) {\n\n\t\tif ( _this.enabled === false ) return;\n\n\t\tevent.preventDefault();\n\n\t}\n\n\tthis.dispose = function () {\n\n\t\tthis.domElement.removeEventListener( 'contextmenu', contextmenu, false );\n\t\tthis.domElement.removeEventListener( 'mousedown', mousedown, false );\n\t\tthis.domElement.removeEventListener( 'wheel', mousewheel, false );\n\n\t\tthis.domElement.removeEventListener( 'touchstart', touchstart, false );\n\t\tthis.domElement.removeEventListener( 'touchend', touchend, false );\n\t\tthis.domElement.removeEventListener( 'touchmove', touchmove, false );\n\n\t\tdocument.removeEventListener( 'mousemove', mousemove, false );\n\t\tdocument.removeEventListener( 'mouseup', mouseup, false );\n\n\t\twindow.removeEventListener( 'keydown', keydown, false );\n\t\twindow.removeEventListener( 'keyup', keyup, false );\n\n\t};\n\n\tthis.domElement.addEventListener( 'contextmenu', contextmenu, false );\n\tthis.domElement.addEventListener( 'mousedown', mousedown, false );\n\tthis.domElement.addEventListener( 'wheel', mousewheel, false );\n\n\tthis.domElement.addEventListener( 'touchstart', touchstart, false );\n\tthis.domElement.addEventListener( 'touchend', touchend, false );\n\tthis.domElement.addEventListener( 'touchmove', touchmove, false );\n\n\twindow.addEventListener( 'keydown', keydown, false );\n\twindow.addEventListener( 'keyup', keyup, false );\n\n\tthis.handleResize();\n\n\t// force an update at start\n\tthis.update();\n\n};\n\nTrackballControls.prototype = Object.create( EventDispatcher.prototype );\nTrackballControls.prototype.constructor = TrackballControls;\n\nexport { TrackballControls };\n","/**\n * @author WestLangley / http://github.com/WestLangley\n *\n */\n\nimport {\n\tBox3,\n\tFloat32BufferAttribute,\n\tInstancedBufferGeometry,\n\tInstancedInterleavedBuffer,\n\tInterleavedBufferAttribute,\n\tSphere,\n\tVector3,\n\tWireframeGeometry\n} from \"../../../build/three.module.js\";\n\nvar LineSegmentsGeometry = function () {\n\n\tInstancedBufferGeometry.call( this );\n\n\tthis.type = 'LineSegmentsGeometry';\n\n\tvar positions = [ - 1, 2, 0, 1, 2, 0, - 1, 1, 0, 1, 1, 0, - 1, 0, 0, 1, 0, 0, - 1, - 1, 0, 1, - 1, 0 ];\n\tvar uvs = [ - 1, 2, 1, 2, - 1, 1, 1, 1, - 1, - 1, 1, - 1, - 1, - 2, 1, - 2 ];\n\tvar index = [ 0, 2, 1, 2, 3, 1, 2, 4, 3, 4, 5, 3, 4, 6, 5, 6, 7, 5 ];\n\n\tthis.setIndex( index );\n\tthis.setAttribute( 'position', new Float32BufferAttribute( positions, 3 ) );\n\tthis.setAttribute( 'uv', new Float32BufferAttribute( uvs, 2 ) );\n\n};\n\nLineSegmentsGeometry.prototype = Object.assign( Object.create( InstancedBufferGeometry.prototype ), {\n\n\tconstructor: LineSegmentsGeometry,\n\n\tisLineSegmentsGeometry: true,\n\n\tapplyMatrix4: function ( matrix ) {\n\n\t\tvar start = this.attributes.instanceStart;\n\t\tvar end = this.attributes.instanceEnd;\n\n\t\tif ( start !== undefined ) {\n\n\t\t\tstart.applyMatrix4( matrix );\n\n\t\t\tend.applyMatrix4( matrix );\n\n\t\t\tstart.data.needsUpdate = true;\n\n\t\t}\n\n\t\tif ( this.boundingBox !== null ) {\n\n\t\t\tthis.computeBoundingBox();\n\n\t\t}\n\n\t\tif ( this.boundingSphere !== null ) {\n\n\t\t\tthis.computeBoundingSphere();\n\n\t\t}\n\n\t\treturn this;\n\n\t},\n\n\tsetPositions: function ( array ) {\n\n\t\tvar lineSegments;\n\n\t\tif ( array instanceof Float32Array ) {\n\n\t\t\tlineSegments = array;\n\n\t\t} else if ( Array.isArray( array ) ) {\n\n\t\t\tlineSegments = new Float32Array( array );\n\n\t\t}\n\n\t\tvar instanceBuffer = new InstancedInterleavedBuffer( lineSegments, 6, 1 ); // xyz, xyz\n\n\t\tthis.setAttribute( 'instanceStart', new InterleavedBufferAttribute( instanceBuffer, 3, 0 ) ); // xyz\n\t\tthis.setAttribute( 'instanceEnd', new InterleavedBufferAttribute( instanceBuffer, 3, 3 ) ); // xyz\n\n\t\t//\n\n\t\tthis.computeBoundingBox();\n\t\tthis.computeBoundingSphere();\n\n\t\treturn this;\n\n\t},\n\n\tsetColors: function ( array ) {\n\n\t\tvar colors;\n\n\t\tif ( array instanceof Float32Array ) {\n\n\t\t\tcolors = array;\n\n\t\t} else if ( Array.isArray( array ) ) {\n\n\t\t\tcolors = new Float32Array( array );\n\n\t\t}\n\n\t\tvar instanceColorBuffer = new InstancedInterleavedBuffer( colors, 6, 1 ); // rgb, rgb\n\n\t\tthis.setAttribute( 'instanceColorStart', new InterleavedBufferAttribute( instanceColorBuffer, 3, 0 ) ); // rgb\n\t\tthis.setAttribute( 'instanceColorEnd', new InterleavedBufferAttribute( instanceColorBuffer, 3, 3 ) ); // rgb\n\n\t\treturn this;\n\n\t},\n\n\tfromWireframeGeometry: function ( geometry ) {\n\n\t\tthis.setPositions( geometry.attributes.position.array );\n\n\t\treturn this;\n\n\t},\n\n\tfromEdgesGeometry: function ( geometry ) {\n\n\t\tthis.setPositions( geometry.attributes.position.array );\n\n\t\treturn this;\n\n\t},\n\n\tfromMesh: function ( mesh ) {\n\n\t\tthis.fromWireframeGeometry( new WireframeGeometry( mesh.geometry ) );\n\n\t\t// set colors, maybe\n\n\t\treturn this;\n\n\t},\n\n\tfromLineSegments: function ( lineSegments ) {\n\n\t\tvar geometry = lineSegments.geometry;\n\n\t\tif ( geometry.isGeometry ) {\n\n\t\t\tthis.setPositions( geometry.vertices );\n\n\t\t} else if ( geometry.isBufferGeometry ) {\n\n\t\t\tthis.setPositions( geometry.attributes.position.array ); // assumes non-indexed\n\n\t\t}\n\n\t\t// set colors, maybe\n\n\t\treturn this;\n\n\t},\n\n\tcomputeBoundingBox: function () {\n\n\t\tvar box = new Box3();\n\n\t\treturn function computeBoundingBox() {\n\n\t\t\tif ( this.boundingBox === null ) {\n\n\t\t\t\tthis.boundingBox = new Box3();\n\n\t\t\t}\n\n\t\t\tvar start = this.attributes.instanceStart;\n\t\t\tvar end = this.attributes.instanceEnd;\n\n\t\t\tif ( start !== undefined && end !== undefined ) {\n\n\t\t\t\tthis.boundingBox.setFromBufferAttribute( start );\n\n\t\t\t\tbox.setFromBufferAttribute( end );\n\n\t\t\t\tthis.boundingBox.union( box );\n\n\t\t\t}\n\n\t\t};\n\n\t}(),\n\n\tcomputeBoundingSphere: function () {\n\n\t\tvar vector = new Vector3();\n\n\t\treturn function computeBoundingSphere() {\n\n\t\t\tif ( this.boundingSphere === null ) {\n\n\t\t\t\tthis.boundingSphere = new Sphere();\n\n\t\t\t}\n\n\t\t\tif ( this.boundingBox === null ) {\n\n\t\t\t\tthis.computeBoundingBox();\n\n\t\t\t}\n\n\t\t\tvar start = this.attributes.instanceStart;\n\t\t\tvar end = this.attributes.instanceEnd;\n\n\t\t\tif ( start !== undefined && end !== undefined ) {\n\n\t\t\t\tvar center = this.boundingSphere.center;\n\n\t\t\t\tthis.boundingBox.getCenter( center );\n\n\t\t\t\tvar maxRadiusSq = 0;\n\n\t\t\t\tfor ( var i = 0, il = start.count; i < il; i ++ ) {\n\n\t\t\t\t\tvector.fromBufferAttribute( start, i );\n\t\t\t\t\tmaxRadiusSq = Math.max( maxRadiusSq, center.distanceToSquared( vector ) );\n\n\t\t\t\t\tvector.fromBufferAttribute( end, i );\n\t\t\t\t\tmaxRadiusSq = Math.max( maxRadiusSq, center.distanceToSquared( vector ) );\n\n\t\t\t\t}\n\n\t\t\t\tthis.boundingSphere.radius = Math.sqrt( maxRadiusSq );\n\n\t\t\t\tif ( isNaN( this.boundingSphere.radius ) ) {\n\n\t\t\t\t\tconsole.error( 'THREE.LineSegmentsGeometry.computeBoundingSphere(): Computed radius is NaN. The instanced position data is likely to have NaN values.', this );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t};\n\n\t}(),\n\n\ttoJSON: function () {\n\n\t\t// todo\n\n\t},\n\n\tapplyMatrix: function ( matrix ) {\n\n\t\tconsole.warn( 'THREE.LineSegmentsGeometry: applyMatrix() has been renamed to applyMatrix4().' );\n\n\t\treturn this.applyMatrix4( matrix );\n\n\t}\n\n} );\n\nexport { LineSegmentsGeometry };\n","/**\n * @author qiao / https://github.com/qiao\n * @author mrdoob / http://mrdoob.com\n * @author alteredq / http://alteredqualia.com/\n * @author WestLangley / http://github.com/WestLangley\n * @author erich666 / http://erichaines.com\n * @author ScieCode / http://github.com/sciecode\n */\n\nimport {\n\tEventDispatcher,\n\tMOUSE,\n\tQuaternion,\n\tSpherical,\n\tTOUCH,\n\tVector2,\n\tVector3\n} from \"../../../build/three.module.js\";\n\n// This set of controls performs orbiting, dollying (zooming), and panning.\n// Unlike TrackballControls, it maintains the \"up\" direction object.up (+Y by default).\n//\n//    Orbit - left mouse / touch: one-finger move\n//    Zoom - middle mouse, or mousewheel / touch: two-finger spread or squish\n//    Pan - right mouse, or left mouse + ctrl/meta/shiftKey, or arrow keys / touch: two-finger move\n\nvar OrbitControls = function ( object, domElement ) {\n\n\tif ( domElement === undefined ) console.warn( 'THREE.OrbitControls: The second parameter \"domElement\" is now mandatory.' );\n\tif ( domElement === document ) console.error( 'THREE.OrbitControls: \"document\" should not be used as the target \"domElement\". Please use \"renderer.domElement\" instead.' );\n\n\tthis.object = object;\n\tthis.domElement = domElement;\n\n\t// Set to false to disable this control\n\tthis.enabled = true;\n\n\t// \"target\" sets the location of focus, where the object orbits around\n\tthis.target = new Vector3();\n\n\t// How far you can dolly in and out ( PerspectiveCamera only )\n\tthis.minDistance = 0;\n\tthis.maxDistance = Infinity;\n\n\t// How far you can zoom in and out ( OrthographicCamera only )\n\tthis.minZoom = 0;\n\tthis.maxZoom = Infinity;\n\n\t// How far you can orbit vertically, upper and lower limits.\n\t// Range is 0 to Math.PI radians.\n\tthis.minPolarAngle = 0; // radians\n\tthis.maxPolarAngle = Math.PI; // radians\n\n\t// How far you can orbit horizontally, upper and lower limits.\n\t// If set, must be a sub-interval of the interval [ - Math.PI, Math.PI ].\n\tthis.minAzimuthAngle = - Infinity; // radians\n\tthis.maxAzimuthAngle = Infinity; // radians\n\n\t// Set to true to enable damping (inertia)\n\t// If damping is enabled, you must call controls.update() in your animation loop\n\tthis.enableDamping = false;\n\tthis.dampingFactor = 0.05;\n\n\t// This option actually enables dollying in and out; left as \"zoom\" for backwards compatibility.\n\t// Set to false to disable zooming\n\tthis.enableZoom = true;\n\tthis.zoomSpeed = 1.0;\n\n\t// Set to false to disable rotating\n\tthis.enableRotate = true;\n\tthis.rotateSpeed = 1.0;\n\n\t// Set to false to disable panning\n\tthis.enablePan = true;\n\tthis.panSpeed = 1.0;\n\tthis.screenSpacePanning = false; // if true, pan in screen-space\n\tthis.keyPanSpeed = 7.0;\t// pixels moved per arrow key push\n\n\t// Set to true to automatically rotate around the target\n\t// If auto-rotate is enabled, you must call controls.update() in your animation loop\n\tthis.autoRotate = false;\n\tthis.autoRotateSpeed = 2.0; // 30 seconds per round when fps is 60\n\n\t// Set to false to disable use of the keys\n\tthis.enableKeys = true;\n\n\t// The four arrow keys\n\tthis.keys = { LEFT: 37, UP: 38, RIGHT: 39, BOTTOM: 40 };\n\n\t// Mouse buttons\n\tthis.mouseButtons = { LEFT: MOUSE.ROTATE, MIDDLE: MOUSE.DOLLY, RIGHT: MOUSE.PAN };\n\n\t// Touch fingers\n\tthis.touches = { ONE: TOUCH.ROTATE, TWO: TOUCH.DOLLY_PAN };\n\n\t// for reset\n\tthis.target0 = this.target.clone();\n\tthis.position0 = this.object.position.clone();\n\tthis.zoom0 = this.object.zoom;\n\n\t//\n\t// public methods\n\t//\n\n\tthis.getPolarAngle = function () {\n\n\t\treturn spherical.phi;\n\n\t};\n\n\tthis.getAzimuthalAngle = function () {\n\n\t\treturn spherical.theta;\n\n\t};\n\n\tthis.saveState = function () {\n\n\t\tscope.target0.copy( scope.target );\n\t\tscope.position0.copy( scope.object.position );\n\t\tscope.zoom0 = scope.object.zoom;\n\n\t};\n\n\tthis.reset = function () {\n\n\t\tscope.target.copy( scope.target0 );\n\t\tscope.object.position.copy( scope.position0 );\n\t\tscope.object.zoom = scope.zoom0;\n\n\t\tscope.object.updateProjectionMatrix();\n\t\tscope.dispatchEvent( changeEvent );\n\n\t\tscope.update();\n\n\t\tstate = STATE.NONE;\n\n\t};\n\n\t// this method is exposed, but perhaps it would be better if we can make it private...\n\tthis.update = function () {\n\n\t\tvar offset = new Vector3();\n\n\t\t// so camera.up is the orbit axis\n\t\tvar quat = new Quaternion().setFromUnitVectors( object.up, new Vector3( 0, 1, 0 ) );\n\t\tvar quatInverse = quat.clone().inverse();\n\n\t\tvar lastPosition = new Vector3();\n\t\tvar lastQuaternion = new Quaternion();\n\n\t\treturn function update() {\n\n\t\t\tvar position = scope.object.position;\n\n\t\t\toffset.copy( position ).sub( scope.target );\n\n\t\t\t// rotate offset to \"y-axis-is-up\" space\n\t\t\toffset.applyQuaternion( quat );\n\n\t\t\t// angle from z-axis around y-axis\n\t\t\tspherical.setFromVector3( offset );\n\n\t\t\tif ( scope.autoRotate && state === STATE.NONE ) {\n\n\t\t\t\trotateLeft( getAutoRotationAngle() );\n\n\t\t\t}\n\n\t\t\tif ( scope.enableDamping ) {\n\n\t\t\t\tspherical.theta += sphericalDelta.theta * scope.dampingFactor;\n\t\t\t\tspherical.phi += sphericalDelta.phi * scope.dampingFactor;\n\n\t\t\t} else {\n\n\t\t\t\tspherical.theta += sphericalDelta.theta;\n\t\t\t\tspherical.phi += sphericalDelta.phi;\n\n\t\t\t}\n\n\t\t\t// restrict theta to be between desired limits\n\t\t\tspherical.theta = Math.max( scope.minAzimuthAngle, Math.min( scope.maxAzimuthAngle, spherical.theta ) );\n\n\t\t\t// restrict phi to be between desired limits\n\t\t\tspherical.phi = Math.max( scope.minPolarAngle, Math.min( scope.maxPolarAngle, spherical.phi ) );\n\n\t\t\tspherical.makeSafe();\n\n\n\t\t\tspherical.radius *= scale;\n\n\t\t\t// restrict radius to be between desired limits\n\t\t\tspherical.radius = Math.max( scope.minDistance, Math.min( scope.maxDistance, spherical.radius ) );\n\n\t\t\t// move target to panned location\n\n\t\t\tif ( scope.enableDamping === true ) {\n\n\t\t\t\tscope.target.addScaledVector( panOffset, scope.dampingFactor );\n\n\t\t\t} else {\n\n\t\t\t\tscope.target.add( panOffset );\n\n\t\t\t}\n\n\t\t\toffset.setFromSpherical( spherical );\n\n\t\t\t// rotate offset back to \"camera-up-vector-is-up\" space\n\t\t\toffset.applyQuaternion( quatInverse );\n\n\t\t\tposition.copy( scope.target ).add( offset );\n\n\t\t\tscope.object.lookAt( scope.target );\n\n\t\t\tif ( scope.enableDamping === true ) {\n\n\t\t\t\tsphericalDelta.theta *= ( 1 - scope.dampingFactor );\n\t\t\t\tsphericalDelta.phi *= ( 1 - scope.dampingFactor );\n\n\t\t\t\tpanOffset.multiplyScalar( 1 - scope.dampingFactor );\n\n\t\t\t} else {\n\n\t\t\t\tsphericalDelta.set( 0, 0, 0 );\n\n\t\t\t\tpanOffset.set( 0, 0, 0 );\n\n\t\t\t}\n\n\t\t\tscale = 1;\n\n\t\t\t// update condition is:\n\t\t\t// min(camera displacement, camera rotation in radians)^2 > EPS\n\t\t\t// using small-angle approximation cos(x/2) = 1 - x^2 / 8\n\n\t\t\tif ( zoomChanged ||\n\t\t\t\tlastPosition.distanceToSquared( scope.object.position ) > EPS ||\n\t\t\t\t8 * ( 1 - lastQuaternion.dot( scope.object.quaternion ) ) > EPS ) {\n\n\t\t\t\tscope.dispatchEvent( changeEvent );\n\n\t\t\t\tlastPosition.copy( scope.object.position );\n\t\t\t\tlastQuaternion.copy( scope.object.quaternion );\n\t\t\t\tzoomChanged = false;\n\n\t\t\t\treturn true;\n\n\t\t\t}\n\n\t\t\treturn false;\n\n\t\t};\n\n\t}();\n\n\tthis.dispose = function () {\n\n\t\tscope.domElement.removeEventListener( 'contextmenu', onContextMenu, false );\n\t\tscope.domElement.removeEventListener( 'mousedown', onMouseDown, false );\n\t\tscope.domElement.removeEventListener( 'wheel', onMouseWheel, false );\n\n\t\tscope.domElement.removeEventListener( 'touchstart', onTouchStart, false );\n\t\tscope.domElement.removeEventListener( 'touchend', onTouchEnd, false );\n\t\tscope.domElement.removeEventListener( 'touchmove', onTouchMove, false );\n\n\t\tdocument.removeEventListener( 'mousemove', onMouseMove, false );\n\t\tdocument.removeEventListener( 'mouseup', onMouseUp, false );\n\n\t\tscope.domElement.removeEventListener( 'keydown', onKeyDown, false );\n\n\t\t//scope.dispatchEvent( { type: 'dispose' } ); // should this be added here?\n\n\t};\n\n\t//\n\t// internals\n\t//\n\n\tvar scope = this;\n\n\tvar changeEvent = { type: 'change' };\n\tvar startEvent = { type: 'start' };\n\tvar endEvent = { type: 'end' };\n\n\tvar STATE = {\n\t\tNONE: - 1,\n\t\tROTATE: 0,\n\t\tDOLLY: 1,\n\t\tPAN: 2,\n\t\tTOUCH_ROTATE: 3,\n\t\tTOUCH_PAN: 4,\n\t\tTOUCH_DOLLY_PAN: 5,\n\t\tTOUCH_DOLLY_ROTATE: 6\n\t};\n\n\tvar state = STATE.NONE;\n\n\tvar EPS = 0.000001;\n\n\t// current position in spherical coordinates\n\tvar spherical = new Spherical();\n\tvar sphericalDelta = new Spherical();\n\n\tvar scale = 1;\n\tvar panOffset = new Vector3();\n\tvar zoomChanged = false;\n\n\tvar rotateStart = new Vector2();\n\tvar rotateEnd = new Vector2();\n\tvar rotateDelta = new Vector2();\n\n\tvar panStart = new Vector2();\n\tvar panEnd = new Vector2();\n\tvar panDelta = new Vector2();\n\n\tvar dollyStart = new Vector2();\n\tvar dollyEnd = new Vector2();\n\tvar dollyDelta = new Vector2();\n\n\tfunction getAutoRotationAngle() {\n\n\t\treturn 2 * Math.PI / 60 / 60 * scope.autoRotateSpeed;\n\n\t}\n\n\tfunction getZoomScale() {\n\n\t\treturn Math.pow( 0.95, scope.zoomSpeed );\n\n\t}\n\n\tfunction rotateLeft( angle ) {\n\n\t\tsphericalDelta.theta -= angle;\n\n\t}\n\n\tfunction rotateUp( angle ) {\n\n\t\tsphericalDelta.phi -= angle;\n\n\t}\n\n\tvar panLeft = function () {\n\n\t\tvar v = new Vector3();\n\n\t\treturn function panLeft( distance, objectMatrix ) {\n\n\t\t\tv.setFromMatrixColumn( objectMatrix, 0 ); // get X column of objectMatrix\n\t\t\tv.multiplyScalar( - distance );\n\n\t\t\tpanOffset.add( v );\n\n\t\t};\n\n\t}();\n\n\tvar panUp = function () {\n\n\t\tvar v = new Vector3();\n\n\t\treturn function panUp( distance, objectMatrix ) {\n\n\t\t\tif ( scope.screenSpacePanning === true ) {\n\n\t\t\t\tv.setFromMatrixColumn( objectMatrix, 1 );\n\n\t\t\t} else {\n\n\t\t\t\tv.setFromMatrixColumn( objectMatrix, 0 );\n\t\t\t\tv.crossVectors( scope.object.up, v );\n\n\t\t\t}\n\n\t\t\tv.multiplyScalar( distance );\n\n\t\t\tpanOffset.add( v );\n\n\t\t};\n\n\t}();\n\n\t// deltaX and deltaY are in pixels; right and down are positive\n\tvar pan = function () {\n\n\t\tvar offset = new Vector3();\n\n\t\treturn function pan( deltaX, deltaY ) {\n\n\t\t\tvar element = scope.domElement;\n\n\t\t\tif ( scope.object.isPerspectiveCamera ) {\n\n\t\t\t\t// perspective\n\t\t\t\tvar position = scope.object.position;\n\t\t\t\toffset.copy( position ).sub( scope.target );\n\t\t\t\tvar targetDistance = offset.length();\n\n\t\t\t\t// half of the fov is center to top of screen\n\t\t\t\ttargetDistance *= Math.tan( ( scope.object.fov / 2 ) * Math.PI / 180.0 );\n\n\t\t\t\t// we use only clientHeight here so aspect ratio does not distort speed\n\t\t\t\tpanLeft( 2 * deltaX * targetDistance / element.clientHeight, scope.object.matrix );\n\t\t\t\tpanUp( 2 * deltaY * targetDistance / element.clientHeight, scope.object.matrix );\n\n\t\t\t} else if ( scope.object.isOrthographicCamera ) {\n\n\t\t\t\t// orthographic\n\t\t\t\tpanLeft( deltaX * ( scope.object.right - scope.object.left ) / scope.object.zoom / element.clientWidth, scope.object.matrix );\n\t\t\t\tpanUp( deltaY * ( scope.object.top - scope.object.bottom ) / scope.object.zoom / element.clientHeight, scope.object.matrix );\n\n\t\t\t} else {\n\n\t\t\t\t// camera neither orthographic nor perspective\n\t\t\t\tconsole.warn( 'WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.' );\n\t\t\t\tscope.enablePan = false;\n\n\t\t\t}\n\n\t\t};\n\n\t}();\n\n\tfunction dollyOut( dollyScale ) {\n\n\t\tif ( scope.object.isPerspectiveCamera ) {\n\n\t\t\tscale /= dollyScale;\n\n\t\t} else if ( scope.object.isOrthographicCamera ) {\n\n\t\t\tscope.object.zoom = Math.max( scope.minZoom, Math.min( scope.maxZoom, scope.object.zoom * dollyScale ) );\n\t\t\tscope.object.updateProjectionMatrix();\n\t\t\tzoomChanged = true;\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.' );\n\t\t\tscope.enableZoom = false;\n\n\t\t}\n\n\t}\n\n\tfunction dollyIn( dollyScale ) {\n\n\t\tif ( scope.object.isPerspectiveCamera ) {\n\n\t\t\tscale *= dollyScale;\n\n\t\t} else if ( scope.object.isOrthographicCamera ) {\n\n\t\t\tscope.object.zoom = Math.max( scope.minZoom, Math.min( scope.maxZoom, scope.object.zoom / dollyScale ) );\n\t\t\tscope.object.updateProjectionMatrix();\n\t\t\tzoomChanged = true;\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.' );\n\t\t\tscope.enableZoom = false;\n\n\t\t}\n\n\t}\n\n\t//\n\t// event callbacks - update the object state\n\t//\n\n\tfunction handleMouseDownRotate( event ) {\n\n\t\trotateStart.set( event.clientX, event.clientY );\n\n\t}\n\n\tfunction handleMouseDownDolly( event ) {\n\n\t\tdollyStart.set( event.clientX, event.clientY );\n\n\t}\n\n\tfunction handleMouseDownPan( event ) {\n\n\t\tpanStart.set( event.clientX, event.clientY );\n\n\t}\n\n\tfunction handleMouseMoveRotate( event ) {\n\n\t\trotateEnd.set( event.clientX, event.clientY );\n\n\t\trotateDelta.subVectors( rotateEnd, rotateStart ).multiplyScalar( scope.rotateSpeed );\n\n\t\tvar element = scope.domElement;\n\n\t\trotateLeft( 2 * Math.PI * rotateDelta.x / element.clientHeight ); // yes, height\n\n\t\trotateUp( 2 * Math.PI * rotateDelta.y / element.clientHeight );\n\n\t\trotateStart.copy( rotateEnd );\n\n\t\tscope.update();\n\n\t}\n\n\tfunction handleMouseMoveDolly( event ) {\n\n\t\tdollyEnd.set( event.clientX, event.clientY );\n\n\t\tdollyDelta.subVectors( dollyEnd, dollyStart );\n\n\t\tif ( dollyDelta.y > 0 ) {\n\n\t\t\tdollyOut( getZoomScale() );\n\n\t\t} else if ( dollyDelta.y < 0 ) {\n\n\t\t\tdollyIn( getZoomScale() );\n\n\t\t}\n\n\t\tdollyStart.copy( dollyEnd );\n\n\t\tscope.update();\n\n\t}\n\n\tfunction handleMouseMovePan( event ) {\n\n\t\tpanEnd.set( event.clientX, event.clientY );\n\n\t\tpanDelta.subVectors( panEnd, panStart ).multiplyScalar( scope.panSpeed );\n\n\t\tpan( panDelta.x, panDelta.y );\n\n\t\tpanStart.copy( panEnd );\n\n\t\tscope.update();\n\n\t}\n\n\tfunction handleMouseUp( /*event*/ ) {\n\n\t\t// no-op\n\n\t}\n\n\tfunction handleMouseWheel( event ) {\n\n\t\tif ( event.deltaY < 0 ) {\n\n\t\t\tdollyIn( getZoomScale() );\n\n\t\t} else if ( event.deltaY > 0 ) {\n\n\t\t\tdollyOut( getZoomScale() );\n\n\t\t}\n\n\t\tscope.update();\n\n\t}\n\n\tfunction handleKeyDown( event ) {\n\n\t\tvar needsUpdate = false;\n\n\t\tswitch ( event.keyCode ) {\n\n\t\t\tcase scope.keys.UP:\n\t\t\t\tpan( 0, scope.keyPanSpeed );\n\t\t\t\tneedsUpdate = true;\n\t\t\t\tbreak;\n\n\t\t\tcase scope.keys.BOTTOM:\n\t\t\t\tpan( 0, - scope.keyPanSpeed );\n\t\t\t\tneedsUpdate = true;\n\t\t\t\tbreak;\n\n\t\t\tcase scope.keys.LEFT:\n\t\t\t\tpan( scope.keyPanSpeed, 0 );\n\t\t\t\tneedsUpdate = true;\n\t\t\t\tbreak;\n\n\t\t\tcase scope.keys.RIGHT:\n\t\t\t\tpan( - scope.keyPanSpeed, 0 );\n\t\t\t\tneedsUpdate = true;\n\t\t\t\tbreak;\n\n\t\t}\n\n\t\tif ( needsUpdate ) {\n\n\t\t\t// prevent the browser from scrolling on cursor keys\n\t\t\tevent.preventDefault();\n\n\t\t\tscope.update();\n\n\t\t}\n\n\n\t}\n\n\tfunction handleTouchStartRotate( event ) {\n\n\t\tif ( event.touches.length == 1 ) {\n\n\t\t\trotateStart.set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY );\n\n\t\t} else {\n\n\t\t\tvar x = 0.5 * ( event.touches[ 0 ].pageX + event.touches[ 1 ].pageX );\n\t\t\tvar y = 0.5 * ( event.touches[ 0 ].pageY + event.touches[ 1 ].pageY );\n\n\t\t\trotateStart.set( x, y );\n\n\t\t}\n\n\t}\n\n\tfunction handleTouchStartPan( event ) {\n\n\t\tif ( event.touches.length == 1 ) {\n\n\t\t\tpanStart.set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY );\n\n\t\t} else {\n\n\t\t\tvar x = 0.5 * ( event.touches[ 0 ].pageX + event.touches[ 1 ].pageX );\n\t\t\tvar y = 0.5 * ( event.touches[ 0 ].pageY + event.touches[ 1 ].pageY );\n\n\t\t\tpanStart.set( x, y );\n\n\t\t}\n\n\t}\n\n\tfunction handleTouchStartDolly( event ) {\n\n\t\tvar dx = event.touches[ 0 ].pageX - event.touches[ 1 ].pageX;\n\t\tvar dy = event.touches[ 0 ].pageY - event.touches[ 1 ].pageY;\n\n\t\tvar distance = Math.sqrt( dx * dx + dy * dy );\n\n\t\tdollyStart.set( 0, distance );\n\n\t}\n\n\tfunction handleTouchStartDollyPan( event ) {\n\n\t\tif ( scope.enableZoom ) handleTouchStartDolly( event );\n\n\t\tif ( scope.enablePan ) handleTouchStartPan( event );\n\n\t}\n\n\tfunction handleTouchStartDollyRotate( event ) {\n\n\t\tif ( scope.enableZoom ) handleTouchStartDolly( event );\n\n\t\tif ( scope.enableRotate ) handleTouchStartRotate( event );\n\n\t}\n\n\tfunction handleTouchMoveRotate( event ) {\n\n\t\tif ( event.touches.length == 1 ) {\n\n\t\t\trotateEnd.set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY );\n\n\t\t} else {\n\n\t\t\tvar x = 0.5 * ( event.touches[ 0 ].pageX + event.touches[ 1 ].pageX );\n\t\t\tvar y = 0.5 * ( event.touches[ 0 ].pageY + event.touches[ 1 ].pageY );\n\n\t\t\trotateEnd.set( x, y );\n\n\t\t}\n\n\t\trotateDelta.subVectors( rotateEnd, rotateStart ).multiplyScalar( scope.rotateSpeed );\n\n\t\tvar element = scope.domElement;\n\n\t\trotateLeft( 2 * Math.PI * rotateDelta.x / element.clientHeight ); // yes, height\n\n\t\trotateUp( 2 * Math.PI * rotateDelta.y / element.clientHeight );\n\n\t\trotateStart.copy( rotateEnd );\n\n\t}\n\n\tfunction handleTouchMovePan( event ) {\n\n\t\tif ( event.touches.length == 1 ) {\n\n\t\t\tpanEnd.set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY );\n\n\t\t} else {\n\n\t\t\tvar x = 0.5 * ( event.touches[ 0 ].pageX + event.touches[ 1 ].pageX );\n\t\t\tvar y = 0.5 * ( event.touches[ 0 ].pageY + event.touches[ 1 ].pageY );\n\n\t\t\tpanEnd.set( x, y );\n\n\t\t}\n\n\t\tpanDelta.subVectors( panEnd, panStart ).multiplyScalar( scope.panSpeed );\n\n\t\tpan( panDelta.x, panDelta.y );\n\n\t\tpanStart.copy( panEnd );\n\n\t}\n\n\tfunction handleTouchMoveDolly( event ) {\n\n\t\tvar dx = event.touches[ 0 ].pageX - event.touches[ 1 ].pageX;\n\t\tvar dy = event.touches[ 0 ].pageY - event.touches[ 1 ].pageY;\n\n\t\tvar distance = Math.sqrt( dx * dx + dy * dy );\n\n\t\tdollyEnd.set( 0, distance );\n\n\t\tdollyDelta.set( 0, Math.pow( dollyEnd.y / dollyStart.y, scope.zoomSpeed ) );\n\n\t\tdollyOut( dollyDelta.y );\n\n\t\tdollyStart.copy( dollyEnd );\n\n\t}\n\n\tfunction handleTouchMoveDollyPan( event ) {\n\n\t\tif ( scope.enableZoom ) handleTouchMoveDolly( event );\n\n\t\tif ( scope.enablePan ) handleTouchMovePan( event );\n\n\t}\n\n\tfunction handleTouchMoveDollyRotate( event ) {\n\n\t\tif ( scope.enableZoom ) handleTouchMoveDolly( event );\n\n\t\tif ( scope.enableRotate ) handleTouchMoveRotate( event );\n\n\t}\n\n\tfunction handleTouchEnd( /*event*/ ) {\n\n\t\t// no-op\n\n\t}\n\n\t//\n\t// event handlers - FSM: listen for events and reset state\n\t//\n\n\tfunction onMouseDown( event ) {\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\t// Prevent the browser from scrolling.\n\t\tevent.preventDefault();\n\n\t\t// Manually set the focus since calling preventDefault above\n\t\t// prevents the browser from setting it automatically.\n\n\t\tscope.domElement.focus ? scope.domElement.focus() : window.focus();\n\n\t\tvar mouseAction;\n\n\t\tswitch ( event.button ) {\n\n\t\t\tcase 0:\n\n\t\t\t\tmouseAction = scope.mouseButtons.LEFT;\n\t\t\t\tbreak;\n\n\t\t\tcase 1:\n\n\t\t\t\tmouseAction = scope.mouseButtons.MIDDLE;\n\t\t\t\tbreak;\n\n\t\t\tcase 2:\n\n\t\t\t\tmouseAction = scope.mouseButtons.RIGHT;\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\n\t\t\t\tmouseAction = - 1;\n\n\t\t}\n\n\t\tswitch ( mouseAction ) {\n\n\t\t\tcase MOUSE.DOLLY:\n\n\t\t\t\tif ( scope.enableZoom === false ) return;\n\n\t\t\t\thandleMouseDownDolly( event );\n\n\t\t\t\tstate = STATE.DOLLY;\n\n\t\t\t\tbreak;\n\n\t\t\tcase MOUSE.ROTATE:\n\n\t\t\t\tif ( event.ctrlKey || event.metaKey || event.shiftKey ) {\n\n\t\t\t\t\tif ( scope.enablePan === false ) return;\n\n\t\t\t\t\thandleMouseDownPan( event );\n\n\t\t\t\t\tstate = STATE.PAN;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tif ( scope.enableRotate === false ) return;\n\n\t\t\t\t\thandleMouseDownRotate( event );\n\n\t\t\t\t\tstate = STATE.ROTATE;\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tcase MOUSE.PAN:\n\n\t\t\t\tif ( event.ctrlKey || event.metaKey || event.shiftKey ) {\n\n\t\t\t\t\tif ( scope.enableRotate === false ) return;\n\n\t\t\t\t\thandleMouseDownRotate( event );\n\n\t\t\t\t\tstate = STATE.ROTATE;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tif ( scope.enablePan === false ) return;\n\n\t\t\t\t\thandleMouseDownPan( event );\n\n\t\t\t\t\tstate = STATE.PAN;\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\n\t\t\t\tstate = STATE.NONE;\n\n\t\t}\n\n\t\tif ( state !== STATE.NONE ) {\n\n\t\t\tdocument.addEventListener( 'mousemove', onMouseMove, false );\n\t\t\tdocument.addEventListener( 'mouseup', onMouseUp, false );\n\n\t\t\tscope.dispatchEvent( startEvent );\n\n\t\t}\n\n\t}\n\n\tfunction onMouseMove( event ) {\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\tevent.preventDefault();\n\n\t\tswitch ( state ) {\n\n\t\t\tcase STATE.ROTATE:\n\n\t\t\t\tif ( scope.enableRotate === false ) return;\n\n\t\t\t\thandleMouseMoveRotate( event );\n\n\t\t\t\tbreak;\n\n\t\t\tcase STATE.DOLLY:\n\n\t\t\t\tif ( scope.enableZoom === false ) return;\n\n\t\t\t\thandleMouseMoveDolly( event );\n\n\t\t\t\tbreak;\n\n\t\t\tcase STATE.PAN:\n\n\t\t\t\tif ( scope.enablePan === false ) return;\n\n\t\t\t\thandleMouseMovePan( event );\n\n\t\t\t\tbreak;\n\n\t\t}\n\n\t}\n\n\tfunction onMouseUp( event ) {\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\thandleMouseUp( event );\n\n\t\tdocument.removeEventListener( 'mousemove', onMouseMove, false );\n\t\tdocument.removeEventListener( 'mouseup', onMouseUp, false );\n\n\t\tscope.dispatchEvent( endEvent );\n\n\t\tstate = STATE.NONE;\n\n\t}\n\n\tfunction onMouseWheel( event ) {\n\n\t\tif ( scope.enabled === false || scope.enableZoom === false || ( state !== STATE.NONE && state !== STATE.ROTATE ) ) return;\n\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\n\t\tscope.dispatchEvent( startEvent );\n\n\t\thandleMouseWheel( event );\n\n\t\tscope.dispatchEvent( endEvent );\n\n\t}\n\n\tfunction onKeyDown( event ) {\n\n\t\tif ( scope.enabled === false || scope.enableKeys === false || scope.enablePan === false ) return;\n\n\t\thandleKeyDown( event );\n\n\t}\n\n\tfunction onTouchStart( event ) {\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\tevent.preventDefault(); // prevent scrolling\n\n\t\tswitch ( event.touches.length ) {\n\n\t\t\tcase 1:\n\n\t\t\t\tswitch ( scope.touches.ONE ) {\n\n\t\t\t\t\tcase TOUCH.ROTATE:\n\n\t\t\t\t\t\tif ( scope.enableRotate === false ) return;\n\n\t\t\t\t\t\thandleTouchStartRotate( event );\n\n\t\t\t\t\t\tstate = STATE.TOUCH_ROTATE;\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase TOUCH.PAN:\n\n\t\t\t\t\t\tif ( scope.enablePan === false ) return;\n\n\t\t\t\t\t\thandleTouchStartPan( event );\n\n\t\t\t\t\t\tstate = STATE.TOUCH_PAN;\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\n\t\t\t\t\t\tstate = STATE.NONE;\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tcase 2:\n\n\t\t\t\tswitch ( scope.touches.TWO ) {\n\n\t\t\t\t\tcase TOUCH.DOLLY_PAN:\n\n\t\t\t\t\t\tif ( scope.enableZoom === false && scope.enablePan === false ) return;\n\n\t\t\t\t\t\thandleTouchStartDollyPan( event );\n\n\t\t\t\t\t\tstate = STATE.TOUCH_DOLLY_PAN;\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase TOUCH.DOLLY_ROTATE:\n\n\t\t\t\t\t\tif ( scope.enableZoom === false && scope.enableRotate === false ) return;\n\n\t\t\t\t\t\thandleTouchStartDollyRotate( event );\n\n\t\t\t\t\t\tstate = STATE.TOUCH_DOLLY_ROTATE;\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\n\t\t\t\t\t\tstate = STATE.NONE;\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\n\t\t\t\tstate = STATE.NONE;\n\n\t\t}\n\n\t\tif ( state !== STATE.NONE ) {\n\n\t\t\tscope.dispatchEvent( startEvent );\n\n\t\t}\n\n\t}\n\n\tfunction onTouchMove( event ) {\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\tevent.preventDefault(); // prevent scrolling\n\t\tevent.stopPropagation();\n\n\t\tswitch ( state ) {\n\n\t\t\tcase STATE.TOUCH_ROTATE:\n\n\t\t\t\tif ( scope.enableRotate === false ) return;\n\n\t\t\t\thandleTouchMoveRotate( event );\n\n\t\t\t\tscope.update();\n\n\t\t\t\tbreak;\n\n\t\t\tcase STATE.TOUCH_PAN:\n\n\t\t\t\tif ( scope.enablePan === false ) return;\n\n\t\t\t\thandleTouchMovePan( event );\n\n\t\t\t\tscope.update();\n\n\t\t\t\tbreak;\n\n\t\t\tcase STATE.TOUCH_DOLLY_PAN:\n\n\t\t\t\tif ( scope.enableZoom === false && scope.enablePan === false ) return;\n\n\t\t\t\thandleTouchMoveDollyPan( event );\n\n\t\t\t\tscope.update();\n\n\t\t\t\tbreak;\n\n\t\t\tcase STATE.TOUCH_DOLLY_ROTATE:\n\n\t\t\t\tif ( scope.enableZoom === false && scope.enableRotate === false ) return;\n\n\t\t\t\thandleTouchMoveDollyRotate( event );\n\n\t\t\t\tscope.update();\n\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\n\t\t\t\tstate = STATE.NONE;\n\n\t\t}\n\n\t}\n\n\tfunction onTouchEnd( event ) {\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\thandleTouchEnd( event );\n\n\t\tscope.dispatchEvent( endEvent );\n\n\t\tstate = STATE.NONE;\n\n\t}\n\n\tfunction onContextMenu( event ) {\n\n\t\tif ( scope.enabled === false ) return;\n\n\t\tevent.preventDefault();\n\n\t}\n\n\t//\n\n\tscope.domElement.addEventListener( 'contextmenu', onContextMenu, false );\n\n\tscope.domElement.addEventListener( 'mousedown', onMouseDown, false );\n\tscope.domElement.addEventListener( 'wheel', onMouseWheel, false );\n\n\tscope.domElement.addEventListener( 'touchstart', onTouchStart, false );\n\tscope.domElement.addEventListener( 'touchend', onTouchEnd, false );\n\tscope.domElement.addEventListener( 'touchmove', onTouchMove, false );\n\n\tscope.domElement.addEventListener( 'keydown', onKeyDown, false );\n\n\t// make sure element can receive keys.\n\n\tif ( scope.domElement.tabIndex === - 1 ) {\n\n\t\tscope.domElement.tabIndex = 0;\n\n\t}\n\n\t// force an update at start\n\n\tthis.update();\n\n};\n\nOrbitControls.prototype = Object.create( EventDispatcher.prototype );\nOrbitControls.prototype.constructor = OrbitControls;\n\n\n// This set of controls performs orbiting, dollying (zooming), and panning.\n// Unlike TrackballControls, it maintains the \"up\" direction object.up (+Y by default).\n// This is very similar to OrbitControls, another set of touch behavior\n//\n//    Orbit - right mouse, or left mouse + ctrl/meta/shiftKey / touch: two-finger rotate\n//    Zoom - middle mouse, or mousewheel / touch: two-finger spread or squish\n//    Pan - left mouse, or arrow keys / touch: one-finger move\n\nvar MapControls = function ( object, domElement ) {\n\n\tOrbitControls.call( this, object, domElement );\n\n\tthis.mouseButtons.LEFT = MOUSE.PAN;\n\tthis.mouseButtons.RIGHT = MOUSE.ROTATE;\n\n\tthis.touches.ONE = TOUCH.PAN;\n\tthis.touches.TWO = TOUCH.DOLLY_ROTATE;\n\n};\n\nMapControls.prototype = Object.create( EventDispatcher.prototype );\nMapControls.prototype.constructor = MapControls;\n\nexport { OrbitControls, MapControls };\n"],"sourceRoot":""}